"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/pkijs";
exports.ids = ["vendor-chunks/pkijs"];
exports.modules = {

/***/ "(ssr)/./node_modules/pkijs/build/index.es.js":
/*!**********************************************!*\
  !*** ./node_modules/pkijs/build/index.es.js ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AbstractCryptoEngine: () => (/* binding */ AbstractCryptoEngine),\n/* harmony export */   AccessDescription: () => (/* binding */ AccessDescription),\n/* harmony export */   Accuracy: () => (/* binding */ Accuracy),\n/* harmony export */   AlgorithmIdentifier: () => (/* binding */ AlgorithmIdentifier),\n/* harmony export */   AltName: () => (/* binding */ AltName),\n/* harmony export */   ArgumentError: () => (/* binding */ ArgumentError),\n/* harmony export */   AsnError: () => (/* binding */ AsnError),\n/* harmony export */   AttCertValidityPeriod: () => (/* binding */ AttCertValidityPeriod),\n/* harmony export */   Attribute: () => (/* binding */ Attribute),\n/* harmony export */   AttributeCertificateInfoV1: () => (/* binding */ AttributeCertificateInfoV1),\n/* harmony export */   AttributeCertificateInfoV2: () => (/* binding */ AttributeCertificateInfoV2),\n/* harmony export */   AttributeCertificateV1: () => (/* binding */ AttributeCertificateV1),\n/* harmony export */   AttributeCertificateV2: () => (/* binding */ AttributeCertificateV2),\n/* harmony export */   AttributeTypeAndValue: () => (/* binding */ AttributeTypeAndValue),\n/* harmony export */   AuthenticatedSafe: () => (/* binding */ AuthenticatedSafe),\n/* harmony export */   AuthorityKeyIdentifier: () => (/* binding */ AuthorityKeyIdentifier),\n/* harmony export */   BasicConstraints: () => (/* binding */ BasicConstraints),\n/* harmony export */   BasicOCSPResponse: () => (/* binding */ BasicOCSPResponse),\n/* harmony export */   CAVersion: () => (/* binding */ CAVersion),\n/* harmony export */   CRLBag: () => (/* binding */ CRLBag),\n/* harmony export */   CRLDistributionPoints: () => (/* binding */ CRLDistributionPoints),\n/* harmony export */   CertBag: () => (/* binding */ CertBag),\n/* harmony export */   CertID: () => (/* binding */ CertID),\n/* harmony export */   Certificate: () => (/* binding */ Certificate),\n/* harmony export */   CertificateChainValidationEngine: () => (/* binding */ CertificateChainValidationEngine),\n/* harmony export */   CertificatePolicies: () => (/* binding */ CertificatePolicies),\n/* harmony export */   CertificateRevocationList: () => (/* binding */ CertificateRevocationList),\n/* harmony export */   CertificateSet: () => (/* binding */ CertificateSet),\n/* harmony export */   CertificateTemplate: () => (/* binding */ CertificateTemplate),\n/* harmony export */   CertificationRequest: () => (/* binding */ CertificationRequest),\n/* harmony export */   ChainValidationCode: () => (/* binding */ ChainValidationCode),\n/* harmony export */   ChainValidationError: () => (/* binding */ ChainValidationError),\n/* harmony export */   ContentInfo: () => (/* binding */ ContentInfo),\n/* harmony export */   CryptoEngine: () => (/* binding */ CryptoEngine),\n/* harmony export */   DigestInfo: () => (/* binding */ DigestInfo),\n/* harmony export */   DistributionPoint: () => (/* binding */ DistributionPoint),\n/* harmony export */   ECCCMSSharedInfo: () => (/* binding */ ECCCMSSharedInfo),\n/* harmony export */   ECNamedCurves: () => (/* binding */ ECNamedCurves),\n/* harmony export */   ECPrivateKey: () => (/* binding */ ECPrivateKey),\n/* harmony export */   ECPublicKey: () => (/* binding */ ECPublicKey),\n/* harmony export */   EncapsulatedContentInfo: () => (/* binding */ EncapsulatedContentInfo),\n/* harmony export */   EncryptedContentInfo: () => (/* binding */ EncryptedContentInfo),\n/* harmony export */   EncryptedData: () => (/* binding */ EncryptedData),\n/* harmony export */   EnvelopedData: () => (/* binding */ EnvelopedData),\n/* harmony export */   ExtKeyUsage: () => (/* binding */ ExtKeyUsage),\n/* harmony export */   Extension: () => (/* binding */ Extension),\n/* harmony export */   ExtensionValueFactory: () => (/* binding */ ExtensionValueFactory),\n/* harmony export */   Extensions: () => (/* binding */ Extensions),\n/* harmony export */   GeneralName: () => (/* binding */ GeneralName),\n/* harmony export */   GeneralNames: () => (/* binding */ GeneralNames),\n/* harmony export */   GeneralSubtree: () => (/* binding */ GeneralSubtree),\n/* harmony export */   HASHED_MESSAGE: () => (/* binding */ HASHED_MESSAGE),\n/* harmony export */   HASH_ALGORITHM: () => (/* binding */ HASH_ALGORITHM),\n/* harmony export */   Holder: () => (/* binding */ Holder),\n/* harmony export */   InfoAccess: () => (/* binding */ InfoAccess),\n/* harmony export */   IssuerAndSerialNumber: () => (/* binding */ IssuerAndSerialNumber),\n/* harmony export */   IssuerSerial: () => (/* binding */ IssuerSerial),\n/* harmony export */   IssuingDistributionPoint: () => (/* binding */ IssuingDistributionPoint),\n/* harmony export */   KEKIdentifier: () => (/* binding */ KEKIdentifier),\n/* harmony export */   KEKRecipientInfo: () => (/* binding */ KEKRecipientInfo),\n/* harmony export */   KeyAgreeRecipientIdentifier: () => (/* binding */ KeyAgreeRecipientIdentifier),\n/* harmony export */   KeyAgreeRecipientInfo: () => (/* binding */ KeyAgreeRecipientInfo),\n/* harmony export */   KeyBag: () => (/* binding */ KeyBag),\n/* harmony export */   KeyTransRecipientInfo: () => (/* binding */ KeyTransRecipientInfo),\n/* harmony export */   MICROS: () => (/* binding */ MICROS),\n/* harmony export */   MILLIS: () => (/* binding */ MILLIS),\n/* harmony export */   MacData: () => (/* binding */ MacData),\n/* harmony export */   MessageImprint: () => (/* binding */ MessageImprint),\n/* harmony export */   NameConstraints: () => (/* binding */ NameConstraints),\n/* harmony export */   OCSPRequest: () => (/* binding */ OCSPRequest),\n/* harmony export */   OCSPResponse: () => (/* binding */ OCSPResponse),\n/* harmony export */   ObjectDigestInfo: () => (/* binding */ ObjectDigestInfo),\n/* harmony export */   OriginatorIdentifierOrKey: () => (/* binding */ OriginatorIdentifierOrKey),\n/* harmony export */   OriginatorInfo: () => (/* binding */ OriginatorInfo),\n/* harmony export */   OriginatorPublicKey: () => (/* binding */ OriginatorPublicKey),\n/* harmony export */   OtherCertificateFormat: () => (/* binding */ OtherCertificateFormat),\n/* harmony export */   OtherKeyAttribute: () => (/* binding */ OtherKeyAttribute),\n/* harmony export */   OtherPrimeInfo: () => (/* binding */ OtherPrimeInfo),\n/* harmony export */   OtherRecipientInfo: () => (/* binding */ OtherRecipientInfo),\n/* harmony export */   OtherRevocationInfoFormat: () => (/* binding */ OtherRevocationInfoFormat),\n/* harmony export */   PBES2Params: () => (/* binding */ PBES2Params),\n/* harmony export */   PBKDF2Params: () => (/* binding */ PBKDF2Params),\n/* harmony export */   PFX: () => (/* binding */ PFX),\n/* harmony export */   PKCS8ShroudedKeyBag: () => (/* binding */ PKCS8ShroudedKeyBag),\n/* harmony export */   PKIStatus: () => (/* binding */ PKIStatus),\n/* harmony export */   PKIStatusInfo: () => (/* binding */ PKIStatusInfo),\n/* harmony export */   POLICY_IDENTIFIER: () => (/* binding */ POLICY_IDENTIFIER),\n/* harmony export */   POLICY_QUALIFIERS: () => (/* binding */ POLICY_QUALIFIERS),\n/* harmony export */   ParameterError: () => (/* binding */ ParameterError),\n/* harmony export */   PasswordRecipientinfo: () => (/* binding */ PasswordRecipientinfo),\n/* harmony export */   PkiObject: () => (/* binding */ PkiObject),\n/* harmony export */   PolicyConstraints: () => (/* binding */ PolicyConstraints),\n/* harmony export */   PolicyInformation: () => (/* binding */ PolicyInformation),\n/* harmony export */   PolicyMapping: () => (/* binding */ PolicyMapping),\n/* harmony export */   PolicyMappings: () => (/* binding */ PolicyMappings),\n/* harmony export */   PolicyQualifierInfo: () => (/* binding */ PolicyQualifierInfo),\n/* harmony export */   PrivateKeyInfo: () => (/* binding */ PrivateKeyInfo),\n/* harmony export */   PrivateKeyUsagePeriod: () => (/* binding */ PrivateKeyUsagePeriod),\n/* harmony export */   PublicKeyInfo: () => (/* binding */ PublicKeyInfo),\n/* harmony export */   QCStatement: () => (/* binding */ QCStatement),\n/* harmony export */   QCStatements: () => (/* binding */ QCStatements),\n/* harmony export */   RDN: () => (/* binding */ RDN),\n/* harmony export */   RSAESOAEPParams: () => (/* binding */ RSAESOAEPParams),\n/* harmony export */   RSAPrivateKey: () => (/* binding */ RSAPrivateKey),\n/* harmony export */   RSAPublicKey: () => (/* binding */ RSAPublicKey),\n/* harmony export */   RSASSAPSSParams: () => (/* binding */ RSASSAPSSParams),\n/* harmony export */   RecipientEncryptedKey: () => (/* binding */ RecipientEncryptedKey),\n/* harmony export */   RecipientEncryptedKeys: () => (/* binding */ RecipientEncryptedKeys),\n/* harmony export */   RecipientIdentifier: () => (/* binding */ RecipientIdentifier),\n/* harmony export */   RecipientInfo: () => (/* binding */ RecipientInfo),\n/* harmony export */   RecipientKeyIdentifier: () => (/* binding */ RecipientKeyIdentifier),\n/* harmony export */   RelativeDistinguishedNames: () => (/* binding */ RelativeDistinguishedNames),\n/* harmony export */   Request: () => (/* binding */ Request),\n/* harmony export */   ResponseBytes: () => (/* binding */ ResponseBytes),\n/* harmony export */   ResponseData: () => (/* binding */ ResponseData),\n/* harmony export */   RevocationInfoChoices: () => (/* binding */ RevocationInfoChoices),\n/* harmony export */   RevokedCertificate: () => (/* binding */ RevokedCertificate),\n/* harmony export */   SECONDS: () => (/* binding */ SECONDS),\n/* harmony export */   SafeBag: () => (/* binding */ SafeBag),\n/* harmony export */   SafeBagValueFactory: () => (/* binding */ SafeBagValueFactory),\n/* harmony export */   SafeContents: () => (/* binding */ SafeContents),\n/* harmony export */   SecretBag: () => (/* binding */ SecretBag),\n/* harmony export */   Signature: () => (/* binding */ Signature),\n/* harmony export */   SignedAndUnsignedAttributes: () => (/* binding */ SignedAndUnsignedAttributes),\n/* harmony export */   SignedCertificateTimestamp: () => (/* binding */ SignedCertificateTimestamp),\n/* harmony export */   SignedCertificateTimestampList: () => (/* binding */ SignedCertificateTimestampList),\n/* harmony export */   SignedData: () => (/* binding */ SignedData),\n/* harmony export */   SignedDataVerifyError: () => (/* binding */ SignedDataVerifyError),\n/* harmony export */   SignerInfo: () => (/* binding */ SignerInfo),\n/* harmony export */   SingleResponse: () => (/* binding */ SingleResponse),\n/* harmony export */   SubjectDirectoryAttributes: () => (/* binding */ SubjectDirectoryAttributes),\n/* harmony export */   TBSRequest: () => (/* binding */ TBSRequest),\n/* harmony export */   TSTInfo: () => (/* binding */ TSTInfo),\n/* harmony export */   TYPE: () => (/* binding */ TYPE$4),\n/* harmony export */   TYPE_AND_VALUES: () => (/* binding */ TYPE_AND_VALUES),\n/* harmony export */   Time: () => (/* binding */ Time),\n/* harmony export */   TimeStampReq: () => (/* binding */ TimeStampReq),\n/* harmony export */   TimeStampResp: () => (/* binding */ TimeStampResp),\n/* harmony export */   TimeType: () => (/* binding */ TimeType),\n/* harmony export */   V2Form: () => (/* binding */ V2Form),\n/* harmony export */   VALUE: () => (/* binding */ VALUE$5),\n/* harmony export */   VALUE_BEFORE_DECODE: () => (/* binding */ VALUE_BEFORE_DECODE),\n/* harmony export */   checkCA: () => (/* binding */ checkCA),\n/* harmony export */   createCMSECDSASignature: () => (/* binding */ createCMSECDSASignature),\n/* harmony export */   createECDSASignatureFromCMS: () => (/* binding */ createECDSASignatureFromCMS),\n/* harmony export */   engine: () => (/* binding */ engine),\n/* harmony export */   getAlgorithmByOID: () => (/* binding */ getAlgorithmByOID),\n/* harmony export */   getAlgorithmParameters: () => (/* binding */ getAlgorithmParameters),\n/* harmony export */   getCrypto: () => (/* binding */ getCrypto),\n/* harmony export */   getEngine: () => (/* binding */ getEngine),\n/* harmony export */   getHashAlgorithm: () => (/* binding */ getHashAlgorithm),\n/* harmony export */   getOIDByAlgorithm: () => (/* binding */ getOIDByAlgorithm),\n/* harmony export */   getRandomValues: () => (/* binding */ getRandomValues),\n/* harmony export */   id_AnyPolicy: () => (/* binding */ id_AnyPolicy),\n/* harmony export */   id_AuthorityInfoAccess: () => (/* binding */ id_AuthorityInfoAccess),\n/* harmony export */   id_AuthorityKeyIdentifier: () => (/* binding */ id_AuthorityKeyIdentifier),\n/* harmony export */   id_BaseCRLNumber: () => (/* binding */ id_BaseCRLNumber),\n/* harmony export */   id_BasicConstraints: () => (/* binding */ id_BasicConstraints),\n/* harmony export */   id_CRLBag_X509CRL: () => (/* binding */ id_CRLBag_X509CRL),\n/* harmony export */   id_CRLDistributionPoints: () => (/* binding */ id_CRLDistributionPoints),\n/* harmony export */   id_CRLNumber: () => (/* binding */ id_CRLNumber),\n/* harmony export */   id_CRLReason: () => (/* binding */ id_CRLReason),\n/* harmony export */   id_CertBag_AttributeCertificate: () => (/* binding */ id_CertBag_AttributeCertificate),\n/* harmony export */   id_CertBag_SDSICertificate: () => (/* binding */ id_CertBag_SDSICertificate),\n/* harmony export */   id_CertBag_X509Certificate: () => (/* binding */ id_CertBag_X509Certificate),\n/* harmony export */   id_CertificateIssuer: () => (/* binding */ id_CertificateIssuer),\n/* harmony export */   id_CertificatePolicies: () => (/* binding */ id_CertificatePolicies),\n/* harmony export */   id_ContentType_Data: () => (/* binding */ id_ContentType_Data),\n/* harmony export */   id_ContentType_EncryptedData: () => (/* binding */ id_ContentType_EncryptedData),\n/* harmony export */   id_ContentType_EnvelopedData: () => (/* binding */ id_ContentType_EnvelopedData),\n/* harmony export */   id_ContentType_SignedData: () => (/* binding */ id_ContentType_SignedData),\n/* harmony export */   id_ExtKeyUsage: () => (/* binding */ id_ExtKeyUsage),\n/* harmony export */   id_FreshestCRL: () => (/* binding */ id_FreshestCRL),\n/* harmony export */   id_InhibitAnyPolicy: () => (/* binding */ id_InhibitAnyPolicy),\n/* harmony export */   id_InvalidityDate: () => (/* binding */ id_InvalidityDate),\n/* harmony export */   id_IssuerAltName: () => (/* binding */ id_IssuerAltName),\n/* harmony export */   id_IssuingDistributionPoint: () => (/* binding */ id_IssuingDistributionPoint),\n/* harmony export */   id_KeyUsage: () => (/* binding */ id_KeyUsage),\n/* harmony export */   id_MicrosoftAppPolicies: () => (/* binding */ id_MicrosoftAppPolicies),\n/* harmony export */   id_MicrosoftCaVersion: () => (/* binding */ id_MicrosoftCaVersion),\n/* harmony export */   id_MicrosoftCertTemplateV1: () => (/* binding */ id_MicrosoftCertTemplateV1),\n/* harmony export */   id_MicrosoftCertTemplateV2: () => (/* binding */ id_MicrosoftCertTemplateV2),\n/* harmony export */   id_MicrosoftPrevCaCertHash: () => (/* binding */ id_MicrosoftPrevCaCertHash),\n/* harmony export */   id_NameConstraints: () => (/* binding */ id_NameConstraints),\n/* harmony export */   id_PKIX_OCSP_Basic: () => (/* binding */ id_PKIX_OCSP_Basic),\n/* harmony export */   id_PolicyConstraints: () => (/* binding */ id_PolicyConstraints),\n/* harmony export */   id_PolicyMappings: () => (/* binding */ id_PolicyMappings),\n/* harmony export */   id_PrivateKeyUsagePeriod: () => (/* binding */ id_PrivateKeyUsagePeriod),\n/* harmony export */   id_QCStatements: () => (/* binding */ id_QCStatements),\n/* harmony export */   id_SignedCertificateTimestampList: () => (/* binding */ id_SignedCertificateTimestampList),\n/* harmony export */   id_SubjectAltName: () => (/* binding */ id_SubjectAltName),\n/* harmony export */   id_SubjectDirectoryAttributes: () => (/* binding */ id_SubjectDirectoryAttributes),\n/* harmony export */   id_SubjectInfoAccess: () => (/* binding */ id_SubjectInfoAccess),\n/* harmony export */   id_SubjectKeyIdentifier: () => (/* binding */ id_SubjectKeyIdentifier),\n/* harmony export */   id_ad: () => (/* binding */ id_ad),\n/* harmony export */   id_ad_caIssuers: () => (/* binding */ id_ad_caIssuers),\n/* harmony export */   id_ad_ocsp: () => (/* binding */ id_ad_ocsp),\n/* harmony export */   id_eContentType_TSTInfo: () => (/* binding */ id_eContentType_TSTInfo),\n/* harmony export */   id_pkix: () => (/* binding */ id_pkix),\n/* harmony export */   id_sha1: () => (/* binding */ id_sha1),\n/* harmony export */   id_sha256: () => (/* binding */ id_sha256),\n/* harmony export */   id_sha384: () => (/* binding */ id_sha384),\n/* harmony export */   id_sha512: () => (/* binding */ id_sha512),\n/* harmony export */   kdf: () => (/* binding */ kdf),\n/* harmony export */   setEngine: () => (/* binding */ setEngine),\n/* harmony export */   stringPrep: () => (/* binding */ stringPrep),\n/* harmony export */   verifySCTsForCertificate: () => (/* binding */ verifySCTsForCertificate)\n/* harmony export */ });\n/* harmony import */ var asn1js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! asn1js */ \"(ssr)/./node_modules/asn1js/build/index.es.js\");\n/* harmony import */ var pvtsutils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pvtsutils */ \"(ssr)/./node_modules/pvtsutils/build/index.es.js\");\n/* harmony import */ var pvutils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pvutils */ \"(ssr)/./node_modules/pvutils/build/utils.es.js\");\n/* harmony import */ var bytestreamjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! bytestreamjs */ \"(ssr)/./node_modules/bytestreamjs/build/mjs/index.js\");\n/* harmony import */ var _noble_hashes_sha1__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @noble/hashes/sha1 */ \"(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/sha1.js\");\n/* harmony import */ var _noble_hashes_sha2__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @noble/hashes/sha2 */ \"(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/sha256.js\");\n/* harmony import */ var _noble_hashes_sha2__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @noble/hashes/sha2 */ \"(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/sha512.js\");\n/*!\n * Copyright (c) 2014, GlobalSign\n * Copyright (c) 2015-2019, Peculiar Ventures\n * All rights reserved.\n * \n * Author 2014-2019, Yury Strozhevsky\n * \n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n * \n * * Redistributions of source code must retain the above copyright notice, this\n *   list of conditions and the following disclaimer.\n * \n * * Redistributions in binary form must reproduce the above copyright notice, this\n *   list of conditions and the following disclaimer in the documentation and/or\n *   other materials provided with the distribution.\n * \n * * Neither the name of the {organization} nor the names of its\n *   contributors may be used to endorse or promote products derived from\n *   this software without specific prior written permission.\n * \n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n * \n */\n\n\n\n\n\n\n\n\n\nconst EMPTY_BUFFER = new ArrayBuffer(0);\nconst EMPTY_STRING = \"\";\n\nclass ArgumentError extends TypeError {\n    constructor() {\n        super(...arguments);\n        this.name = ArgumentError.NAME;\n    }\n    static isType(value, type) {\n        if (typeof type === \"string\") {\n            if (type === \"Array\" && Array.isArray(value)) {\n                return true;\n            }\n            else if (type === \"ArrayBuffer\" && value instanceof ArrayBuffer) {\n                return true;\n            }\n            else if (type === \"ArrayBufferView\" && ArrayBuffer.isView(value)) {\n                return true;\n            }\n            else if (typeof value === type) {\n                return true;\n            }\n        }\n        else if (value instanceof type) {\n            return true;\n        }\n        return false;\n    }\n    static assert(value, name, ...types) {\n        for (const type of types) {\n            if (this.isType(value, type)) {\n                return;\n            }\n        }\n        const typeNames = types.map(o => o instanceof Function && \"name\" in o ? o.name : `${o}`);\n        throw new ArgumentError(`Parameter '${name}' is not of type ${typeNames.length > 1 ? `(${typeNames.join(\" or \")})` : typeNames[0]}`);\n    }\n}\nArgumentError.NAME = \"ArgumentError\";\n\nclass ParameterError extends TypeError {\n    static assert(...args) {\n        let target = null;\n        let params;\n        let fields;\n        if (typeof args[0] === \"string\") {\n            target = args[0];\n            params = args[1];\n            fields = args.slice(2);\n        }\n        else {\n            params = args[0];\n            fields = args.slice(1);\n        }\n        ArgumentError.assert(params, \"parameters\", \"object\");\n        for (const field of fields) {\n            const value = params[field];\n            if (value === undefined || value === null) {\n                throw new ParameterError(field, target);\n            }\n        }\n    }\n    static assertEmpty(value, name, target) {\n        if (value === undefined || value === null) {\n            throw new ParameterError(name, target);\n        }\n    }\n    constructor(field, target = null, message) {\n        super();\n        this.name = ParameterError.NAME;\n        this.field = field;\n        if (target) {\n            this.target = target;\n        }\n        if (message) {\n            this.message = message;\n        }\n        else {\n            this.message = `Absent mandatory parameter '${field}' ${target ? ` in '${target}'` : EMPTY_STRING}`;\n        }\n    }\n}\nParameterError.NAME = \"ParameterError\";\n\nclass AsnError extends Error {\n    static assertSchema(asn1, target) {\n        if (!asn1.verified) {\n            throw new Error(`Object's schema was not verified against input data for ${target}`);\n        }\n    }\n    static assert(asn, target) {\n        if (asn.offset === -1) {\n            throw new AsnError(`Error during parsing of ASN.1 data. Data is not correct for '${target}'.`);\n        }\n    }\n    constructor(message) {\n        super(message);\n        this.name = \"AsnError\";\n    }\n}\n\nclass PkiObject {\n    static blockName() {\n        return this.CLASS_NAME;\n    }\n    static fromBER(raw) {\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(raw);\n        AsnError.assert(asn1, this.name);\n        try {\n            return new this({ schema: asn1.result });\n        }\n        catch (e) {\n            throw new AsnError(`Cannot create '${this.CLASS_NAME}' from ASN.1 object`);\n        }\n    }\n    static defaultValues(memberName) {\n        throw new Error(`Invalid member name for ${this.CLASS_NAME} class: ${memberName}`);\n    }\n    static schema(parameters = {}) {\n        throw new Error(`Method '${this.CLASS_NAME}.schema' should be overridden`);\n    }\n    get className() {\n        return this.constructor.CLASS_NAME;\n    }\n    toString(encoding = \"hex\") {\n        let schema;\n        try {\n            schema = this.toSchema();\n        }\n        catch {\n            schema = this.toSchema(true);\n        }\n        return pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToString(schema.toBER(), encoding);\n    }\n}\nPkiObject.CLASS_NAME = \"PkiObject\";\n\nfunction stringPrep(inputString) {\n    let isSpace = false;\n    let cutResult = EMPTY_STRING;\n    const result = inputString.trim();\n    for (let i = 0; i < result.length; i++) {\n        if (result.charCodeAt(i) === 32) {\n            if (isSpace === false)\n                isSpace = true;\n        }\n        else {\n            if (isSpace) {\n                cutResult += \" \";\n                isSpace = false;\n            }\n            cutResult += result[i];\n        }\n    }\n    return cutResult.toLowerCase();\n}\n\nconst TYPE$5 = \"type\";\nconst VALUE$6 = \"value\";\nclass AttributeTypeAndValue extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.type = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TYPE$5, AttributeTypeAndValue.defaultValues(TYPE$5));\n        this.value = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VALUE$6, AttributeTypeAndValue.defaultValues(VALUE$6));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TYPE$5:\n                return EMPTY_STRING;\n            case VALUE$6:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.type || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ name: (names.value || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, [\n            TYPE$5,\n            \"typeValue\"\n        ]);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, AttributeTypeAndValue.schema({\n            names: {\n                type: TYPE$5,\n                value: \"typeValue\"\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.type = asn1.result.type.valueBlock.toString();\n        this.value = asn1.result.typeValue;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.type }),\n                this.value\n            ]\n        }));\n    }\n    toJSON() {\n        const _object = {\n            type: this.type\n        };\n        if (Object.keys(this.value).length !== 0) {\n            _object.value = (this.value).toJSON();\n        }\n        else {\n            _object.value = this.value;\n        }\n        return _object;\n    }\n    isEqual(compareTo) {\n        const stringBlockNames = [\n            asn1js__WEBPACK_IMPORTED_MODULE_0__.Utf8String.blockName(),\n            asn1js__WEBPACK_IMPORTED_MODULE_0__.BmpString.blockName(),\n            asn1js__WEBPACK_IMPORTED_MODULE_0__.UniversalString.blockName(),\n            asn1js__WEBPACK_IMPORTED_MODULE_0__.NumericString.blockName(),\n            asn1js__WEBPACK_IMPORTED_MODULE_0__.PrintableString.blockName(),\n            asn1js__WEBPACK_IMPORTED_MODULE_0__.TeletexString.blockName(),\n            asn1js__WEBPACK_IMPORTED_MODULE_0__.VideotexString.blockName(),\n            asn1js__WEBPACK_IMPORTED_MODULE_0__.IA5String.blockName(),\n            asn1js__WEBPACK_IMPORTED_MODULE_0__.GraphicString.blockName(),\n            asn1js__WEBPACK_IMPORTED_MODULE_0__.VisibleString.blockName(),\n            asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralString.blockName(),\n            asn1js__WEBPACK_IMPORTED_MODULE_0__.CharacterString.blockName()\n        ];\n        if (compareTo instanceof ArrayBuffer) {\n            return pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isEqual(this.value.valueBeforeDecodeView, compareTo);\n        }\n        if (compareTo.constructor.blockName() === AttributeTypeAndValue.blockName()) {\n            if (this.type !== compareTo.type)\n                return false;\n            const isStringPair = [false, false];\n            const thisName = this.value.constructor.blockName();\n            for (const name of stringBlockNames) {\n                if (thisName === name) {\n                    isStringPair[0] = true;\n                }\n                if (compareTo.value.constructor.blockName() === name) {\n                    isStringPair[1] = true;\n                }\n            }\n            if (isStringPair[0] !== isStringPair[1]) {\n                return false;\n            }\n            const isString = (isStringPair[0] && isStringPair[1]);\n            if (isString) {\n                const value1 = stringPrep(this.value.valueBlock.value);\n                const value2 = stringPrep(compareTo.value.valueBlock.value);\n                if (value1.localeCompare(value2) !== 0)\n                    return false;\n            }\n            else {\n                if (!pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isEqual(this.value.valueBeforeDecodeView, compareTo.value.valueBeforeDecodeView))\n                    return false;\n            }\n            return true;\n        }\n        return false;\n    }\n}\nAttributeTypeAndValue.CLASS_NAME = \"AttributeTypeAndValue\";\n\nconst TYPE_AND_VALUES = \"typesAndValues\";\nconst VALUE_BEFORE_DECODE = \"valueBeforeDecode\";\nconst RDN = \"RDN\";\nclass RelativeDistinguishedNames extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.typesAndValues = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TYPE_AND_VALUES, RelativeDistinguishedNames.defaultValues(TYPE_AND_VALUES));\n        this.valueBeforeDecode = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VALUE_BEFORE_DECODE, RelativeDistinguishedNames.defaultValues(VALUE_BEFORE_DECODE));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TYPE_AND_VALUES:\n                return [];\n            case VALUE_BEFORE_DECODE:\n                return EMPTY_BUFFER;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case TYPE_AND_VALUES:\n                return (memberValue.length === 0);\n            case VALUE_BEFORE_DECODE:\n                return (memberValue.byteLength === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.repeatedSequence || EMPTY_STRING),\n                    value: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n                        value: [\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                                name: (names.repeatedSet || EMPTY_STRING),\n                                value: AttributeTypeAndValue.schema(names.typeAndValue || {})\n                            })\n                        ]\n                    })\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, [\n            RDN,\n            TYPE_AND_VALUES\n        ]);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, RelativeDistinguishedNames.schema({\n            names: {\n                blockName: RDN,\n                repeatedSet: TYPE_AND_VALUES\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (TYPE_AND_VALUES in asn1.result) {\n            this.typesAndValues = Array.from(asn1.result.typesAndValues, element => new AttributeTypeAndValue({ schema: element }));\n        }\n        this.valueBeforeDecode = asn1.result.RDN.valueBeforeDecodeView.slice().buffer;\n    }\n    toSchema() {\n        if (this.valueBeforeDecode.byteLength === 0) {\n            return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n                        value: Array.from(this.typesAndValues, o => o.toSchema())\n                    })]\n            }));\n        }\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(this.valueBeforeDecode);\n        AsnError.assert(asn1, \"RelativeDistinguishedNames\");\n        if (!(asn1.result instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence)) {\n            throw new Error(\"ASN.1 result should be SEQUENCE\");\n        }\n        return asn1.result;\n    }\n    toJSON() {\n        return {\n            typesAndValues: Array.from(this.typesAndValues, o => o.toJSON())\n        };\n    }\n    isEqual(compareTo) {\n        if (compareTo instanceof RelativeDistinguishedNames) {\n            if (this.typesAndValues.length !== compareTo.typesAndValues.length)\n                return false;\n            for (const [index, typeAndValue] of this.typesAndValues.entries()) {\n                if (typeAndValue.isEqual(compareTo.typesAndValues[index]) === false)\n                    return false;\n            }\n            return true;\n        }\n        if (compareTo instanceof ArrayBuffer) {\n            return pvutils__WEBPACK_IMPORTED_MODULE_2__.isEqualBuffer(this.valueBeforeDecode, compareTo);\n        }\n        return false;\n    }\n}\nRelativeDistinguishedNames.CLASS_NAME = \"RelativeDistinguishedNames\";\n\nconst TYPE$4 = \"type\";\nconst VALUE$5 = \"value\";\nfunction builtInStandardAttributes(parameters = {}, optional = false) {\n    const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n    return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n        optional,\n        value: [\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 2,\n                    tagNumber: 1\n                },\n                name: (names.country_name || EMPTY_STRING),\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                        value: [\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.NumericString(),\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.PrintableString()\n                        ]\n                    })\n                ]\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 2,\n                    tagNumber: 2\n                },\n                name: (names.administration_domain_name || EMPTY_STRING),\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                        value: [\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.NumericString(),\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.PrintableString()\n                        ]\n                    })\n                ]\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                name: (names.network_address || EMPTY_STRING),\n                isHexOnly: true\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                name: (names.terminal_identifier || EMPTY_STRING),\n                isHexOnly: true\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 2\n                },\n                name: (names.private_domain_name || EMPTY_STRING),\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                        value: [\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.NumericString(),\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.PrintableString()\n                        ]\n                    })\n                ]\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 3\n                },\n                name: (names.organization_name || EMPTY_STRING),\n                isHexOnly: true\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                optional: true,\n                name: (names.numeric_user_identifier || EMPTY_STRING),\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 4\n                },\n                isHexOnly: true\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                name: (names.personal_name || EMPTY_STRING),\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 5\n                },\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                        idBlock: {\n                            tagClass: 3,\n                            tagNumber: 0\n                        },\n                        isHexOnly: true\n                    }),\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                        optional: true,\n                        idBlock: {\n                            tagClass: 3,\n                            tagNumber: 1\n                        },\n                        isHexOnly: true\n                    }),\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                        optional: true,\n                        idBlock: {\n                            tagClass: 3,\n                            tagNumber: 2\n                        },\n                        isHexOnly: true\n                    }),\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                        optional: true,\n                        idBlock: {\n                            tagClass: 3,\n                            tagNumber: 3\n                        },\n                        isHexOnly: true\n                    })\n                ]\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                name: (names.organizational_unit_names || EMPTY_STRING),\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 6\n                },\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                        value: new asn1js__WEBPACK_IMPORTED_MODULE_0__.PrintableString()\n                    })\n                ]\n            })\n        ]\n    }));\n}\nfunction builtInDomainDefinedAttributes(optional = false) {\n    return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n        optional,\n        value: [\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.PrintableString(),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.PrintableString()\n        ]\n    }));\n}\nfunction extensionAttributes(optional = false) {\n    return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n        optional,\n        value: [\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                isHexOnly: true\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any()]\n            })\n        ]\n    }));\n}\nclass GeneralName extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.type = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TYPE$4, GeneralName.defaultValues(TYPE$4));\n        this.value = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VALUE$5, GeneralName.defaultValues(VALUE$5));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TYPE$4:\n                return 9;\n            case VALUE$5:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case TYPE$4:\n                return (memberValue === GeneralName.defaultValues(memberName));\n            case VALUE$5:\n                return (Object.keys(memberValue).length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    name: (names.blockName || EMPTY_STRING),\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier(),\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 0\n                            },\n                            value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any()]\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.blockName || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.blockName || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 2\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 3\n                    },\n                    name: (names.blockName || EMPTY_STRING),\n                    value: [\n                        builtInStandardAttributes((names.builtInStandardAttributes || {}), false),\n                        builtInDomainDefinedAttributes(true),\n                        extensionAttributes(true)\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 4\n                    },\n                    name: (names.blockName || EMPTY_STRING),\n                    value: [RelativeDistinguishedNames.schema(names.directoryName || {})]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 5\n                    },\n                    name: (names.blockName || EMPTY_STRING),\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            optional: true,\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 0\n                            },\n                            value: [\n                                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                                    value: [\n                                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.TeletexString(),\n                                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.PrintableString(),\n                                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.UniversalString(),\n                                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Utf8String(),\n                                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.BmpString()\n                                    ]\n                                })\n                            ]\n                        }),\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 1\n                            },\n                            value: [\n                                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                                    value: [\n                                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.TeletexString(),\n                                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.PrintableString(),\n                                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.UniversalString(),\n                                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Utf8String(),\n                                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.BmpString()\n                                    ]\n                                })\n                            ]\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.blockName || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 6\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.blockName || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 7\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.blockName || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 8\n                    }\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, [\n            \"blockName\",\n            \"otherName\",\n            \"rfc822Name\",\n            \"dNSName\",\n            \"x400Address\",\n            \"directoryName\",\n            \"ediPartyName\",\n            \"uniformResourceIdentifier\",\n            \"iPAddress\",\n            \"registeredID\"\n        ]);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, GeneralName.schema({\n            names: {\n                blockName: \"blockName\",\n                otherName: \"otherName\",\n                rfc822Name: \"rfc822Name\",\n                dNSName: \"dNSName\",\n                x400Address: \"x400Address\",\n                directoryName: {\n                    names: {\n                        blockName: \"directoryName\"\n                    }\n                },\n                ediPartyName: \"ediPartyName\",\n                uniformResourceIdentifier: \"uniformResourceIdentifier\",\n                iPAddress: \"iPAddress\",\n                registeredID: \"registeredID\"\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.type = asn1.result.blockName.idBlock.tagNumber;\n        switch (this.type) {\n            case 0:\n                this.value = asn1.result.blockName;\n                break;\n            case 1:\n            case 2:\n            case 6:\n                {\n                    const value = asn1.result.blockName;\n                    value.idBlock.tagClass = 1;\n                    value.idBlock.tagNumber = 22;\n                    const valueBER = value.toBER(false);\n                    const asnValue = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(valueBER);\n                    AsnError.assert(asnValue, \"GeneralName value\");\n                    this.value = asnValue.result.valueBlock.value;\n                }\n                break;\n            case 3:\n                this.value = asn1.result.blockName;\n                break;\n            case 4:\n                this.value = new RelativeDistinguishedNames({ schema: asn1.result.directoryName });\n                break;\n            case 5:\n                this.value = asn1.result.ediPartyName;\n                break;\n            case 7:\n                this.value = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: asn1.result.blockName.valueBlock.valueHex });\n                break;\n            case 8:\n                {\n                    const value = asn1.result.blockName;\n                    value.idBlock.tagClass = 1;\n                    value.idBlock.tagNumber = 6;\n                    const valueBER = value.toBER(false);\n                    const asnValue = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(valueBER);\n                    AsnError.assert(asnValue, \"GeneralName registeredID\");\n                    this.value = asnValue.result.valueBlock.toString();\n                }\n                break;\n        }\n    }\n    toSchema() {\n        switch (this.type) {\n            case 0:\n            case 3:\n            case 5:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: this.type\n                    },\n                    value: [\n                        this.value\n                    ]\n                });\n            case 1:\n            case 2:\n            case 6:\n                {\n                    const value = new asn1js__WEBPACK_IMPORTED_MODULE_0__.IA5String({ value: this.value });\n                    value.idBlock.tagClass = 3;\n                    value.idBlock.tagNumber = this.type;\n                    return value;\n                }\n            case 4:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 4\n                    },\n                    value: [this.value.toSchema()]\n                });\n            case 7:\n                {\n                    const value = this.value;\n                    value.idBlock.tagClass = 3;\n                    value.idBlock.tagNumber = this.type;\n                    return value;\n                }\n            case 8:\n                {\n                    const value = new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.value });\n                    value.idBlock.tagClass = 3;\n                    value.idBlock.tagNumber = this.type;\n                    return value;\n                }\n            default:\n                return GeneralName.schema();\n        }\n    }\n    toJSON() {\n        const _object = {\n            type: this.type,\n            value: EMPTY_STRING\n        };\n        if ((typeof this.value) === \"string\")\n            _object.value = this.value;\n        else {\n            try {\n                _object.value = this.value.toJSON();\n            }\n            catch {\n            }\n        }\n        return _object;\n    }\n}\nGeneralName.CLASS_NAME = \"GeneralName\";\n\nconst ACCESS_METHOD = \"accessMethod\";\nconst ACCESS_LOCATION = \"accessLocation\";\nconst CLEAR_PROPS$1v = [\n    ACCESS_METHOD,\n    ACCESS_LOCATION,\n];\nclass AccessDescription extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.accessMethod = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ACCESS_METHOD, AccessDescription.defaultValues(ACCESS_METHOD));\n        this.accessLocation = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ACCESS_LOCATION, AccessDescription.defaultValues(ACCESS_LOCATION));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ACCESS_METHOD:\n                return EMPTY_STRING;\n            case ACCESS_LOCATION:\n                return new GeneralName();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.accessMethod || EMPTY_STRING) }),\n                GeneralName.schema(names.accessLocation || {})\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1v);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, AccessDescription.schema({\n            names: {\n                accessMethod: ACCESS_METHOD,\n                accessLocation: {\n                    names: {\n                        blockName: ACCESS_LOCATION\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.accessMethod = asn1.result.accessMethod.valueBlock.toString();\n        this.accessLocation = new GeneralName({ schema: asn1.result.accessLocation });\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.accessMethod }),\n                this.accessLocation.toSchema()\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            accessMethod: this.accessMethod,\n            accessLocation: this.accessLocation.toJSON()\n        };\n    }\n}\nAccessDescription.CLASS_NAME = \"AccessDescription\";\n\nconst SECONDS = \"seconds\";\nconst MILLIS = \"millis\";\nconst MICROS = \"micros\";\nclass Accuracy extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        if (SECONDS in parameters) {\n            this.seconds = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SECONDS, Accuracy.defaultValues(SECONDS));\n        }\n        if (MILLIS in parameters) {\n            this.millis = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MILLIS, Accuracy.defaultValues(MILLIS));\n        }\n        if (MICROS in parameters) {\n            this.micros = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MICROS, Accuracy.defaultValues(MICROS));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case SECONDS:\n            case MILLIS:\n            case MICROS:\n                return 0;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case SECONDS:\n            case MILLIS:\n            case MICROS:\n                return (memberValue === Accuracy.defaultValues(memberName));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            optional: true,\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({\n                    optional: true,\n                    name: (names.seconds || EMPTY_STRING)\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.millis || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.micros || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    }\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, [\n            SECONDS,\n            MILLIS,\n            MICROS,\n        ]);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, Accuracy.schema({\n            names: {\n                seconds: SECONDS,\n                millis: MILLIS,\n                micros: MICROS,\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (\"seconds\" in asn1.result) {\n            this.seconds = asn1.result.seconds.valueBlock.valueDec;\n        }\n        if (\"millis\" in asn1.result) {\n            const intMillis = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: asn1.result.millis.valueBlock.valueHex });\n            this.millis = intMillis.valueBlock.valueDec;\n        }\n        if (\"micros\" in asn1.result) {\n            const intMicros = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: asn1.result.micros.valueBlock.valueHex });\n            this.micros = intMicros.valueBlock.valueDec;\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        if (this.seconds !== undefined)\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.seconds }));\n        if (this.millis !== undefined) {\n            const intMillis = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.millis });\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                valueHex: intMillis.valueBlock.valueHexView\n            }));\n        }\n        if (this.micros !== undefined) {\n            const intMicros = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.micros });\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                valueHex: intMicros.valueBlock.valueHexView\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const _object = {};\n        if (this.seconds !== undefined)\n            _object.seconds = this.seconds;\n        if (this.millis !== undefined)\n            _object.millis = this.millis;\n        if (this.micros !== undefined)\n            _object.micros = this.micros;\n        return _object;\n    }\n}\nAccuracy.CLASS_NAME = \"Accuracy\";\n\nconst ALGORITHM_ID = \"algorithmId\";\nconst ALGORITHM_PARAMS = \"algorithmParams\";\nconst ALGORITHM$2 = \"algorithm\";\nconst PARAMS = \"params\";\nconst CLEAR_PROPS$1u = [\n    ALGORITHM$2,\n    PARAMS\n];\nclass AlgorithmIdentifier extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.algorithmId = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ALGORITHM_ID, AlgorithmIdentifier.defaultValues(ALGORITHM_ID));\n        if (ALGORITHM_PARAMS in parameters) {\n            this.algorithmParams = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ALGORITHM_PARAMS, AlgorithmIdentifier.defaultValues(ALGORITHM_PARAMS));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ALGORITHM_ID:\n                return EMPTY_STRING;\n            case ALGORITHM_PARAMS:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case ALGORITHM_ID:\n                return (memberValue === EMPTY_STRING);\n            case ALGORITHM_PARAMS:\n                return (memberValue instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            optional: (names.optional || false),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.algorithmIdentifier || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ name: (names.algorithmParams || EMPTY_STRING), optional: true })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1u);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, AlgorithmIdentifier.schema({\n            names: {\n                algorithmIdentifier: ALGORITHM$2,\n                algorithmParams: PARAMS\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.algorithmId = asn1.result.algorithm.valueBlock.toString();\n        if (PARAMS in asn1.result) {\n            this.algorithmParams = asn1.result.params;\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.algorithmId }));\n        if (this.algorithmParams && !(this.algorithmParams instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any)) {\n            outputArray.push(this.algorithmParams);\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const object = {\n            algorithmId: this.algorithmId\n        };\n        if (this.algorithmParams && !(this.algorithmParams instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any)) {\n            object.algorithmParams = this.algorithmParams.toJSON();\n        }\n        return object;\n    }\n    isEqual(algorithmIdentifier) {\n        if (!(algorithmIdentifier instanceof AlgorithmIdentifier)) {\n            return false;\n        }\n        if (this.algorithmId !== algorithmIdentifier.algorithmId) {\n            return false;\n        }\n        if (this.algorithmParams) {\n            if (algorithmIdentifier.algorithmParams) {\n                return JSON.stringify(this.algorithmParams) === JSON.stringify(algorithmIdentifier.algorithmParams);\n            }\n            return false;\n        }\n        if (algorithmIdentifier.algorithmParams) {\n            return false;\n        }\n        return true;\n    }\n}\nAlgorithmIdentifier.CLASS_NAME = \"AlgorithmIdentifier\";\n\nconst ALT_NAMES = \"altNames\";\nconst CLEAR_PROPS$1t = [\n    ALT_NAMES\n];\nclass AltName extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.altNames = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ALT_NAMES, AltName.defaultValues(ALT_NAMES));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ALT_NAMES:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.altNames || EMPTY_STRING),\n                    value: GeneralName.schema()\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1t);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, AltName.schema({\n            names: {\n                altNames: ALT_NAMES\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (ALT_NAMES in asn1.result) {\n            this.altNames = Array.from(asn1.result.altNames, element => new GeneralName({ schema: element }));\n        }\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.altNames, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        return {\n            altNames: Array.from(this.altNames, o => o.toJSON())\n        };\n    }\n}\nAltName.CLASS_NAME = \"AltName\";\n\nconst TYPE$3 = \"type\";\nconst VALUES$1 = \"values\";\nconst CLEAR_PROPS$1s = [\n    TYPE$3,\n    VALUES$1\n];\nclass Attribute extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.type = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TYPE$3, Attribute.defaultValues(TYPE$3));\n        this.values = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VALUES$1, Attribute.defaultValues(VALUES$1));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TYPE$3:\n                return EMPTY_STRING;\n            case VALUES$1:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case TYPE$3:\n                return (memberValue === EMPTY_STRING);\n            case VALUES$1:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.type || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n                    name: (names.setName || EMPTY_STRING),\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.values || EMPTY_STRING),\n                            value: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any()\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1s);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, Attribute.schema({\n            names: {\n                type: TYPE$3,\n                values: VALUES$1\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.type = asn1.result.type.valueBlock.toString();\n        this.values = asn1.result.values;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.type }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n                    value: this.values\n                })\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            type: this.type,\n            values: Array.from(this.values, o => o.toJSON())\n        };\n    }\n}\nAttribute.CLASS_NAME = \"Attribute\";\n\nconst NOT_BEFORE_TIME = \"notBeforeTime\";\nconst NOT_AFTER_TIME = \"notAfterTime\";\nconst CLEAR_PROPS$1r = [\n    NOT_BEFORE_TIME,\n    NOT_AFTER_TIME,\n];\nclass AttCertValidityPeriod extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.notBeforeTime = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NOT_BEFORE_TIME, AttCertValidityPeriod.defaultValues(NOT_BEFORE_TIME));\n        this.notAfterTime = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NOT_AFTER_TIME, AttCertValidityPeriod.defaultValues(NOT_AFTER_TIME));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case NOT_BEFORE_TIME:\n            case NOT_AFTER_TIME:\n                return new Date(0, 0, 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ name: (names.notBeforeTime || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ name: (names.notAfterTime || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1r);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, AttCertValidityPeriod.schema({\n            names: {\n                notBeforeTime: NOT_BEFORE_TIME,\n                notAfterTime: NOT_AFTER_TIME\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.notBeforeTime = asn1.result.notBeforeTime.toDate();\n        this.notAfterTime = asn1.result.notAfterTime.toDate();\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ valueDate: this.notBeforeTime }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ valueDate: this.notAfterTime }),\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            notBeforeTime: this.notBeforeTime,\n            notAfterTime: this.notAfterTime\n        };\n    }\n}\nAttCertValidityPeriod.CLASS_NAME = \"AttCertValidityPeriod\";\n\nconst NAMES = \"names\";\nconst GENERAL_NAMES = \"generalNames\";\nclass GeneralNames extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NAMES, GeneralNames.defaultValues(NAMES));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case \"names\":\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}, optional = false) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NAMES, {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            optional,\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.generalNames || EMPTY_STRING),\n                    value: GeneralName.schema()\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, [\n            NAMES,\n            GENERAL_NAMES\n        ]);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, GeneralNames.schema({\n            names: {\n                blockName: NAMES,\n                generalNames: GENERAL_NAMES\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.names = Array.from(asn1.result.generalNames, element => new GeneralName({ schema: element }));\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.names, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        return {\n            names: Array.from(this.names, o => o.toJSON())\n        };\n    }\n}\nGeneralNames.CLASS_NAME = \"GeneralNames\";\n\nconst id_SubjectDirectoryAttributes = \"2.5.29.9\";\nconst id_SubjectKeyIdentifier = \"2.5.29.14\";\nconst id_KeyUsage = \"2.5.29.15\";\nconst id_PrivateKeyUsagePeriod = \"2.5.29.16\";\nconst id_SubjectAltName = \"2.5.29.17\";\nconst id_IssuerAltName = \"2.5.29.18\";\nconst id_BasicConstraints = \"2.5.29.19\";\nconst id_CRLNumber = \"2.5.29.20\";\nconst id_BaseCRLNumber = \"2.5.29.27\";\nconst id_CRLReason = \"2.5.29.21\";\nconst id_InvalidityDate = \"2.5.29.24\";\nconst id_IssuingDistributionPoint = \"2.5.29.28\";\nconst id_CertificateIssuer = \"2.5.29.29\";\nconst id_NameConstraints = \"2.5.29.30\";\nconst id_CRLDistributionPoints = \"2.5.29.31\";\nconst id_FreshestCRL = \"2.5.29.46\";\nconst id_CertificatePolicies = \"2.5.29.32\";\nconst id_AnyPolicy = \"2.5.29.32.0\";\nconst id_MicrosoftAppPolicies = \"1.3.6.1.4.1.311.21.10\";\nconst id_PolicyMappings = \"2.5.29.33\";\nconst id_AuthorityKeyIdentifier = \"2.5.29.35\";\nconst id_PolicyConstraints = \"2.5.29.36\";\nconst id_ExtKeyUsage = \"2.5.29.37\";\nconst id_InhibitAnyPolicy = \"2.5.29.54\";\nconst id_AuthorityInfoAccess = \"1.3.6.1.5.5.7.1.1\";\nconst id_SubjectInfoAccess = \"1.3.6.1.5.5.7.1.11\";\nconst id_SignedCertificateTimestampList = \"1.3.6.1.4.1.11129.2.4.2\";\nconst id_MicrosoftCertTemplateV1 = \"1.3.6.1.4.1.311.20.2\";\nconst id_MicrosoftPrevCaCertHash = \"1.3.6.1.4.1.311.21.2\";\nconst id_MicrosoftCertTemplateV2 = \"1.3.6.1.4.1.311.21.7\";\nconst id_MicrosoftCaVersion = \"1.3.6.1.4.1.311.21.1\";\nconst id_QCStatements = \"1.3.6.1.5.5.7.1.3\";\nconst id_ContentType_Data = \"1.2.840.113549.1.7.1\";\nconst id_ContentType_SignedData = \"1.2.840.113549.1.7.2\";\nconst id_ContentType_EnvelopedData = \"1.2.840.113549.1.7.3\";\nconst id_ContentType_EncryptedData = \"1.2.840.113549.1.7.6\";\nconst id_eContentType_TSTInfo = \"1.2.840.113549.1.9.16.1.4\";\nconst id_CertBag_X509Certificate = \"1.2.840.113549.1.9.22.1\";\nconst id_CertBag_SDSICertificate = \"1.2.840.113549.1.9.22.2\";\nconst id_CertBag_AttributeCertificate = \"1.2.840.113549.1.9.22.3\";\nconst id_CRLBag_X509CRL = \"1.2.840.113549.1.9.23.1\";\nconst id_pkix = \"1.3.6.1.5.5.7\";\nconst id_ad = `${id_pkix}.48`;\nconst id_PKIX_OCSP_Basic = `${id_ad}.1.1`;\nconst id_ad_caIssuers = `${id_ad}.2`;\nconst id_ad_ocsp = `${id_ad}.1`;\nconst id_sha1 = \"1.3.14.3.2.26\";\nconst id_sha256 = \"2.16.840.1.101.3.4.2.1\";\nconst id_sha384 = \"2.16.840.1.101.3.4.2.2\";\nconst id_sha512 = \"2.16.840.1.101.3.4.2.3\";\n\nconst KEY_IDENTIFIER$1 = \"keyIdentifier\";\nconst AUTHORITY_CERT_ISSUER = \"authorityCertIssuer\";\nconst AUTHORITY_CERT_SERIAL_NUMBER = \"authorityCertSerialNumber\";\nconst CLEAR_PROPS$1q = [\n    KEY_IDENTIFIER$1,\n    AUTHORITY_CERT_ISSUER,\n    AUTHORITY_CERT_SERIAL_NUMBER,\n];\nclass AuthorityKeyIdentifier extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        if (KEY_IDENTIFIER$1 in parameters) {\n            this.keyIdentifier = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_IDENTIFIER$1, AuthorityKeyIdentifier.defaultValues(KEY_IDENTIFIER$1));\n        }\n        if (AUTHORITY_CERT_ISSUER in parameters) {\n            this.authorityCertIssuer = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, AUTHORITY_CERT_ISSUER, AuthorityKeyIdentifier.defaultValues(AUTHORITY_CERT_ISSUER));\n        }\n        if (AUTHORITY_CERT_SERIAL_NUMBER in parameters) {\n            this.authorityCertSerialNumber = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, AUTHORITY_CERT_SERIAL_NUMBER, AuthorityKeyIdentifier.defaultValues(AUTHORITY_CERT_SERIAL_NUMBER));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case KEY_IDENTIFIER$1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case AUTHORITY_CERT_ISSUER:\n                return [];\n            case AUTHORITY_CERT_SERIAL_NUMBER:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.keyIdentifier || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.authorityCertIssuer || EMPTY_STRING),\n                            value: GeneralName.schema()\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.authorityCertSerialNumber || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 2\n                    }\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1q);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, AuthorityKeyIdentifier.schema({\n            names: {\n                keyIdentifier: KEY_IDENTIFIER$1,\n                authorityCertIssuer: AUTHORITY_CERT_ISSUER,\n                authorityCertSerialNumber: AUTHORITY_CERT_SERIAL_NUMBER\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (KEY_IDENTIFIER$1 in asn1.result)\n            this.keyIdentifier = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: asn1.result.keyIdentifier.valueBlock.valueHex });\n        if (AUTHORITY_CERT_ISSUER in asn1.result)\n            this.authorityCertIssuer = Array.from(asn1.result.authorityCertIssuer, o => new GeneralName({ schema: o }));\n        if (AUTHORITY_CERT_SERIAL_NUMBER in asn1.result)\n            this.authorityCertSerialNumber = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: asn1.result.authorityCertSerialNumber.valueBlock.valueHex });\n    }\n    toSchema() {\n        const outputArray = [];\n        if (this.keyIdentifier) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                valueHex: this.keyIdentifier.valueBlock.valueHexView\n            }));\n        }\n        if (this.authorityCertIssuer) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: Array.from(this.authorityCertIssuer, o => o.toSchema())\n            }));\n        }\n        if (this.authorityCertSerialNumber) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 2\n                },\n                valueHex: this.authorityCertSerialNumber.valueBlock.valueHexView\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const object = {};\n        if (this.keyIdentifier) {\n            object.keyIdentifier = this.keyIdentifier.toJSON();\n        }\n        if (this.authorityCertIssuer) {\n            object.authorityCertIssuer = Array.from(this.authorityCertIssuer, o => o.toJSON());\n        }\n        if (this.authorityCertSerialNumber) {\n            object.authorityCertSerialNumber = this.authorityCertSerialNumber.toJSON();\n        }\n        return object;\n    }\n}\nAuthorityKeyIdentifier.CLASS_NAME = \"AuthorityKeyIdentifier\";\n\nconst PATH_LENGTH_CONSTRAINT = \"pathLenConstraint\";\nconst CA = \"cA\";\nclass BasicConstraints extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.cA = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CA, false);\n        if (PATH_LENGTH_CONSTRAINT in parameters) {\n            this.pathLenConstraint = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PATH_LENGTH_CONSTRAINT, 0);\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case CA:\n                return false;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Boolean({\n                    optional: true,\n                    name: (names.cA || EMPTY_STRING)\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({\n                    optional: true,\n                    name: (names.pathLenConstraint || EMPTY_STRING)\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, [\n            CA,\n            PATH_LENGTH_CONSTRAINT\n        ]);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, BasicConstraints.schema({\n            names: {\n                cA: CA,\n                pathLenConstraint: PATH_LENGTH_CONSTRAINT\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (CA in asn1.result) {\n            this.cA = asn1.result.cA.valueBlock.value;\n        }\n        if (PATH_LENGTH_CONSTRAINT in asn1.result) {\n            if (asn1.result.pathLenConstraint.valueBlock.isHexOnly) {\n                this.pathLenConstraint = asn1.result.pathLenConstraint;\n            }\n            else {\n                this.pathLenConstraint = asn1.result.pathLenConstraint.valueBlock.valueDec;\n            }\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        if (this.cA !== BasicConstraints.defaultValues(CA))\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Boolean({ value: this.cA }));\n        if (PATH_LENGTH_CONSTRAINT in this) {\n            if (this.pathLenConstraint instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer) {\n                outputArray.push(this.pathLenConstraint);\n            }\n            else {\n                outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.pathLenConstraint }));\n            }\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const object = {};\n        if (this.cA !== BasicConstraints.defaultValues(CA)) {\n            object.cA = this.cA;\n        }\n        if (PATH_LENGTH_CONSTRAINT in this) {\n            if (this.pathLenConstraint instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer) {\n                object.pathLenConstraint = this.pathLenConstraint.toJSON();\n            }\n            else {\n                object.pathLenConstraint = this.pathLenConstraint;\n            }\n        }\n        return object;\n    }\n}\nBasicConstraints.CLASS_NAME = \"BasicConstraints\";\n\nconst CERTIFICATE_INDEX = \"certificateIndex\";\nconst KEY_INDEX = \"keyIndex\";\nclass CAVersion extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.certificateIndex = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CERTIFICATE_INDEX, CAVersion.defaultValues(CERTIFICATE_INDEX));\n        this.keyIndex = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_INDEX, CAVersion.defaultValues(KEY_INDEX));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case CERTIFICATE_INDEX:\n            case KEY_INDEX:\n                return 0;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer());\n    }\n    fromSchema(schema) {\n        if (schema.constructor.blockName() !== asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer.blockName()) {\n            throw new Error(\"Object's schema was not verified against input data for CAVersion\");\n        }\n        let value = schema.valueBlock.valueHex.slice(0);\n        const valueView = new Uint8Array(value);\n        switch (true) {\n            case (value.byteLength < 4):\n                {\n                    const tempValue = new ArrayBuffer(4);\n                    const tempValueView = new Uint8Array(tempValue);\n                    tempValueView.set(valueView, 4 - value.byteLength);\n                    value = tempValue.slice(0);\n                }\n                break;\n            case (value.byteLength > 4):\n                {\n                    const tempValue = new ArrayBuffer(4);\n                    const tempValueView = new Uint8Array(tempValue);\n                    tempValueView.set(valueView.slice(0, 4));\n                    value = tempValue.slice(0);\n                }\n                break;\n        }\n        const keyIndexBuffer = value.slice(0, 2);\n        const keyIndexView8 = new Uint8Array(keyIndexBuffer);\n        let temp = keyIndexView8[0];\n        keyIndexView8[0] = keyIndexView8[1];\n        keyIndexView8[1] = temp;\n        const keyIndexView16 = new Uint16Array(keyIndexBuffer);\n        this.keyIndex = keyIndexView16[0];\n        const certificateIndexBuffer = value.slice(2);\n        const certificateIndexView8 = new Uint8Array(certificateIndexBuffer);\n        temp = certificateIndexView8[0];\n        certificateIndexView8[0] = certificateIndexView8[1];\n        certificateIndexView8[1] = temp;\n        const certificateIndexView16 = new Uint16Array(certificateIndexBuffer);\n        this.certificateIndex = certificateIndexView16[0];\n    }\n    toSchema() {\n        const certificateIndexBuffer = new ArrayBuffer(2);\n        const certificateIndexView = new Uint16Array(certificateIndexBuffer);\n        certificateIndexView[0] = this.certificateIndex;\n        const certificateIndexView8 = new Uint8Array(certificateIndexBuffer);\n        let temp = certificateIndexView8[0];\n        certificateIndexView8[0] = certificateIndexView8[1];\n        certificateIndexView8[1] = temp;\n        const keyIndexBuffer = new ArrayBuffer(2);\n        const keyIndexView = new Uint16Array(keyIndexBuffer);\n        keyIndexView[0] = this.keyIndex;\n        const keyIndexView8 = new Uint8Array(keyIndexBuffer);\n        temp = keyIndexView8[0];\n        keyIndexView8[0] = keyIndexView8[1];\n        keyIndexView8[1] = temp;\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({\n            valueHex: pvutils__WEBPACK_IMPORTED_MODULE_2__.utilConcatBuf(keyIndexBuffer, certificateIndexBuffer)\n        }));\n    }\n    toJSON() {\n        return {\n            certificateIndex: this.certificateIndex,\n            keyIndex: this.keyIndex\n        };\n    }\n}\nCAVersion.CLASS_NAME = \"CAVersion\";\n\nconst POLICY_QUALIFIER_ID = \"policyQualifierId\";\nconst QUALIFIER = \"qualifier\";\nconst CLEAR_PROPS$1p = [\n    POLICY_QUALIFIER_ID,\n    QUALIFIER\n];\nclass PolicyQualifierInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.policyQualifierId = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, POLICY_QUALIFIER_ID, PolicyQualifierInfo.defaultValues(POLICY_QUALIFIER_ID));\n        this.qualifier = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, QUALIFIER, PolicyQualifierInfo.defaultValues(QUALIFIER));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case POLICY_QUALIFIER_ID:\n                return EMPTY_STRING;\n            case QUALIFIER:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.policyQualifierId || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ name: (names.qualifier || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1p);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PolicyQualifierInfo.schema({\n            names: {\n                policyQualifierId: POLICY_QUALIFIER_ID,\n                qualifier: QUALIFIER\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.policyQualifierId = asn1.result.policyQualifierId.valueBlock.toString();\n        this.qualifier = asn1.result.qualifier;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.policyQualifierId }),\n                this.qualifier\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            policyQualifierId: this.policyQualifierId,\n            qualifier: this.qualifier.toJSON()\n        };\n    }\n}\nPolicyQualifierInfo.CLASS_NAME = \"PolicyQualifierInfo\";\n\nconst POLICY_IDENTIFIER = \"policyIdentifier\";\nconst POLICY_QUALIFIERS = \"policyQualifiers\";\nconst CLEAR_PROPS$1o = [\n    POLICY_IDENTIFIER,\n    POLICY_QUALIFIERS\n];\nclass PolicyInformation extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.policyIdentifier = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, POLICY_IDENTIFIER, PolicyInformation.defaultValues(POLICY_IDENTIFIER));\n        if (POLICY_QUALIFIERS in parameters) {\n            this.policyQualifiers = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, POLICY_QUALIFIERS, PolicyInformation.defaultValues(POLICY_QUALIFIERS));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case POLICY_IDENTIFIER:\n                return EMPTY_STRING;\n            case POLICY_QUALIFIERS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.policyIdentifier || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    optional: true,\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.policyQualifiers || EMPTY_STRING),\n                            value: PolicyQualifierInfo.schema()\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1o);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PolicyInformation.schema({\n            names: {\n                policyIdentifier: POLICY_IDENTIFIER,\n                policyQualifiers: POLICY_QUALIFIERS\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.policyIdentifier = asn1.result.policyIdentifier.valueBlock.toString();\n        if (POLICY_QUALIFIERS in asn1.result) {\n            this.policyQualifiers = Array.from(asn1.result.policyQualifiers, element => new PolicyQualifierInfo({ schema: element }));\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.policyIdentifier }));\n        if (this.policyQualifiers) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                value: Array.from(this.policyQualifiers, o => o.toSchema())\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            policyIdentifier: this.policyIdentifier\n        };\n        if (this.policyQualifiers)\n            res.policyQualifiers = Array.from(this.policyQualifiers, o => o.toJSON());\n        return res;\n    }\n}\nPolicyInformation.CLASS_NAME = \"PolicyInformation\";\n\nconst CERTIFICATE_POLICIES = \"certificatePolicies\";\nconst CLEAR_PROPS$1n = [\n    CERTIFICATE_POLICIES,\n];\nclass CertificatePolicies extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.certificatePolicies = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CERTIFICATE_POLICIES, CertificatePolicies.defaultValues(CERTIFICATE_POLICIES));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case CERTIFICATE_POLICIES:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.certificatePolicies || EMPTY_STRING),\n                    value: PolicyInformation.schema()\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1n);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, CertificatePolicies.schema({\n            names: {\n                certificatePolicies: CERTIFICATE_POLICIES\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.certificatePolicies = Array.from(asn1.result.certificatePolicies, element => new PolicyInformation({ schema: element }));\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.certificatePolicies, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        return {\n            certificatePolicies: Array.from(this.certificatePolicies, o => o.toJSON())\n        };\n    }\n}\nCertificatePolicies.CLASS_NAME = \"CertificatePolicies\";\n\nconst TEMPLATE_ID = \"templateID\";\nconst TEMPLATE_MAJOR_VERSION = \"templateMajorVersion\";\nconst TEMPLATE_MINOR_VERSION = \"templateMinorVersion\";\nconst CLEAR_PROPS$1m = [\n    TEMPLATE_ID,\n    TEMPLATE_MAJOR_VERSION,\n    TEMPLATE_MINOR_VERSION\n];\nclass CertificateTemplate extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.templateID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TEMPLATE_ID, CertificateTemplate.defaultValues(TEMPLATE_ID));\n        if (TEMPLATE_MAJOR_VERSION in parameters) {\n            this.templateMajorVersion = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TEMPLATE_MAJOR_VERSION, CertificateTemplate.defaultValues(TEMPLATE_MAJOR_VERSION));\n        }\n        if (TEMPLATE_MINOR_VERSION in parameters) {\n            this.templateMinorVersion = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TEMPLATE_MINOR_VERSION, CertificateTemplate.defaultValues(TEMPLATE_MINOR_VERSION));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TEMPLATE_ID:\n                return EMPTY_STRING;\n            case TEMPLATE_MAJOR_VERSION:\n            case TEMPLATE_MINOR_VERSION:\n                return 0;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.templateID || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({\n                    name: (names.templateMajorVersion || EMPTY_STRING),\n                    optional: true\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({\n                    name: (names.templateMinorVersion || EMPTY_STRING),\n                    optional: true\n                }),\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1m);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, CertificateTemplate.schema({\n            names: {\n                templateID: TEMPLATE_ID,\n                templateMajorVersion: TEMPLATE_MAJOR_VERSION,\n                templateMinorVersion: TEMPLATE_MINOR_VERSION\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.templateID = asn1.result.templateID.valueBlock.toString();\n        if (TEMPLATE_MAJOR_VERSION in asn1.result) {\n            this.templateMajorVersion = asn1.result.templateMajorVersion.valueBlock.valueDec;\n        }\n        if (TEMPLATE_MINOR_VERSION in asn1.result) {\n            this.templateMinorVersion = asn1.result.templateMinorVersion.valueBlock.valueDec;\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.templateID }));\n        if (TEMPLATE_MAJOR_VERSION in this) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.templateMajorVersion }));\n        }\n        if (TEMPLATE_MINOR_VERSION in this) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.templateMinorVersion }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            templateID: this.templateID\n        };\n        if (TEMPLATE_MAJOR_VERSION in this)\n            res.templateMajorVersion = this.templateMajorVersion;\n        if (TEMPLATE_MINOR_VERSION in this)\n            res.templateMinorVersion = this.templateMinorVersion;\n        return res;\n    }\n}\n\nconst DISTRIBUTION_POINT$1 = \"distributionPoint\";\nconst DISTRIBUTION_POINT_NAMES$1 = \"distributionPointNames\";\nconst REASONS = \"reasons\";\nconst CRL_ISSUER = \"cRLIssuer\";\nconst CRL_ISSUER_NAMES = \"cRLIssuerNames\";\nconst CLEAR_PROPS$1l = [\n    DISTRIBUTION_POINT$1,\n    DISTRIBUTION_POINT_NAMES$1,\n    REASONS,\n    CRL_ISSUER,\n    CRL_ISSUER_NAMES,\n];\nclass DistributionPoint extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        if (DISTRIBUTION_POINT$1 in parameters) {\n            this.distributionPoint = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, DISTRIBUTION_POINT$1, DistributionPoint.defaultValues(DISTRIBUTION_POINT$1));\n        }\n        if (REASONS in parameters) {\n            this.reasons = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, REASONS, DistributionPoint.defaultValues(REASONS));\n        }\n        if (CRL_ISSUER in parameters) {\n            this.cRLIssuer = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CRL_ISSUER, DistributionPoint.defaultValues(CRL_ISSUER));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case DISTRIBUTION_POINT$1:\n                return [];\n            case REASONS:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            case CRL_ISSUER:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                            value: [\n                                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                                    name: (names.distributionPoint || EMPTY_STRING),\n                                    optional: true,\n                                    idBlock: {\n                                        tagClass: 3,\n                                        tagNumber: 0\n                                    },\n                                    value: [\n                                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                                            name: (names.distributionPointNames || EMPTY_STRING),\n                                            value: GeneralName.schema()\n                                        })\n                                    ]\n                                }),\n                                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                                    name: (names.distributionPoint || EMPTY_STRING),\n                                    optional: true,\n                                    idBlock: {\n                                        tagClass: 3,\n                                        tagNumber: 1\n                                    },\n                                    value: RelativeDistinguishedNames.schema().valueBlock.value\n                                })\n                            ]\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.reasons || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.cRLIssuer || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 2\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.cRLIssuerNames || EMPTY_STRING),\n                            value: GeneralName.schema()\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1l);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, DistributionPoint.schema({\n            names: {\n                distributionPoint: DISTRIBUTION_POINT$1,\n                distributionPointNames: DISTRIBUTION_POINT_NAMES$1,\n                reasons: REASONS,\n                cRLIssuer: CRL_ISSUER,\n                cRLIssuerNames: CRL_ISSUER_NAMES\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (DISTRIBUTION_POINT$1 in asn1.result) {\n            if (asn1.result.distributionPoint.idBlock.tagNumber === 0) {\n                this.distributionPoint = Array.from(asn1.result.distributionPointNames, element => new GeneralName({ schema: element }));\n            }\n            if (asn1.result.distributionPoint.idBlock.tagNumber === 1) {\n                this.distributionPoint = new RelativeDistinguishedNames({\n                    schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                        value: asn1.result.distributionPoint.valueBlock.value\n                    })\n                });\n            }\n        }\n        if (REASONS in asn1.result) {\n            this.reasons = new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ valueHex: asn1.result.reasons.valueBlock.valueHex });\n        }\n        if (CRL_ISSUER in asn1.result) {\n            this.cRLIssuer = Array.from(asn1.result.cRLIssuerNames, element => new GeneralName({ schema: element }));\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        if (this.distributionPoint) {\n            let internalValue;\n            if (this.distributionPoint instanceof Array) {\n                internalValue = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: Array.from(this.distributionPoint, o => o.toSchema())\n                });\n            }\n            else {\n                internalValue = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [this.distributionPoint.toSchema()]\n                });\n            }\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [internalValue]\n            }));\n        }\n        if (this.reasons) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                valueHex: this.reasons.valueBlock.valueHexView\n            }));\n        }\n        if (this.cRLIssuer) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 2\n                },\n                value: Array.from(this.cRLIssuer, o => o.toSchema())\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const object = {};\n        if (this.distributionPoint) {\n            if (this.distributionPoint instanceof Array) {\n                object.distributionPoint = Array.from(this.distributionPoint, o => o.toJSON());\n            }\n            else {\n                object.distributionPoint = this.distributionPoint.toJSON();\n            }\n        }\n        if (this.reasons) {\n            object.reasons = this.reasons.toJSON();\n        }\n        if (this.cRLIssuer) {\n            object.cRLIssuer = Array.from(this.cRLIssuer, o => o.toJSON());\n        }\n        return object;\n    }\n}\nDistributionPoint.CLASS_NAME = \"DistributionPoint\";\n\nconst DISTRIBUTION_POINTS = \"distributionPoints\";\nconst CLEAR_PROPS$1k = [\n    DISTRIBUTION_POINTS\n];\nclass CRLDistributionPoints extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.distributionPoints = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, DISTRIBUTION_POINTS, CRLDistributionPoints.defaultValues(DISTRIBUTION_POINTS));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case DISTRIBUTION_POINTS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.distributionPoints || EMPTY_STRING),\n                    value: DistributionPoint.schema()\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1k);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, CRLDistributionPoints.schema({\n            names: {\n                distributionPoints: DISTRIBUTION_POINTS\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.distributionPoints = Array.from(asn1.result.distributionPoints, element => new DistributionPoint({ schema: element }));\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.distributionPoints, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        return {\n            distributionPoints: Array.from(this.distributionPoints, o => o.toJSON())\n        };\n    }\n}\nCRLDistributionPoints.CLASS_NAME = \"CRLDistributionPoints\";\n\nconst KEY_PURPOSES = \"keyPurposes\";\nconst CLEAR_PROPS$1j = [\n    KEY_PURPOSES,\n];\nclass ExtKeyUsage extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.keyPurposes = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_PURPOSES, ExtKeyUsage.defaultValues(KEY_PURPOSES));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case KEY_PURPOSES:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.keyPurposes || EMPTY_STRING),\n                    value: new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier()\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1j);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, ExtKeyUsage.schema({\n            names: {\n                keyPurposes: KEY_PURPOSES\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.keyPurposes = Array.from(asn1.result.keyPurposes, (element) => element.valueBlock.toString());\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.keyPurposes, element => new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: element }))\n        }));\n    }\n    toJSON() {\n        return {\n            keyPurposes: Array.from(this.keyPurposes)\n        };\n    }\n}\nExtKeyUsage.CLASS_NAME = \"ExtKeyUsage\";\n\nconst ACCESS_DESCRIPTIONS = \"accessDescriptions\";\nclass InfoAccess extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.accessDescriptions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ACCESS_DESCRIPTIONS, InfoAccess.defaultValues(ACCESS_DESCRIPTIONS));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ACCESS_DESCRIPTIONS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.accessDescriptions || EMPTY_STRING),\n                    value: AccessDescription.schema()\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, [\n            ACCESS_DESCRIPTIONS\n        ]);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, InfoAccess.schema({\n            names: {\n                accessDescriptions: ACCESS_DESCRIPTIONS\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.accessDescriptions = Array.from(asn1.result.accessDescriptions, element => new AccessDescription({ schema: element }));\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.accessDescriptions, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        return {\n            accessDescriptions: Array.from(this.accessDescriptions, o => o.toJSON())\n        };\n    }\n}\nInfoAccess.CLASS_NAME = \"InfoAccess\";\n\nconst DISTRIBUTION_POINT = \"distributionPoint\";\nconst DISTRIBUTION_POINT_NAMES = \"distributionPointNames\";\nconst ONLY_CONTAINS_USER_CERTS = \"onlyContainsUserCerts\";\nconst ONLY_CONTAINS_CA_CERTS = \"onlyContainsCACerts\";\nconst ONLY_SOME_REASON = \"onlySomeReasons\";\nconst INDIRECT_CRL = \"indirectCRL\";\nconst ONLY_CONTAINS_ATTRIBUTE_CERTS = \"onlyContainsAttributeCerts\";\nconst CLEAR_PROPS$1i = [\n    DISTRIBUTION_POINT,\n    DISTRIBUTION_POINT_NAMES,\n    ONLY_CONTAINS_USER_CERTS,\n    ONLY_CONTAINS_CA_CERTS,\n    ONLY_SOME_REASON,\n    INDIRECT_CRL,\n    ONLY_CONTAINS_ATTRIBUTE_CERTS,\n];\nclass IssuingDistributionPoint extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        if (DISTRIBUTION_POINT in parameters) {\n            this.distributionPoint = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, DISTRIBUTION_POINT, IssuingDistributionPoint.defaultValues(DISTRIBUTION_POINT));\n        }\n        this.onlyContainsUserCerts = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ONLY_CONTAINS_USER_CERTS, IssuingDistributionPoint.defaultValues(ONLY_CONTAINS_USER_CERTS));\n        this.onlyContainsCACerts = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ONLY_CONTAINS_CA_CERTS, IssuingDistributionPoint.defaultValues(ONLY_CONTAINS_CA_CERTS));\n        if (ONLY_SOME_REASON in parameters) {\n            this.onlySomeReasons = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ONLY_SOME_REASON, IssuingDistributionPoint.defaultValues(ONLY_SOME_REASON));\n        }\n        this.indirectCRL = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, INDIRECT_CRL, IssuingDistributionPoint.defaultValues(INDIRECT_CRL));\n        this.onlyContainsAttributeCerts = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ONLY_CONTAINS_ATTRIBUTE_CERTS, IssuingDistributionPoint.defaultValues(ONLY_CONTAINS_ATTRIBUTE_CERTS));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case DISTRIBUTION_POINT:\n                return [];\n            case ONLY_CONTAINS_USER_CERTS:\n                return false;\n            case ONLY_CONTAINS_CA_CERTS:\n                return false;\n            case ONLY_SOME_REASON:\n                return 0;\n            case INDIRECT_CRL:\n                return false;\n            case ONLY_CONTAINS_ATTRIBUTE_CERTS:\n                return false;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                            value: [\n                                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                                    name: (names.distributionPoint || EMPTY_STRING),\n                                    idBlock: {\n                                        tagClass: 3,\n                                        tagNumber: 0\n                                    },\n                                    value: [\n                                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                                            name: (names.distributionPointNames || EMPTY_STRING),\n                                            value: GeneralName.schema()\n                                        })\n                                    ]\n                                }),\n                                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                                    name: (names.distributionPoint || EMPTY_STRING),\n                                    idBlock: {\n                                        tagClass: 3,\n                                        tagNumber: 1\n                                    },\n                                    value: RelativeDistinguishedNames.schema().valueBlock.value\n                                })\n                            ]\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.onlyContainsUserCerts || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.onlyContainsCACerts || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 2\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.onlySomeReasons || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 3\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.indirectCRL || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 4\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.onlyContainsAttributeCerts || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 5\n                    }\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1i);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, IssuingDistributionPoint.schema({\n            names: {\n                distributionPoint: DISTRIBUTION_POINT,\n                distributionPointNames: DISTRIBUTION_POINT_NAMES,\n                onlyContainsUserCerts: ONLY_CONTAINS_USER_CERTS,\n                onlyContainsCACerts: ONLY_CONTAINS_CA_CERTS,\n                onlySomeReasons: ONLY_SOME_REASON,\n                indirectCRL: INDIRECT_CRL,\n                onlyContainsAttributeCerts: ONLY_CONTAINS_ATTRIBUTE_CERTS\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (DISTRIBUTION_POINT in asn1.result) {\n            switch (true) {\n                case (asn1.result.distributionPoint.idBlock.tagNumber === 0):\n                    this.distributionPoint = Array.from(asn1.result.distributionPointNames, element => new GeneralName({ schema: element }));\n                    break;\n                case (asn1.result.distributionPoint.idBlock.tagNumber === 1):\n                    {\n                        this.distributionPoint = new RelativeDistinguishedNames({\n                            schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                                value: asn1.result.distributionPoint.valueBlock.value\n                            })\n                        });\n                    }\n                    break;\n                default:\n                    throw new Error(\"Unknown tagNumber for distributionPoint: {$asn1.result.distributionPoint.idBlock.tagNumber}\");\n            }\n        }\n        if (ONLY_CONTAINS_USER_CERTS in asn1.result) {\n            const view = new Uint8Array(asn1.result.onlyContainsUserCerts.valueBlock.valueHex);\n            this.onlyContainsUserCerts = (view[0] !== 0x00);\n        }\n        if (ONLY_CONTAINS_CA_CERTS in asn1.result) {\n            const view = new Uint8Array(asn1.result.onlyContainsCACerts.valueBlock.valueHex);\n            this.onlyContainsCACerts = (view[0] !== 0x00);\n        }\n        if (ONLY_SOME_REASON in asn1.result) {\n            const view = new Uint8Array(asn1.result.onlySomeReasons.valueBlock.valueHex);\n            this.onlySomeReasons = view[0];\n        }\n        if (INDIRECT_CRL in asn1.result) {\n            const view = new Uint8Array(asn1.result.indirectCRL.valueBlock.valueHex);\n            this.indirectCRL = (view[0] !== 0x00);\n        }\n        if (ONLY_CONTAINS_ATTRIBUTE_CERTS in asn1.result) {\n            const view = new Uint8Array(asn1.result.onlyContainsAttributeCerts.valueBlock.valueHex);\n            this.onlyContainsAttributeCerts = (view[0] !== 0x00);\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        if (this.distributionPoint) {\n            let value;\n            if (this.distributionPoint instanceof Array) {\n                value = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: Array.from(this.distributionPoint, o => o.toSchema())\n                });\n            }\n            else {\n                value = this.distributionPoint.toSchema();\n                value.idBlock.tagClass = 3;\n                value.idBlock.tagNumber = 1;\n            }\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [value]\n            }));\n        }\n        if (this.onlyContainsUserCerts !== IssuingDistributionPoint.defaultValues(ONLY_CONTAINS_USER_CERTS)) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                valueHex: (new Uint8Array([0xFF])).buffer\n            }));\n        }\n        if (this.onlyContainsCACerts !== IssuingDistributionPoint.defaultValues(ONLY_CONTAINS_CA_CERTS)) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 2\n                },\n                valueHex: (new Uint8Array([0xFF])).buffer\n            }));\n        }\n        if (this.onlySomeReasons !== undefined) {\n            const buffer = new ArrayBuffer(1);\n            const view = new Uint8Array(buffer);\n            view[0] = this.onlySomeReasons;\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 3\n                },\n                valueHex: buffer\n            }));\n        }\n        if (this.indirectCRL !== IssuingDistributionPoint.defaultValues(INDIRECT_CRL)) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 4\n                },\n                valueHex: (new Uint8Array([0xFF])).buffer\n            }));\n        }\n        if (this.onlyContainsAttributeCerts !== IssuingDistributionPoint.defaultValues(ONLY_CONTAINS_ATTRIBUTE_CERTS)) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 5\n                },\n                valueHex: (new Uint8Array([0xFF])).buffer\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const obj = {};\n        if (this.distributionPoint) {\n            if (this.distributionPoint instanceof Array) {\n                obj.distributionPoint = Array.from(this.distributionPoint, o => o.toJSON());\n            }\n            else {\n                obj.distributionPoint = this.distributionPoint.toJSON();\n            }\n        }\n        if (this.onlyContainsUserCerts !== IssuingDistributionPoint.defaultValues(ONLY_CONTAINS_USER_CERTS)) {\n            obj.onlyContainsUserCerts = this.onlyContainsUserCerts;\n        }\n        if (this.onlyContainsCACerts !== IssuingDistributionPoint.defaultValues(ONLY_CONTAINS_CA_CERTS)) {\n            obj.onlyContainsCACerts = this.onlyContainsCACerts;\n        }\n        if (ONLY_SOME_REASON in this) {\n            obj.onlySomeReasons = this.onlySomeReasons;\n        }\n        if (this.indirectCRL !== IssuingDistributionPoint.defaultValues(INDIRECT_CRL)) {\n            obj.indirectCRL = this.indirectCRL;\n        }\n        if (this.onlyContainsAttributeCerts !== IssuingDistributionPoint.defaultValues(ONLY_CONTAINS_ATTRIBUTE_CERTS)) {\n            obj.onlyContainsAttributeCerts = this.onlyContainsAttributeCerts;\n        }\n        return obj;\n    }\n}\nIssuingDistributionPoint.CLASS_NAME = \"IssuingDistributionPoint\";\n\nconst BASE = \"base\";\nconst MINIMUM = \"minimum\";\nconst MAXIMUM = \"maximum\";\nconst CLEAR_PROPS$1h = [\n    BASE,\n    MINIMUM,\n    MAXIMUM\n];\nclass GeneralSubtree extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.base = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, BASE, GeneralSubtree.defaultValues(BASE));\n        this.minimum = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MINIMUM, GeneralSubtree.defaultValues(MINIMUM));\n        if (MAXIMUM in parameters) {\n            this.maximum = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MAXIMUM, GeneralSubtree.defaultValues(MAXIMUM));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case BASE:\n                return new GeneralName();\n            case MINIMUM:\n                return 0;\n            case MAXIMUM:\n                return 0;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                GeneralName.schema(names.base || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.minimum || EMPTY_STRING) })]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.maximum || EMPTY_STRING) })]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1h);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, GeneralSubtree.schema({\n            names: {\n                base: {\n                    names: {\n                        blockName: BASE\n                    }\n                },\n                minimum: MINIMUM,\n                maximum: MAXIMUM\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.base = new GeneralName({ schema: asn1.result.base });\n        if (MINIMUM in asn1.result) {\n            if (asn1.result.minimum.valueBlock.isHexOnly)\n                this.minimum = asn1.result.minimum;\n            else\n                this.minimum = asn1.result.minimum.valueBlock.valueDec;\n        }\n        if (MAXIMUM in asn1.result) {\n            if (asn1.result.maximum.valueBlock.isHexOnly)\n                this.maximum = asn1.result.maximum;\n            else\n                this.maximum = asn1.result.maximum.valueBlock.valueDec;\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(this.base.toSchema());\n        if (this.minimum !== 0) {\n            let valueMinimum = 0;\n            if (this.minimum instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer) {\n                valueMinimum = this.minimum;\n            }\n            else {\n                valueMinimum = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.minimum });\n            }\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [valueMinimum]\n            }));\n        }\n        if (MAXIMUM in this) {\n            let valueMaximum = 0;\n            if (this.maximum instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer) {\n                valueMaximum = this.maximum;\n            }\n            else {\n                valueMaximum = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.maximum });\n            }\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: [valueMaximum]\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            base: this.base.toJSON()\n        };\n        if (this.minimum !== 0) {\n            if (typeof this.minimum === \"number\") {\n                res.minimum = this.minimum;\n            }\n            else {\n                res.minimum = this.minimum.toJSON();\n            }\n        }\n        if (this.maximum !== undefined) {\n            if (typeof this.maximum === \"number\") {\n                res.maximum = this.maximum;\n            }\n            else {\n                res.maximum = this.maximum.toJSON();\n            }\n        }\n        return res;\n    }\n}\nGeneralSubtree.CLASS_NAME = \"GeneralSubtree\";\n\nconst PERMITTED_SUBTREES = \"permittedSubtrees\";\nconst EXCLUDED_SUBTREES = \"excludedSubtrees\";\nconst CLEAR_PROPS$1g = [\n    PERMITTED_SUBTREES,\n    EXCLUDED_SUBTREES\n];\nclass NameConstraints extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        if (PERMITTED_SUBTREES in parameters) {\n            this.permittedSubtrees = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PERMITTED_SUBTREES, NameConstraints.defaultValues(PERMITTED_SUBTREES));\n        }\n        if (EXCLUDED_SUBTREES in parameters) {\n            this.excludedSubtrees = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, EXCLUDED_SUBTREES, NameConstraints.defaultValues(EXCLUDED_SUBTREES));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case PERMITTED_SUBTREES:\n            case EXCLUDED_SUBTREES:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.permittedSubtrees || EMPTY_STRING),\n                            value: GeneralSubtree.schema()\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.excludedSubtrees || EMPTY_STRING),\n                            value: GeneralSubtree.schema()\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1g);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, NameConstraints.schema({\n            names: {\n                permittedSubtrees: PERMITTED_SUBTREES,\n                excludedSubtrees: EXCLUDED_SUBTREES\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (PERMITTED_SUBTREES in asn1.result)\n            this.permittedSubtrees = Array.from(asn1.result.permittedSubtrees, element => new GeneralSubtree({ schema: element }));\n        if (EXCLUDED_SUBTREES in asn1.result)\n            this.excludedSubtrees = Array.from(asn1.result.excludedSubtrees, element => new GeneralSubtree({ schema: element }));\n    }\n    toSchema() {\n        const outputArray = [];\n        if (this.permittedSubtrees) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: Array.from(this.permittedSubtrees, o => o.toSchema())\n            }));\n        }\n        if (this.excludedSubtrees) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: Array.from(this.excludedSubtrees, o => o.toSchema())\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const object = {};\n        if (this.permittedSubtrees) {\n            object.permittedSubtrees = Array.from(this.permittedSubtrees, o => o.toJSON());\n        }\n        if (this.excludedSubtrees) {\n            object.excludedSubtrees = Array.from(this.excludedSubtrees, o => o.toJSON());\n        }\n        return object;\n    }\n}\nNameConstraints.CLASS_NAME = \"NameConstraints\";\n\nconst REQUIRE_EXPLICIT_POLICY = \"requireExplicitPolicy\";\nconst INHIBIT_POLICY_MAPPING = \"inhibitPolicyMapping\";\nconst CLEAR_PROPS$1f = [\n    REQUIRE_EXPLICIT_POLICY,\n    INHIBIT_POLICY_MAPPING,\n];\nclass PolicyConstraints extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        if (REQUIRE_EXPLICIT_POLICY in parameters) {\n            this.requireExplicitPolicy = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, REQUIRE_EXPLICIT_POLICY, PolicyConstraints.defaultValues(REQUIRE_EXPLICIT_POLICY));\n        }\n        if (INHIBIT_POLICY_MAPPING in parameters) {\n            this.inhibitPolicyMapping = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, INHIBIT_POLICY_MAPPING, PolicyConstraints.defaultValues(INHIBIT_POLICY_MAPPING));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case REQUIRE_EXPLICIT_POLICY:\n                return 0;\n            case INHIBIT_POLICY_MAPPING:\n                return 0;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.requireExplicitPolicy || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.inhibitPolicyMapping || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    }\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1f);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PolicyConstraints.schema({\n            names: {\n                requireExplicitPolicy: REQUIRE_EXPLICIT_POLICY,\n                inhibitPolicyMapping: INHIBIT_POLICY_MAPPING\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (REQUIRE_EXPLICIT_POLICY in asn1.result) {\n            const field1 = asn1.result.requireExplicitPolicy;\n            field1.idBlock.tagClass = 1;\n            field1.idBlock.tagNumber = 2;\n            const ber1 = field1.toBER(false);\n            const int1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(ber1);\n            AsnError.assert(int1, \"Integer\");\n            this.requireExplicitPolicy = int1.result.valueBlock.valueDec;\n        }\n        if (INHIBIT_POLICY_MAPPING in asn1.result) {\n            const field2 = asn1.result.inhibitPolicyMapping;\n            field2.idBlock.tagClass = 1;\n            field2.idBlock.tagNumber = 2;\n            const ber2 = field2.toBER(false);\n            const int2 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(ber2);\n            AsnError.assert(int2, \"Integer\");\n            this.inhibitPolicyMapping = int2.result.valueBlock.valueDec;\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        if (REQUIRE_EXPLICIT_POLICY in this) {\n            const int1 = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.requireExplicitPolicy });\n            int1.idBlock.tagClass = 3;\n            int1.idBlock.tagNumber = 0;\n            outputArray.push(int1);\n        }\n        if (INHIBIT_POLICY_MAPPING in this) {\n            const int2 = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.inhibitPolicyMapping });\n            int2.idBlock.tagClass = 3;\n            int2.idBlock.tagNumber = 1;\n            outputArray.push(int2);\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {};\n        if (REQUIRE_EXPLICIT_POLICY in this) {\n            res.requireExplicitPolicy = this.requireExplicitPolicy;\n        }\n        if (INHIBIT_POLICY_MAPPING in this) {\n            res.inhibitPolicyMapping = this.inhibitPolicyMapping;\n        }\n        return res;\n    }\n}\nPolicyConstraints.CLASS_NAME = \"PolicyConstraints\";\n\nconst ISSUER_DOMAIN_POLICY = \"issuerDomainPolicy\";\nconst SUBJECT_DOMAIN_POLICY = \"subjectDomainPolicy\";\nconst CLEAR_PROPS$1e = [\n    ISSUER_DOMAIN_POLICY,\n    SUBJECT_DOMAIN_POLICY\n];\nclass PolicyMapping extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.issuerDomainPolicy = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER_DOMAIN_POLICY, PolicyMapping.defaultValues(ISSUER_DOMAIN_POLICY));\n        this.subjectDomainPolicy = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SUBJECT_DOMAIN_POLICY, PolicyMapping.defaultValues(SUBJECT_DOMAIN_POLICY));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ISSUER_DOMAIN_POLICY:\n                return EMPTY_STRING;\n            case SUBJECT_DOMAIN_POLICY:\n                return EMPTY_STRING;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.issuerDomainPolicy || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.subjectDomainPolicy || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1e);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PolicyMapping.schema({\n            names: {\n                issuerDomainPolicy: ISSUER_DOMAIN_POLICY,\n                subjectDomainPolicy: SUBJECT_DOMAIN_POLICY\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.issuerDomainPolicy = asn1.result.issuerDomainPolicy.valueBlock.toString();\n        this.subjectDomainPolicy = asn1.result.subjectDomainPolicy.valueBlock.toString();\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.issuerDomainPolicy }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.subjectDomainPolicy })\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            issuerDomainPolicy: this.issuerDomainPolicy,\n            subjectDomainPolicy: this.subjectDomainPolicy\n        };\n    }\n}\nPolicyMapping.CLASS_NAME = \"PolicyMapping\";\n\nconst MAPPINGS = \"mappings\";\nconst CLEAR_PROPS$1d = [\n    MAPPINGS,\n];\nclass PolicyMappings extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.mappings = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MAPPINGS, PolicyMappings.defaultValues(MAPPINGS));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case MAPPINGS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.mappings || EMPTY_STRING),\n                    value: PolicyMapping.schema()\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1d);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PolicyMappings.schema({\n            names: {\n                mappings: MAPPINGS\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.mappings = Array.from(asn1.result.mappings, element => new PolicyMapping({ schema: element }));\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.mappings, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        return {\n            mappings: Array.from(this.mappings, o => o.toJSON())\n        };\n    }\n}\nPolicyMappings.CLASS_NAME = \"PolicyMappings\";\n\nconst NOT_BEFORE$1 = \"notBefore\";\nconst NOT_AFTER$1 = \"notAfter\";\nconst CLEAR_PROPS$1c = [\n    NOT_BEFORE$1,\n    NOT_AFTER$1\n];\nclass PrivateKeyUsagePeriod extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        if (NOT_BEFORE$1 in parameters) {\n            this.notBefore = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NOT_BEFORE$1, PrivateKeyUsagePeriod.defaultValues(NOT_BEFORE$1));\n        }\n        if (NOT_AFTER$1 in parameters) {\n            this.notAfter = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NOT_AFTER$1, PrivateKeyUsagePeriod.defaultValues(NOT_AFTER$1));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case NOT_BEFORE$1:\n                return new Date();\n            case NOT_AFTER$1:\n                return new Date();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.notBefore || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.notAfter || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    }\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1c);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PrivateKeyUsagePeriod.schema({\n            names: {\n                notBefore: NOT_BEFORE$1,\n                notAfter: NOT_AFTER$1\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (NOT_BEFORE$1 in asn1.result) {\n            const localNotBefore = new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime();\n            localNotBefore.fromBuffer(asn1.result.notBefore.valueBlock.valueHex);\n            this.notBefore = localNotBefore.toDate();\n        }\n        if (NOT_AFTER$1 in asn1.result) {\n            const localNotAfter = new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ valueHex: asn1.result.notAfter.valueBlock.valueHex });\n            localNotAfter.fromBuffer(asn1.result.notAfter.valueBlock.valueHex);\n            this.notAfter = localNotAfter.toDate();\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        if (NOT_BEFORE$1 in this) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                valueHex: (new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ valueDate: this.notBefore })).valueBlock.valueHexView\n            }));\n        }\n        if (NOT_AFTER$1 in this) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                valueHex: (new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ valueDate: this.notAfter })).valueBlock.valueHexView\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {};\n        if (this.notBefore) {\n            res.notBefore = this.notBefore;\n        }\n        if (this.notAfter) {\n            res.notAfter = this.notAfter;\n        }\n        return res;\n    }\n}\nPrivateKeyUsagePeriod.CLASS_NAME = \"PrivateKeyUsagePeriod\";\n\nconst ID = \"id\";\nconst TYPE$2 = \"type\";\nconst VALUES = \"values\";\nconst QC_STATEMENT_CLEAR_PROPS = [\n    ID,\n    TYPE$2\n];\nconst QC_STATEMENTS_CLEAR_PROPS = [\n    VALUES\n];\nclass QCStatement extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.id = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ID, QCStatement.defaultValues(ID));\n        if (TYPE$2 in parameters) {\n            this.type = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TYPE$2, QCStatement.defaultValues(TYPE$2));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ID:\n                return EMPTY_STRING;\n            case TYPE$2:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case ID:\n                return (memberValue === EMPTY_STRING);\n            case TYPE$2:\n                return (memberValue instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Null);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.id || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({\n                    name: (names.type || EMPTY_STRING),\n                    optional: true\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, QC_STATEMENT_CLEAR_PROPS);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, QCStatement.schema({\n            names: {\n                id: ID,\n                type: TYPE$2\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.id = asn1.result.id.valueBlock.toString();\n        if (TYPE$2 in asn1.result)\n            this.type = asn1.result.type;\n    }\n    toSchema() {\n        const value = [\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.id })\n        ];\n        if (TYPE$2 in this)\n            value.push(this.type);\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value,\n        }));\n    }\n    toJSON() {\n        const object = {\n            id: this.id\n        };\n        if (this.type) {\n            object.type = this.type.toJSON();\n        }\n        return object;\n    }\n}\nQCStatement.CLASS_NAME = \"QCStatement\";\nclass QCStatements extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.values = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VALUES, QCStatements.defaultValues(VALUES));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VALUES:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VALUES:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.values || EMPTY_STRING),\n                    value: QCStatement.schema(names.value || {})\n                }),\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, QC_STATEMENTS_CLEAR_PROPS);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, QCStatements.schema({\n            names: {\n                values: VALUES\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.values = Array.from(asn1.result.values, element => new QCStatement({ schema: element }));\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.values, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        return {\n            values: Array.from(this.values, o => o.toJSON())\n        };\n    }\n}\nQCStatements.CLASS_NAME = \"QCStatements\";\n\nvar _a;\nclass ECNamedCurves {\n    static register(name, id, size) {\n        this.namedCurves[name.toLowerCase()] = this.namedCurves[id] = { name, id, size };\n    }\n    static find(nameOrId) {\n        return this.namedCurves[nameOrId.toLowerCase()] || null;\n    }\n}\n_a = ECNamedCurves;\nECNamedCurves.namedCurves = {};\n(() => {\n    _a.register(\"P-256\", \"1.2.840.10045.3.1.7\", 32);\n    _a.register(\"P-384\", \"1.3.132.0.34\", 48);\n    _a.register(\"P-521\", \"1.3.132.0.35\", 66);\n    _a.register(\"brainpoolP256r1\", \"1.3.36.3.3.2.8.1.1.7\", 32);\n    _a.register(\"brainpoolP384r1\", \"1.3.36.3.3.2.8.1.1.11\", 48);\n    _a.register(\"brainpoolP512r1\", \"1.3.36.3.3.2.8.1.1.13\", 64);\n})();\n\nconst X = \"x\";\nconst Y = \"y\";\nconst NAMED_CURVE$1 = \"namedCurve\";\nclass ECPublicKey extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.x = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, X, ECPublicKey.defaultValues(X));\n        this.y = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, Y, ECPublicKey.defaultValues(Y));\n        this.namedCurve = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NAMED_CURVE$1, ECPublicKey.defaultValues(NAMED_CURVE$1));\n        if (parameters.json) {\n            this.fromJSON(parameters.json);\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case X:\n            case Y:\n                return EMPTY_BUFFER;\n            case NAMED_CURVE$1:\n                return EMPTY_STRING;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case X:\n            case Y:\n                return memberValue instanceof ArrayBuffer &&\n                    (pvutils__WEBPACK_IMPORTED_MODULE_2__.isEqualBuffer(memberValue, ECPublicKey.defaultValues(memberName)));\n            case NAMED_CURVE$1:\n                return typeof memberValue === \"string\" &&\n                    memberValue === ECPublicKey.defaultValues(memberName);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema() {\n        return new asn1js__WEBPACK_IMPORTED_MODULE_0__.RawData();\n    }\n    fromSchema(schema1) {\n        const view = pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.toUint8Array(schema1);\n        if (view[0] !== 0x04) {\n            throw new Error(\"Object's schema was not verified against input data for ECPublicKey\");\n        }\n        const namedCurve = ECNamedCurves.find(this.namedCurve);\n        if (!namedCurve) {\n            throw new Error(`Incorrect curve OID: ${this.namedCurve}`);\n        }\n        const coordinateLength = namedCurve.size;\n        if (view.byteLength !== (coordinateLength * 2 + 1)) {\n            throw new Error(\"Object's schema was not verified against input data for ECPublicKey\");\n        }\n        this.namedCurve = namedCurve.name;\n        this.x = view.slice(1, coordinateLength + 1).buffer;\n        this.y = view.slice(1 + coordinateLength, coordinateLength * 2 + 1).buffer;\n    }\n    toSchema() {\n        return new asn1js__WEBPACK_IMPORTED_MODULE_0__.RawData({\n            data: pvutils__WEBPACK_IMPORTED_MODULE_2__.utilConcatBuf((new Uint8Array([0x04])).buffer, this.x, this.y)\n        });\n    }\n    toJSON() {\n        const namedCurve = ECNamedCurves.find(this.namedCurve);\n        return {\n            crv: namedCurve ? namedCurve.name : this.namedCurve,\n            x: pvutils__WEBPACK_IMPORTED_MODULE_2__.toBase64(pvutils__WEBPACK_IMPORTED_MODULE_2__.arrayBufferToString(this.x), true, true, false),\n            y: pvutils__WEBPACK_IMPORTED_MODULE_2__.toBase64(pvutils__WEBPACK_IMPORTED_MODULE_2__.arrayBufferToString(this.y), true, true, false)\n        };\n    }\n    fromJSON(json) {\n        ParameterError.assert(\"json\", json, \"crv\", \"x\", \"y\");\n        let coordinateLength = 0;\n        const namedCurve = ECNamedCurves.find(json.crv);\n        if (namedCurve) {\n            this.namedCurve = namedCurve.id;\n            coordinateLength = namedCurve.size;\n        }\n        const xConvertBuffer = pvutils__WEBPACK_IMPORTED_MODULE_2__.stringToArrayBuffer(pvutils__WEBPACK_IMPORTED_MODULE_2__.fromBase64(json.x, true));\n        if (xConvertBuffer.byteLength < coordinateLength) {\n            this.x = new ArrayBuffer(coordinateLength);\n            const view = new Uint8Array(this.x);\n            const convertBufferView = new Uint8Array(xConvertBuffer);\n            view.set(convertBufferView, 1);\n        }\n        else {\n            this.x = xConvertBuffer.slice(0, coordinateLength);\n        }\n        const yConvertBuffer = pvutils__WEBPACK_IMPORTED_MODULE_2__.stringToArrayBuffer(pvutils__WEBPACK_IMPORTED_MODULE_2__.fromBase64(json.y, true));\n        if (yConvertBuffer.byteLength < coordinateLength) {\n            this.y = new ArrayBuffer(coordinateLength);\n            const view = new Uint8Array(this.y);\n            const convertBufferView = new Uint8Array(yConvertBuffer);\n            view.set(convertBufferView, 1);\n        }\n        else {\n            this.y = yConvertBuffer.slice(0, coordinateLength);\n        }\n    }\n}\nECPublicKey.CLASS_NAME = \"ECPublicKey\";\n\nconst MODULUS$1 = \"modulus\";\nconst PUBLIC_EXPONENT$1 = \"publicExponent\";\nconst CLEAR_PROPS$1b = [MODULUS$1, PUBLIC_EXPONENT$1];\nclass RSAPublicKey extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.modulus = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MODULUS$1, RSAPublicKey.defaultValues(MODULUS$1));\n        this.publicExponent = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PUBLIC_EXPONENT$1, RSAPublicKey.defaultValues(PUBLIC_EXPONENT$1));\n        if (parameters.json) {\n            this.fromJSON(parameters.json);\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case MODULUS$1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case PUBLIC_EXPONENT$1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.modulus || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.publicExponent || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1b);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, RSAPublicKey.schema({\n            names: {\n                modulus: MODULUS$1,\n                publicExponent: PUBLIC_EXPONENT$1\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.modulus = asn1.result.modulus.convertFromDER(256);\n        this.publicExponent = asn1.result.publicExponent;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.modulus.convertToDER(),\n                this.publicExponent\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            n: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.modulus.valueBlock.valueHexView),\n            e: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.publicExponent.valueBlock.valueHexView),\n        };\n    }\n    fromJSON(json) {\n        ParameterError.assert(\"json\", json, \"n\", \"e\");\n        const array = pvutils__WEBPACK_IMPORTED_MODULE_2__.stringToArrayBuffer(pvutils__WEBPACK_IMPORTED_MODULE_2__.fromBase64(json.n, true));\n        this.modulus = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: array.slice(0, Math.pow(2, pvutils__WEBPACK_IMPORTED_MODULE_2__.nearestPowerOf2(array.byteLength))) });\n        this.publicExponent = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: pvutils__WEBPACK_IMPORTED_MODULE_2__.stringToArrayBuffer(pvutils__WEBPACK_IMPORTED_MODULE_2__.fromBase64(json.e, true)).slice(0, 3) });\n    }\n}\nRSAPublicKey.CLASS_NAME = \"RSAPublicKey\";\n\nconst ALGORITHM$1 = \"algorithm\";\nconst SUBJECT_PUBLIC_KEY = \"subjectPublicKey\";\nconst CLEAR_PROPS$1a = [ALGORITHM$1, SUBJECT_PUBLIC_KEY];\nclass PublicKeyInfo extends PkiObject {\n    get parsedKey() {\n        if (this._parsedKey === undefined) {\n            switch (this.algorithm.algorithmId) {\n                case \"1.2.840.10045.2.1\":\n                    if (\"algorithmParams\" in this.algorithm) {\n                        if (this.algorithm.algorithmParams.constructor.blockName() === asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier.blockName()) {\n                            try {\n                                this._parsedKey = new ECPublicKey({\n                                    namedCurve: this.algorithm.algorithmParams.valueBlock.toString(),\n                                    schema: this.subjectPublicKey.valueBlock.valueHexView\n                                });\n                            }\n                            catch {\n                            }\n                        }\n                    }\n                    break;\n                case \"1.2.840.113549.1.1.1\":\n                    {\n                        const publicKeyASN1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(this.subjectPublicKey.valueBlock.valueHexView);\n                        if (publicKeyASN1.offset !== -1) {\n                            try {\n                                this._parsedKey = new RSAPublicKey({ schema: publicKeyASN1.result });\n                            }\n                            catch {\n                            }\n                        }\n                    }\n                    break;\n            }\n            this._parsedKey || (this._parsedKey = null);\n        }\n        return this._parsedKey || undefined;\n    }\n    set parsedKey(value) {\n        this._parsedKey = value;\n    }\n    constructor(parameters = {}) {\n        super();\n        this.algorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ALGORITHM$1, PublicKeyInfo.defaultValues(ALGORITHM$1));\n        this.subjectPublicKey = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SUBJECT_PUBLIC_KEY, PublicKeyInfo.defaultValues(SUBJECT_PUBLIC_KEY));\n        const parsedKey = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"parsedKey\", null);\n        if (parsedKey) {\n            this.parsedKey = parsedKey;\n        }\n        if (parameters.json) {\n            this.fromJSON(parameters.json);\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ALGORITHM$1:\n                return new AlgorithmIdentifier();\n            case SUBJECT_PUBLIC_KEY:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                AlgorithmIdentifier.schema(names.algorithm || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ name: (names.subjectPublicKey || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1a);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PublicKeyInfo.schema({\n            names: {\n                algorithm: {\n                    names: {\n                        blockName: ALGORITHM$1\n                    }\n                },\n                subjectPublicKey: SUBJECT_PUBLIC_KEY\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.algorithm = new AlgorithmIdentifier({ schema: asn1.result.algorithm });\n        this.subjectPublicKey = asn1.result.subjectPublicKey;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.algorithm.toSchema(),\n                this.subjectPublicKey\n            ]\n        }));\n    }\n    toJSON() {\n        if (!this.parsedKey) {\n            return {\n                algorithm: this.algorithm.toJSON(),\n                subjectPublicKey: this.subjectPublicKey.toJSON(),\n            };\n        }\n        const jwk = {};\n        switch (this.algorithm.algorithmId) {\n            case \"1.2.840.10045.2.1\":\n                jwk.kty = \"EC\";\n                break;\n            case \"1.2.840.113549.1.1.1\":\n                jwk.kty = \"RSA\";\n                break;\n        }\n        const publicKeyJWK = this.parsedKey.toJSON();\n        Object.assign(jwk, publicKeyJWK);\n        return jwk;\n    }\n    fromJSON(json) {\n        if (\"kty\" in json) {\n            switch (json.kty.toUpperCase()) {\n                case \"EC\":\n                    this.parsedKey = new ECPublicKey({ json });\n                    this.algorithm = new AlgorithmIdentifier({\n                        algorithmId: \"1.2.840.10045.2.1\",\n                        algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.parsedKey.namedCurve })\n                    });\n                    break;\n                case \"RSA\":\n                    this.parsedKey = new RSAPublicKey({ json });\n                    this.algorithm = new AlgorithmIdentifier({\n                        algorithmId: \"1.2.840.113549.1.1.1\",\n                        algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n                    });\n                    break;\n                default:\n                    throw new Error(`Invalid value for \"kty\" parameter: ${json.kty}`);\n            }\n            this.subjectPublicKey = new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ valueHex: this.parsedKey.toSchema().toBER(false) });\n        }\n    }\n    async importKey(publicKey, crypto = getCrypto(true)) {\n        try {\n            if (!publicKey) {\n                throw new Error(\"Need to provide publicKey input parameter\");\n            }\n            const exportedKey = await crypto.exportKey(\"spki\", publicKey);\n            const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(exportedKey);\n            try {\n                this.fromSchema(asn1.result);\n            }\n            catch {\n                throw new Error(\"Error during initializing object from schema\");\n            }\n        }\n        catch (e) {\n            const message = e instanceof Error ? e.message : `${e}`;\n            throw new Error(`Error during exporting public key: ${message}`);\n        }\n    }\n}\nPublicKeyInfo.CLASS_NAME = \"PublicKeyInfo\";\n\nconst VERSION$l = \"version\";\nconst PRIVATE_KEY$1 = \"privateKey\";\nconst NAMED_CURVE = \"namedCurve\";\nconst PUBLIC_KEY$1 = \"publicKey\";\nconst CLEAR_PROPS$19 = [\n    VERSION$l,\n    PRIVATE_KEY$1,\n    NAMED_CURVE,\n    PUBLIC_KEY$1\n];\nclass ECPrivateKey extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$l, ECPrivateKey.defaultValues(VERSION$l));\n        this.privateKey = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PRIVATE_KEY$1, ECPrivateKey.defaultValues(PRIVATE_KEY$1));\n        if (NAMED_CURVE in parameters) {\n            this.namedCurve = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NAMED_CURVE, ECPrivateKey.defaultValues(NAMED_CURVE));\n        }\n        if (PUBLIC_KEY$1 in parameters) {\n            this.publicKey = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PUBLIC_KEY$1, ECPrivateKey.defaultValues(PUBLIC_KEY$1));\n        }\n        if (parameters.json) {\n            this.fromJSON(parameters.json);\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$l:\n                return 1;\n            case PRIVATE_KEY$1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case NAMED_CURVE:\n                return EMPTY_STRING;\n            case PUBLIC_KEY$1:\n                return new ECPublicKey();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VERSION$l:\n                return (memberValue === ECPrivateKey.defaultValues(memberName));\n            case PRIVATE_KEY$1:\n                return (memberValue.isEqual(ECPrivateKey.defaultValues(memberName)));\n            case NAMED_CURVE:\n                return (memberValue === EMPTY_STRING);\n            case PUBLIC_KEY$1:\n                return ((ECPublicKey.compareWithDefault(NAMED_CURVE, memberValue.namedCurve)) &&\n                    (ECPublicKey.compareWithDefault(\"x\", memberValue.x)) &&\n                    (ECPublicKey.compareWithDefault(\"y\", memberValue.y)));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.privateKey || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.namedCurve || EMPTY_STRING) })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ name: (names.publicKey || EMPTY_STRING) })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$19);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, ECPrivateKey.schema({\n            names: {\n                version: VERSION$l,\n                privateKey: PRIVATE_KEY$1,\n                namedCurve: NAMED_CURVE,\n                publicKey: PUBLIC_KEY$1\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result.version.valueBlock.valueDec;\n        this.privateKey = asn1.result.privateKey;\n        if (NAMED_CURVE in asn1.result) {\n            this.namedCurve = asn1.result.namedCurve.valueBlock.toString();\n        }\n        if (PUBLIC_KEY$1 in asn1.result) {\n            const publicKeyData = { schema: asn1.result.publicKey.valueBlock.valueHex };\n            if (NAMED_CURVE in this) {\n                publicKeyData.namedCurve = this.namedCurve;\n            }\n            this.publicKey = new ECPublicKey(publicKeyData);\n        }\n    }\n    toSchema() {\n        const outputArray = [\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }),\n            this.privateKey\n        ];\n        if (this.namedCurve) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.namedCurve })\n                ]\n            }));\n        }\n        if (this.publicKey) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ valueHex: this.publicKey.toSchema().toBER(false) })\n                ]\n            }));\n        }\n        return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        });\n    }\n    toJSON() {\n        if (!this.namedCurve || ECPrivateKey.compareWithDefault(NAMED_CURVE, this.namedCurve)) {\n            throw new Error(\"Not enough information for making JSON: absent \\\"namedCurve\\\" value\");\n        }\n        const curve = ECNamedCurves.find(this.namedCurve);\n        const privateKeyJSON = {\n            crv: curve ? curve.name : this.namedCurve,\n            d: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.privateKey.valueBlock.valueHexView),\n        };\n        if (this.publicKey) {\n            const publicKeyJSON = this.publicKey.toJSON();\n            privateKeyJSON.x = publicKeyJSON.x;\n            privateKeyJSON.y = publicKeyJSON.y;\n        }\n        return privateKeyJSON;\n    }\n    fromJSON(json) {\n        ParameterError.assert(\"json\", json, \"crv\", \"d\");\n        let coordinateLength = 0;\n        const curve = ECNamedCurves.find(json.crv);\n        if (curve) {\n            this.namedCurve = curve.id;\n            coordinateLength = curve.size;\n        }\n        const convertBuffer = pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.FromBase64Url(json.d);\n        if (convertBuffer.byteLength < coordinateLength) {\n            const buffer = new ArrayBuffer(coordinateLength);\n            const view = new Uint8Array(buffer);\n            const convertBufferView = new Uint8Array(convertBuffer);\n            view.set(convertBufferView, 1);\n            this.privateKey = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: buffer });\n        }\n        else {\n            this.privateKey = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: convertBuffer.slice(0, coordinateLength) });\n        }\n        if (json.x && json.y) {\n            this.publicKey = new ECPublicKey({ json });\n        }\n    }\n}\nECPrivateKey.CLASS_NAME = \"ECPrivateKey\";\n\nconst PRIME = \"prime\";\nconst EXPONENT = \"exponent\";\nconst COEFFICIENT$1 = \"coefficient\";\nconst CLEAR_PROPS$18 = [\n    PRIME,\n    EXPONENT,\n    COEFFICIENT$1,\n];\nclass OtherPrimeInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.prime = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PRIME, OtherPrimeInfo.defaultValues(PRIME));\n        this.exponent = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, EXPONENT, OtherPrimeInfo.defaultValues(EXPONENT));\n        this.coefficient = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, COEFFICIENT$1, OtherPrimeInfo.defaultValues(COEFFICIENT$1));\n        if (parameters.json) {\n            this.fromJSON(parameters.json);\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case PRIME:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case EXPONENT:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case COEFFICIENT$1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.prime || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.exponent || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.coefficient || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$18);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, OtherPrimeInfo.schema({\n            names: {\n                prime: PRIME,\n                exponent: EXPONENT,\n                coefficient: COEFFICIENT$1\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.prime = asn1.result.prime.convertFromDER();\n        this.exponent = asn1.result.exponent.convertFromDER();\n        this.coefficient = asn1.result.coefficient.convertFromDER();\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.prime.convertToDER(),\n                this.exponent.convertToDER(),\n                this.coefficient.convertToDER()\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            r: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.prime.valueBlock.valueHexView),\n            d: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.exponent.valueBlock.valueHexView),\n            t: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.coefficient.valueBlock.valueHexView),\n        };\n    }\n    fromJSON(json) {\n        ParameterError.assert(\"json\", json, \"r\", \"d\", \"r\");\n        this.prime = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.FromBase64Url(json.r) });\n        this.exponent = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.FromBase64Url(json.d) });\n        this.coefficient = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.FromBase64Url(json.t) });\n    }\n}\nOtherPrimeInfo.CLASS_NAME = \"OtherPrimeInfo\";\n\nconst VERSION$k = \"version\";\nconst MODULUS = \"modulus\";\nconst PUBLIC_EXPONENT = \"publicExponent\";\nconst PRIVATE_EXPONENT = \"privateExponent\";\nconst PRIME1 = \"prime1\";\nconst PRIME2 = \"prime2\";\nconst EXPONENT1 = \"exponent1\";\nconst EXPONENT2 = \"exponent2\";\nconst COEFFICIENT = \"coefficient\";\nconst OTHER_PRIME_INFOS = \"otherPrimeInfos\";\nconst CLEAR_PROPS$17 = [\n    VERSION$k,\n    MODULUS,\n    PUBLIC_EXPONENT,\n    PRIVATE_EXPONENT,\n    PRIME1,\n    PRIME2,\n    EXPONENT1,\n    EXPONENT2,\n    COEFFICIENT,\n    OTHER_PRIME_INFOS\n];\nclass RSAPrivateKey extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$k, RSAPrivateKey.defaultValues(VERSION$k));\n        this.modulus = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MODULUS, RSAPrivateKey.defaultValues(MODULUS));\n        this.publicExponent = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PUBLIC_EXPONENT, RSAPrivateKey.defaultValues(PUBLIC_EXPONENT));\n        this.privateExponent = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PRIVATE_EXPONENT, RSAPrivateKey.defaultValues(PRIVATE_EXPONENT));\n        this.prime1 = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PRIME1, RSAPrivateKey.defaultValues(PRIME1));\n        this.prime2 = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PRIME2, RSAPrivateKey.defaultValues(PRIME2));\n        this.exponent1 = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, EXPONENT1, RSAPrivateKey.defaultValues(EXPONENT1));\n        this.exponent2 = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, EXPONENT2, RSAPrivateKey.defaultValues(EXPONENT2));\n        this.coefficient = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, COEFFICIENT, RSAPrivateKey.defaultValues(COEFFICIENT));\n        if (OTHER_PRIME_INFOS in parameters) {\n            this.otherPrimeInfos = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OTHER_PRIME_INFOS, RSAPrivateKey.defaultValues(OTHER_PRIME_INFOS));\n        }\n        if (parameters.json) {\n            this.fromJSON(parameters.json);\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$k:\n                return 0;\n            case MODULUS:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case PUBLIC_EXPONENT:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case PRIVATE_EXPONENT:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case PRIME1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case PRIME2:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case EXPONENT1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case EXPONENT2:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case COEFFICIENT:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case OTHER_PRIME_INFOS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.modulus || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.publicExponent || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.privateExponent || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.prime1 || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.prime2 || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.exponent1 || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.exponent2 || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.coefficient || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    optional: true,\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.otherPrimeInfosName || EMPTY_STRING),\n                            value: OtherPrimeInfo.schema(names.otherPrimeInfo || {})\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$17);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, RSAPrivateKey.schema({\n            names: {\n                version: VERSION$k,\n                modulus: MODULUS,\n                publicExponent: PUBLIC_EXPONENT,\n                privateExponent: PRIVATE_EXPONENT,\n                prime1: PRIME1,\n                prime2: PRIME2,\n                exponent1: EXPONENT1,\n                exponent2: EXPONENT2,\n                coefficient: COEFFICIENT,\n                otherPrimeInfo: {\n                    names: {\n                        blockName: OTHER_PRIME_INFOS\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result.version.valueBlock.valueDec;\n        this.modulus = asn1.result.modulus.convertFromDER(256);\n        this.publicExponent = asn1.result.publicExponent;\n        this.privateExponent = asn1.result.privateExponent.convertFromDER(256);\n        this.prime1 = asn1.result.prime1.convertFromDER(128);\n        this.prime2 = asn1.result.prime2.convertFromDER(128);\n        this.exponent1 = asn1.result.exponent1.convertFromDER(128);\n        this.exponent2 = asn1.result.exponent2.convertFromDER(128);\n        this.coefficient = asn1.result.coefficient.convertFromDER(128);\n        if (OTHER_PRIME_INFOS in asn1.result)\n            this.otherPrimeInfos = Array.from(asn1.result.otherPrimeInfos, element => new OtherPrimeInfo({ schema: element }));\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }));\n        outputArray.push(this.modulus.convertToDER());\n        outputArray.push(this.publicExponent);\n        outputArray.push(this.privateExponent.convertToDER());\n        outputArray.push(this.prime1.convertToDER());\n        outputArray.push(this.prime2.convertToDER());\n        outputArray.push(this.exponent1.convertToDER());\n        outputArray.push(this.exponent2.convertToDER());\n        outputArray.push(this.coefficient.convertToDER());\n        if (this.otherPrimeInfos) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                value: Array.from(this.otherPrimeInfos, o => o.toSchema())\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const jwk = {\n            n: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.modulus.valueBlock.valueHexView),\n            e: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.publicExponent.valueBlock.valueHexView),\n            d: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.privateExponent.valueBlock.valueHexView),\n            p: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.prime1.valueBlock.valueHexView),\n            q: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.prime2.valueBlock.valueHexView),\n            dp: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.exponent1.valueBlock.valueHexView),\n            dq: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.exponent2.valueBlock.valueHexView),\n            qi: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.coefficient.valueBlock.valueHexView),\n        };\n        if (this.otherPrimeInfos) {\n            jwk.oth = Array.from(this.otherPrimeInfos, o => o.toJSON());\n        }\n        return jwk;\n    }\n    fromJSON(json) {\n        ParameterError.assert(\"json\", json, \"n\", \"e\", \"d\", \"p\", \"q\", \"dp\", \"dq\", \"qi\");\n        this.modulus = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.FromBase64Url(json.n) });\n        this.publicExponent = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.FromBase64Url(json.e) });\n        this.privateExponent = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.FromBase64Url(json.d) });\n        this.prime1 = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.FromBase64Url(json.p) });\n        this.prime2 = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.FromBase64Url(json.q) });\n        this.exponent1 = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.FromBase64Url(json.dp) });\n        this.exponent2 = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.FromBase64Url(json.dq) });\n        this.coefficient = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.FromBase64Url(json.qi) });\n        if (json.oth) {\n            this.otherPrimeInfos = Array.from(json.oth, (element) => new OtherPrimeInfo({ json: element }));\n        }\n    }\n}\nRSAPrivateKey.CLASS_NAME = \"RSAPrivateKey\";\n\nconst VERSION$j = \"version\";\nconst PRIVATE_KEY_ALGORITHM = \"privateKeyAlgorithm\";\nconst PRIVATE_KEY = \"privateKey\";\nconst ATTRIBUTES$5 = \"attributes\";\nconst PARSED_KEY = \"parsedKey\";\nconst CLEAR_PROPS$16 = [\n    VERSION$j,\n    PRIVATE_KEY_ALGORITHM,\n    PRIVATE_KEY,\n    ATTRIBUTES$5\n];\nclass PrivateKeyInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$j, PrivateKeyInfo.defaultValues(VERSION$j));\n        this.privateKeyAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PRIVATE_KEY_ALGORITHM, PrivateKeyInfo.defaultValues(PRIVATE_KEY_ALGORITHM));\n        this.privateKey = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PRIVATE_KEY, PrivateKeyInfo.defaultValues(PRIVATE_KEY));\n        if (ATTRIBUTES$5 in parameters) {\n            this.attributes = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ATTRIBUTES$5, PrivateKeyInfo.defaultValues(ATTRIBUTES$5));\n        }\n        if (PARSED_KEY in parameters) {\n            this.parsedKey = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PARSED_KEY, PrivateKeyInfo.defaultValues(PARSED_KEY));\n        }\n        if (parameters.json) {\n            this.fromJSON(parameters.json);\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$j:\n                return 0;\n            case PRIVATE_KEY_ALGORITHM:\n                return new AlgorithmIdentifier();\n            case PRIVATE_KEY:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case ATTRIBUTES$5:\n                return [];\n            case PARSED_KEY:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || EMPTY_STRING) }),\n                AlgorithmIdentifier.schema(names.privateKeyAlgorithm || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.privateKey || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.attributes || EMPTY_STRING),\n                            value: Attribute.schema()\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$16);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PrivateKeyInfo.schema({\n            names: {\n                version: VERSION$j,\n                privateKeyAlgorithm: {\n                    names: {\n                        blockName: PRIVATE_KEY_ALGORITHM\n                    }\n                },\n                privateKey: PRIVATE_KEY,\n                attributes: ATTRIBUTES$5\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result.version.valueBlock.valueDec;\n        this.privateKeyAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.privateKeyAlgorithm });\n        this.privateKey = asn1.result.privateKey;\n        if (ATTRIBUTES$5 in asn1.result)\n            this.attributes = Array.from(asn1.result.attributes, element => new Attribute({ schema: element }));\n        switch (this.privateKeyAlgorithm.algorithmId) {\n            case \"1.2.840.113549.1.1.1\":\n                {\n                    const privateKeyASN1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(this.privateKey.valueBlock.valueHexView);\n                    if (privateKeyASN1.offset !== -1)\n                        this.parsedKey = new RSAPrivateKey({ schema: privateKeyASN1.result });\n                }\n                break;\n            case \"1.2.840.10045.2.1\":\n                if (\"algorithmParams\" in this.privateKeyAlgorithm) {\n                    if (this.privateKeyAlgorithm.algorithmParams instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier) {\n                        const privateKeyASN1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(this.privateKey.valueBlock.valueHexView);\n                        if (privateKeyASN1.offset !== -1) {\n                            this.parsedKey = new ECPrivateKey({\n                                namedCurve: this.privateKeyAlgorithm.algorithmParams.valueBlock.toString(),\n                                schema: privateKeyASN1.result\n                            });\n                        }\n                    }\n                }\n                break;\n        }\n    }\n    toSchema() {\n        const outputArray = [\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }),\n            this.privateKeyAlgorithm.toSchema(),\n            this.privateKey\n        ];\n        if (this.attributes) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: Array.from(this.attributes, o => o.toSchema())\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        if (!this.parsedKey) {\n            const object = {\n                version: this.version,\n                privateKeyAlgorithm: this.privateKeyAlgorithm.toJSON(),\n                privateKey: this.privateKey.toJSON(),\n            };\n            if (this.attributes) {\n                object.attributes = Array.from(this.attributes, o => o.toJSON());\n            }\n            return object;\n        }\n        const jwk = {};\n        switch (this.privateKeyAlgorithm.algorithmId) {\n            case \"1.2.840.10045.2.1\":\n                jwk.kty = \"EC\";\n                break;\n            case \"1.2.840.113549.1.1.1\":\n                jwk.kty = \"RSA\";\n                break;\n        }\n        const publicKeyJWK = this.parsedKey.toJSON();\n        Object.assign(jwk, publicKeyJWK);\n        return jwk;\n    }\n    fromJSON(json) {\n        if (\"kty\" in json) {\n            switch (json.kty.toUpperCase()) {\n                case \"EC\":\n                    this.parsedKey = new ECPrivateKey({ json });\n                    this.privateKeyAlgorithm = new AlgorithmIdentifier({\n                        algorithmId: \"1.2.840.10045.2.1\",\n                        algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.parsedKey.namedCurve })\n                    });\n                    break;\n                case \"RSA\":\n                    this.parsedKey = new RSAPrivateKey({ json });\n                    this.privateKeyAlgorithm = new AlgorithmIdentifier({\n                        algorithmId: \"1.2.840.113549.1.1.1\",\n                        algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n                    });\n                    break;\n                default:\n                    throw new Error(`Invalid value for \"kty\" parameter: ${json.kty}`);\n            }\n            this.privateKey = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: this.parsedKey.toSchema().toBER(false) });\n        }\n    }\n}\nPrivateKeyInfo.CLASS_NAME = \"PrivateKeyInfo\";\n\nconst CONTENT_TYPE$1 = \"contentType\";\nconst CONTENT_ENCRYPTION_ALGORITHM = \"contentEncryptionAlgorithm\";\nconst ENCRYPTED_CONTENT = \"encryptedContent\";\nconst CLEAR_PROPS$15 = [\n    CONTENT_TYPE$1,\n    CONTENT_ENCRYPTION_ALGORITHM,\n    ENCRYPTED_CONTENT,\n];\nconst PIECE_SIZE = 1024;\nclass EncryptedContentInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.contentType = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CONTENT_TYPE$1, EncryptedContentInfo.defaultValues(CONTENT_TYPE$1));\n        this.contentEncryptionAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CONTENT_ENCRYPTION_ALGORITHM, EncryptedContentInfo.defaultValues(CONTENT_ENCRYPTION_ALGORITHM));\n        if (ENCRYPTED_CONTENT in parameters && parameters.encryptedContent) {\n            this.encryptedContent = parameters.encryptedContent;\n            if ((this.encryptedContent.idBlock.tagClass === 1) &&\n                (this.encryptedContent.idBlock.tagNumber === 4)) {\n                if (this.encryptedContent.idBlock.isConstructed === false && !parameters.disableSplit) {\n                    const constrString = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({\n                        idBlock: { isConstructed: true },\n                        isConstructed: true\n                    });\n                    let offset = 0;\n                    const valueHex = this.encryptedContent.valueBlock.valueHexView.slice().buffer;\n                    let length = valueHex.byteLength;\n                    while (length > 0) {\n                        const pieceView = new Uint8Array(valueHex, offset, ((offset + PIECE_SIZE) > valueHex.byteLength) ? (valueHex.byteLength - offset) : PIECE_SIZE);\n                        const _array = new ArrayBuffer(pieceView.length);\n                        const _view = new Uint8Array(_array);\n                        for (let i = 0; i < _view.length; i++)\n                            _view[i] = pieceView[i];\n                        constrString.valueBlock.value.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: _array }));\n                        length -= pieceView.length;\n                        offset += pieceView.length;\n                    }\n                    this.encryptedContent = constrString;\n                }\n            }\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case CONTENT_TYPE$1:\n                return EMPTY_STRING;\n            case CONTENT_ENCRYPTION_ALGORITHM:\n                return new AlgorithmIdentifier();\n            case ENCRYPTED_CONTENT:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case CONTENT_TYPE$1:\n                return (memberValue === EMPTY_STRING);\n            case CONTENT_ENCRYPTION_ALGORITHM:\n                return ((memberValue.algorithmId === EMPTY_STRING) && ((\"algorithmParams\" in memberValue) === false));\n            case ENCRYPTED_CONTENT:\n                return (memberValue.isEqual(EncryptedContentInfo.defaultValues(ENCRYPTED_CONTENT)));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.contentType || EMPTY_STRING) }),\n                AlgorithmIdentifier.schema(names.contentEncryptionAlgorithm || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            name: (names.encryptedContent || EMPTY_STRING),\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 0\n                            },\n                            value: [\n                                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                                    value: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString()\n                                })\n                            ]\n                        }),\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                            name: (names.encryptedContent || EMPTY_STRING),\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 0\n                            }\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$15);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, EncryptedContentInfo.schema({\n            names: {\n                contentType: CONTENT_TYPE$1,\n                contentEncryptionAlgorithm: {\n                    names: {\n                        blockName: CONTENT_ENCRYPTION_ALGORITHM\n                    }\n                },\n                encryptedContent: ENCRYPTED_CONTENT\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.contentType = asn1.result.contentType.valueBlock.toString();\n        this.contentEncryptionAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.contentEncryptionAlgorithm });\n        if (ENCRYPTED_CONTENT in asn1.result) {\n            this.encryptedContent = asn1.result.encryptedContent;\n            this.encryptedContent.idBlock.tagClass = 1;\n            this.encryptedContent.idBlock.tagNumber = 4;\n        }\n    }\n    toSchema() {\n        const sequenceLengthBlock = {\n            isIndefiniteForm: false\n        };\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.contentType }));\n        outputArray.push(this.contentEncryptionAlgorithm.toSchema());\n        if (this.encryptedContent) {\n            sequenceLengthBlock.isIndefiniteForm = this.encryptedContent.idBlock.isConstructed;\n            const encryptedValue = this.encryptedContent;\n            encryptedValue.idBlock.tagClass = 3;\n            encryptedValue.idBlock.tagNumber = 0;\n            encryptedValue.lenBlock.isIndefiniteForm = this.encryptedContent.idBlock.isConstructed;\n            outputArray.push(encryptedValue);\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            lenBlock: sequenceLengthBlock,\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            contentType: this.contentType,\n            contentEncryptionAlgorithm: this.contentEncryptionAlgorithm.toJSON()\n        };\n        if (this.encryptedContent) {\n            res.encryptedContent = this.encryptedContent.toJSON();\n        }\n        return res;\n    }\n    getEncryptedContent() {\n        if (!this.encryptedContent) {\n            throw new Error(\"Parameter 'encryptedContent' is undefined\");\n        }\n        return asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString.prototype.getValue.call(this.encryptedContent);\n    }\n}\nEncryptedContentInfo.CLASS_NAME = \"EncryptedContentInfo\";\n\nconst HASH_ALGORITHM$4 = \"hashAlgorithm\";\nconst MASK_GEN_ALGORITHM$1 = \"maskGenAlgorithm\";\nconst SALT_LENGTH = \"saltLength\";\nconst TRAILER_FIELD = \"trailerField\";\nconst CLEAR_PROPS$14 = [\n    HASH_ALGORITHM$4,\n    MASK_GEN_ALGORITHM$1,\n    SALT_LENGTH,\n    TRAILER_FIELD\n];\nclass RSASSAPSSParams extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.hashAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, HASH_ALGORITHM$4, RSASSAPSSParams.defaultValues(HASH_ALGORITHM$4));\n        this.maskGenAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MASK_GEN_ALGORITHM$1, RSASSAPSSParams.defaultValues(MASK_GEN_ALGORITHM$1));\n        this.saltLength = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SALT_LENGTH, RSASSAPSSParams.defaultValues(SALT_LENGTH));\n        this.trailerField = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TRAILER_FIELD, RSASSAPSSParams.defaultValues(TRAILER_FIELD));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case HASH_ALGORITHM$4:\n                return new AlgorithmIdentifier({\n                    algorithmId: \"1.3.14.3.2.26\",\n                    algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n                });\n            case MASK_GEN_ALGORITHM$1:\n                return new AlgorithmIdentifier({\n                    algorithmId: \"1.2.840.113549.1.1.8\",\n                    algorithmParams: (new AlgorithmIdentifier({\n                        algorithmId: \"1.3.14.3.2.26\",\n                        algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n                    })).toSchema()\n                });\n            case SALT_LENGTH:\n                return 20;\n            case TRAILER_FIELD:\n                return 1;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    optional: true,\n                    value: [AlgorithmIdentifier.schema(names.hashAlgorithm || {})]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    optional: true,\n                    value: [AlgorithmIdentifier.schema(names.maskGenAlgorithm || {})]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 2\n                    },\n                    optional: true,\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.saltLength || EMPTY_STRING) })]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 3\n                    },\n                    optional: true,\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.trailerField || EMPTY_STRING) })]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$14);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, RSASSAPSSParams.schema({\n            names: {\n                hashAlgorithm: {\n                    names: {\n                        blockName: HASH_ALGORITHM$4\n                    }\n                },\n                maskGenAlgorithm: {\n                    names: {\n                        blockName: MASK_GEN_ALGORITHM$1\n                    }\n                },\n                saltLength: SALT_LENGTH,\n                trailerField: TRAILER_FIELD\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (HASH_ALGORITHM$4 in asn1.result)\n            this.hashAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.hashAlgorithm });\n        if (MASK_GEN_ALGORITHM$1 in asn1.result)\n            this.maskGenAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.maskGenAlgorithm });\n        if (SALT_LENGTH in asn1.result)\n            this.saltLength = asn1.result.saltLength.valueBlock.valueDec;\n        if (TRAILER_FIELD in asn1.result)\n            this.trailerField = asn1.result.trailerField.valueBlock.valueDec;\n    }\n    toSchema() {\n        const outputArray = [];\n        if (!this.hashAlgorithm.isEqual(RSASSAPSSParams.defaultValues(HASH_ALGORITHM$4))) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [this.hashAlgorithm.toSchema()]\n            }));\n        }\n        if (!this.maskGenAlgorithm.isEqual(RSASSAPSSParams.defaultValues(MASK_GEN_ALGORITHM$1))) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: [this.maskGenAlgorithm.toSchema()]\n            }));\n        }\n        if (this.saltLength !== RSASSAPSSParams.defaultValues(SALT_LENGTH)) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 2\n                },\n                value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.saltLength })]\n            }));\n        }\n        if (this.trailerField !== RSASSAPSSParams.defaultValues(TRAILER_FIELD)) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 3\n                },\n                value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.trailerField })]\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {};\n        if (!this.hashAlgorithm.isEqual(RSASSAPSSParams.defaultValues(HASH_ALGORITHM$4))) {\n            res.hashAlgorithm = this.hashAlgorithm.toJSON();\n        }\n        if (!this.maskGenAlgorithm.isEqual(RSASSAPSSParams.defaultValues(MASK_GEN_ALGORITHM$1))) {\n            res.maskGenAlgorithm = this.maskGenAlgorithm.toJSON();\n        }\n        if (this.saltLength !== RSASSAPSSParams.defaultValues(SALT_LENGTH)) {\n            res.saltLength = this.saltLength;\n        }\n        if (this.trailerField !== RSASSAPSSParams.defaultValues(TRAILER_FIELD)) {\n            res.trailerField = this.trailerField;\n        }\n        return res;\n    }\n}\nRSASSAPSSParams.CLASS_NAME = \"RSASSAPSSParams\";\n\nconst SALT = \"salt\";\nconst ITERATION_COUNT = \"iterationCount\";\nconst KEY_LENGTH = \"keyLength\";\nconst PRF = \"prf\";\nconst CLEAR_PROPS$13 = [\n    SALT,\n    ITERATION_COUNT,\n    KEY_LENGTH,\n    PRF\n];\nclass PBKDF2Params extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.salt = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SALT, PBKDF2Params.defaultValues(SALT));\n        this.iterationCount = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ITERATION_COUNT, PBKDF2Params.defaultValues(ITERATION_COUNT));\n        if (KEY_LENGTH in parameters) {\n            this.keyLength = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_LENGTH, PBKDF2Params.defaultValues(KEY_LENGTH));\n        }\n        if (PRF in parameters) {\n            this.prf = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PRF, PBKDF2Params.defaultValues(PRF));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case SALT:\n                return {};\n            case ITERATION_COUNT:\n                return (-1);\n            case KEY_LENGTH:\n                return 0;\n            case PRF:\n                return new AlgorithmIdentifier({\n                    algorithmId: \"1.3.14.3.2.26\",\n                    algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n                });\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.saltPrimitive || EMPTY_STRING) }),\n                        AlgorithmIdentifier.schema(names.saltConstructed || {})\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.iterationCount || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({\n                    name: (names.keyLength || EMPTY_STRING),\n                    optional: true\n                }),\n                AlgorithmIdentifier.schema(names.prf || {\n                    names: {\n                        optional: true\n                    }\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$13);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PBKDF2Params.schema({\n            names: {\n                saltPrimitive: SALT,\n                saltConstructed: {\n                    names: {\n                        blockName: SALT\n                    }\n                },\n                iterationCount: ITERATION_COUNT,\n                keyLength: KEY_LENGTH,\n                prf: {\n                    names: {\n                        blockName: PRF,\n                        optional: true\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.salt = asn1.result.salt;\n        this.iterationCount = asn1.result.iterationCount.valueBlock.valueDec;\n        if (KEY_LENGTH in asn1.result)\n            this.keyLength = asn1.result.keyLength.valueBlock.valueDec;\n        if (PRF in asn1.result)\n            this.prf = new AlgorithmIdentifier({ schema: asn1.result.prf });\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(this.salt);\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.iterationCount }));\n        if (KEY_LENGTH in this) {\n            if (PBKDF2Params.defaultValues(KEY_LENGTH) !== this.keyLength)\n                outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.keyLength }));\n        }\n        if (this.prf) {\n            if (PBKDF2Params.defaultValues(PRF).isEqual(this.prf) === false)\n                outputArray.push(this.prf.toSchema());\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            salt: this.salt.toJSON(),\n            iterationCount: this.iterationCount\n        };\n        if (KEY_LENGTH in this) {\n            if (PBKDF2Params.defaultValues(KEY_LENGTH) !== this.keyLength)\n                res.keyLength = this.keyLength;\n        }\n        if (this.prf) {\n            if (PBKDF2Params.defaultValues(PRF).isEqual(this.prf) === false)\n                res.prf = this.prf.toJSON();\n        }\n        return res;\n    }\n}\nPBKDF2Params.CLASS_NAME = \"PBKDF2Params\";\n\nconst KEY_DERIVATION_FUNC = \"keyDerivationFunc\";\nconst ENCRYPTION_SCHEME = \"encryptionScheme\";\nconst CLEAR_PROPS$12 = [\n    KEY_DERIVATION_FUNC,\n    ENCRYPTION_SCHEME\n];\nclass PBES2Params extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.keyDerivationFunc = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_DERIVATION_FUNC, PBES2Params.defaultValues(KEY_DERIVATION_FUNC));\n        this.encryptionScheme = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENCRYPTION_SCHEME, PBES2Params.defaultValues(ENCRYPTION_SCHEME));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case KEY_DERIVATION_FUNC:\n                return new AlgorithmIdentifier();\n            case ENCRYPTION_SCHEME:\n                return new AlgorithmIdentifier();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                AlgorithmIdentifier.schema(names.keyDerivationFunc || {}),\n                AlgorithmIdentifier.schema(names.encryptionScheme || {})\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$12);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PBES2Params.schema({\n            names: {\n                keyDerivationFunc: {\n                    names: {\n                        blockName: KEY_DERIVATION_FUNC\n                    }\n                },\n                encryptionScheme: {\n                    names: {\n                        blockName: ENCRYPTION_SCHEME\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.keyDerivationFunc = new AlgorithmIdentifier({ schema: asn1.result.keyDerivationFunc });\n        this.encryptionScheme = new AlgorithmIdentifier({ schema: asn1.result.encryptionScheme });\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.keyDerivationFunc.toSchema(),\n                this.encryptionScheme.toSchema()\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            keyDerivationFunc: this.keyDerivationFunc.toJSON(),\n            encryptionScheme: this.encryptionScheme.toJSON()\n        };\n    }\n}\nPBES2Params.CLASS_NAME = \"PBES2Params\";\n\nclass AbstractCryptoEngine {\n    constructor(parameters) {\n        this.crypto = parameters.crypto;\n        this.subtle = \"webkitSubtle\" in parameters.crypto\n            ? parameters.crypto.webkitSubtle\n            : parameters.crypto.subtle;\n        this.name = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"name\", EMPTY_STRING);\n    }\n    async encrypt(...args) {\n        return this.subtle.encrypt(...args);\n    }\n    async decrypt(...args) {\n        return this.subtle.decrypt(...args);\n    }\n    sign(...args) {\n        return this.subtle.sign(...args);\n    }\n    async verify(...args) {\n        return this.subtle.verify(...args);\n    }\n    async digest(...args) {\n        return this.subtle.digest(...args);\n    }\n    async generateKey(...args) {\n        return this.subtle.generateKey(...args);\n    }\n    async deriveKey(...args) {\n        return this.subtle.deriveKey(...args);\n    }\n    async deriveBits(...args) {\n        return this.subtle.deriveBits(...args);\n    }\n    async wrapKey(...args) {\n        return this.subtle.wrapKey(...args);\n    }\n    async unwrapKey(...args) {\n        return this.subtle.unwrapKey(...args);\n    }\n    exportKey(...args) {\n        return this.subtle.exportKey(...args);\n    }\n    importKey(...args) {\n        return this.subtle.importKey(...args);\n    }\n    getRandomValues(array) {\n        if (array === null) {\n            throw new Error(\"Argument \\\"array\\\" must not be null\");\n        }\n        return this.crypto.getRandomValues(array);\n    }\n}\n\nasync function makePKCS12B2Key(hashAlgorithm, keyLength, password, salt, iterationCount) {\n    let u;\n    let v;\n    let md;\n    switch (hashAlgorithm.toUpperCase()) {\n        case \"SHA-1\":\n            u = 20;\n            v = 64;\n            md = _noble_hashes_sha1__WEBPACK_IMPORTED_MODULE_4__.sha1;\n            break;\n        case \"SHA-256\":\n            u = 32;\n            v = 64;\n            md = _noble_hashes_sha2__WEBPACK_IMPORTED_MODULE_5__.sha256;\n            break;\n        case \"SHA-384\":\n            u = 48;\n            v = 128;\n            md = _noble_hashes_sha2__WEBPACK_IMPORTED_MODULE_6__.sha384;\n            break;\n        case \"SHA-512\":\n            u = 64;\n            v = 128;\n            md = _noble_hashes_sha2__WEBPACK_IMPORTED_MODULE_6__.sha512;\n            break;\n        default:\n            throw new Error(\"Unsupported hashing algorithm\");\n    }\n    const originalPassword = new Uint8Array(password);\n    let decodedPassword = new TextDecoder().decode(password);\n    const encodedPassword = new TextEncoder().encode(decodedPassword);\n    if (encodedPassword.some((byte, i) => byte !== originalPassword[i])) {\n        decodedPassword = String.fromCharCode(...originalPassword);\n    }\n    const passwordTransformed = new Uint8Array(decodedPassword.length * 2 + 2);\n    const passwordView = new DataView(passwordTransformed.buffer);\n    for (let i = 0; i < decodedPassword.length; i++) {\n        passwordView.setUint16(i * 2, decodedPassword.charCodeAt(i), false);\n    }\n    passwordView.setUint16(decodedPassword.length * 2, 0, false);\n    const D = new Uint8Array(v).fill(3);\n    const saltView = new Uint8Array(salt);\n    const S = new Uint8Array(v * Math.ceil(saltView.length / v)).map((_, i) => saltView[i % saltView.length]);\n    const P = new Uint8Array(v * Math.ceil(passwordTransformed.length / v)).map((_, i) => passwordTransformed[i % passwordTransformed.length]);\n    let I = new Uint8Array(S.length + P.length);\n    I.set(S);\n    I.set(P, S.length);\n    const c = Math.ceil((keyLength >> 3) / u);\n    const result = [];\n    for (let i = 0; i < c; i++) {\n        let A = new Uint8Array(D.length + I.length);\n        A.set(D);\n        A.set(I, D.length);\n        for (let j = 0; j < iterationCount; j++) {\n            A = md(A);\n        }\n        const B = new Uint8Array(v).map((_, i) => A[i % A.length]);\n        const k = Math.ceil(saltView.length / v) + Math.ceil(passwordTransformed.length / v);\n        const iRound = [];\n        for (let j = 0; j < k; j++) {\n            const chunk = Array.from(I.slice(j * v, (j + 1) * v));\n            let x = 0x1ff;\n            for (let l = B.length - 1; l >= 0; l--) {\n                x >>= 8;\n                x += B[l] + (chunk[l] || 0);\n                chunk[l] = x & 0xff;\n            }\n            iRound.push(...chunk);\n        }\n        I = new Uint8Array(iRound);\n        result.push(...A);\n    }\n    return new Uint8Array(result.slice(0, keyLength >> 3)).buffer;\n}\nfunction prepareAlgorithm(data) {\n    const res = typeof data === \"string\"\n        ? { name: data }\n        : data;\n    if (\"hash\" in res) {\n        return {\n            ...res,\n            hash: prepareAlgorithm(res.hash)\n        };\n    }\n    return res;\n}\nclass CryptoEngine extends AbstractCryptoEngine {\n    async importKey(format, keyData, algorithm, extractable, keyUsages) {\n        var _a, _b, _c, _d, _e, _f;\n        let jwk = {};\n        const alg = prepareAlgorithm(algorithm);\n        switch (format.toLowerCase()) {\n            case \"raw\":\n                return this.subtle.importKey(\"raw\", keyData, algorithm, extractable, keyUsages);\n            case \"spki\":\n                {\n                    const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.toArrayBuffer(keyData));\n                    AsnError.assert(asn1, \"keyData\");\n                    const publicKeyInfo = new PublicKeyInfo();\n                    try {\n                        publicKeyInfo.fromSchema(asn1.result);\n                    }\n                    catch {\n                        throw new ArgumentError(\"Incorrect keyData\");\n                    }\n                    switch (alg.name.toUpperCase()) {\n                        case \"RSA-PSS\":\n                            {\n                                if (!alg.hash) {\n                                    throw new ParameterError(\"hash\", \"algorithm.hash\", \"Incorrect hash algorithm: Hash algorithm is missed\");\n                                }\n                                switch (alg.hash.name.toUpperCase()) {\n                                    case \"SHA-1\":\n                                        jwk.alg = \"PS1\";\n                                        break;\n                                    case \"SHA-256\":\n                                        jwk.alg = \"PS256\";\n                                        break;\n                                    case \"SHA-384\":\n                                        jwk.alg = \"PS384\";\n                                        break;\n                                    case \"SHA-512\":\n                                        jwk.alg = \"PS512\";\n                                        break;\n                                    default:\n                                        throw new Error(`Incorrect hash algorithm: ${alg.hash.name.toUpperCase()}`);\n                                }\n                            }\n                        case \"RSASSA-PKCS1-V1_5\":\n                            {\n                                keyUsages = [\"verify\"];\n                                jwk.kty = \"RSA\";\n                                jwk.ext = extractable;\n                                jwk.key_ops = keyUsages;\n                                if (publicKeyInfo.algorithm.algorithmId !== \"1.2.840.113549.1.1.1\")\n                                    throw new Error(`Incorrect public key algorithm: ${publicKeyInfo.algorithm.algorithmId}`);\n                                if (!jwk.alg) {\n                                    if (!alg.hash) {\n                                        throw new ParameterError(\"hash\", \"algorithm.hash\", \"Incorrect hash algorithm: Hash algorithm is missed\");\n                                    }\n                                    switch (alg.hash.name.toUpperCase()) {\n                                        case \"SHA-1\":\n                                            jwk.alg = \"RS1\";\n                                            break;\n                                        case \"SHA-256\":\n                                            jwk.alg = \"RS256\";\n                                            break;\n                                        case \"SHA-384\":\n                                            jwk.alg = \"RS384\";\n                                            break;\n                                        case \"SHA-512\":\n                                            jwk.alg = \"RS512\";\n                                            break;\n                                        default:\n                                            throw new Error(`Incorrect hash algorithm: ${alg.hash.name.toUpperCase()}`);\n                                    }\n                                }\n                                const publicKeyJSON = publicKeyInfo.toJSON();\n                                Object.assign(jwk, publicKeyJSON);\n                            }\n                            break;\n                        case \"ECDSA\":\n                            keyUsages = [\"verify\"];\n                        case \"ECDH\":\n                            {\n                                jwk = {\n                                    kty: \"EC\",\n                                    ext: extractable,\n                                    key_ops: keyUsages\n                                };\n                                if (publicKeyInfo.algorithm.algorithmId !== \"1.2.840.10045.2.1\") {\n                                    throw new Error(`Incorrect public key algorithm: ${publicKeyInfo.algorithm.algorithmId}`);\n                                }\n                                const publicKeyJSON = publicKeyInfo.toJSON();\n                                Object.assign(jwk, publicKeyJSON);\n                            }\n                            break;\n                        case \"RSA-OAEP\":\n                            {\n                                jwk.kty = \"RSA\";\n                                jwk.ext = extractable;\n                                jwk.key_ops = keyUsages;\n                                if (this.name.toLowerCase() === \"safari\")\n                                    jwk.alg = \"RSA-OAEP\";\n                                else {\n                                    if (!alg.hash) {\n                                        throw new ParameterError(\"hash\", \"algorithm.hash\", \"Incorrect hash algorithm: Hash algorithm is missed\");\n                                    }\n                                    switch (alg.hash.name.toUpperCase()) {\n                                        case \"SHA-1\":\n                                            jwk.alg = \"RSA-OAEP\";\n                                            break;\n                                        case \"SHA-256\":\n                                            jwk.alg = \"RSA-OAEP-256\";\n                                            break;\n                                        case \"SHA-384\":\n                                            jwk.alg = \"RSA-OAEP-384\";\n                                            break;\n                                        case \"SHA-512\":\n                                            jwk.alg = \"RSA-OAEP-512\";\n                                            break;\n                                        default:\n                                            throw new Error(`Incorrect hash algorithm: ${alg.hash.name.toUpperCase()}`);\n                                    }\n                                }\n                                const publicKeyJSON = publicKeyInfo.toJSON();\n                                Object.assign(jwk, publicKeyJSON);\n                            }\n                            break;\n                        case \"RSAES-PKCS1-V1_5\":\n                            {\n                                jwk.kty = \"RSA\";\n                                jwk.ext = extractable;\n                                jwk.key_ops = keyUsages;\n                                jwk.alg = \"PS1\";\n                                const publicKeyJSON = publicKeyInfo.toJSON();\n                                Object.assign(jwk, publicKeyJSON);\n                            }\n                            break;\n                        default:\n                            throw new Error(`Incorrect algorithm name: ${alg.name.toUpperCase()}`);\n                    }\n                }\n                break;\n            case \"pkcs8\":\n                {\n                    const privateKeyInfo = new PrivateKeyInfo();\n                    const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.toArrayBuffer(keyData));\n                    AsnError.assert(asn1, \"keyData\");\n                    try {\n                        privateKeyInfo.fromSchema(asn1.result);\n                    }\n                    catch {\n                        throw new Error(\"Incorrect keyData\");\n                    }\n                    if (!privateKeyInfo.parsedKey)\n                        throw new Error(\"Incorrect keyData\");\n                    switch (alg.name.toUpperCase()) {\n                        case \"RSA-PSS\":\n                            {\n                                switch ((_a = alg.hash) === null || _a === void 0 ? void 0 : _a.name.toUpperCase()) {\n                                    case \"SHA-1\":\n                                        jwk.alg = \"PS1\";\n                                        break;\n                                    case \"SHA-256\":\n                                        jwk.alg = \"PS256\";\n                                        break;\n                                    case \"SHA-384\":\n                                        jwk.alg = \"PS384\";\n                                        break;\n                                    case \"SHA-512\":\n                                        jwk.alg = \"PS512\";\n                                        break;\n                                    default:\n                                        throw new Error(`Incorrect hash algorithm: ${(_b = alg.hash) === null || _b === void 0 ? void 0 : _b.name.toUpperCase()}`);\n                                }\n                            }\n                        case \"RSASSA-PKCS1-V1_5\":\n                            {\n                                keyUsages = [\"sign\"];\n                                jwk.kty = \"RSA\";\n                                jwk.ext = extractable;\n                                jwk.key_ops = keyUsages;\n                                if (privateKeyInfo.privateKeyAlgorithm.algorithmId !== \"1.2.840.113549.1.1.1\")\n                                    throw new Error(`Incorrect private key algorithm: ${privateKeyInfo.privateKeyAlgorithm.algorithmId}`);\n                                if ((\"alg\" in jwk) === false) {\n                                    switch ((_c = alg.hash) === null || _c === void 0 ? void 0 : _c.name.toUpperCase()) {\n                                        case \"SHA-1\":\n                                            jwk.alg = \"RS1\";\n                                            break;\n                                        case \"SHA-256\":\n                                            jwk.alg = \"RS256\";\n                                            break;\n                                        case \"SHA-384\":\n                                            jwk.alg = \"RS384\";\n                                            break;\n                                        case \"SHA-512\":\n                                            jwk.alg = \"RS512\";\n                                            break;\n                                        default:\n                                            throw new Error(`Incorrect hash algorithm: ${(_d = alg.hash) === null || _d === void 0 ? void 0 : _d.name.toUpperCase()}`);\n                                    }\n                                }\n                                const privateKeyJSON = privateKeyInfo.toJSON();\n                                Object.assign(jwk, privateKeyJSON);\n                            }\n                            break;\n                        case \"ECDSA\":\n                            keyUsages = [\"sign\"];\n                        case \"ECDH\":\n                            {\n                                jwk = {\n                                    kty: \"EC\",\n                                    ext: extractable,\n                                    key_ops: keyUsages\n                                };\n                                if (privateKeyInfo.privateKeyAlgorithm.algorithmId !== \"1.2.840.10045.2.1\")\n                                    throw new Error(`Incorrect algorithm: ${privateKeyInfo.privateKeyAlgorithm.algorithmId}`);\n                                const privateKeyJSON = privateKeyInfo.toJSON();\n                                Object.assign(jwk, privateKeyJSON);\n                            }\n                            break;\n                        case \"RSA-OAEP\":\n                            {\n                                jwk.kty = \"RSA\";\n                                jwk.ext = extractable;\n                                jwk.key_ops = keyUsages;\n                                if (this.name.toLowerCase() === \"safari\")\n                                    jwk.alg = \"RSA-OAEP\";\n                                else {\n                                    switch ((_e = alg.hash) === null || _e === void 0 ? void 0 : _e.name.toUpperCase()) {\n                                        case \"SHA-1\":\n                                            jwk.alg = \"RSA-OAEP\";\n                                            break;\n                                        case \"SHA-256\":\n                                            jwk.alg = \"RSA-OAEP-256\";\n                                            break;\n                                        case \"SHA-384\":\n                                            jwk.alg = \"RSA-OAEP-384\";\n                                            break;\n                                        case \"SHA-512\":\n                                            jwk.alg = \"RSA-OAEP-512\";\n                                            break;\n                                        default:\n                                            throw new Error(`Incorrect hash algorithm: ${(_f = alg.hash) === null || _f === void 0 ? void 0 : _f.name.toUpperCase()}`);\n                                    }\n                                }\n                                const privateKeyJSON = privateKeyInfo.toJSON();\n                                Object.assign(jwk, privateKeyJSON);\n                            }\n                            break;\n                        case \"RSAES-PKCS1-V1_5\":\n                            {\n                                keyUsages = [\"decrypt\"];\n                                jwk.kty = \"RSA\";\n                                jwk.ext = extractable;\n                                jwk.key_ops = keyUsages;\n                                jwk.alg = \"PS1\";\n                                const privateKeyJSON = privateKeyInfo.toJSON();\n                                Object.assign(jwk, privateKeyJSON);\n                            }\n                            break;\n                        default:\n                            throw new Error(`Incorrect algorithm name: ${alg.name.toUpperCase()}`);\n                    }\n                }\n                break;\n            case \"jwk\":\n                jwk = keyData;\n                break;\n            default:\n                throw new Error(`Incorrect format: ${format}`);\n        }\n        if (this.name.toLowerCase() === \"safari\") {\n            try {\n                return this.subtle.importKey(\"jwk\", pvutils__WEBPACK_IMPORTED_MODULE_2__.stringToArrayBuffer(JSON.stringify(jwk)), algorithm, extractable, keyUsages);\n            }\n            catch {\n                return this.subtle.importKey(\"jwk\", jwk, algorithm, extractable, keyUsages);\n            }\n        }\n        return this.subtle.importKey(\"jwk\", jwk, algorithm, extractable, keyUsages);\n    }\n    async exportKey(format, key) {\n        let jwk = await this.subtle.exportKey(\"jwk\", key);\n        if (this.name.toLowerCase() === \"safari\") {\n            if (jwk instanceof ArrayBuffer) {\n                jwk = JSON.parse(pvutils__WEBPACK_IMPORTED_MODULE_2__.arrayBufferToString(jwk));\n            }\n        }\n        switch (format.toLowerCase()) {\n            case \"raw\":\n                return this.subtle.exportKey(\"raw\", key);\n            case \"spki\": {\n                const publicKeyInfo = new PublicKeyInfo();\n                try {\n                    publicKeyInfo.fromJSON(jwk);\n                }\n                catch {\n                    throw new Error(\"Incorrect key data\");\n                }\n                return publicKeyInfo.toSchema().toBER(false);\n            }\n            case \"pkcs8\": {\n                const privateKeyInfo = new PrivateKeyInfo();\n                try {\n                    privateKeyInfo.fromJSON(jwk);\n                }\n                catch {\n                    throw new Error(\"Incorrect key data\");\n                }\n                return privateKeyInfo.toSchema().toBER(false);\n            }\n            case \"jwk\":\n                return jwk;\n            default:\n                throw new Error(`Incorrect format: ${format}`);\n        }\n    }\n    async convert(inputFormat, outputFormat, keyData, algorithm, extractable, keyUsages) {\n        if (inputFormat.toLowerCase() === outputFormat.toLowerCase()) {\n            return keyData;\n        }\n        const key = await this.importKey(inputFormat, keyData, algorithm, extractable, keyUsages);\n        return this.exportKey(outputFormat, key);\n    }\n    getAlgorithmByOID(oid, safety = false, target) {\n        switch (oid) {\n            case \"1.2.840.113549.1.1.1\":\n                return {\n                    name: \"RSAES-PKCS1-v1_5\"\n                };\n            case \"1.2.840.113549.1.1.5\":\n                return {\n                    name: \"RSASSA-PKCS1-v1_5\",\n                    hash: {\n                        name: \"SHA-1\"\n                    }\n                };\n            case \"1.2.840.113549.1.1.11\":\n                return {\n                    name: \"RSASSA-PKCS1-v1_5\",\n                    hash: {\n                        name: \"SHA-256\"\n                    }\n                };\n            case \"1.2.840.113549.1.1.12\":\n                return {\n                    name: \"RSASSA-PKCS1-v1_5\",\n                    hash: {\n                        name: \"SHA-384\"\n                    }\n                };\n            case \"1.2.840.113549.1.1.13\":\n                return {\n                    name: \"RSASSA-PKCS1-v1_5\",\n                    hash: {\n                        name: \"SHA-512\"\n                    }\n                };\n            case \"1.2.840.113549.1.1.10\":\n                return {\n                    name: \"RSA-PSS\"\n                };\n            case \"1.2.840.113549.1.1.7\":\n                return {\n                    name: \"RSA-OAEP\"\n                };\n            case \"1.2.840.10045.2.1\":\n            case \"1.2.840.10045.4.1\":\n                return {\n                    name: \"ECDSA\",\n                    hash: {\n                        name: \"SHA-1\"\n                    }\n                };\n            case \"1.2.840.10045.4.3.2\":\n                return {\n                    name: \"ECDSA\",\n                    hash: {\n                        name: \"SHA-256\"\n                    }\n                };\n            case \"1.2.840.10045.4.3.3\":\n                return {\n                    name: \"ECDSA\",\n                    hash: {\n                        name: \"SHA-384\"\n                    }\n                };\n            case \"1.2.840.10045.4.3.4\":\n                return {\n                    name: \"ECDSA\",\n                    hash: {\n                        name: \"SHA-512\"\n                    }\n                };\n            case \"1.3.133.16.840.63.0.2\":\n                return {\n                    name: \"ECDH\",\n                    kdf: \"SHA-1\"\n                };\n            case \"1.3.132.1.11.1\":\n                return {\n                    name: \"ECDH\",\n                    kdf: \"SHA-256\"\n                };\n            case \"1.3.132.1.11.2\":\n                return {\n                    name: \"ECDH\",\n                    kdf: \"SHA-384\"\n                };\n            case \"1.3.132.1.11.3\":\n                return {\n                    name: \"ECDH\",\n                    kdf: \"SHA-512\"\n                };\n            case \"2.16.840.1.101.3.4.1.2\":\n                return {\n                    name: \"AES-CBC\",\n                    length: 128\n                };\n            case \"2.16.840.1.101.3.4.1.22\":\n                return {\n                    name: \"AES-CBC\",\n                    length: 192\n                };\n            case \"2.16.840.1.101.3.4.1.42\":\n                return {\n                    name: \"AES-CBC\",\n                    length: 256\n                };\n            case \"2.16.840.1.101.3.4.1.6\":\n                return {\n                    name: \"AES-GCM\",\n                    length: 128\n                };\n            case \"2.16.840.1.101.3.4.1.26\":\n                return {\n                    name: \"AES-GCM\",\n                    length: 192\n                };\n            case \"2.16.840.1.101.3.4.1.46\":\n                return {\n                    name: \"AES-GCM\",\n                    length: 256\n                };\n            case \"2.16.840.1.101.3.4.1.4\":\n                return {\n                    name: \"AES-CFB\",\n                    length: 128\n                };\n            case \"2.16.840.1.101.3.4.1.24\":\n                return {\n                    name: \"AES-CFB\",\n                    length: 192\n                };\n            case \"2.16.840.1.101.3.4.1.44\":\n                return {\n                    name: \"AES-CFB\",\n                    length: 256\n                };\n            case \"2.16.840.1.101.3.4.1.5\":\n                return {\n                    name: \"AES-KW\",\n                    length: 128\n                };\n            case \"2.16.840.1.101.3.4.1.25\":\n                return {\n                    name: \"AES-KW\",\n                    length: 192\n                };\n            case \"2.16.840.1.101.3.4.1.45\":\n                return {\n                    name: \"AES-KW\",\n                    length: 256\n                };\n            case \"1.2.840.113549.2.7\":\n                return {\n                    name: \"HMAC\",\n                    hash: {\n                        name: \"SHA-1\"\n                    }\n                };\n            case \"1.2.840.113549.2.9\":\n                return {\n                    name: \"HMAC\",\n                    hash: {\n                        name: \"SHA-256\"\n                    }\n                };\n            case \"1.2.840.113549.2.10\":\n                return {\n                    name: \"HMAC\",\n                    hash: {\n                        name: \"SHA-384\"\n                    }\n                };\n            case \"1.2.840.113549.2.11\":\n                return {\n                    name: \"HMAC\",\n                    hash: {\n                        name: \"SHA-512\"\n                    }\n                };\n            case \"1.2.840.113549.1.9.16.3.5\":\n                return {\n                    name: \"DH\"\n                };\n            case \"1.3.14.3.2.26\":\n                return {\n                    name: \"SHA-1\"\n                };\n            case \"2.16.840.1.101.3.4.2.1\":\n                return {\n                    name: \"SHA-256\"\n                };\n            case \"2.16.840.1.101.3.4.2.2\":\n                return {\n                    name: \"SHA-384\"\n                };\n            case \"2.16.840.1.101.3.4.2.3\":\n                return {\n                    name: \"SHA-512\"\n                };\n            case \"1.2.840.113549.1.5.12\":\n                return {\n                    name: \"PBKDF2\"\n                };\n            case \"1.2.840.10045.3.1.7\":\n                return {\n                    name: \"P-256\"\n                };\n            case \"1.3.132.0.34\":\n                return {\n                    name: \"P-384\"\n                };\n            case \"1.3.132.0.35\":\n                return {\n                    name: \"P-521\"\n                };\n        }\n        if (safety) {\n            throw new Error(`Unsupported algorithm identifier ${target ? `for ${target} ` : EMPTY_STRING}: ${oid}`);\n        }\n        return {};\n    }\n    getOIDByAlgorithm(algorithm, safety = false, target) {\n        let result = EMPTY_STRING;\n        switch (algorithm.name.toUpperCase()) {\n            case \"RSAES-PKCS1-V1_5\":\n                result = \"1.2.840.113549.1.1.1\";\n                break;\n            case \"RSASSA-PKCS1-V1_5\":\n                switch (algorithm.hash.name.toUpperCase()) {\n                    case \"SHA-1\":\n                        result = \"1.2.840.113549.1.1.5\";\n                        break;\n                    case \"SHA-256\":\n                        result = \"1.2.840.113549.1.1.11\";\n                        break;\n                    case \"SHA-384\":\n                        result = \"1.2.840.113549.1.1.12\";\n                        break;\n                    case \"SHA-512\":\n                        result = \"1.2.840.113549.1.1.13\";\n                        break;\n                }\n                break;\n            case \"RSA-PSS\":\n                result = \"1.2.840.113549.1.1.10\";\n                break;\n            case \"RSA-OAEP\":\n                result = \"1.2.840.113549.1.1.7\";\n                break;\n            case \"ECDSA\":\n                switch (algorithm.hash.name.toUpperCase()) {\n                    case \"SHA-1\":\n                        result = \"1.2.840.10045.4.1\";\n                        break;\n                    case \"SHA-256\":\n                        result = \"1.2.840.10045.4.3.2\";\n                        break;\n                    case \"SHA-384\":\n                        result = \"1.2.840.10045.4.3.3\";\n                        break;\n                    case \"SHA-512\":\n                        result = \"1.2.840.10045.4.3.4\";\n                        break;\n                }\n                break;\n            case \"ECDH\":\n                switch (algorithm.kdf.toUpperCase()) {\n                    case \"SHA-1\":\n                        result = \"1.3.133.16.840.63.0.2\";\n                        break;\n                    case \"SHA-256\":\n                        result = \"1.3.132.1.11.1\";\n                        break;\n                    case \"SHA-384\":\n                        result = \"1.3.132.1.11.2\";\n                        break;\n                    case \"SHA-512\":\n                        result = \"1.3.132.1.11.3\";\n                        break;\n                }\n                break;\n            case \"AES-CTR\":\n                break;\n            case \"AES-CBC\":\n                switch (algorithm.length) {\n                    case 128:\n                        result = \"2.16.840.1.101.3.4.1.2\";\n                        break;\n                    case 192:\n                        result = \"2.16.840.1.101.3.4.1.22\";\n                        break;\n                    case 256:\n                        result = \"2.16.840.1.101.3.4.1.42\";\n                        break;\n                }\n                break;\n            case \"AES-CMAC\":\n                break;\n            case \"AES-GCM\":\n                switch (algorithm.length) {\n                    case 128:\n                        result = \"2.16.840.1.101.3.4.1.6\";\n                        break;\n                    case 192:\n                        result = \"2.16.840.1.101.3.4.1.26\";\n                        break;\n                    case 256:\n                        result = \"2.16.840.1.101.3.4.1.46\";\n                        break;\n                }\n                break;\n            case \"AES-CFB\":\n                switch (algorithm.length) {\n                    case 128:\n                        result = \"2.16.840.1.101.3.4.1.4\";\n                        break;\n                    case 192:\n                        result = \"2.16.840.1.101.3.4.1.24\";\n                        break;\n                    case 256:\n                        result = \"2.16.840.1.101.3.4.1.44\";\n                        break;\n                }\n                break;\n            case \"AES-KW\":\n                switch (algorithm.length) {\n                    case 128:\n                        result = \"2.16.840.1.101.3.4.1.5\";\n                        break;\n                    case 192:\n                        result = \"2.16.840.1.101.3.4.1.25\";\n                        break;\n                    case 256:\n                        result = \"2.16.840.1.101.3.4.1.45\";\n                        break;\n                }\n                break;\n            case \"HMAC\":\n                switch (algorithm.hash.name.toUpperCase()) {\n                    case \"SHA-1\":\n                        result = \"1.2.840.113549.2.7\";\n                        break;\n                    case \"SHA-256\":\n                        result = \"1.2.840.113549.2.9\";\n                        break;\n                    case \"SHA-384\":\n                        result = \"1.2.840.113549.2.10\";\n                        break;\n                    case \"SHA-512\":\n                        result = \"1.2.840.113549.2.11\";\n                        break;\n                }\n                break;\n            case \"DH\":\n                result = \"1.2.840.113549.1.9.16.3.5\";\n                break;\n            case \"SHA-1\":\n                result = \"1.3.14.3.2.26\";\n                break;\n            case \"SHA-256\":\n                result = \"2.16.840.1.101.3.4.2.1\";\n                break;\n            case \"SHA-384\":\n                result = \"2.16.840.1.101.3.4.2.2\";\n                break;\n            case \"SHA-512\":\n                result = \"2.16.840.1.101.3.4.2.3\";\n                break;\n            case \"CONCAT\":\n                break;\n            case \"HKDF\":\n                break;\n            case \"PBKDF2\":\n                result = \"1.2.840.113549.1.5.12\";\n                break;\n            case \"P-256\":\n                result = \"1.2.840.10045.3.1.7\";\n                break;\n            case \"P-384\":\n                result = \"1.3.132.0.34\";\n                break;\n            case \"P-521\":\n                result = \"1.3.132.0.35\";\n                break;\n        }\n        if (!result && safety) {\n            throw new Error(`Unsupported algorithm ${target ? `for ${target} ` : EMPTY_STRING}: ${algorithm.name}`);\n        }\n        return result;\n    }\n    getAlgorithmParameters(algorithmName, operation) {\n        let result = {\n            algorithm: {},\n            usages: []\n        };\n        switch (algorithmName.toUpperCase()) {\n            case \"RSAES-PKCS1-V1_5\":\n            case \"RSASSA-PKCS1-V1_5\":\n                switch (operation.toLowerCase()) {\n                    case \"generatekey\":\n                        result = {\n                            algorithm: {\n                                name: \"RSASSA-PKCS1-v1_5\",\n                                modulusLength: 2048,\n                                publicExponent: new Uint8Array([0x01, 0x00, 0x01]),\n                                hash: {\n                                    name: \"SHA-256\"\n                                }\n                            },\n                            usages: [\"sign\", \"verify\"]\n                        };\n                        break;\n                    case \"verify\":\n                    case \"sign\":\n                    case \"importkey\":\n                        result = {\n                            algorithm: {\n                                name: \"RSASSA-PKCS1-v1_5\",\n                                hash: {\n                                    name: \"SHA-256\"\n                                }\n                            },\n                            usages: [\"verify\"]\n                        };\n                        break;\n                    case \"exportkey\":\n                    default:\n                        return {\n                            algorithm: {\n                                name: \"RSASSA-PKCS1-v1_5\"\n                            },\n                            usages: []\n                        };\n                }\n                break;\n            case \"RSA-PSS\":\n                switch (operation.toLowerCase()) {\n                    case \"sign\":\n                    case \"verify\":\n                        result = {\n                            algorithm: {\n                                name: \"RSA-PSS\",\n                                hash: {\n                                    name: \"SHA-1\"\n                                },\n                                saltLength: 20\n                            },\n                            usages: [\"sign\", \"verify\"]\n                        };\n                        break;\n                    case \"generatekey\":\n                        result = {\n                            algorithm: {\n                                name: \"RSA-PSS\",\n                                modulusLength: 2048,\n                                publicExponent: new Uint8Array([0x01, 0x00, 0x01]),\n                                hash: {\n                                    name: \"SHA-1\"\n                                }\n                            },\n                            usages: [\"sign\", \"verify\"]\n                        };\n                        break;\n                    case \"importkey\":\n                        result = {\n                            algorithm: {\n                                name: \"RSA-PSS\",\n                                hash: {\n                                    name: \"SHA-1\"\n                                }\n                            },\n                            usages: [\"verify\"]\n                        };\n                        break;\n                    case \"exportkey\":\n                    default:\n                        return {\n                            algorithm: {\n                                name: \"RSA-PSS\"\n                            },\n                            usages: []\n                        };\n                }\n                break;\n            case \"RSA-OAEP\":\n                switch (operation.toLowerCase()) {\n                    case \"encrypt\":\n                    case \"decrypt\":\n                        result = {\n                            algorithm: {\n                                name: \"RSA-OAEP\"\n                            },\n                            usages: [\"encrypt\", \"decrypt\"]\n                        };\n                        break;\n                    case \"generatekey\":\n                        result = {\n                            algorithm: {\n                                name: \"RSA-OAEP\",\n                                modulusLength: 2048,\n                                publicExponent: new Uint8Array([0x01, 0x00, 0x01]),\n                                hash: {\n                                    name: \"SHA-256\"\n                                }\n                            },\n                            usages: [\"encrypt\", \"decrypt\", \"wrapKey\", \"unwrapKey\"]\n                        };\n                        break;\n                    case \"importkey\":\n                        result = {\n                            algorithm: {\n                                name: \"RSA-OAEP\",\n                                hash: {\n                                    name: \"SHA-256\"\n                                }\n                            },\n                            usages: [\"encrypt\"]\n                        };\n                        break;\n                    case \"exportkey\":\n                    default:\n                        return {\n                            algorithm: {\n                                name: \"RSA-OAEP\"\n                            },\n                            usages: []\n                        };\n                }\n                break;\n            case \"ECDSA\":\n                switch (operation.toLowerCase()) {\n                    case \"generatekey\":\n                        result = {\n                            algorithm: {\n                                name: \"ECDSA\",\n                                namedCurve: \"P-256\"\n                            },\n                            usages: [\"sign\", \"verify\"]\n                        };\n                        break;\n                    case \"importkey\":\n                        result = {\n                            algorithm: {\n                                name: \"ECDSA\",\n                                namedCurve: \"P-256\"\n                            },\n                            usages: [\"verify\"]\n                        };\n                        break;\n                    case \"verify\":\n                    case \"sign\":\n                        result = {\n                            algorithm: {\n                                name: \"ECDSA\",\n                                hash: {\n                                    name: \"SHA-256\"\n                                }\n                            },\n                            usages: [\"sign\"]\n                        };\n                        break;\n                    default:\n                        return {\n                            algorithm: {\n                                name: \"ECDSA\"\n                            },\n                            usages: []\n                        };\n                }\n                break;\n            case \"ECDH\":\n                switch (operation.toLowerCase()) {\n                    case \"exportkey\":\n                    case \"importkey\":\n                    case \"generatekey\":\n                        result = {\n                            algorithm: {\n                                name: \"ECDH\",\n                                namedCurve: \"P-256\"\n                            },\n                            usages: [\"deriveKey\", \"deriveBits\"]\n                        };\n                        break;\n                    case \"derivekey\":\n                    case \"derivebits\":\n                        result = {\n                            algorithm: {\n                                name: \"ECDH\",\n                                namedCurve: \"P-256\",\n                                public: []\n                            },\n                            usages: [\"encrypt\", \"decrypt\"]\n                        };\n                        break;\n                    default:\n                        return {\n                            algorithm: {\n                                name: \"ECDH\"\n                            },\n                            usages: []\n                        };\n                }\n                break;\n            case \"AES-CTR\":\n                switch (operation.toLowerCase()) {\n                    case \"importkey\":\n                    case \"exportkey\":\n                    case \"generatekey\":\n                        result = {\n                            algorithm: {\n                                name: \"AES-CTR\",\n                                length: 256\n                            },\n                            usages: [\"encrypt\", \"decrypt\", \"wrapKey\", \"unwrapKey\"]\n                        };\n                        break;\n                    case \"decrypt\":\n                    case \"encrypt\":\n                        result = {\n                            algorithm: {\n                                name: \"AES-CTR\",\n                                counter: new Uint8Array(16),\n                                length: 10\n                            },\n                            usages: [\"encrypt\", \"decrypt\", \"wrapKey\", \"unwrapKey\"]\n                        };\n                        break;\n                    default:\n                        return {\n                            algorithm: {\n                                name: \"AES-CTR\"\n                            },\n                            usages: []\n                        };\n                }\n                break;\n            case \"AES-CBC\":\n                switch (operation.toLowerCase()) {\n                    case \"importkey\":\n                    case \"exportkey\":\n                    case \"generatekey\":\n                        result = {\n                            algorithm: {\n                                name: \"AES-CBC\",\n                                length: 256\n                            },\n                            usages: [\"encrypt\", \"decrypt\", \"wrapKey\", \"unwrapKey\"]\n                        };\n                        break;\n                    case \"decrypt\":\n                    case \"encrypt\":\n                        result = {\n                            algorithm: {\n                                name: \"AES-CBC\",\n                                iv: this.getRandomValues(new Uint8Array(16))\n                            },\n                            usages: [\"encrypt\", \"decrypt\", \"wrapKey\", \"unwrapKey\"]\n                        };\n                        break;\n                    default:\n                        return {\n                            algorithm: {\n                                name: \"AES-CBC\"\n                            },\n                            usages: []\n                        };\n                }\n                break;\n            case \"AES-GCM\":\n                switch (operation.toLowerCase()) {\n                    case \"importkey\":\n                    case \"exportkey\":\n                    case \"generatekey\":\n                        result = {\n                            algorithm: {\n                                name: \"AES-GCM\",\n                                length: 256\n                            },\n                            usages: [\"encrypt\", \"decrypt\", \"wrapKey\", \"unwrapKey\"]\n                        };\n                        break;\n                    case \"decrypt\":\n                    case \"encrypt\":\n                        result = {\n                            algorithm: {\n                                name: \"AES-GCM\",\n                                iv: this.getRandomValues(new Uint8Array(16))\n                            },\n                            usages: [\"encrypt\", \"decrypt\", \"wrapKey\", \"unwrapKey\"]\n                        };\n                        break;\n                    default:\n                        return {\n                            algorithm: {\n                                name: \"AES-GCM\"\n                            },\n                            usages: []\n                        };\n                }\n                break;\n            case \"AES-KW\":\n                switch (operation.toLowerCase()) {\n                    case \"importkey\":\n                    case \"exportkey\":\n                    case \"generatekey\":\n                    case \"wrapkey\":\n                    case \"unwrapkey\":\n                        result = {\n                            algorithm: {\n                                name: \"AES-KW\",\n                                length: 256\n                            },\n                            usages: [\"wrapKey\", \"unwrapKey\"]\n                        };\n                        break;\n                    default:\n                        return {\n                            algorithm: {\n                                name: \"AES-KW\"\n                            },\n                            usages: []\n                        };\n                }\n                break;\n            case \"HMAC\":\n                switch (operation.toLowerCase()) {\n                    case \"sign\":\n                    case \"verify\":\n                        result = {\n                            algorithm: {\n                                name: \"HMAC\"\n                            },\n                            usages: [\"sign\", \"verify\"]\n                        };\n                        break;\n                    case \"importkey\":\n                    case \"exportkey\":\n                    case \"generatekey\":\n                        result = {\n                            algorithm: {\n                                name: \"HMAC\",\n                                length: 32,\n                                hash: {\n                                    name: \"SHA-256\"\n                                }\n                            },\n                            usages: [\"sign\", \"verify\"]\n                        };\n                        break;\n                    default:\n                        return {\n                            algorithm: {\n                                name: \"HMAC\"\n                            },\n                            usages: []\n                        };\n                }\n                break;\n            case \"HKDF\":\n                switch (operation.toLowerCase()) {\n                    case \"derivekey\":\n                        result = {\n                            algorithm: {\n                                name: \"HKDF\",\n                                hash: \"SHA-256\",\n                                salt: new Uint8Array([]),\n                                info: new Uint8Array([])\n                            },\n                            usages: [\"encrypt\", \"decrypt\"]\n                        };\n                        break;\n                    default:\n                        return {\n                            algorithm: {\n                                name: \"HKDF\"\n                            },\n                            usages: []\n                        };\n                }\n                break;\n            case \"PBKDF2\":\n                switch (operation.toLowerCase()) {\n                    case \"derivekey\":\n                        result = {\n                            algorithm: {\n                                name: \"PBKDF2\",\n                                hash: { name: \"SHA-256\" },\n                                salt: new Uint8Array([]),\n                                iterations: 10000\n                            },\n                            usages: [\"encrypt\", \"decrypt\"]\n                        };\n                        break;\n                    default:\n                        return {\n                            algorithm: {\n                                name: \"PBKDF2\"\n                            },\n                            usages: []\n                        };\n                }\n                break;\n        }\n        return result;\n    }\n    getHashAlgorithm(signatureAlgorithm) {\n        let result = EMPTY_STRING;\n        switch (signatureAlgorithm.algorithmId) {\n            case \"1.2.840.10045.4.1\":\n            case \"1.2.840.113549.1.1.5\":\n                result = \"SHA-1\";\n                break;\n            case \"1.2.840.10045.4.3.2\":\n            case \"1.2.840.113549.1.1.11\":\n                result = \"SHA-256\";\n                break;\n            case \"1.2.840.10045.4.3.3\":\n            case \"1.2.840.113549.1.1.12\":\n                result = \"SHA-384\";\n                break;\n            case \"1.2.840.10045.4.3.4\":\n            case \"1.2.840.113549.1.1.13\":\n                result = \"SHA-512\";\n                break;\n            case \"1.2.840.113549.1.1.10\":\n                {\n                    try {\n                        const params = new RSASSAPSSParams({ schema: signatureAlgorithm.algorithmParams });\n                        if (params.hashAlgorithm) {\n                            const algorithm = this.getAlgorithmByOID(params.hashAlgorithm.algorithmId);\n                            if (\"name\" in algorithm) {\n                                result = algorithm.name;\n                            }\n                            else {\n                                return EMPTY_STRING;\n                            }\n                        }\n                        else\n                            result = \"SHA-1\";\n                    }\n                    catch {\n                    }\n                }\n                break;\n        }\n        return result;\n    }\n    async encryptEncryptedContentInfo(parameters) {\n        ParameterError.assert(parameters, \"password\", \"contentEncryptionAlgorithm\", \"hmacHashAlgorithm\", \"iterationCount\", \"contentToEncrypt\", \"contentToEncrypt\", \"contentType\");\n        const contentEncryptionOID = this.getOIDByAlgorithm(parameters.contentEncryptionAlgorithm, true, \"contentEncryptionAlgorithm\");\n        const pbkdf2OID = this.getOIDByAlgorithm({\n            name: \"PBKDF2\"\n        }, true, \"PBKDF2\");\n        const hmacOID = this.getOIDByAlgorithm({\n            name: \"HMAC\",\n            hash: {\n                name: parameters.hmacHashAlgorithm\n            }\n        }, true, \"hmacHashAlgorithm\");\n        const ivBuffer = new ArrayBuffer(16);\n        const ivView = new Uint8Array(ivBuffer);\n        this.getRandomValues(ivView);\n        const saltBuffer = new ArrayBuffer(64);\n        const saltView = new Uint8Array(saltBuffer);\n        this.getRandomValues(saltView);\n        const contentView = new Uint8Array(parameters.contentToEncrypt);\n        const pbkdf2Params = new PBKDF2Params({\n            salt: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: saltBuffer }),\n            iterationCount: parameters.iterationCount,\n            prf: new AlgorithmIdentifier({\n                algorithmId: hmacOID,\n                algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n            })\n        });\n        const passwordView = new Uint8Array(parameters.password);\n        const pbkdfKey = await this.importKey(\"raw\", passwordView, \"PBKDF2\", false, [\"deriveKey\"]);\n        const derivedKey = await this.deriveKey({\n            name: \"PBKDF2\",\n            hash: {\n                name: parameters.hmacHashAlgorithm\n            },\n            salt: saltView,\n            iterations: parameters.iterationCount\n        }, pbkdfKey, parameters.contentEncryptionAlgorithm, false, [\"encrypt\"]);\n        const encryptedData = await this.encrypt({\n            name: parameters.contentEncryptionAlgorithm.name,\n            iv: ivView\n        }, derivedKey, contentView);\n        const pbes2Parameters = new PBES2Params({\n            keyDerivationFunc: new AlgorithmIdentifier({\n                algorithmId: pbkdf2OID,\n                algorithmParams: pbkdf2Params.toSchema()\n            }),\n            encryptionScheme: new AlgorithmIdentifier({\n                algorithmId: contentEncryptionOID,\n                algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: ivBuffer })\n            })\n        });\n        return new EncryptedContentInfo({\n            contentType: parameters.contentType,\n            contentEncryptionAlgorithm: new AlgorithmIdentifier({\n                algorithmId: \"1.2.840.113549.1.5.13\",\n                algorithmParams: pbes2Parameters.toSchema()\n            }),\n            encryptedContent: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: encryptedData })\n        });\n    }\n    async decryptEncryptedContentInfo(parameters) {\n        ParameterError.assert(parameters, \"password\", \"encryptedContentInfo\");\n        if (parameters.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId !== \"1.2.840.113549.1.5.13\")\n            throw new Error(`Unknown \"contentEncryptionAlgorithm\": ${parameters.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId}`);\n        let pbes2Parameters;\n        try {\n            pbes2Parameters = new PBES2Params({ schema: parameters.encryptedContentInfo.contentEncryptionAlgorithm.algorithmParams });\n        }\n        catch {\n            throw new Error(\"Incorrectly encoded \\\"pbes2Parameters\\\"\");\n        }\n        let pbkdf2Params;\n        try {\n            pbkdf2Params = new PBKDF2Params({ schema: pbes2Parameters.keyDerivationFunc.algorithmParams });\n        }\n        catch {\n            throw new Error(\"Incorrectly encoded \\\"pbkdf2Params\\\"\");\n        }\n        const contentEncryptionAlgorithm = this.getAlgorithmByOID(pbes2Parameters.encryptionScheme.algorithmId, true);\n        const ivBuffer = pbes2Parameters.encryptionScheme.algorithmParams.valueBlock.valueHex;\n        const ivView = new Uint8Array(ivBuffer);\n        const saltBuffer = pbkdf2Params.salt.valueBlock.valueHex;\n        const saltView = new Uint8Array(saltBuffer);\n        const iterationCount = pbkdf2Params.iterationCount;\n        let hmacHashAlgorithm = \"SHA-1\";\n        if (pbkdf2Params.prf) {\n            const algorithm = this.getAlgorithmByOID(pbkdf2Params.prf.algorithmId, true);\n            hmacHashAlgorithm = algorithm.hash.name;\n        }\n        const pbkdfKey = await this.importKey(\"raw\", parameters.password, \"PBKDF2\", false, [\"deriveKey\"]);\n        const result = await this.deriveKey({\n            name: \"PBKDF2\",\n            hash: {\n                name: hmacHashAlgorithm\n            },\n            salt: saltView,\n            iterations: iterationCount\n        }, pbkdfKey, contentEncryptionAlgorithm, false, [\"decrypt\"]);\n        const dataBuffer = parameters.encryptedContentInfo.getEncryptedContent();\n        return this.decrypt({\n            name: contentEncryptionAlgorithm.name,\n            iv: ivView\n        }, result, dataBuffer);\n    }\n    async stampDataWithPassword(parameters) {\n        if ((parameters instanceof Object) === false)\n            throw new Error(\"Parameters must have type \\\"Object\\\"\");\n        ParameterError.assert(parameters, \"password\", \"hashAlgorithm\", \"iterationCount\", \"salt\", \"contentToStamp\");\n        let length;\n        switch (parameters.hashAlgorithm.toLowerCase()) {\n            case \"sha-1\":\n                length = 160;\n                break;\n            case \"sha-256\":\n                length = 256;\n                break;\n            case \"sha-384\":\n                length = 384;\n                break;\n            case \"sha-512\":\n                length = 512;\n                break;\n            default:\n                throw new Error(`Incorrect \"parameters.hashAlgorithm\" parameter: ${parameters.hashAlgorithm}`);\n        }\n        const hmacAlgorithm = {\n            name: \"HMAC\",\n            length,\n            hash: {\n                name: parameters.hashAlgorithm\n            }\n        };\n        const pkcsKey = await makePKCS12B2Key(parameters.hashAlgorithm, length, parameters.password, parameters.salt, parameters.iterationCount);\n        const hmacKey = await this.importKey(\"raw\", new Uint8Array(pkcsKey), hmacAlgorithm, false, [\"sign\"]);\n        return this.sign(hmacAlgorithm, hmacKey, new Uint8Array(parameters.contentToStamp));\n    }\n    async verifyDataStampedWithPassword(parameters) {\n        ParameterError.assert(parameters, \"password\", \"hashAlgorithm\", \"salt\", \"iterationCount\", \"contentToVerify\", \"signatureToVerify\");\n        let length = 0;\n        switch (parameters.hashAlgorithm.toLowerCase()) {\n            case \"sha-1\":\n                length = 160;\n                break;\n            case \"sha-256\":\n                length = 256;\n                break;\n            case \"sha-384\":\n                length = 384;\n                break;\n            case \"sha-512\":\n                length = 512;\n                break;\n            default:\n                throw new Error(`Incorrect \"parameters.hashAlgorithm\" parameter: ${parameters.hashAlgorithm}`);\n        }\n        const hmacAlgorithm = {\n            name: \"HMAC\",\n            length,\n            hash: {\n                name: parameters.hashAlgorithm\n            }\n        };\n        const pkcsKey = await makePKCS12B2Key(parameters.hashAlgorithm, length, parameters.password, parameters.salt, parameters.iterationCount);\n        const hmacKey = await this.importKey(\"raw\", new Uint8Array(pkcsKey), hmacAlgorithm, false, [\"verify\"]);\n        return this.verify(hmacAlgorithm, hmacKey, new Uint8Array(parameters.signatureToVerify), new Uint8Array(parameters.contentToVerify));\n    }\n    async getSignatureParameters(privateKey, hashAlgorithm = \"SHA-1\") {\n        this.getOIDByAlgorithm({ name: hashAlgorithm }, true, \"hashAlgorithm\");\n        const signatureAlgorithm = new AlgorithmIdentifier();\n        const parameters = this.getAlgorithmParameters(privateKey.algorithm.name, \"sign\");\n        if (!Object.keys(parameters.algorithm).length) {\n            throw new Error(\"Parameter 'algorithm' is empty\");\n        }\n        const algorithm = parameters.algorithm;\n        if (\"hash\" in privateKey.algorithm && privateKey.algorithm.hash && privateKey.algorithm.hash.name) {\n            algorithm.hash.name = privateKey.algorithm.hash.name;\n        }\n        else {\n            algorithm.hash.name = hashAlgorithm;\n        }\n        switch (privateKey.algorithm.name.toUpperCase()) {\n            case \"RSASSA-PKCS1-V1_5\":\n            case \"ECDSA\":\n                signatureAlgorithm.algorithmId = this.getOIDByAlgorithm(algorithm, true);\n                break;\n            case \"RSA-PSS\":\n                {\n                    switch (algorithm.hash.name.toUpperCase()) {\n                        case \"SHA-256\":\n                            algorithm.saltLength = 32;\n                            break;\n                        case \"SHA-384\":\n                            algorithm.saltLength = 48;\n                            break;\n                        case \"SHA-512\":\n                            algorithm.saltLength = 64;\n                            break;\n                    }\n                    const paramsObject = {};\n                    if (algorithm.hash.name.toUpperCase() !== \"SHA-1\") {\n                        const hashAlgorithmOID = this.getOIDByAlgorithm({ name: algorithm.hash.name }, true, \"hashAlgorithm\");\n                        paramsObject.hashAlgorithm = new AlgorithmIdentifier({\n                            algorithmId: hashAlgorithmOID,\n                            algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n                        });\n                        paramsObject.maskGenAlgorithm = new AlgorithmIdentifier({\n                            algorithmId: \"1.2.840.113549.1.1.8\",\n                            algorithmParams: paramsObject.hashAlgorithm.toSchema()\n                        });\n                    }\n                    if (algorithm.saltLength !== 20)\n                        paramsObject.saltLength = algorithm.saltLength;\n                    const pssParameters = new RSASSAPSSParams(paramsObject);\n                    signatureAlgorithm.algorithmId = \"1.2.840.113549.1.1.10\";\n                    signatureAlgorithm.algorithmParams = pssParameters.toSchema();\n                }\n                break;\n            default:\n                throw new Error(`Unsupported signature algorithm: ${privateKey.algorithm.name}`);\n        }\n        return {\n            signatureAlgorithm,\n            parameters\n        };\n    }\n    async signWithPrivateKey(data, privateKey, parameters) {\n        const signature = await this.sign(parameters.algorithm, privateKey, data);\n        if (parameters.algorithm.name === \"ECDSA\") {\n            return createCMSECDSASignature(signature);\n        }\n        return signature;\n    }\n    fillPublicKeyParameters(publicKeyInfo, signatureAlgorithm) {\n        const parameters = {};\n        const shaAlgorithm = this.getHashAlgorithm(signatureAlgorithm);\n        if (shaAlgorithm === EMPTY_STRING)\n            throw new Error(`Unsupported signature algorithm: ${signatureAlgorithm.algorithmId}`);\n        let algorithmId;\n        if (signatureAlgorithm.algorithmId === \"1.2.840.113549.1.1.10\")\n            algorithmId = signatureAlgorithm.algorithmId;\n        else\n            algorithmId = publicKeyInfo.algorithm.algorithmId;\n        const algorithmObject = this.getAlgorithmByOID(algorithmId, true);\n        parameters.algorithm = this.getAlgorithmParameters(algorithmObject.name, \"importKey\");\n        if (\"hash\" in parameters.algorithm.algorithm)\n            parameters.algorithm.algorithm.hash.name = shaAlgorithm;\n        if (algorithmObject.name === \"ECDSA\") {\n            const publicKeyAlgorithm = publicKeyInfo.algorithm;\n            if (!publicKeyAlgorithm.algorithmParams) {\n                throw new Error(\"Algorithm parameters for ECDSA public key are missed\");\n            }\n            const publicKeyAlgorithmParams = publicKeyAlgorithm.algorithmParams;\n            if (\"idBlock\" in publicKeyAlgorithm.algorithmParams) {\n                if (!((publicKeyAlgorithmParams.idBlock.tagClass === 1) && (publicKeyAlgorithmParams.idBlock.tagNumber === 6))) {\n                    throw new Error(\"Incorrect type for ECDSA public key parameters\");\n                }\n            }\n            const curveObject = this.getAlgorithmByOID(publicKeyAlgorithmParams.valueBlock.toString(), true);\n            parameters.algorithm.algorithm.namedCurve = curveObject.name;\n        }\n        return parameters;\n    }\n    async getPublicKey(publicKeyInfo, signatureAlgorithm, parameters) {\n        if (!parameters) {\n            parameters = this.fillPublicKeyParameters(publicKeyInfo, signatureAlgorithm);\n        }\n        const publicKeyInfoBuffer = publicKeyInfo.toSchema().toBER(false);\n        return this.importKey(\"spki\", publicKeyInfoBuffer, parameters.algorithm.algorithm, true, parameters.algorithm.usages);\n    }\n    async verifyWithPublicKey(data, signature, publicKeyInfo, signatureAlgorithm, shaAlgorithm) {\n        let publicKey;\n        if (!shaAlgorithm) {\n            shaAlgorithm = this.getHashAlgorithm(signatureAlgorithm);\n            if (!shaAlgorithm)\n                throw new Error(`Unsupported signature algorithm: ${signatureAlgorithm.algorithmId}`);\n            publicKey = await this.getPublicKey(publicKeyInfo, signatureAlgorithm);\n        }\n        else {\n            const parameters = {};\n            let algorithmId;\n            if (signatureAlgorithm.algorithmId === \"1.2.840.113549.1.1.10\")\n                algorithmId = signatureAlgorithm.algorithmId;\n            else\n                algorithmId = publicKeyInfo.algorithm.algorithmId;\n            const algorithmObject = this.getAlgorithmByOID(algorithmId, true);\n            parameters.algorithm = this.getAlgorithmParameters(algorithmObject.name, \"importKey\");\n            if (\"hash\" in parameters.algorithm.algorithm)\n                parameters.algorithm.algorithm.hash.name = shaAlgorithm;\n            if (algorithmObject.name === \"ECDSA\") {\n                let algorithmParamsChecked = false;\n                if ((\"algorithmParams\" in publicKeyInfo.algorithm) === true) {\n                    if (\"idBlock\" in publicKeyInfo.algorithm.algorithmParams) {\n                        if ((publicKeyInfo.algorithm.algorithmParams.idBlock.tagClass === 1) && (publicKeyInfo.algorithm.algorithmParams.idBlock.tagNumber === 6))\n                            algorithmParamsChecked = true;\n                    }\n                }\n                if (algorithmParamsChecked === false) {\n                    throw new Error(\"Incorrect type for ECDSA public key parameters\");\n                }\n                const curveObject = this.getAlgorithmByOID(publicKeyInfo.algorithm.algorithmParams.valueBlock.toString(), true);\n                parameters.algorithm.algorithm.namedCurve = curveObject.name;\n            }\n            publicKey = await this.getPublicKey(publicKeyInfo, null, parameters);\n        }\n        const algorithm = this.getAlgorithmParameters(publicKey.algorithm.name, \"verify\");\n        if (\"hash\" in algorithm.algorithm)\n            algorithm.algorithm.hash.name = shaAlgorithm;\n        let signatureValue = signature.valueBlock.valueHexView;\n        if (publicKey.algorithm.name === \"ECDSA\") {\n            const namedCurve = ECNamedCurves.find(publicKey.algorithm.namedCurve);\n            if (!namedCurve) {\n                throw new Error(\"Unsupported named curve in use\");\n            }\n            const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(signatureValue);\n            AsnError.assert(asn1, \"Signature value\");\n            signatureValue = createECDSASignatureFromCMS(asn1.result, namedCurve.size);\n        }\n        if (publicKey.algorithm.name === \"RSA-PSS\") {\n            const pssParameters = new RSASSAPSSParams({ schema: signatureAlgorithm.algorithmParams });\n            if (\"saltLength\" in pssParameters)\n                algorithm.algorithm.saltLength = pssParameters.saltLength;\n            else\n                algorithm.algorithm.saltLength = 20;\n            let hashAlgo = \"SHA-1\";\n            if (\"hashAlgorithm\" in pssParameters) {\n                const hashAlgorithm = this.getAlgorithmByOID(pssParameters.hashAlgorithm.algorithmId, true);\n                hashAlgo = hashAlgorithm.name;\n            }\n            algorithm.algorithm.hash.name = hashAlgo;\n        }\n        return this.verify(algorithm.algorithm, publicKey, signatureValue, data);\n    }\n}\n\nlet engine = {\n    name: \"none\",\n    crypto: null,\n};\nfunction isCryptoEngine(engine) {\n    return engine\n        && typeof engine === \"object\"\n        && \"crypto\" in engine\n        ? true\n        : false;\n}\nfunction setEngine(name, ...args) {\n    let crypto = null;\n    if (args.length < 2) {\n        if (args.length) {\n            crypto = args[0];\n        }\n        else {\n            crypto = typeof self !== \"undefined\" && self.crypto ? new CryptoEngine({ name: \"browser\", crypto: self.crypto }) : null;\n        }\n    }\n    else {\n        const cryptoArg = args[0];\n        const subtleArg = args[1];\n        if (isCryptoEngine(subtleArg)) {\n            crypto = subtleArg;\n        }\n        else if (isCryptoEngine(cryptoArg)) {\n            crypto = cryptoArg;\n        }\n        else if (\"subtle\" in cryptoArg && \"getRandomValues\" in cryptoArg) {\n            crypto = new CryptoEngine({\n                crypto: cryptoArg,\n            });\n        }\n    }\n    if ((typeof process !== \"undefined\") && (\"pid\" in process) && (typeof global !== \"undefined\") && (typeof window === \"undefined\")) {\n        if (typeof global[process.pid] === \"undefined\") {\n            global[process.pid] = {};\n        }\n        else {\n            if (typeof global[process.pid] !== \"object\") {\n                throw new Error(`Name global.${process.pid} already exists and it is not an object`);\n            }\n        }\n        if (typeof global[process.pid].pkijs === \"undefined\") {\n            global[process.pid].pkijs = {};\n        }\n        else {\n            if (typeof global[process.pid].pkijs !== \"object\") {\n                throw new Error(`Name global.${process.pid}.pkijs already exists and it is not an object`);\n            }\n        }\n        global[process.pid].pkijs.engine = {\n            name: name,\n            crypto,\n        };\n    }\n    else {\n        engine = {\n            name: name,\n            crypto,\n        };\n    }\n}\nfunction getEngine() {\n    if ((typeof process !== \"undefined\") && (\"pid\" in process) && (typeof global !== \"undefined\") && (typeof window === \"undefined\")) {\n        let _engine;\n        try {\n            _engine = global[process.pid].pkijs.engine;\n        }\n        catch {\n            throw new Error(\"Please call 'setEngine' before call to 'getEngine'\");\n        }\n        return _engine;\n    }\n    return engine;\n}\nfunction getCrypto(safety = false) {\n    const _engine = getEngine();\n    if (!_engine.crypto && safety) {\n        throw new Error(\"Unable to create WebCrypto object\");\n    }\n    return _engine.crypto;\n}\nfunction getRandomValues(view) {\n    return getCrypto(true).getRandomValues(view);\n}\nfunction getOIDByAlgorithm(algorithm, safety, target) {\n    return getCrypto(true).getOIDByAlgorithm(algorithm, safety, target);\n}\nfunction getAlgorithmParameters(algorithmName, operation) {\n    return getCrypto(true).getAlgorithmParameters(algorithmName, operation);\n}\nfunction createCMSECDSASignature(signatureBuffer) {\n    if ((signatureBuffer.byteLength % 2) !== 0)\n        return EMPTY_BUFFER;\n    const length = signatureBuffer.byteLength / 2;\n    const rBuffer = new ArrayBuffer(length);\n    const rView = new Uint8Array(rBuffer);\n    rView.set(new Uint8Array(signatureBuffer, 0, length));\n    const rInteger = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: rBuffer });\n    const sBuffer = new ArrayBuffer(length);\n    const sView = new Uint8Array(sBuffer);\n    sView.set(new Uint8Array(signatureBuffer, length, length));\n    const sInteger = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: sBuffer });\n    return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n        value: [\n            rInteger.convertToDER(),\n            sInteger.convertToDER()\n        ]\n    })).toBER(false);\n}\nfunction createECDSASignatureFromCMS(cmsSignature, pointSize) {\n    if (!(cmsSignature instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence\n        && cmsSignature.valueBlock.value.length === 2\n        && cmsSignature.valueBlock.value[0] instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer\n        && cmsSignature.valueBlock.value[1] instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer))\n        return EMPTY_BUFFER;\n    const rValueView = cmsSignature.valueBlock.value[0].convertFromDER().valueBlock.valueHexView;\n    const sValueView = cmsSignature.valueBlock.value[1].convertFromDER().valueBlock.valueHexView;\n    const res = new Uint8Array(pointSize * 2);\n    res.set(rValueView, pointSize - rValueView.byteLength);\n    res.set(sValueView, (2 * pointSize) - sValueView.byteLength);\n    return res.buffer;\n}\nfunction getAlgorithmByOID(oid, safety = false, target) {\n    return getCrypto(true).getAlgorithmByOID(oid, safety, target);\n}\nfunction getHashAlgorithm(signatureAlgorithm) {\n    return getCrypto(true).getHashAlgorithm(signatureAlgorithm);\n}\nasync function kdfWithCounter(hashFunction, zBuffer, Counter, SharedInfo, crypto) {\n    switch (hashFunction.toUpperCase()) {\n        case \"SHA-1\":\n        case \"SHA-256\":\n        case \"SHA-384\":\n        case \"SHA-512\":\n            break;\n        default:\n            throw new ArgumentError(`Unknown hash function: ${hashFunction}`);\n    }\n    ArgumentError.assert(zBuffer, \"zBuffer\", \"ArrayBuffer\");\n    if (zBuffer.byteLength === 0)\n        throw new ArgumentError(\"'zBuffer' has zero length, error\");\n    ArgumentError.assert(SharedInfo, \"SharedInfo\", \"ArrayBuffer\");\n    if (Counter > 255)\n        throw new ArgumentError(\"Please set 'Counter' argument to value less or equal to 255\");\n    const counterBuffer = new ArrayBuffer(4);\n    const counterView = new Uint8Array(counterBuffer);\n    counterView[0] = 0x00;\n    counterView[1] = 0x00;\n    counterView[2] = 0x00;\n    counterView[3] = Counter;\n    let combinedBuffer = EMPTY_BUFFER;\n    combinedBuffer = pvutils__WEBPACK_IMPORTED_MODULE_2__.utilConcatBuf(combinedBuffer, zBuffer);\n    combinedBuffer = pvutils__WEBPACK_IMPORTED_MODULE_2__.utilConcatBuf(combinedBuffer, counterBuffer);\n    combinedBuffer = pvutils__WEBPACK_IMPORTED_MODULE_2__.utilConcatBuf(combinedBuffer, SharedInfo);\n    const result = await crypto.digest({ name: hashFunction }, combinedBuffer);\n    return {\n        counter: Counter,\n        result\n    };\n}\nasync function kdf(hashFunction, Zbuffer, keydatalen, SharedInfo, crypto = getCrypto(true)) {\n    let hashLength = 0;\n    let maxCounter = 1;\n    switch (hashFunction.toUpperCase()) {\n        case \"SHA-1\":\n            hashLength = 160;\n            break;\n        case \"SHA-256\":\n            hashLength = 256;\n            break;\n        case \"SHA-384\":\n            hashLength = 384;\n            break;\n        case \"SHA-512\":\n            hashLength = 512;\n            break;\n        default:\n            throw new ArgumentError(`Unknown hash function: ${hashFunction}`);\n    }\n    ArgumentError.assert(Zbuffer, \"Zbuffer\", \"ArrayBuffer\");\n    if (Zbuffer.byteLength === 0)\n        throw new ArgumentError(\"'Zbuffer' has zero length, error\");\n    ArgumentError.assert(SharedInfo, \"SharedInfo\", \"ArrayBuffer\");\n    const quotient = keydatalen / hashLength;\n    if (Math.floor(quotient) > 0) {\n        maxCounter = Math.floor(quotient);\n        if ((quotient - maxCounter) > 0)\n            maxCounter++;\n    }\n    const incomingResult = [];\n    for (let i = 1; i <= maxCounter; i++)\n        incomingResult.push(await kdfWithCounter(hashFunction, Zbuffer, i, SharedInfo, crypto));\n    let combinedBuffer = EMPTY_BUFFER;\n    let currentCounter = 1;\n    let found = true;\n    while (found) {\n        found = false;\n        for (const result of incomingResult) {\n            if (result.counter === currentCounter) {\n                combinedBuffer = pvutils__WEBPACK_IMPORTED_MODULE_2__.utilConcatBuf(combinedBuffer, result.result);\n                found = true;\n                break;\n            }\n        }\n        currentCounter++;\n    }\n    keydatalen >>= 3;\n    if (combinedBuffer.byteLength > keydatalen) {\n        const newBuffer = new ArrayBuffer(keydatalen);\n        const newView = new Uint8Array(newBuffer);\n        const combinedView = new Uint8Array(combinedBuffer);\n        for (let i = 0; i < keydatalen; i++)\n            newView[i] = combinedView[i];\n        return newBuffer;\n    }\n    return combinedBuffer;\n}\n\nconst VERSION$i = \"version\";\nconst LOG_ID = \"logID\";\nconst EXTENSIONS$6 = \"extensions\";\nconst TIMESTAMP = \"timestamp\";\nconst HASH_ALGORITHM$3 = \"hashAlgorithm\";\nconst SIGNATURE_ALGORITHM$8 = \"signatureAlgorithm\";\nconst SIGNATURE$7 = \"signature\";\nconst NONE = \"none\";\nconst MD5 = \"md5\";\nconst SHA1 = \"sha1\";\nconst SHA224 = \"sha224\";\nconst SHA256 = \"sha256\";\nconst SHA384 = \"sha384\";\nconst SHA512 = \"sha512\";\nconst ANONYMOUS = \"anonymous\";\nconst RSA = \"rsa\";\nconst DSA = \"dsa\";\nconst ECDSA = \"ecdsa\";\nclass SignedCertificateTimestamp extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$i, SignedCertificateTimestamp.defaultValues(VERSION$i));\n        this.logID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, LOG_ID, SignedCertificateTimestamp.defaultValues(LOG_ID));\n        this.timestamp = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TIMESTAMP, SignedCertificateTimestamp.defaultValues(TIMESTAMP));\n        this.extensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, EXTENSIONS$6, SignedCertificateTimestamp.defaultValues(EXTENSIONS$6));\n        this.hashAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, HASH_ALGORITHM$3, SignedCertificateTimestamp.defaultValues(HASH_ALGORITHM$3));\n        this.signatureAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_ALGORITHM$8, SignedCertificateTimestamp.defaultValues(SIGNATURE_ALGORITHM$8));\n        this.signature = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE$7, SignedCertificateTimestamp.defaultValues(SIGNATURE$7));\n        if (\"stream\" in parameters && parameters.stream) {\n            this.fromStream(parameters.stream);\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$i:\n                return 0;\n            case LOG_ID:\n            case EXTENSIONS$6:\n                return EMPTY_BUFFER;\n            case TIMESTAMP:\n                return new Date(0);\n            case HASH_ALGORITHM$3:\n            case SIGNATURE_ALGORITHM$8:\n                return EMPTY_STRING;\n            case SIGNATURE$7:\n                return EMPTY_BUFFER;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    fromSchema(schema) {\n        if ((schema instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.RawData) === false)\n            throw new Error(\"Object's schema was not verified against input data for SignedCertificateTimestamp\");\n        const seqStream = new bytestreamjs__WEBPACK_IMPORTED_MODULE_3__.SeqStream({\n            stream: new bytestreamjs__WEBPACK_IMPORTED_MODULE_3__.ByteStream({\n                buffer: schema.data\n            })\n        });\n        this.fromStream(seqStream);\n    }\n    fromStream(stream) {\n        const blockLength = stream.getUint16();\n        this.version = (stream.getBlock(1))[0];\n        if (this.version === 0) {\n            this.logID = (new Uint8Array(stream.getBlock(32))).buffer.slice(0);\n            this.timestamp = new Date(pvutils__WEBPACK_IMPORTED_MODULE_2__.utilFromBase(new Uint8Array(stream.getBlock(8)), 8));\n            const extensionsLength = stream.getUint16();\n            this.extensions = (new Uint8Array(stream.getBlock(extensionsLength))).buffer.slice(0);\n            switch ((stream.getBlock(1))[0]) {\n                case 0:\n                    this.hashAlgorithm = NONE;\n                    break;\n                case 1:\n                    this.hashAlgorithm = MD5;\n                    break;\n                case 2:\n                    this.hashAlgorithm = SHA1;\n                    break;\n                case 3:\n                    this.hashAlgorithm = SHA224;\n                    break;\n                case 4:\n                    this.hashAlgorithm = SHA256;\n                    break;\n                case 5:\n                    this.hashAlgorithm = SHA384;\n                    break;\n                case 6:\n                    this.hashAlgorithm = SHA512;\n                    break;\n                default:\n                    throw new Error(\"Object's stream was not correct for SignedCertificateTimestamp\");\n            }\n            switch ((stream.getBlock(1))[0]) {\n                case 0:\n                    this.signatureAlgorithm = ANONYMOUS;\n                    break;\n                case 1:\n                    this.signatureAlgorithm = RSA;\n                    break;\n                case 2:\n                    this.signatureAlgorithm = DSA;\n                    break;\n                case 3:\n                    this.signatureAlgorithm = ECDSA;\n                    break;\n                default:\n                    throw new Error(\"Object's stream was not correct for SignedCertificateTimestamp\");\n            }\n            const signatureLength = stream.getUint16();\n            this.signature = new Uint8Array(stream.getBlock(signatureLength)).buffer.slice(0);\n            if (blockLength !== (47 + extensionsLength + signatureLength)) {\n                throw new Error(\"Object's stream was not correct for SignedCertificateTimestamp\");\n            }\n        }\n    }\n    toSchema() {\n        const stream = this.toStream();\n        return new asn1js__WEBPACK_IMPORTED_MODULE_0__.RawData({ data: stream.stream.buffer });\n    }\n    toStream() {\n        const stream = new bytestreamjs__WEBPACK_IMPORTED_MODULE_3__.SeqStream();\n        stream.appendUint16(47 + this.extensions.byteLength + this.signature.byteLength);\n        stream.appendChar(this.version);\n        stream.appendView(new Uint8Array(this.logID));\n        const timeBuffer = new ArrayBuffer(8);\n        const timeView = new Uint8Array(timeBuffer);\n        const baseArray = pvutils__WEBPACK_IMPORTED_MODULE_2__.utilToBase(this.timestamp.valueOf(), 8);\n        timeView.set(new Uint8Array(baseArray), 8 - baseArray.byteLength);\n        stream.appendView(timeView);\n        stream.appendUint16(this.extensions.byteLength);\n        if (this.extensions.byteLength)\n            stream.appendView(new Uint8Array(this.extensions));\n        let _hashAlgorithm;\n        switch (this.hashAlgorithm.toLowerCase()) {\n            case NONE:\n                _hashAlgorithm = 0;\n                break;\n            case MD5:\n                _hashAlgorithm = 1;\n                break;\n            case SHA1:\n                _hashAlgorithm = 2;\n                break;\n            case SHA224:\n                _hashAlgorithm = 3;\n                break;\n            case SHA256:\n                _hashAlgorithm = 4;\n                break;\n            case SHA384:\n                _hashAlgorithm = 5;\n                break;\n            case SHA512:\n                _hashAlgorithm = 6;\n                break;\n            default:\n                throw new Error(`Incorrect data for hashAlgorithm: ${this.hashAlgorithm}`);\n        }\n        stream.appendChar(_hashAlgorithm);\n        let _signatureAlgorithm;\n        switch (this.signatureAlgorithm.toLowerCase()) {\n            case ANONYMOUS:\n                _signatureAlgorithm = 0;\n                break;\n            case RSA:\n                _signatureAlgorithm = 1;\n                break;\n            case DSA:\n                _signatureAlgorithm = 2;\n                break;\n            case ECDSA:\n                _signatureAlgorithm = 3;\n                break;\n            default:\n                throw new Error(`Incorrect data for signatureAlgorithm: ${this.signatureAlgorithm}`);\n        }\n        stream.appendChar(_signatureAlgorithm);\n        stream.appendUint16(this.signature.byteLength);\n        stream.appendView(new Uint8Array(this.signature));\n        return stream;\n    }\n    toJSON() {\n        return {\n            version: this.version,\n            logID: pvutils__WEBPACK_IMPORTED_MODULE_2__.bufferToHexCodes(this.logID),\n            timestamp: this.timestamp,\n            extensions: pvutils__WEBPACK_IMPORTED_MODULE_2__.bufferToHexCodes(this.extensions),\n            hashAlgorithm: this.hashAlgorithm,\n            signatureAlgorithm: this.signatureAlgorithm,\n            signature: pvutils__WEBPACK_IMPORTED_MODULE_2__.bufferToHexCodes(this.signature),\n        };\n    }\n    async verify(logs, data, dataType = 0, crypto = getCrypto(true)) {\n        const logId = pvutils__WEBPACK_IMPORTED_MODULE_2__.toBase64(pvutils__WEBPACK_IMPORTED_MODULE_2__.arrayBufferToString(this.logID));\n        let publicKeyBase64 = null;\n        const stream = new bytestreamjs__WEBPACK_IMPORTED_MODULE_3__.SeqStream();\n        for (const log of logs) {\n            if (log.log_id === logId) {\n                publicKeyBase64 = log.key;\n                break;\n            }\n        }\n        if (!publicKeyBase64) {\n            throw new Error(`Public key not found for CT with logId: ${logId}`);\n        }\n        const pki = pvutils__WEBPACK_IMPORTED_MODULE_2__.stringToArrayBuffer(pvutils__WEBPACK_IMPORTED_MODULE_2__.fromBase64(publicKeyBase64));\n        const publicKeyInfo = PublicKeyInfo.fromBER(pki);\n        stream.appendChar(0x00);\n        stream.appendChar(0x00);\n        const timeBuffer = new ArrayBuffer(8);\n        const timeView = new Uint8Array(timeBuffer);\n        const baseArray = pvutils__WEBPACK_IMPORTED_MODULE_2__.utilToBase(this.timestamp.valueOf(), 8);\n        timeView.set(new Uint8Array(baseArray), 8 - baseArray.byteLength);\n        stream.appendView(timeView);\n        stream.appendUint16(dataType);\n        if (dataType === 0)\n            stream.appendUint24(data.byteLength);\n        stream.appendView(new Uint8Array(data));\n        stream.appendUint16(this.extensions.byteLength);\n        if (this.extensions.byteLength !== 0)\n            stream.appendView(new Uint8Array(this.extensions));\n        return crypto.verifyWithPublicKey(stream.buffer.slice(0, stream.length), new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: this.signature }), publicKeyInfo, { algorithmId: EMPTY_STRING }, \"SHA-256\");\n    }\n}\nSignedCertificateTimestamp.CLASS_NAME = \"SignedCertificateTimestamp\";\nasync function verifySCTsForCertificate(certificate, issuerCertificate, logs, index = (-1), crypto = getCrypto(true)) {\n    let parsedValue = null;\n    const stream = new bytestreamjs__WEBPACK_IMPORTED_MODULE_3__.SeqStream();\n    if (certificate.extensions) {\n        for (let i = certificate.extensions.length - 1; i >= 0; i--) {\n            switch (certificate.extensions[i].extnID) {\n                case id_SignedCertificateTimestampList:\n                    {\n                        parsedValue = certificate.extensions[i].parsedValue;\n                        if (!parsedValue || parsedValue.timestamps.length === 0)\n                            throw new Error(\"Nothing to verify in the certificate\");\n                        certificate.extensions.splice(i, 1);\n                    }\n                    break;\n            }\n        }\n    }\n    if (parsedValue === null)\n        throw new Error(\"No SignedCertificateTimestampList extension in the specified certificate\");\n    const tbs = certificate.encodeTBS().toBER();\n    const issuerId = await crypto.digest({ name: \"SHA-256\" }, new Uint8Array(issuerCertificate.subjectPublicKeyInfo.toSchema().toBER(false)));\n    stream.appendView(new Uint8Array(issuerId));\n    stream.appendUint24(tbs.byteLength);\n    stream.appendView(new Uint8Array(tbs));\n    const preCert = stream.stream.slice(0, stream.length);\n    if (index === (-1)) {\n        const verifyArray = [];\n        for (const timestamp of parsedValue.timestamps) {\n            const verifyResult = await timestamp.verify(logs, preCert.buffer, 1, crypto);\n            verifyArray.push(verifyResult);\n        }\n        return verifyArray;\n    }\n    if (index >= parsedValue.timestamps.length)\n        index = (parsedValue.timestamps.length - 1);\n    return [await parsedValue.timestamps[index].verify(logs, preCert.buffer, 1, crypto)];\n}\n\nconst TIMESTAMPS = \"timestamps\";\nclass SignedCertificateTimestampList extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.timestamps = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TIMESTAMPS, SignedCertificateTimestampList.defaultValues(TIMESTAMPS));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TIMESTAMPS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case TIMESTAMPS:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        var _a;\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        (_a = names.optional) !== null && _a !== void 0 ? _a : (names.optional = false);\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({\n            name: (names.blockName || \"SignedCertificateTimestampList\"),\n            optional: names.optional\n        }));\n    }\n    fromSchema(schema) {\n        if ((schema instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString) === false) {\n            throw new Error(\"Object's schema was not verified against input data for SignedCertificateTimestampList\");\n        }\n        const seqStream = new bytestreamjs__WEBPACK_IMPORTED_MODULE_3__.SeqStream({\n            stream: new bytestreamjs__WEBPACK_IMPORTED_MODULE_3__.ByteStream({\n                buffer: schema.valueBlock.valueHex\n            })\n        });\n        const dataLength = seqStream.getUint16();\n        if (dataLength !== seqStream.length) {\n            throw new Error(\"Object's schema was not verified against input data for SignedCertificateTimestampList\");\n        }\n        while (seqStream.length) {\n            this.timestamps.push(new SignedCertificateTimestamp({ stream: seqStream }));\n        }\n    }\n    toSchema() {\n        const stream = new bytestreamjs__WEBPACK_IMPORTED_MODULE_3__.SeqStream();\n        let overallLength = 0;\n        const timestampsData = [];\n        for (const timestamp of this.timestamps) {\n            const timestampStream = timestamp.toStream();\n            timestampsData.push(timestampStream);\n            overallLength += timestampStream.stream.buffer.byteLength;\n        }\n        stream.appendUint16(overallLength);\n        for (const timestamp of timestampsData) {\n            stream.appendView(timestamp.stream.view);\n        }\n        return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: stream.stream.buffer.slice(0) });\n    }\n    toJSON() {\n        return {\n            timestamps: Array.from(this.timestamps, o => o.toJSON())\n        };\n    }\n}\nSignedCertificateTimestampList.CLASS_NAME = \"SignedCertificateTimestampList\";\n\nconst ATTRIBUTES$4 = \"attributes\";\nconst CLEAR_PROPS$11 = [\n    ATTRIBUTES$4\n];\nclass SubjectDirectoryAttributes extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.attributes = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ATTRIBUTES$4, SubjectDirectoryAttributes.defaultValues(ATTRIBUTES$4));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ATTRIBUTES$4:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.attributes || EMPTY_STRING),\n                    value: Attribute.schema()\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$11);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, SubjectDirectoryAttributes.schema({\n            names: {\n                attributes: ATTRIBUTES$4\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.attributes = Array.from(asn1.result.attributes, element => new Attribute({ schema: element }));\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.attributes, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        return {\n            attributes: Array.from(this.attributes, o => o.toJSON())\n        };\n    }\n}\nSubjectDirectoryAttributes.CLASS_NAME = \"SubjectDirectoryAttributes\";\n\nclass ExtensionValueFactory {\n    static getItems() {\n        if (!this.types) {\n            this.types = {};\n            ExtensionValueFactory.register(id_SubjectAltName, \"SubjectAltName\", AltName);\n            ExtensionValueFactory.register(id_IssuerAltName, \"IssuerAltName\", AltName);\n            ExtensionValueFactory.register(id_AuthorityKeyIdentifier, \"AuthorityKeyIdentifier\", AuthorityKeyIdentifier);\n            ExtensionValueFactory.register(id_BasicConstraints, \"BasicConstraints\", BasicConstraints);\n            ExtensionValueFactory.register(id_MicrosoftCaVersion, \"MicrosoftCaVersion\", CAVersion);\n            ExtensionValueFactory.register(id_CertificatePolicies, \"CertificatePolicies\", CertificatePolicies);\n            ExtensionValueFactory.register(id_MicrosoftAppPolicies, \"CertificatePoliciesMicrosoft\", CertificatePolicies);\n            ExtensionValueFactory.register(id_MicrosoftCertTemplateV2, \"MicrosoftCertTemplateV2\", CertificateTemplate);\n            ExtensionValueFactory.register(id_CRLDistributionPoints, \"CRLDistributionPoints\", CRLDistributionPoints);\n            ExtensionValueFactory.register(id_FreshestCRL, \"FreshestCRL\", CRLDistributionPoints);\n            ExtensionValueFactory.register(id_ExtKeyUsage, \"ExtKeyUsage\", ExtKeyUsage);\n            ExtensionValueFactory.register(id_CertificateIssuer, \"CertificateIssuer\", GeneralNames);\n            ExtensionValueFactory.register(id_AuthorityInfoAccess, \"AuthorityInfoAccess\", InfoAccess);\n            ExtensionValueFactory.register(id_SubjectInfoAccess, \"SubjectInfoAccess\", InfoAccess);\n            ExtensionValueFactory.register(id_IssuingDistributionPoint, \"IssuingDistributionPoint\", IssuingDistributionPoint);\n            ExtensionValueFactory.register(id_NameConstraints, \"NameConstraints\", NameConstraints);\n            ExtensionValueFactory.register(id_PolicyConstraints, \"PolicyConstraints\", PolicyConstraints);\n            ExtensionValueFactory.register(id_PolicyMappings, \"PolicyMappings\", PolicyMappings);\n            ExtensionValueFactory.register(id_PrivateKeyUsagePeriod, \"PrivateKeyUsagePeriod\", PrivateKeyUsagePeriod);\n            ExtensionValueFactory.register(id_QCStatements, \"QCStatements\", QCStatements);\n            ExtensionValueFactory.register(id_SignedCertificateTimestampList, \"SignedCertificateTimestampList\", SignedCertificateTimestampList);\n            ExtensionValueFactory.register(id_SubjectDirectoryAttributes, \"SubjectDirectoryAttributes\", SubjectDirectoryAttributes);\n        }\n        return this.types;\n    }\n    static fromBER(id, raw) {\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(raw);\n        if (asn1.offset === -1) {\n            return null;\n        }\n        const item = this.find(id);\n        if (item) {\n            try {\n                return new item.type({ schema: asn1.result });\n            }\n            catch {\n                const res = new item.type();\n                res.parsingError = `Incorrectly formatted value of extension ${item.name} (${id})`;\n                return res;\n            }\n        }\n        return asn1.result;\n    }\n    static find(id) {\n        const types = this.getItems();\n        return types[id] || null;\n    }\n    static register(id, name, type) {\n        this.getItems()[id] = { name, type };\n    }\n}\n\nconst EXTN_ID = \"extnID\";\nconst CRITICAL = \"critical\";\nconst EXTN_VALUE = \"extnValue\";\nconst PARSED_VALUE$5 = \"parsedValue\";\nconst CLEAR_PROPS$10 = [\n    EXTN_ID,\n    CRITICAL,\n    EXTN_VALUE\n];\nclass Extension extends PkiObject {\n    get parsedValue() {\n        if (this._parsedValue === undefined) {\n            const parsedValue = ExtensionValueFactory.fromBER(this.extnID, this.extnValue.valueBlock.valueHexView);\n            this._parsedValue = parsedValue;\n        }\n        return this._parsedValue || undefined;\n    }\n    set parsedValue(value) {\n        this._parsedValue = value;\n    }\n    constructor(parameters = {}) {\n        super();\n        this.extnID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, EXTN_ID, Extension.defaultValues(EXTN_ID));\n        this.critical = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CRITICAL, Extension.defaultValues(CRITICAL));\n        if (EXTN_VALUE in parameters) {\n            this.extnValue = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: parameters.extnValue });\n        }\n        else {\n            this.extnValue = Extension.defaultValues(EXTN_VALUE);\n        }\n        if (PARSED_VALUE$5 in parameters) {\n            this.parsedValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PARSED_VALUE$5, Extension.defaultValues(PARSED_VALUE$5));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case EXTN_ID:\n                return EMPTY_STRING;\n            case CRITICAL:\n                return false;\n            case EXTN_VALUE:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case PARSED_VALUE$5:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.extnID || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Boolean({\n                    name: (names.critical || EMPTY_STRING),\n                    optional: true\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.extnValue || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$10);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, Extension.schema({\n            names: {\n                extnID: EXTN_ID,\n                critical: CRITICAL,\n                extnValue: EXTN_VALUE\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.extnID = asn1.result.extnID.valueBlock.toString();\n        if (CRITICAL in asn1.result) {\n            this.critical = asn1.result.critical.valueBlock.value;\n        }\n        this.extnValue = asn1.result.extnValue;\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.extnID }));\n        if (this.critical !== Extension.defaultValues(CRITICAL)) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Boolean({ value: this.critical }));\n        }\n        outputArray.push(this.extnValue);\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const object = {\n            extnID: this.extnID,\n            extnValue: this.extnValue.toJSON(),\n        };\n        if (this.critical !== Extension.defaultValues(CRITICAL)) {\n            object.critical = this.critical;\n        }\n        if (this.parsedValue && this.parsedValue.toJSON) {\n            object.parsedValue = this.parsedValue.toJSON();\n        }\n        return object;\n    }\n}\nExtension.CLASS_NAME = \"Extension\";\n\nconst EXTENSIONS$5 = \"extensions\";\nconst CLEAR_PROPS$$ = [\n    EXTENSIONS$5,\n];\nclass Extensions extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.extensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, EXTENSIONS$5, Extensions.defaultValues(EXTENSIONS$5));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case EXTENSIONS$5:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}, optional = false) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            optional,\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.extensions || EMPTY_STRING),\n                    value: Extension.schema(names.extension || {})\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$$);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, Extensions.schema({\n            names: {\n                extensions: EXTENSIONS$5\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.extensions = Array.from(asn1.result.extensions, element => new Extension({ schema: element }));\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.extensions, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        return {\n            extensions: this.extensions.map(o => o.toJSON())\n        };\n    }\n}\nExtensions.CLASS_NAME = \"Extensions\";\n\nconst ISSUER$5 = \"issuer\";\nconst SERIAL_NUMBER$6 = \"serialNumber\";\nconst ISSUER_UID = \"issuerUID\";\nconst CLEAR_PROPS$_ = [\n    ISSUER$5,\n    SERIAL_NUMBER$6,\n    ISSUER_UID,\n];\nclass IssuerSerial extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.issuer = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER$5, IssuerSerial.defaultValues(ISSUER$5));\n        this.serialNumber = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SERIAL_NUMBER$6, IssuerSerial.defaultValues(SERIAL_NUMBER$6));\n        if (ISSUER_UID in parameters) {\n            this.issuerUID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER_UID, IssuerSerial.defaultValues(ISSUER_UID));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ISSUER$5:\n                return new GeneralNames();\n            case SERIAL_NUMBER$6:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case ISSUER_UID:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                GeneralNames.schema(names.issuer || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.serialNumber || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({\n                    optional: true,\n                    name: (names.issuerUID || EMPTY_STRING)\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$_);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, IssuerSerial.schema({\n            names: {\n                issuer: {\n                    names: {\n                        blockName: ISSUER$5\n                    }\n                },\n                serialNumber: SERIAL_NUMBER$6,\n                issuerUID: ISSUER_UID\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.issuer = new GeneralNames({ schema: asn1.result.issuer });\n        this.serialNumber = asn1.result.serialNumber;\n        if (ISSUER_UID in asn1.result)\n            this.issuerUID = asn1.result.issuerUID;\n    }\n    toSchema() {\n        const result = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.issuer.toSchema(),\n                this.serialNumber\n            ]\n        });\n        if (this.issuerUID) {\n            result.valueBlock.value.push(this.issuerUID);\n        }\n        return result;\n    }\n    toJSON() {\n        const result = {\n            issuer: this.issuer.toJSON(),\n            serialNumber: this.serialNumber.toJSON()\n        };\n        if (this.issuerUID) {\n            result.issuerUID = this.issuerUID.toJSON();\n        }\n        return result;\n    }\n}\nIssuerSerial.CLASS_NAME = \"IssuerSerial\";\n\nconst VERSION$h = \"version\";\nconst BASE_CERTIFICATE_ID$2 = \"baseCertificateID\";\nconst SUBJECT_NAME = \"subjectName\";\nconst ISSUER$4 = \"issuer\";\nconst SIGNATURE$6 = \"signature\";\nconst SERIAL_NUMBER$5 = \"serialNumber\";\nconst ATTR_CERT_VALIDITY_PERIOD$1 = \"attrCertValidityPeriod\";\nconst ATTRIBUTES$3 = \"attributes\";\nconst ISSUER_UNIQUE_ID$2 = \"issuerUniqueID\";\nconst EXTENSIONS$4 = \"extensions\";\nconst CLEAR_PROPS$Z = [\n    VERSION$h,\n    BASE_CERTIFICATE_ID$2,\n    SUBJECT_NAME,\n    ISSUER$4,\n    SIGNATURE$6,\n    SERIAL_NUMBER$5,\n    ATTR_CERT_VALIDITY_PERIOD$1,\n    ATTRIBUTES$3,\n    ISSUER_UNIQUE_ID$2,\n    EXTENSIONS$4,\n];\nclass AttributeCertificateInfoV1 extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$h, AttributeCertificateInfoV1.defaultValues(VERSION$h));\n        if (BASE_CERTIFICATE_ID$2 in parameters) {\n            this.baseCertificateID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, BASE_CERTIFICATE_ID$2, AttributeCertificateInfoV1.defaultValues(BASE_CERTIFICATE_ID$2));\n        }\n        if (SUBJECT_NAME in parameters) {\n            this.subjectName = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SUBJECT_NAME, AttributeCertificateInfoV1.defaultValues(SUBJECT_NAME));\n        }\n        this.issuer = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER$4, AttributeCertificateInfoV1.defaultValues(ISSUER$4));\n        this.signature = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE$6, AttributeCertificateInfoV1.defaultValues(SIGNATURE$6));\n        this.serialNumber = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SERIAL_NUMBER$5, AttributeCertificateInfoV1.defaultValues(SERIAL_NUMBER$5));\n        this.attrCertValidityPeriod = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ATTR_CERT_VALIDITY_PERIOD$1, AttributeCertificateInfoV1.defaultValues(ATTR_CERT_VALIDITY_PERIOD$1));\n        this.attributes = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ATTRIBUTES$3, AttributeCertificateInfoV1.defaultValues(ATTRIBUTES$3));\n        if (ISSUER_UNIQUE_ID$2 in parameters)\n            this.issuerUniqueID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER_UNIQUE_ID$2, AttributeCertificateInfoV1.defaultValues(ISSUER_UNIQUE_ID$2));\n        if (EXTENSIONS$4 in parameters) {\n            this.extensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, EXTENSIONS$4, AttributeCertificateInfoV1.defaultValues(EXTENSIONS$4));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$h:\n                return 0;\n            case BASE_CERTIFICATE_ID$2:\n                return new IssuerSerial();\n            case SUBJECT_NAME:\n                return new GeneralNames();\n            case ISSUER$4:\n                return new GeneralNames();\n            case SIGNATURE$6:\n                return new AlgorithmIdentifier();\n            case SERIAL_NUMBER$5:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case ATTR_CERT_VALIDITY_PERIOD$1:\n                return new AttCertValidityPeriod();\n            case ATTRIBUTES$3:\n                return [];\n            case ISSUER_UNIQUE_ID$2:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            case EXTENSIONS$4:\n                return new Extensions();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            name: (names.baseCertificateID || EMPTY_STRING),\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 0\n                            },\n                            value: IssuerSerial.schema().valueBlock.value\n                        }),\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            name: (names.subjectName || EMPTY_STRING),\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 1\n                            },\n                            value: GeneralNames.schema().valueBlock.value\n                        }),\n                    ]\n                }),\n                GeneralNames.schema({\n                    names: {\n                        blockName: (names.issuer || EMPTY_STRING)\n                    }\n                }),\n                AlgorithmIdentifier.schema(names.signature || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.serialNumber || EMPTY_STRING) }),\n                AttCertValidityPeriod.schema(names.attrCertValidityPeriod || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    name: (names.attributes || EMPTY_STRING),\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            value: Attribute.schema()\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({\n                    optional: true,\n                    name: (names.issuerUniqueID || EMPTY_STRING)\n                }),\n                Extensions.schema(names.extensions || {}, true)\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$Z);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, AttributeCertificateInfoV1.schema({\n            names: {\n                version: VERSION$h,\n                baseCertificateID: BASE_CERTIFICATE_ID$2,\n                subjectName: SUBJECT_NAME,\n                issuer: ISSUER$4,\n                signature: {\n                    names: {\n                        blockName: SIGNATURE$6\n                    }\n                },\n                serialNumber: SERIAL_NUMBER$5,\n                attrCertValidityPeriod: {\n                    names: {\n                        blockName: ATTR_CERT_VALIDITY_PERIOD$1\n                    }\n                },\n                attributes: ATTRIBUTES$3,\n                issuerUniqueID: ISSUER_UNIQUE_ID$2,\n                extensions: {\n                    names: {\n                        blockName: EXTENSIONS$4\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result.version.valueBlock.valueDec;\n        if (BASE_CERTIFICATE_ID$2 in asn1.result) {\n            this.baseCertificateID = new IssuerSerial({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    value: asn1.result.baseCertificateID.valueBlock.value\n                })\n            });\n        }\n        if (SUBJECT_NAME in asn1.result) {\n            this.subjectName = new GeneralNames({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    value: asn1.result.subjectName.valueBlock.value\n                })\n            });\n        }\n        this.issuer = asn1.result.issuer;\n        this.signature = new AlgorithmIdentifier({ schema: asn1.result.signature });\n        this.serialNumber = asn1.result.serialNumber;\n        this.attrCertValidityPeriod = new AttCertValidityPeriod({ schema: asn1.result.attrCertValidityPeriod });\n        this.attributes = Array.from(asn1.result.attributes.valueBlock.value, element => new Attribute({ schema: element }));\n        if (ISSUER_UNIQUE_ID$2 in asn1.result) {\n            this.issuerUniqueID = asn1.result.issuerUniqueID;\n        }\n        if (EXTENSIONS$4 in asn1.result) {\n            this.extensions = new Extensions({ schema: asn1.result.extensions });\n        }\n    }\n    toSchema() {\n        const result = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version })]\n        });\n        if (this.baseCertificateID) {\n            result.valueBlock.value.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: this.baseCertificateID.toSchema().valueBlock.value\n            }));\n        }\n        if (this.subjectName) {\n            result.valueBlock.value.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: this.subjectName.toSchema().valueBlock.value\n            }));\n        }\n        result.valueBlock.value.push(this.issuer.toSchema());\n        result.valueBlock.value.push(this.signature.toSchema());\n        result.valueBlock.value.push(this.serialNumber);\n        result.valueBlock.value.push(this.attrCertValidityPeriod.toSchema());\n        result.valueBlock.value.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.attributes, o => o.toSchema())\n        }));\n        if (this.issuerUniqueID) {\n            result.valueBlock.value.push(this.issuerUniqueID);\n        }\n        if (this.extensions) {\n            result.valueBlock.value.push(this.extensions.toSchema());\n        }\n        return result;\n    }\n    toJSON() {\n        const result = {\n            version: this.version\n        };\n        if (this.baseCertificateID) {\n            result.baseCertificateID = this.baseCertificateID.toJSON();\n        }\n        if (this.subjectName) {\n            result.subjectName = this.subjectName.toJSON();\n        }\n        result.issuer = this.issuer.toJSON();\n        result.signature = this.signature.toJSON();\n        result.serialNumber = this.serialNumber.toJSON();\n        result.attrCertValidityPeriod = this.attrCertValidityPeriod.toJSON();\n        result.attributes = Array.from(this.attributes, o => o.toJSON());\n        if (this.issuerUniqueID) {\n            result.issuerUniqueID = this.issuerUniqueID.toJSON();\n        }\n        if (this.extensions) {\n            result.extensions = this.extensions.toJSON();\n        }\n        return result;\n    }\n}\nAttributeCertificateInfoV1.CLASS_NAME = \"AttributeCertificateInfoV1\";\n\nconst ACINFO$1 = \"acinfo\";\nconst SIGNATURE_ALGORITHM$7 = \"signatureAlgorithm\";\nconst SIGNATURE_VALUE$4 = \"signatureValue\";\nconst CLEAR_PROPS$Y = [\n    ACINFO$1,\n    SIGNATURE_VALUE$4,\n    SIGNATURE_ALGORITHM$7\n];\nclass AttributeCertificateV1 extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.acinfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ACINFO$1, AttributeCertificateV1.defaultValues(ACINFO$1));\n        this.signatureAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_ALGORITHM$7, AttributeCertificateV1.defaultValues(SIGNATURE_ALGORITHM$7));\n        this.signatureValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_VALUE$4, AttributeCertificateV1.defaultValues(SIGNATURE_VALUE$4));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ACINFO$1:\n                return new AttributeCertificateInfoV1();\n            case SIGNATURE_ALGORITHM$7:\n                return new AlgorithmIdentifier();\n            case SIGNATURE_VALUE$4:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                AttributeCertificateInfoV1.schema(names.acinfo || {}),\n                AlgorithmIdentifier.schema(names.signatureAlgorithm || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ name: (names.signatureValue || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$Y);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, AttributeCertificateV1.schema({\n            names: {\n                acinfo: {\n                    names: {\n                        blockName: ACINFO$1\n                    }\n                },\n                signatureAlgorithm: {\n                    names: {\n                        blockName: SIGNATURE_ALGORITHM$7\n                    }\n                },\n                signatureValue: SIGNATURE_VALUE$4\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.acinfo = new AttributeCertificateInfoV1({ schema: asn1.result.acinfo });\n        this.signatureAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.signatureAlgorithm });\n        this.signatureValue = asn1.result.signatureValue;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.acinfo.toSchema(),\n                this.signatureAlgorithm.toSchema(),\n                this.signatureValue\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            acinfo: this.acinfo.toJSON(),\n            signatureAlgorithm: this.signatureAlgorithm.toJSON(),\n            signatureValue: this.signatureValue.toJSON(),\n        };\n    }\n}\nAttributeCertificateV1.CLASS_NAME = \"AttributeCertificateV1\";\n\nconst DIGESTED_OBJECT_TYPE = \"digestedObjectType\";\nconst OTHER_OBJECT_TYPE_ID = \"otherObjectTypeID\";\nconst DIGEST_ALGORITHM$2 = \"digestAlgorithm\";\nconst OBJECT_DIGEST = \"objectDigest\";\nconst CLEAR_PROPS$X = [\n    DIGESTED_OBJECT_TYPE,\n    OTHER_OBJECT_TYPE_ID,\n    DIGEST_ALGORITHM$2,\n    OBJECT_DIGEST,\n];\nclass ObjectDigestInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.digestedObjectType = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, DIGESTED_OBJECT_TYPE, ObjectDigestInfo.defaultValues(DIGESTED_OBJECT_TYPE));\n        if (OTHER_OBJECT_TYPE_ID in parameters) {\n            this.otherObjectTypeID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OTHER_OBJECT_TYPE_ID, ObjectDigestInfo.defaultValues(OTHER_OBJECT_TYPE_ID));\n        }\n        this.digestAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, DIGEST_ALGORITHM$2, ObjectDigestInfo.defaultValues(DIGEST_ALGORITHM$2));\n        this.objectDigest = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OBJECT_DIGEST, ObjectDigestInfo.defaultValues(OBJECT_DIGEST));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case DIGESTED_OBJECT_TYPE:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Enumerated();\n            case OTHER_OBJECT_TYPE_ID:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier();\n            case DIGEST_ALGORITHM$2:\n                return new AlgorithmIdentifier();\n            case OBJECT_DIGEST:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Enumerated({ name: (names.digestedObjectType || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({\n                    optional: true,\n                    name: (names.otherObjectTypeID || EMPTY_STRING)\n                }),\n                AlgorithmIdentifier.schema(names.digestAlgorithm || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ name: (names.objectDigest || EMPTY_STRING) }),\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$X);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, ObjectDigestInfo.schema({\n            names: {\n                digestedObjectType: DIGESTED_OBJECT_TYPE,\n                otherObjectTypeID: OTHER_OBJECT_TYPE_ID,\n                digestAlgorithm: {\n                    names: {\n                        blockName: DIGEST_ALGORITHM$2\n                    }\n                },\n                objectDigest: OBJECT_DIGEST\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.digestedObjectType = asn1.result.digestedObjectType;\n        if (OTHER_OBJECT_TYPE_ID in asn1.result) {\n            this.otherObjectTypeID = asn1.result.otherObjectTypeID;\n        }\n        this.digestAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.digestAlgorithm });\n        this.objectDigest = asn1.result.objectDigest;\n    }\n    toSchema() {\n        const result = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [this.digestedObjectType]\n        });\n        if (this.otherObjectTypeID) {\n            result.valueBlock.value.push(this.otherObjectTypeID);\n        }\n        result.valueBlock.value.push(this.digestAlgorithm.toSchema());\n        result.valueBlock.value.push(this.objectDigest);\n        return result;\n    }\n    toJSON() {\n        const result = {\n            digestedObjectType: this.digestedObjectType.toJSON(),\n            digestAlgorithm: this.digestAlgorithm.toJSON(),\n            objectDigest: this.objectDigest.toJSON(),\n        };\n        if (this.otherObjectTypeID) {\n            result.otherObjectTypeID = this.otherObjectTypeID.toJSON();\n        }\n        return result;\n    }\n}\nObjectDigestInfo.CLASS_NAME = \"ObjectDigestInfo\";\n\nconst ISSUER_NAME = \"issuerName\";\nconst BASE_CERTIFICATE_ID$1 = \"baseCertificateID\";\nconst OBJECT_DIGEST_INFO$1 = \"objectDigestInfo\";\nconst CLEAR_PROPS$W = [\n    ISSUER_NAME,\n    BASE_CERTIFICATE_ID$1,\n    OBJECT_DIGEST_INFO$1\n];\nclass V2Form extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        if (ISSUER_NAME in parameters) {\n            this.issuerName = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER_NAME, V2Form.defaultValues(ISSUER_NAME));\n        }\n        if (BASE_CERTIFICATE_ID$1 in parameters) {\n            this.baseCertificateID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, BASE_CERTIFICATE_ID$1, V2Form.defaultValues(BASE_CERTIFICATE_ID$1));\n        }\n        if (OBJECT_DIGEST_INFO$1 in parameters) {\n            this.objectDigestInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OBJECT_DIGEST_INFO$1, V2Form.defaultValues(OBJECT_DIGEST_INFO$1));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ISSUER_NAME:\n                return new GeneralNames();\n            case BASE_CERTIFICATE_ID$1:\n                return new IssuerSerial();\n            case OBJECT_DIGEST_INFO$1:\n                return new ObjectDigestInfo();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                GeneralNames.schema({\n                    names: {\n                        blockName: names.issuerName\n                    }\n                }, true),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    name: (names.baseCertificateID || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: IssuerSerial.schema().valueBlock.value\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    name: (names.objectDigestInfo || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: ObjectDigestInfo.schema().valueBlock.value\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$W);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, V2Form.schema({\n            names: {\n                issuerName: ISSUER_NAME,\n                baseCertificateID: BASE_CERTIFICATE_ID$1,\n                objectDigestInfo: OBJECT_DIGEST_INFO$1\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (ISSUER_NAME in asn1.result)\n            this.issuerName = new GeneralNames({ schema: asn1.result.issuerName });\n        if (BASE_CERTIFICATE_ID$1 in asn1.result) {\n            this.baseCertificateID = new IssuerSerial({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    value: asn1.result.baseCertificateID.valueBlock.value\n                })\n            });\n        }\n        if (OBJECT_DIGEST_INFO$1 in asn1.result) {\n            this.objectDigestInfo = new ObjectDigestInfo({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    value: asn1.result.objectDigestInfo.valueBlock.value\n                })\n            });\n        }\n    }\n    toSchema() {\n        const result = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence();\n        if (this.issuerName)\n            result.valueBlock.value.push(this.issuerName.toSchema());\n        if (this.baseCertificateID) {\n            result.valueBlock.value.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: this.baseCertificateID.toSchema().valueBlock.value\n            }));\n        }\n        if (this.objectDigestInfo) {\n            result.valueBlock.value.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: this.objectDigestInfo.toSchema().valueBlock.value\n            }));\n        }\n        return result;\n    }\n    toJSON() {\n        const result = {};\n        if (this.issuerName) {\n            result.issuerName = this.issuerName.toJSON();\n        }\n        if (this.baseCertificateID) {\n            result.baseCertificateID = this.baseCertificateID.toJSON();\n        }\n        if (this.objectDigestInfo) {\n            result.objectDigestInfo = this.objectDigestInfo.toJSON();\n        }\n        return result;\n    }\n}\nV2Form.CLASS_NAME = \"V2Form\";\n\nconst BASE_CERTIFICATE_ID = \"baseCertificateID\";\nconst ENTITY_NAME = \"entityName\";\nconst OBJECT_DIGEST_INFO = \"objectDigestInfo\";\nconst CLEAR_PROPS$V = [\n    BASE_CERTIFICATE_ID,\n    ENTITY_NAME,\n    OBJECT_DIGEST_INFO\n];\nclass Holder extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        if (BASE_CERTIFICATE_ID in parameters) {\n            this.baseCertificateID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, BASE_CERTIFICATE_ID, Holder.defaultValues(BASE_CERTIFICATE_ID));\n        }\n        if (ENTITY_NAME in parameters) {\n            this.entityName = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENTITY_NAME, Holder.defaultValues(ENTITY_NAME));\n        }\n        if (OBJECT_DIGEST_INFO in parameters) {\n            this.objectDigestInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OBJECT_DIGEST_INFO, Holder.defaultValues(OBJECT_DIGEST_INFO));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case BASE_CERTIFICATE_ID:\n                return new IssuerSerial();\n            case ENTITY_NAME:\n                return new GeneralNames();\n            case OBJECT_DIGEST_INFO:\n                return new ObjectDigestInfo();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    name: (names.baseCertificateID || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: IssuerSerial.schema().valueBlock.value\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    name: (names.entityName || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: GeneralNames.schema().valueBlock.value\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    name: (names.objectDigestInfo || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 2\n                    },\n                    value: ObjectDigestInfo.schema().valueBlock.value\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$V);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, Holder.schema({\n            names: {\n                baseCertificateID: BASE_CERTIFICATE_ID,\n                entityName: ENTITY_NAME,\n                objectDigestInfo: OBJECT_DIGEST_INFO\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (BASE_CERTIFICATE_ID in asn1.result) {\n            this.baseCertificateID = new IssuerSerial({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    value: asn1.result.baseCertificateID.valueBlock.value\n                })\n            });\n        }\n        if (ENTITY_NAME in asn1.result) {\n            this.entityName = new GeneralNames({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    value: asn1.result.entityName.valueBlock.value\n                })\n            });\n        }\n        if (OBJECT_DIGEST_INFO in asn1.result) {\n            this.objectDigestInfo = new ObjectDigestInfo({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    value: asn1.result.objectDigestInfo.valueBlock.value\n                })\n            });\n        }\n    }\n    toSchema() {\n        const result = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence();\n        if (this.baseCertificateID) {\n            result.valueBlock.value.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: this.baseCertificateID.toSchema().valueBlock.value\n            }));\n        }\n        if (this.entityName) {\n            result.valueBlock.value.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: this.entityName.toSchema().valueBlock.value\n            }));\n        }\n        if (this.objectDigestInfo) {\n            result.valueBlock.value.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 2\n                },\n                value: this.objectDigestInfo.toSchema().valueBlock.value\n            }));\n        }\n        return result;\n    }\n    toJSON() {\n        const result = {};\n        if (this.baseCertificateID) {\n            result.baseCertificateID = this.baseCertificateID.toJSON();\n        }\n        if (this.entityName) {\n            result.entityName = this.entityName.toJSON();\n        }\n        if (this.objectDigestInfo) {\n            result.objectDigestInfo = this.objectDigestInfo.toJSON();\n        }\n        return result;\n    }\n}\nHolder.CLASS_NAME = \"Holder\";\n\nconst VERSION$g = \"version\";\nconst HOLDER = \"holder\";\nconst ISSUER$3 = \"issuer\";\nconst SIGNATURE$5 = \"signature\";\nconst SERIAL_NUMBER$4 = \"serialNumber\";\nconst ATTR_CERT_VALIDITY_PERIOD = \"attrCertValidityPeriod\";\nconst ATTRIBUTES$2 = \"attributes\";\nconst ISSUER_UNIQUE_ID$1 = \"issuerUniqueID\";\nconst EXTENSIONS$3 = \"extensions\";\nconst CLEAR_PROPS$U = [\n    VERSION$g,\n    HOLDER,\n    ISSUER$3,\n    SIGNATURE$5,\n    SERIAL_NUMBER$4,\n    ATTR_CERT_VALIDITY_PERIOD,\n    ATTRIBUTES$2,\n    ISSUER_UNIQUE_ID$1,\n    EXTENSIONS$3\n];\nclass AttributeCertificateInfoV2 extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$g, AttributeCertificateInfoV2.defaultValues(VERSION$g));\n        this.holder = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, HOLDER, AttributeCertificateInfoV2.defaultValues(HOLDER));\n        this.issuer = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER$3, AttributeCertificateInfoV2.defaultValues(ISSUER$3));\n        this.signature = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE$5, AttributeCertificateInfoV2.defaultValues(SIGNATURE$5));\n        this.serialNumber = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SERIAL_NUMBER$4, AttributeCertificateInfoV2.defaultValues(SERIAL_NUMBER$4));\n        this.attrCertValidityPeriod = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ATTR_CERT_VALIDITY_PERIOD, AttributeCertificateInfoV2.defaultValues(ATTR_CERT_VALIDITY_PERIOD));\n        this.attributes = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ATTRIBUTES$2, AttributeCertificateInfoV2.defaultValues(ATTRIBUTES$2));\n        if (ISSUER_UNIQUE_ID$1 in parameters) {\n            this.issuerUniqueID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER_UNIQUE_ID$1, AttributeCertificateInfoV2.defaultValues(ISSUER_UNIQUE_ID$1));\n        }\n        if (EXTENSIONS$3 in parameters) {\n            this.extensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, EXTENSIONS$3, AttributeCertificateInfoV2.defaultValues(EXTENSIONS$3));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$g:\n                return 1;\n            case HOLDER:\n                return new Holder();\n            case ISSUER$3:\n                return {};\n            case SIGNATURE$5:\n                return new AlgorithmIdentifier();\n            case SERIAL_NUMBER$4:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case ATTR_CERT_VALIDITY_PERIOD:\n                return new AttCertValidityPeriod();\n            case ATTRIBUTES$2:\n                return [];\n            case ISSUER_UNIQUE_ID$1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            case EXTENSIONS$3:\n                return new Extensions();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || EMPTY_STRING) }),\n                Holder.schema(names.holder || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                    value: [\n                        GeneralNames.schema({\n                            names: {\n                                blockName: (names.issuer || EMPTY_STRING)\n                            }\n                        }),\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            name: (names.issuer || EMPTY_STRING),\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 0\n                            },\n                            value: V2Form.schema().valueBlock.value\n                        })\n                    ]\n                }),\n                AlgorithmIdentifier.schema(names.signature || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.serialNumber || EMPTY_STRING) }),\n                AttCertValidityPeriod.schema(names.attrCertValidityPeriod || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    name: (names.attributes || EMPTY_STRING),\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            value: Attribute.schema()\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({\n                    optional: true,\n                    name: (names.issuerUniqueID || EMPTY_STRING)\n                }),\n                Extensions.schema(names.extensions || {}, true)\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$U);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, AttributeCertificateInfoV2.schema({\n            names: {\n                version: VERSION$g,\n                holder: {\n                    names: {\n                        blockName: HOLDER\n                    }\n                },\n                issuer: ISSUER$3,\n                signature: {\n                    names: {\n                        blockName: SIGNATURE$5\n                    }\n                },\n                serialNumber: SERIAL_NUMBER$4,\n                attrCertValidityPeriod: {\n                    names: {\n                        blockName: ATTR_CERT_VALIDITY_PERIOD\n                    }\n                },\n                attributes: ATTRIBUTES$2,\n                issuerUniqueID: ISSUER_UNIQUE_ID$1,\n                extensions: {\n                    names: {\n                        blockName: EXTENSIONS$3\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result.version.valueBlock.valueDec;\n        this.holder = new Holder({ schema: asn1.result.holder });\n        switch (asn1.result.issuer.idBlock.tagClass) {\n            case 3:\n                this.issuer = new V2Form({\n                    schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                        value: asn1.result.issuer.valueBlock.value\n                    })\n                });\n                break;\n            case 1:\n            default:\n                throw new Error(\"Incorrect value for 'issuer' in AttributeCertificateInfoV2\");\n        }\n        this.signature = new AlgorithmIdentifier({ schema: asn1.result.signature });\n        this.serialNumber = asn1.result.serialNumber;\n        this.attrCertValidityPeriod = new AttCertValidityPeriod({ schema: asn1.result.attrCertValidityPeriod });\n        this.attributes = Array.from(asn1.result.attributes.valueBlock.value, element => new Attribute({ schema: element }));\n        if (ISSUER_UNIQUE_ID$1 in asn1.result) {\n            this.issuerUniqueID = asn1.result.issuerUniqueID;\n        }\n        if (EXTENSIONS$3 in asn1.result) {\n            this.extensions = new Extensions({ schema: asn1.result.extensions });\n        }\n    }\n    toSchema() {\n        const result = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }),\n                this.holder.toSchema(),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: this.issuer.toSchema().valueBlock.value\n                }),\n                this.signature.toSchema(),\n                this.serialNumber,\n                this.attrCertValidityPeriod.toSchema(),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    value: Array.from(this.attributes, o => o.toSchema())\n                })\n            ]\n        });\n        if (this.issuerUniqueID) {\n            result.valueBlock.value.push(this.issuerUniqueID);\n        }\n        if (this.extensions) {\n            result.valueBlock.value.push(this.extensions.toSchema());\n        }\n        return result;\n    }\n    toJSON() {\n        const result = {\n            version: this.version,\n            holder: this.holder.toJSON(),\n            issuer: this.issuer.toJSON(),\n            signature: this.signature.toJSON(),\n            serialNumber: this.serialNumber.toJSON(),\n            attrCertValidityPeriod: this.attrCertValidityPeriod.toJSON(),\n            attributes: Array.from(this.attributes, o => o.toJSON())\n        };\n        if (this.issuerUniqueID) {\n            result.issuerUniqueID = this.issuerUniqueID.toJSON();\n        }\n        if (this.extensions) {\n            result.extensions = this.extensions.toJSON();\n        }\n        return result;\n    }\n}\nAttributeCertificateInfoV2.CLASS_NAME = \"AttributeCertificateInfoV2\";\n\nconst ACINFO = \"acinfo\";\nconst SIGNATURE_ALGORITHM$6 = \"signatureAlgorithm\";\nconst SIGNATURE_VALUE$3 = \"signatureValue\";\nconst CLEAR_PROPS$T = [\n    ACINFO,\n    SIGNATURE_ALGORITHM$6,\n    SIGNATURE_VALUE$3,\n];\nclass AttributeCertificateV2 extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.acinfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ACINFO, AttributeCertificateV2.defaultValues(ACINFO));\n        this.signatureAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_ALGORITHM$6, AttributeCertificateV2.defaultValues(SIGNATURE_ALGORITHM$6));\n        this.signatureValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_VALUE$3, AttributeCertificateV2.defaultValues(SIGNATURE_VALUE$3));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ACINFO:\n                return new AttributeCertificateInfoV2();\n            case SIGNATURE_ALGORITHM$6:\n                return new AlgorithmIdentifier();\n            case SIGNATURE_VALUE$3:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                AttributeCertificateInfoV2.schema(names.acinfo || {}),\n                AlgorithmIdentifier.schema(names.signatureAlgorithm || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ name: (names.signatureValue || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$T);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, AttributeCertificateV2.schema({\n            names: {\n                acinfo: {\n                    names: {\n                        blockName: ACINFO\n                    }\n                },\n                signatureAlgorithm: {\n                    names: {\n                        blockName: SIGNATURE_ALGORITHM$6\n                    }\n                },\n                signatureValue: SIGNATURE_VALUE$3\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.acinfo = new AttributeCertificateInfoV2({ schema: asn1.result.acinfo });\n        this.signatureAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.signatureAlgorithm });\n        this.signatureValue = asn1.result.signatureValue;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.acinfo.toSchema(),\n                this.signatureAlgorithm.toSchema(),\n                this.signatureValue\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            acinfo: this.acinfo.toJSON(),\n            signatureAlgorithm: this.signatureAlgorithm.toJSON(),\n            signatureValue: this.signatureValue.toJSON(),\n        };\n    }\n}\nAttributeCertificateV2.CLASS_NAME = \"AttributeCertificateV2\";\n\nconst CONTENT_TYPE = \"contentType\";\nconst CONTENT = \"content\";\nconst CLEAR_PROPS$S = [CONTENT_TYPE, CONTENT];\nclass ContentInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.contentType = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CONTENT_TYPE, ContentInfo.defaultValues(CONTENT_TYPE));\n        this.content = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CONTENT, ContentInfo.defaultValues(CONTENT));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case CONTENT_TYPE:\n                return EMPTY_STRING;\n            case CONTENT:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case CONTENT_TYPE:\n                return (typeof memberValue === \"string\" &&\n                    memberValue === this.defaultValues(CONTENT_TYPE));\n            case CONTENT:\n                return (memberValue instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        if ((\"optional\" in names) === false) {\n            names.optional = false;\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || \"ContentInfo\"),\n            optional: names.optional,\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.contentType || CONTENT_TYPE) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ name: (names.content || CONTENT) })]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$S);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, ContentInfo.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.contentType = asn1.result.contentType.valueBlock.toString();\n        this.content = asn1.result.content;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.contentType }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [this.content]\n                })\n            ]\n        }));\n    }\n    toJSON() {\n        const object = {\n            contentType: this.contentType\n        };\n        if (!(this.content instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any)) {\n            object.content = this.content.toJSON();\n        }\n        return object;\n    }\n}\nContentInfo.CLASS_NAME = \"ContentInfo\";\nContentInfo.DATA = id_ContentType_Data;\nContentInfo.SIGNED_DATA = id_ContentType_SignedData;\nContentInfo.ENVELOPED_DATA = id_ContentType_EnvelopedData;\nContentInfo.ENCRYPTED_DATA = id_ContentType_EncryptedData;\n\nconst TYPE$1 = \"type\";\nconst VALUE$4 = \"value\";\nconst UTC_TIME_NAME = \"utcTimeName\";\nconst GENERAL_TIME_NAME = \"generalTimeName\";\nconst CLEAR_PROPS$R = [UTC_TIME_NAME, GENERAL_TIME_NAME];\nvar TimeType;\n(function (TimeType) {\n    TimeType[TimeType[\"UTCTime\"] = 0] = \"UTCTime\";\n    TimeType[TimeType[\"GeneralizedTime\"] = 1] = \"GeneralizedTime\";\n    TimeType[TimeType[\"empty\"] = 2] = \"empty\";\n})(TimeType || (TimeType = {}));\nclass Time extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.type = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TYPE$1, Time.defaultValues(TYPE$1));\n        this.value = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VALUE$4, Time.defaultValues(VALUE$4));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TYPE$1:\n                return 0;\n            case VALUE$4:\n                return new Date(0, 0, 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}, optional = false) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n            optional,\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.UTCTime({ name: (names.utcTimeName || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ name: (names.generalTimeName || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$R);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, Time.schema({\n            names: {\n                utcTimeName: UTC_TIME_NAME,\n                generalTimeName: GENERAL_TIME_NAME\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (UTC_TIME_NAME in asn1.result) {\n            this.type = 0;\n            this.value = asn1.result.utcTimeName.toDate();\n        }\n        if (GENERAL_TIME_NAME in asn1.result) {\n            this.type = 1;\n            this.value = asn1.result.generalTimeName.toDate();\n        }\n    }\n    toSchema() {\n        if (this.type === 0) {\n            return new asn1js__WEBPACK_IMPORTED_MODULE_0__.UTCTime({ valueDate: this.value });\n        }\n        else if (this.type === 1) {\n            return new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ valueDate: this.value });\n        }\n        return {};\n    }\n    toJSON() {\n        return {\n            type: this.type,\n            value: this.value\n        };\n    }\n}\nTime.CLASS_NAME = \"Time\";\n\nconst TBS$4 = \"tbs\";\nconst VERSION$f = \"version\";\nconst SERIAL_NUMBER$3 = \"serialNumber\";\nconst SIGNATURE$4 = \"signature\";\nconst ISSUER$2 = \"issuer\";\nconst NOT_BEFORE = \"notBefore\";\nconst NOT_AFTER = \"notAfter\";\nconst SUBJECT$1 = \"subject\";\nconst SUBJECT_PUBLIC_KEY_INFO = \"subjectPublicKeyInfo\";\nconst ISSUER_UNIQUE_ID = \"issuerUniqueID\";\nconst SUBJECT_UNIQUE_ID = \"subjectUniqueID\";\nconst EXTENSIONS$2 = \"extensions\";\nconst SIGNATURE_ALGORITHM$5 = \"signatureAlgorithm\";\nconst SIGNATURE_VALUE$2 = \"signatureValue\";\nconst TBS_CERTIFICATE = \"tbsCertificate\";\nconst TBS_CERTIFICATE_VERSION = `${TBS_CERTIFICATE}.${VERSION$f}`;\nconst TBS_CERTIFICATE_SERIAL_NUMBER = `${TBS_CERTIFICATE}.${SERIAL_NUMBER$3}`;\nconst TBS_CERTIFICATE_SIGNATURE = `${TBS_CERTIFICATE}.${SIGNATURE$4}`;\nconst TBS_CERTIFICATE_ISSUER = `${TBS_CERTIFICATE}.${ISSUER$2}`;\nconst TBS_CERTIFICATE_NOT_BEFORE = `${TBS_CERTIFICATE}.${NOT_BEFORE}`;\nconst TBS_CERTIFICATE_NOT_AFTER = `${TBS_CERTIFICATE}.${NOT_AFTER}`;\nconst TBS_CERTIFICATE_SUBJECT = `${TBS_CERTIFICATE}.${SUBJECT$1}`;\nconst TBS_CERTIFICATE_SUBJECT_PUBLIC_KEY = `${TBS_CERTIFICATE}.${SUBJECT_PUBLIC_KEY_INFO}`;\nconst TBS_CERTIFICATE_ISSUER_UNIQUE_ID = `${TBS_CERTIFICATE}.${ISSUER_UNIQUE_ID}`;\nconst TBS_CERTIFICATE_SUBJECT_UNIQUE_ID = `${TBS_CERTIFICATE}.${SUBJECT_UNIQUE_ID}`;\nconst TBS_CERTIFICATE_EXTENSIONS = `${TBS_CERTIFICATE}.${EXTENSIONS$2}`;\nconst CLEAR_PROPS$Q = [\n    TBS_CERTIFICATE,\n    TBS_CERTIFICATE_VERSION,\n    TBS_CERTIFICATE_SERIAL_NUMBER,\n    TBS_CERTIFICATE_SIGNATURE,\n    TBS_CERTIFICATE_ISSUER,\n    TBS_CERTIFICATE_NOT_BEFORE,\n    TBS_CERTIFICATE_NOT_AFTER,\n    TBS_CERTIFICATE_SUBJECT,\n    TBS_CERTIFICATE_SUBJECT_PUBLIC_KEY,\n    TBS_CERTIFICATE_ISSUER_UNIQUE_ID,\n    TBS_CERTIFICATE_SUBJECT_UNIQUE_ID,\n    TBS_CERTIFICATE_EXTENSIONS,\n    SIGNATURE_ALGORITHM$5,\n    SIGNATURE_VALUE$2\n];\nfunction tbsCertificate(parameters = {}) {\n    const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n    return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n        name: (names.blockName || TBS_CERTIFICATE),\n        value: [\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.tbsCertificateVersion || TBS_CERTIFICATE_VERSION) })\n                ]\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.tbsCertificateSerialNumber || TBS_CERTIFICATE_SERIAL_NUMBER) }),\n            AlgorithmIdentifier.schema(names.signature || {\n                names: {\n                    blockName: TBS_CERTIFICATE_SIGNATURE\n                }\n            }),\n            RelativeDistinguishedNames.schema(names.issuer || {\n                names: {\n                    blockName: TBS_CERTIFICATE_ISSUER\n                }\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                name: (names.tbsCertificateValidity || \"tbsCertificate.validity\"),\n                value: [\n                    Time.schema(names.notBefore || {\n                        names: {\n                            utcTimeName: TBS_CERTIFICATE_NOT_BEFORE,\n                            generalTimeName: TBS_CERTIFICATE_NOT_BEFORE\n                        }\n                    }),\n                    Time.schema(names.notAfter || {\n                        names: {\n                            utcTimeName: TBS_CERTIFICATE_NOT_AFTER,\n                            generalTimeName: TBS_CERTIFICATE_NOT_AFTER\n                        }\n                    })\n                ]\n            }),\n            RelativeDistinguishedNames.schema(names.subject || {\n                names: {\n                    blockName: TBS_CERTIFICATE_SUBJECT\n                }\n            }),\n            PublicKeyInfo.schema(names.subjectPublicKeyInfo || {\n                names: {\n                    blockName: TBS_CERTIFICATE_SUBJECT_PUBLIC_KEY\n                }\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                name: (names.tbsCertificateIssuerUniqueID || TBS_CERTIFICATE_ISSUER_UNIQUE_ID),\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                }\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                name: (names.tbsCertificateSubjectUniqueID || TBS_CERTIFICATE_SUBJECT_UNIQUE_ID),\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 2\n                }\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 3\n                },\n                value: [Extensions.schema(names.extensions || {\n                        names: {\n                            blockName: TBS_CERTIFICATE_EXTENSIONS\n                        }\n                    })]\n            })\n        ]\n    }));\n}\nclass Certificate extends PkiObject {\n    get tbs() {\n        return pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.toArrayBuffer(this.tbsView);\n    }\n    set tbs(value) {\n        this.tbsView = new Uint8Array(value);\n    }\n    constructor(parameters = {}) {\n        super();\n        this.tbsView = new Uint8Array(pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TBS$4, Certificate.defaultValues(TBS$4)));\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$f, Certificate.defaultValues(VERSION$f));\n        this.serialNumber = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SERIAL_NUMBER$3, Certificate.defaultValues(SERIAL_NUMBER$3));\n        this.signature = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE$4, Certificate.defaultValues(SIGNATURE$4));\n        this.issuer = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER$2, Certificate.defaultValues(ISSUER$2));\n        this.notBefore = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NOT_BEFORE, Certificate.defaultValues(NOT_BEFORE));\n        this.notAfter = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NOT_AFTER, Certificate.defaultValues(NOT_AFTER));\n        this.subject = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SUBJECT$1, Certificate.defaultValues(SUBJECT$1));\n        this.subjectPublicKeyInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SUBJECT_PUBLIC_KEY_INFO, Certificate.defaultValues(SUBJECT_PUBLIC_KEY_INFO));\n        if (ISSUER_UNIQUE_ID in parameters) {\n            this.issuerUniqueID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER_UNIQUE_ID, Certificate.defaultValues(ISSUER_UNIQUE_ID));\n        }\n        if (SUBJECT_UNIQUE_ID in parameters) {\n            this.subjectUniqueID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SUBJECT_UNIQUE_ID, Certificate.defaultValues(SUBJECT_UNIQUE_ID));\n        }\n        if (EXTENSIONS$2 in parameters) {\n            this.extensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, EXTENSIONS$2, Certificate.defaultValues(EXTENSIONS$2));\n        }\n        this.signatureAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_ALGORITHM$5, Certificate.defaultValues(SIGNATURE_ALGORITHM$5));\n        this.signatureValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_VALUE$2, Certificate.defaultValues(SIGNATURE_VALUE$2));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TBS$4:\n                return EMPTY_BUFFER;\n            case VERSION$f:\n                return 0;\n            case SERIAL_NUMBER$3:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case SIGNATURE$4:\n                return new AlgorithmIdentifier();\n            case ISSUER$2:\n                return new RelativeDistinguishedNames();\n            case NOT_BEFORE:\n                return new Time();\n            case NOT_AFTER:\n                return new Time();\n            case SUBJECT$1:\n                return new RelativeDistinguishedNames();\n            case SUBJECT_PUBLIC_KEY_INFO:\n                return new PublicKeyInfo();\n            case ISSUER_UNIQUE_ID:\n                return EMPTY_BUFFER;\n            case SUBJECT_UNIQUE_ID:\n                return EMPTY_BUFFER;\n            case EXTENSIONS$2:\n                return [];\n            case SIGNATURE_ALGORITHM$5:\n                return new AlgorithmIdentifier();\n            case SIGNATURE_VALUE$2:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                tbsCertificate(names.tbsCertificate),\n                AlgorithmIdentifier.schema(names.signatureAlgorithm || {\n                    names: {\n                        blockName: SIGNATURE_ALGORITHM$5\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ name: (names.signatureValue || SIGNATURE_VALUE$2) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$Q);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, Certificate.schema({\n            names: {\n                tbsCertificate: {\n                    names: {\n                        extensions: {\n                            names: {\n                                extensions: TBS_CERTIFICATE_EXTENSIONS\n                            }\n                        }\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.tbsView = asn1.result.tbsCertificate.valueBeforeDecodeView;\n        if (TBS_CERTIFICATE_VERSION in asn1.result)\n            this.version = asn1.result[TBS_CERTIFICATE_VERSION].valueBlock.valueDec;\n        this.serialNumber = asn1.result[TBS_CERTIFICATE_SERIAL_NUMBER];\n        this.signature = new AlgorithmIdentifier({ schema: asn1.result[TBS_CERTIFICATE_SIGNATURE] });\n        this.issuer = new RelativeDistinguishedNames({ schema: asn1.result[TBS_CERTIFICATE_ISSUER] });\n        this.notBefore = new Time({ schema: asn1.result[TBS_CERTIFICATE_NOT_BEFORE] });\n        this.notAfter = new Time({ schema: asn1.result[TBS_CERTIFICATE_NOT_AFTER] });\n        this.subject = new RelativeDistinguishedNames({ schema: asn1.result[TBS_CERTIFICATE_SUBJECT] });\n        this.subjectPublicKeyInfo = new PublicKeyInfo({ schema: asn1.result[TBS_CERTIFICATE_SUBJECT_PUBLIC_KEY] });\n        if (TBS_CERTIFICATE_ISSUER_UNIQUE_ID in asn1.result)\n            this.issuerUniqueID = asn1.result[TBS_CERTIFICATE_ISSUER_UNIQUE_ID].valueBlock.valueHex;\n        if (TBS_CERTIFICATE_SUBJECT_UNIQUE_ID in asn1.result)\n            this.subjectUniqueID = asn1.result[TBS_CERTIFICATE_SUBJECT_UNIQUE_ID].valueBlock.valueHex;\n        if (TBS_CERTIFICATE_EXTENSIONS in asn1.result)\n            this.extensions = Array.from(asn1.result[TBS_CERTIFICATE_EXTENSIONS], element => new Extension({ schema: element }));\n        this.signatureAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.signatureAlgorithm });\n        this.signatureValue = asn1.result.signatureValue;\n    }\n    encodeTBS() {\n        const outputArray = [];\n        if ((VERSION$f in this) && (this.version !== Certificate.defaultValues(VERSION$f))) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version })\n                ]\n            }));\n        }\n        outputArray.push(this.serialNumber);\n        outputArray.push(this.signature.toSchema());\n        outputArray.push(this.issuer.toSchema());\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.notBefore.toSchema(),\n                this.notAfter.toSchema()\n            ]\n        }));\n        outputArray.push(this.subject.toSchema());\n        outputArray.push(this.subjectPublicKeyInfo.toSchema());\n        if (this.issuerUniqueID) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                valueHex: this.issuerUniqueID\n            }));\n        }\n        if (this.subjectUniqueID) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 2\n                },\n                valueHex: this.subjectUniqueID\n            }));\n        }\n        if (this.extensions) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 3\n                },\n                value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                        value: Array.from(this.extensions, o => o.toSchema())\n                    })]\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toSchema(encodeFlag = false) {\n        let tbsSchema;\n        if (encodeFlag === false) {\n            if (!this.tbsView.byteLength) {\n                return Certificate.schema().value[0];\n            }\n            const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(this.tbsView);\n            AsnError.assert(asn1, \"TBS Certificate\");\n            tbsSchema = asn1.result;\n        }\n        else {\n            tbsSchema = this.encodeTBS();\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                tbsSchema,\n                this.signatureAlgorithm.toSchema(),\n                this.signatureValue\n            ]\n        }));\n    }\n    toJSON() {\n        const res = {\n            tbs: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToHex(this.tbsView),\n            version: this.version,\n            serialNumber: this.serialNumber.toJSON(),\n            signature: this.signature.toJSON(),\n            issuer: this.issuer.toJSON(),\n            notBefore: this.notBefore.toJSON(),\n            notAfter: this.notAfter.toJSON(),\n            subject: this.subject.toJSON(),\n            subjectPublicKeyInfo: this.subjectPublicKeyInfo.toJSON(),\n            signatureAlgorithm: this.signatureAlgorithm.toJSON(),\n            signatureValue: this.signatureValue.toJSON(),\n        };\n        if ((VERSION$f in this) && (this.version !== Certificate.defaultValues(VERSION$f))) {\n            res.version = this.version;\n        }\n        if (this.issuerUniqueID) {\n            res.issuerUniqueID = pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToHex(this.issuerUniqueID);\n        }\n        if (this.subjectUniqueID) {\n            res.subjectUniqueID = pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToHex(this.subjectUniqueID);\n        }\n        if (this.extensions) {\n            res.extensions = Array.from(this.extensions, o => o.toJSON());\n        }\n        return res;\n    }\n    async getPublicKey(parameters, crypto = getCrypto(true)) {\n        return crypto.getPublicKey(this.subjectPublicKeyInfo, this.signatureAlgorithm, parameters);\n    }\n    async getKeyHash(hashAlgorithm = \"SHA-1\", crypto = getCrypto(true)) {\n        return crypto.digest({ name: hashAlgorithm }, this.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView);\n    }\n    async sign(privateKey, hashAlgorithm = \"SHA-1\", crypto = getCrypto(true)) {\n        if (!privateKey) {\n            throw new Error(\"Need to provide a private key for signing\");\n        }\n        const signatureParameters = await crypto.getSignatureParameters(privateKey, hashAlgorithm);\n        const parameters = signatureParameters.parameters;\n        this.signature = signatureParameters.signatureAlgorithm;\n        this.signatureAlgorithm = signatureParameters.signatureAlgorithm;\n        this.tbsView = new Uint8Array(this.encodeTBS().toBER());\n        const signature = await crypto.signWithPrivateKey(this.tbsView, privateKey, parameters);\n        this.signatureValue = new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ valueHex: signature });\n    }\n    async verify(issuerCertificate, crypto = getCrypto(true)) {\n        let subjectPublicKeyInfo;\n        if (issuerCertificate) {\n            subjectPublicKeyInfo = issuerCertificate.subjectPublicKeyInfo;\n        }\n        else if (this.issuer.isEqual(this.subject)) {\n            subjectPublicKeyInfo = this.subjectPublicKeyInfo;\n        }\n        if (!(subjectPublicKeyInfo instanceof PublicKeyInfo)) {\n            throw new Error(\"Please provide issuer certificate as a parameter\");\n        }\n        return crypto.verifyWithPublicKey(this.tbsView, this.signatureValue, subjectPublicKeyInfo, this.signatureAlgorithm);\n    }\n}\nCertificate.CLASS_NAME = \"Certificate\";\nfunction checkCA(cert, signerCert = null) {\n    if (signerCert && cert.issuer.isEqual(signerCert.issuer) && cert.serialNumber.isEqual(signerCert.serialNumber)) {\n        return null;\n    }\n    let isCA = false;\n    if (cert.extensions) {\n        for (const extension of cert.extensions) {\n            if (extension.extnID === id_BasicConstraints && extension.parsedValue instanceof BasicConstraints) {\n                if (extension.parsedValue.cA) {\n                    isCA = true;\n                    break;\n                }\n            }\n        }\n    }\n    if (isCA) {\n        return cert;\n    }\n    return null;\n}\n\nconst CERT_ID$1 = \"certId\";\nconst CERT_VALUE = \"certValue\";\nconst PARSED_VALUE$4 = \"parsedValue\";\nconst CLEAR_PROPS$P = [\n    CERT_ID$1,\n    CERT_VALUE\n];\nclass CertBag extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.certId = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CERT_ID$1, CertBag.defaultValues(CERT_ID$1));\n        this.certValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CERT_VALUE, CertBag.defaultValues(CERT_VALUE));\n        if (PARSED_VALUE$4 in parameters) {\n            this.parsedValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PARSED_VALUE$4, CertBag.defaultValues(PARSED_VALUE$4));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case CERT_ID$1:\n                return EMPTY_STRING;\n            case CERT_VALUE:\n                return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any());\n            case PARSED_VALUE$4:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case CERT_ID$1:\n                return (memberValue === EMPTY_STRING);\n            case CERT_VALUE:\n                return (memberValue instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any);\n            case PARSED_VALUE$4:\n                return ((memberValue instanceof Object) && (Object.keys(memberValue).length === 0));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.id || \"id\") }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ name: (names.value || \"value\") })]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$P);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, CertBag.schema({\n            names: {\n                id: CERT_ID$1,\n                value: CERT_VALUE\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.certId = asn1.result.certId.valueBlock.toString();\n        this.certValue = asn1.result.certValue;\n        const certValueHex = this.certValue.valueBlock.valueHexView;\n        switch (this.certId) {\n            case id_CertBag_X509Certificate:\n                {\n                    try {\n                        this.parsedValue = Certificate.fromBER(certValueHex);\n                    }\n                    catch {\n                        AttributeCertificateV2.fromBER(certValueHex);\n                    }\n                }\n                break;\n            case id_CertBag_AttributeCertificate:\n                {\n                    this.parsedValue = AttributeCertificateV2.fromBER(certValueHex);\n                }\n                break;\n            case id_CertBag_SDSICertificate:\n            default:\n                throw new Error(`Incorrect CERT_ID value in CertBag: ${this.certId}`);\n        }\n    }\n    toSchema() {\n        if (PARSED_VALUE$4 in this) {\n            if (\"acinfo\" in this.parsedValue) {\n                this.certId = id_CertBag_AttributeCertificate;\n            }\n            else {\n                this.certId = id_CertBag_X509Certificate;\n            }\n            this.certValue = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: this.parsedValue.toSchema().toBER(false) });\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.certId }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [((\"toSchema\" in this.certValue) ? this.certValue.toSchema() : this.certValue)]\n                })\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            certId: this.certId,\n            certValue: this.certValue.toJSON()\n        };\n    }\n}\nCertBag.CLASS_NAME = \"CertBag\";\n\nconst USER_CERTIFICATE = \"userCertificate\";\nconst REVOCATION_DATE = \"revocationDate\";\nconst CRL_ENTRY_EXTENSIONS = \"crlEntryExtensions\";\nconst CLEAR_PROPS$O = [\n    USER_CERTIFICATE,\n    REVOCATION_DATE,\n    CRL_ENTRY_EXTENSIONS\n];\nclass RevokedCertificate extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.userCertificate = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, USER_CERTIFICATE, RevokedCertificate.defaultValues(USER_CERTIFICATE));\n        this.revocationDate = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, REVOCATION_DATE, RevokedCertificate.defaultValues(REVOCATION_DATE));\n        if (CRL_ENTRY_EXTENSIONS in parameters) {\n            this.crlEntryExtensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CRL_ENTRY_EXTENSIONS, RevokedCertificate.defaultValues(CRL_ENTRY_EXTENSIONS));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case USER_CERTIFICATE:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case REVOCATION_DATE:\n                return new Time();\n            case CRL_ENTRY_EXTENSIONS:\n                return new Extensions();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.userCertificate || USER_CERTIFICATE) }),\n                Time.schema({\n                    names: {\n                        utcTimeName: (names.revocationDate || REVOCATION_DATE),\n                        generalTimeName: (names.revocationDate || REVOCATION_DATE)\n                    }\n                }),\n                Extensions.schema({\n                    names: {\n                        blockName: (names.crlEntryExtensions || CRL_ENTRY_EXTENSIONS)\n                    }\n                }, true)\n            ]\n        });\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$O);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, RevokedCertificate.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.userCertificate = asn1.result.userCertificate;\n        this.revocationDate = new Time({ schema: asn1.result.revocationDate });\n        if (CRL_ENTRY_EXTENSIONS in asn1.result) {\n            this.crlEntryExtensions = new Extensions({ schema: asn1.result.crlEntryExtensions });\n        }\n    }\n    toSchema() {\n        const outputArray = [\n            this.userCertificate,\n            this.revocationDate.toSchema()\n        ];\n        if (this.crlEntryExtensions) {\n            outputArray.push(this.crlEntryExtensions.toSchema());\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            userCertificate: this.userCertificate.toJSON(),\n            revocationDate: this.revocationDate.toJSON(),\n        };\n        if (this.crlEntryExtensions) {\n            res.crlEntryExtensions = this.crlEntryExtensions.toJSON();\n        }\n        return res;\n    }\n}\nRevokedCertificate.CLASS_NAME = \"RevokedCertificate\";\n\nconst TBS$3 = \"tbs\";\nconst VERSION$e = \"version\";\nconst SIGNATURE$3 = \"signature\";\nconst ISSUER$1 = \"issuer\";\nconst THIS_UPDATE$1 = \"thisUpdate\";\nconst NEXT_UPDATE$1 = \"nextUpdate\";\nconst REVOKED_CERTIFICATES = \"revokedCertificates\";\nconst CRL_EXTENSIONS = \"crlExtensions\";\nconst SIGNATURE_ALGORITHM$4 = \"signatureAlgorithm\";\nconst SIGNATURE_VALUE$1 = \"signatureValue\";\nconst TBS_CERT_LIST = \"tbsCertList\";\nconst TBS_CERT_LIST_VERSION = `${TBS_CERT_LIST}.version`;\nconst TBS_CERT_LIST_SIGNATURE = `${TBS_CERT_LIST}.signature`;\nconst TBS_CERT_LIST_ISSUER = `${TBS_CERT_LIST}.issuer`;\nconst TBS_CERT_LIST_THIS_UPDATE = `${TBS_CERT_LIST}.thisUpdate`;\nconst TBS_CERT_LIST_NEXT_UPDATE = `${TBS_CERT_LIST}.nextUpdate`;\nconst TBS_CERT_LIST_REVOKED_CERTIFICATES = `${TBS_CERT_LIST}.revokedCertificates`;\nconst TBS_CERT_LIST_EXTENSIONS = `${TBS_CERT_LIST}.extensions`;\nconst CLEAR_PROPS$N = [\n    TBS_CERT_LIST,\n    TBS_CERT_LIST_VERSION,\n    TBS_CERT_LIST_SIGNATURE,\n    TBS_CERT_LIST_ISSUER,\n    TBS_CERT_LIST_THIS_UPDATE,\n    TBS_CERT_LIST_NEXT_UPDATE,\n    TBS_CERT_LIST_REVOKED_CERTIFICATES,\n    TBS_CERT_LIST_EXTENSIONS,\n    SIGNATURE_ALGORITHM$4,\n    SIGNATURE_VALUE$1\n];\nfunction tbsCertList(parameters = {}) {\n    const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n    return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n        name: (names.blockName || TBS_CERT_LIST),\n        value: [\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({\n                optional: true,\n                name: (names.tbsCertListVersion || TBS_CERT_LIST_VERSION),\n                value: 2\n            }),\n            AlgorithmIdentifier.schema(names.signature || {\n                names: {\n                    blockName: TBS_CERT_LIST_SIGNATURE\n                }\n            }),\n            RelativeDistinguishedNames.schema(names.issuer || {\n                names: {\n                    blockName: TBS_CERT_LIST_ISSUER\n                }\n            }),\n            Time.schema(names.tbsCertListThisUpdate || {\n                names: {\n                    utcTimeName: TBS_CERT_LIST_THIS_UPDATE,\n                    generalTimeName: TBS_CERT_LIST_THIS_UPDATE\n                }\n            }),\n            Time.schema(names.tbsCertListNextUpdate || {\n                names: {\n                    utcTimeName: TBS_CERT_LIST_NEXT_UPDATE,\n                    generalTimeName: TBS_CERT_LIST_NEXT_UPDATE\n                }\n            }, true),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                optional: true,\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                        name: (names.tbsCertListRevokedCertificates || TBS_CERT_LIST_REVOKED_CERTIFICATES),\n                        value: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                            value: [\n                                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer(),\n                                Time.schema(),\n                                Extensions.schema({}, true)\n                            ]\n                        })\n                    })\n                ]\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [Extensions.schema(names.crlExtensions || {\n                        names: {\n                            blockName: TBS_CERT_LIST_EXTENSIONS\n                        }\n                    })]\n            })\n        ]\n    }));\n}\nconst WELL_KNOWN_EXTENSIONS = [\n    id_AuthorityKeyIdentifier,\n    id_IssuerAltName,\n    id_CRLNumber,\n    id_BaseCRLNumber,\n    id_IssuingDistributionPoint,\n    id_FreshestCRL,\n    id_AuthorityInfoAccess,\n    id_CRLReason,\n    id_InvalidityDate,\n    id_CertificateIssuer,\n];\nclass CertificateRevocationList extends PkiObject {\n    get tbs() {\n        return pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.toArrayBuffer(this.tbsView);\n    }\n    set tbs(value) {\n        this.tbsView = new Uint8Array(value);\n    }\n    constructor(parameters = {}) {\n        super();\n        this.tbsView = new Uint8Array(pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TBS$3, CertificateRevocationList.defaultValues(TBS$3)));\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$e, CertificateRevocationList.defaultValues(VERSION$e));\n        this.signature = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE$3, CertificateRevocationList.defaultValues(SIGNATURE$3));\n        this.issuer = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER$1, CertificateRevocationList.defaultValues(ISSUER$1));\n        this.thisUpdate = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, THIS_UPDATE$1, CertificateRevocationList.defaultValues(THIS_UPDATE$1));\n        if (NEXT_UPDATE$1 in parameters) {\n            this.nextUpdate = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NEXT_UPDATE$1, CertificateRevocationList.defaultValues(NEXT_UPDATE$1));\n        }\n        if (REVOKED_CERTIFICATES in parameters) {\n            this.revokedCertificates = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, REVOKED_CERTIFICATES, CertificateRevocationList.defaultValues(REVOKED_CERTIFICATES));\n        }\n        if (CRL_EXTENSIONS in parameters) {\n            this.crlExtensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CRL_EXTENSIONS, CertificateRevocationList.defaultValues(CRL_EXTENSIONS));\n        }\n        this.signatureAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_ALGORITHM$4, CertificateRevocationList.defaultValues(SIGNATURE_ALGORITHM$4));\n        this.signatureValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_VALUE$1, CertificateRevocationList.defaultValues(SIGNATURE_VALUE$1));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TBS$3:\n                return EMPTY_BUFFER;\n            case VERSION$e:\n                return 0;\n            case SIGNATURE$3:\n                return new AlgorithmIdentifier();\n            case ISSUER$1:\n                return new RelativeDistinguishedNames();\n            case THIS_UPDATE$1:\n                return new Time();\n            case NEXT_UPDATE$1:\n                return new Time();\n            case REVOKED_CERTIFICATES:\n                return [];\n            case CRL_EXTENSIONS:\n                return new Extensions();\n            case SIGNATURE_ALGORITHM$4:\n                return new AlgorithmIdentifier();\n            case SIGNATURE_VALUE$1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || \"CertificateList\"),\n            value: [\n                tbsCertList(parameters),\n                AlgorithmIdentifier.schema(names.signatureAlgorithm || {\n                    names: {\n                        blockName: SIGNATURE_ALGORITHM$4\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ name: (names.signatureValue || SIGNATURE_VALUE$1) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$N);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, CertificateRevocationList.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.tbsView = asn1.result.tbsCertList.valueBeforeDecodeView;\n        if (TBS_CERT_LIST_VERSION in asn1.result) {\n            this.version = asn1.result[TBS_CERT_LIST_VERSION].valueBlock.valueDec;\n        }\n        this.signature = new AlgorithmIdentifier({ schema: asn1.result[TBS_CERT_LIST_SIGNATURE] });\n        this.issuer = new RelativeDistinguishedNames({ schema: asn1.result[TBS_CERT_LIST_ISSUER] });\n        this.thisUpdate = new Time({ schema: asn1.result[TBS_CERT_LIST_THIS_UPDATE] });\n        if (TBS_CERT_LIST_NEXT_UPDATE in asn1.result) {\n            this.nextUpdate = new Time({ schema: asn1.result[TBS_CERT_LIST_NEXT_UPDATE] });\n        }\n        if (TBS_CERT_LIST_REVOKED_CERTIFICATES in asn1.result) {\n            this.revokedCertificates = Array.from(asn1.result[TBS_CERT_LIST_REVOKED_CERTIFICATES], element => new RevokedCertificate({ schema: element }));\n        }\n        if (TBS_CERT_LIST_EXTENSIONS in asn1.result) {\n            this.crlExtensions = new Extensions({ schema: asn1.result[TBS_CERT_LIST_EXTENSIONS] });\n        }\n        this.signatureAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.signatureAlgorithm });\n        this.signatureValue = asn1.result.signatureValue;\n    }\n    encodeTBS() {\n        const outputArray = [];\n        if (this.version !== CertificateRevocationList.defaultValues(VERSION$e)) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }));\n        }\n        outputArray.push(this.signature.toSchema());\n        outputArray.push(this.issuer.toSchema());\n        outputArray.push(this.thisUpdate.toSchema());\n        if (this.nextUpdate) {\n            outputArray.push(this.nextUpdate.toSchema());\n        }\n        if (this.revokedCertificates) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                value: Array.from(this.revokedCertificates, o => o.toSchema())\n            }));\n        }\n        if (this.crlExtensions) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [\n                    this.crlExtensions.toSchema()\n                ]\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toSchema(encodeFlag = false) {\n        let tbsSchema;\n        if (!encodeFlag) {\n            if (!this.tbsView.byteLength) {\n                return CertificateRevocationList.schema();\n            }\n            const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(this.tbsView);\n            AsnError.assert(asn1, \"TBS Certificate Revocation List\");\n            tbsSchema = asn1.result;\n        }\n        else {\n            tbsSchema = this.encodeTBS();\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                tbsSchema,\n                this.signatureAlgorithm.toSchema(),\n                this.signatureValue\n            ]\n        }));\n    }\n    toJSON() {\n        const res = {\n            tbs: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToHex(this.tbsView),\n            version: this.version,\n            signature: this.signature.toJSON(),\n            issuer: this.issuer.toJSON(),\n            thisUpdate: this.thisUpdate.toJSON(),\n            signatureAlgorithm: this.signatureAlgorithm.toJSON(),\n            signatureValue: this.signatureValue.toJSON()\n        };\n        if (this.version !== CertificateRevocationList.defaultValues(VERSION$e))\n            res.version = this.version;\n        if (this.nextUpdate) {\n            res.nextUpdate = this.nextUpdate.toJSON();\n        }\n        if (this.revokedCertificates) {\n            res.revokedCertificates = Array.from(this.revokedCertificates, o => o.toJSON());\n        }\n        if (this.crlExtensions) {\n            res.crlExtensions = this.crlExtensions.toJSON();\n        }\n        return res;\n    }\n    isCertificateRevoked(certificate) {\n        if (!this.issuer.isEqual(certificate.issuer)) {\n            return false;\n        }\n        if (!this.revokedCertificates) {\n            return false;\n        }\n        for (const revokedCertificate of this.revokedCertificates) {\n            if (revokedCertificate.userCertificate.isEqual(certificate.serialNumber)) {\n                return true;\n            }\n        }\n        return false;\n    }\n    async sign(privateKey, hashAlgorithm = \"SHA-1\", crypto = getCrypto(true)) {\n        if (!privateKey) {\n            throw new Error(\"Need to provide a private key for signing\");\n        }\n        const signatureParameters = await crypto.getSignatureParameters(privateKey, hashAlgorithm);\n        const { parameters } = signatureParameters;\n        this.signature = signatureParameters.signatureAlgorithm;\n        this.signatureAlgorithm = signatureParameters.signatureAlgorithm;\n        this.tbsView = new Uint8Array(this.encodeTBS().toBER());\n        const signature = await crypto.signWithPrivateKey(this.tbsView, privateKey, parameters);\n        this.signatureValue = new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ valueHex: signature });\n    }\n    async verify(parameters = {}, crypto = getCrypto(true)) {\n        let subjectPublicKeyInfo;\n        if (parameters.issuerCertificate) {\n            subjectPublicKeyInfo = parameters.issuerCertificate.subjectPublicKeyInfo;\n            if (!this.issuer.isEqual(parameters.issuerCertificate.subject)) {\n                return false;\n            }\n        }\n        if (parameters.publicKeyInfo) {\n            subjectPublicKeyInfo = parameters.publicKeyInfo;\n        }\n        if (!subjectPublicKeyInfo) {\n            throw new Error(\"Issuer's certificate must be provided as an input parameter\");\n        }\n        if (this.crlExtensions) {\n            for (const extension of this.crlExtensions.extensions) {\n                if (extension.critical) {\n                    if (!WELL_KNOWN_EXTENSIONS.includes(extension.extnID))\n                        return false;\n                }\n            }\n        }\n        return crypto.verifyWithPublicKey(this.tbsView, this.signatureValue, subjectPublicKeyInfo, this.signatureAlgorithm);\n    }\n}\nCertificateRevocationList.CLASS_NAME = \"CertificateRevocationList\";\n\nconst CRL_ID = \"crlId\";\nconst CRL_VALUE = \"crlValue\";\nconst PARSED_VALUE$3 = \"parsedValue\";\nconst CLEAR_PROPS$M = [\n    CRL_ID,\n    CRL_VALUE,\n];\nclass CRLBag extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.crlId = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CRL_ID, CRLBag.defaultValues(CRL_ID));\n        this.crlValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CRL_VALUE, CRLBag.defaultValues(CRL_VALUE));\n        if (PARSED_VALUE$3 in parameters) {\n            this.parsedValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PARSED_VALUE$3, CRLBag.defaultValues(PARSED_VALUE$3));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case CRL_ID:\n                return EMPTY_STRING;\n            case CRL_VALUE:\n                return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any());\n            case PARSED_VALUE$3:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case CRL_ID:\n                return (memberValue === EMPTY_STRING);\n            case CRL_VALUE:\n                return (memberValue instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any);\n            case PARSED_VALUE$3:\n                return ((memberValue instanceof Object) && (Object.keys(memberValue).length === 0));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.id || \"id\") }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ name: (names.value || \"value\") })]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$M);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, CRLBag.schema({\n            names: {\n                id: CRL_ID,\n                value: CRL_VALUE\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.crlId = asn1.result.crlId.valueBlock.toString();\n        this.crlValue = asn1.result.crlValue;\n        switch (this.crlId) {\n            case id_CRLBag_X509CRL:\n                {\n                    this.parsedValue = CertificateRevocationList.fromBER(this.certValue.valueBlock.valueHex);\n                }\n                break;\n            default:\n                throw new Error(`Incorrect CRL_ID value in CRLBag: ${this.crlId}`);\n        }\n    }\n    toSchema() {\n        if (this.parsedValue) {\n            this.crlId = id_CRLBag_X509CRL;\n            this.crlValue = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: this.parsedValue.toSchema().toBER(false) });\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.crlId }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [this.crlValue.toSchema()]\n                })\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            crlId: this.crlId,\n            crlValue: this.crlValue.toJSON()\n        };\n    }\n}\nCRLBag.CLASS_NAME = \"CRLBag\";\n\nconst VERSION$d = \"version\";\nconst ENCRYPTED_CONTENT_INFO$1 = \"encryptedContentInfo\";\nconst UNPROTECTED_ATTRS$1 = \"unprotectedAttrs\";\nconst CLEAR_PROPS$L = [\n    VERSION$d,\n    ENCRYPTED_CONTENT_INFO$1,\n    UNPROTECTED_ATTRS$1,\n];\nclass EncryptedData extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$d, EncryptedData.defaultValues(VERSION$d));\n        this.encryptedContentInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENCRYPTED_CONTENT_INFO$1, EncryptedData.defaultValues(ENCRYPTED_CONTENT_INFO$1));\n        if (UNPROTECTED_ATTRS$1 in parameters) {\n            this.unprotectedAttrs = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, UNPROTECTED_ATTRS$1, EncryptedData.defaultValues(UNPROTECTED_ATTRS$1));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$d:\n                return 0;\n            case ENCRYPTED_CONTENT_INFO$1:\n                return new EncryptedContentInfo();\n            case UNPROTECTED_ATTRS$1:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VERSION$d:\n                return (memberValue === 0);\n            case ENCRYPTED_CONTENT_INFO$1:\n                return ((EncryptedContentInfo.compareWithDefault(\"contentType\", memberValue.contentType)) &&\n                    (EncryptedContentInfo.compareWithDefault(\"contentEncryptionAlgorithm\", memberValue.contentEncryptionAlgorithm)) &&\n                    (EncryptedContentInfo.compareWithDefault(\"encryptedContent\", memberValue.encryptedContent)));\n            case UNPROTECTED_ATTRS$1:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || EMPTY_STRING) }),\n                EncryptedContentInfo.schema(names.encryptedContentInfo || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.unprotectedAttrs || EMPTY_STRING),\n                            value: Attribute.schema()\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$L);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, EncryptedData.schema({\n            names: {\n                version: VERSION$d,\n                encryptedContentInfo: {\n                    names: {\n                        blockName: ENCRYPTED_CONTENT_INFO$1\n                    }\n                },\n                unprotectedAttrs: UNPROTECTED_ATTRS$1\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result.version.valueBlock.valueDec;\n        this.encryptedContentInfo = new EncryptedContentInfo({ schema: asn1.result.encryptedContentInfo });\n        if (UNPROTECTED_ATTRS$1 in asn1.result)\n            this.unprotectedAttrs = Array.from(asn1.result.unprotectedAttrs, element => new Attribute({ schema: element }));\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }));\n        outputArray.push(this.encryptedContentInfo.toSchema());\n        if (this.unprotectedAttrs) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: Array.from(this.unprotectedAttrs, o => o.toSchema())\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            version: this.version,\n            encryptedContentInfo: this.encryptedContentInfo.toJSON()\n        };\n        if (this.unprotectedAttrs)\n            res.unprotectedAttrs = Array.from(this.unprotectedAttrs, o => o.toJSON());\n        return res;\n    }\n    async encrypt(parameters, crypto = getCrypto(true)) {\n        ArgumentError.assert(parameters, \"parameters\", \"object\");\n        const encryptParams = {\n            ...parameters,\n            contentType: \"1.2.840.113549.1.7.1\",\n        };\n        this.encryptedContentInfo = await crypto.encryptEncryptedContentInfo(encryptParams);\n    }\n    async decrypt(parameters, crypto = getCrypto(true)) {\n        ArgumentError.assert(parameters, \"parameters\", \"object\");\n        const decryptParams = {\n            ...parameters,\n            encryptedContentInfo: this.encryptedContentInfo,\n        };\n        return crypto.decryptEncryptedContentInfo(decryptParams);\n    }\n}\nEncryptedData.CLASS_NAME = \"EncryptedData\";\n\nconst ENCRYPTION_ALGORITHM = \"encryptionAlgorithm\";\nconst ENCRYPTED_DATA = \"encryptedData\";\nconst PARSED_VALUE$2 = \"parsedValue\";\nconst CLEAR_PROPS$K = [\n    ENCRYPTION_ALGORITHM,\n    ENCRYPTED_DATA,\n];\nclass PKCS8ShroudedKeyBag extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.encryptionAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENCRYPTION_ALGORITHM, PKCS8ShroudedKeyBag.defaultValues(ENCRYPTION_ALGORITHM));\n        this.encryptedData = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENCRYPTED_DATA, PKCS8ShroudedKeyBag.defaultValues(ENCRYPTED_DATA));\n        if (PARSED_VALUE$2 in parameters) {\n            this.parsedValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PARSED_VALUE$2, PKCS8ShroudedKeyBag.defaultValues(PARSED_VALUE$2));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ENCRYPTION_ALGORITHM:\n                return (new AlgorithmIdentifier());\n            case ENCRYPTED_DATA:\n                return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString());\n            case PARSED_VALUE$2:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case ENCRYPTION_ALGORITHM:\n                return ((AlgorithmIdentifier.compareWithDefault(\"algorithmId\", memberValue.algorithmId)) &&\n                    ((\"algorithmParams\" in memberValue) === false));\n            case ENCRYPTED_DATA:\n                return (memberValue.isEqual(PKCS8ShroudedKeyBag.defaultValues(memberName)));\n            case PARSED_VALUE$2:\n                return ((memberValue instanceof Object) && (Object.keys(memberValue).length === 0));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                AlgorithmIdentifier.schema(names.encryptionAlgorithm || {\n                    names: {\n                        blockName: ENCRYPTION_ALGORITHM\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.encryptedData || ENCRYPTED_DATA) }),\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({\n                            idBlock: {\n                                isConstructed: true\n                            },\n                            name: (names.encryptedData || ENCRYPTED_DATA)\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$K);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PKCS8ShroudedKeyBag.schema({\n            names: {\n                encryptionAlgorithm: {\n                    names: {\n                        blockName: ENCRYPTION_ALGORITHM\n                    }\n                },\n                encryptedData: ENCRYPTED_DATA\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.encryptionAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.encryptionAlgorithm });\n        this.encryptedData = asn1.result.encryptedData;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.encryptionAlgorithm.toSchema(),\n                this.encryptedData\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            encryptionAlgorithm: this.encryptionAlgorithm.toJSON(),\n            encryptedData: this.encryptedData.toJSON(),\n        };\n    }\n    async parseInternalValues(parameters, crypto = getCrypto(true)) {\n        const cmsEncrypted = new EncryptedData({\n            encryptedContentInfo: new EncryptedContentInfo({\n                contentEncryptionAlgorithm: this.encryptionAlgorithm,\n                encryptedContent: this.encryptedData\n            })\n        });\n        const decryptedData = await cmsEncrypted.decrypt(parameters, crypto);\n        this.parsedValue = PrivateKeyInfo.fromBER(decryptedData);\n    }\n    async makeInternalValues(parameters, crypto = getCrypto(true)) {\n        if (!this.parsedValue) {\n            throw new Error(\"Please initialize \\\"parsedValue\\\" first\");\n        }\n        const cmsEncrypted = new EncryptedData();\n        const encryptParams = {\n            ...parameters,\n            contentToEncrypt: this.parsedValue.toSchema().toBER(false),\n        };\n        await cmsEncrypted.encrypt(encryptParams, crypto);\n        if (!cmsEncrypted.encryptedContentInfo.encryptedContent) {\n            throw new Error(\"The filed `encryptedContent` in EncryptedContentInfo is empty\");\n        }\n        this.encryptionAlgorithm = cmsEncrypted.encryptedContentInfo.contentEncryptionAlgorithm;\n        this.encryptedData = cmsEncrypted.encryptedContentInfo.encryptedContent;\n    }\n}\nPKCS8ShroudedKeyBag.CLASS_NAME = \"PKCS8ShroudedKeyBag\";\n\nconst SECRET_TYPE_ID = \"secretTypeId\";\nconst SECRET_VALUE = \"secretValue\";\nconst CLEAR_PROPS$J = [\n    SECRET_TYPE_ID,\n    SECRET_VALUE,\n];\nclass SecretBag extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.secretTypeId = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SECRET_TYPE_ID, SecretBag.defaultValues(SECRET_TYPE_ID));\n        this.secretValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SECRET_VALUE, SecretBag.defaultValues(SECRET_VALUE));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case SECRET_TYPE_ID:\n                return EMPTY_STRING;\n            case SECRET_VALUE:\n                return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any());\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case SECRET_TYPE_ID:\n                return (memberValue === EMPTY_STRING);\n            case SECRET_VALUE:\n                return (memberValue instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.id || \"id\") }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ name: (names.value || \"value\") })]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$J);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, SecretBag.schema({\n            names: {\n                id: SECRET_TYPE_ID,\n                value: SECRET_VALUE\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.secretTypeId = asn1.result.secretTypeId.valueBlock.toString();\n        this.secretValue = asn1.result.secretValue;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.secretTypeId }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [this.secretValue.toSchema()]\n                })\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            secretTypeId: this.secretTypeId,\n            secretValue: this.secretValue.toJSON()\n        };\n    }\n}\nSecretBag.CLASS_NAME = \"SecretBag\";\n\nclass SafeBagValueFactory {\n    static getItems() {\n        if (!this.items) {\n            this.items = {};\n            SafeBagValueFactory.register(\"1.2.840.113549.1.12.10.1.1\", PrivateKeyInfo);\n            SafeBagValueFactory.register(\"1.2.840.113549.1.12.10.1.2\", PKCS8ShroudedKeyBag);\n            SafeBagValueFactory.register(\"1.2.840.113549.1.12.10.1.3\", CertBag);\n            SafeBagValueFactory.register(\"1.2.840.113549.1.12.10.1.4\", CRLBag);\n            SafeBagValueFactory.register(\"1.2.840.113549.1.12.10.1.5\", SecretBag);\n            SafeBagValueFactory.register(\"1.2.840.113549.1.12.10.1.6\", SafeContents);\n        }\n        return this.items;\n    }\n    static register(id, type) {\n        this.getItems()[id] = type;\n    }\n    static find(id) {\n        return this.getItems()[id] || null;\n    }\n}\n\nconst BAG_ID = \"bagId\";\nconst BAG_VALUE = \"bagValue\";\nconst BAG_ATTRIBUTES = \"bagAttributes\";\nconst CLEAR_PROPS$I = [\n    BAG_ID,\n    BAG_VALUE,\n    BAG_ATTRIBUTES\n];\nclass SafeBag extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.bagId = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, BAG_ID, SafeBag.defaultValues(BAG_ID));\n        this.bagValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, BAG_VALUE, SafeBag.defaultValues(BAG_VALUE));\n        if (BAG_ATTRIBUTES in parameters) {\n            this.bagAttributes = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, BAG_ATTRIBUTES, SafeBag.defaultValues(BAG_ATTRIBUTES));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case BAG_ID:\n                return EMPTY_STRING;\n            case BAG_VALUE:\n                return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any());\n            case BAG_ATTRIBUTES:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case BAG_ID:\n                return (memberValue === EMPTY_STRING);\n            case BAG_VALUE:\n                return (memberValue instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any);\n            case BAG_ATTRIBUTES:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.bagId || BAG_ID) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ name: (names.bagValue || BAG_VALUE) })]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n                    optional: true,\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.bagAttributes || BAG_ATTRIBUTES),\n                            value: Attribute.schema()\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$I);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, SafeBag.schema({\n            names: {\n                bagId: BAG_ID,\n                bagValue: BAG_VALUE,\n                bagAttributes: BAG_ATTRIBUTES\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.bagId = asn1.result.bagId.valueBlock.toString();\n        const bagType = SafeBagValueFactory.find(this.bagId);\n        if (!bagType) {\n            throw new Error(`Invalid BAG_ID for SafeBag: ${this.bagId}`);\n        }\n        this.bagValue = new bagType({ schema: asn1.result.bagValue });\n        if (BAG_ATTRIBUTES in asn1.result) {\n            this.bagAttributes = Array.from(asn1.result.bagAttributes, element => new Attribute({ schema: element }));\n        }\n    }\n    toSchema() {\n        const outputArray = [\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.bagId }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [this.bagValue.toSchema()]\n            })\n        ];\n        if (this.bagAttributes) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n                value: Array.from(this.bagAttributes, o => o.toSchema())\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const output = {\n            bagId: this.bagId,\n            bagValue: this.bagValue.toJSON()\n        };\n        if (this.bagAttributes) {\n            output.bagAttributes = Array.from(this.bagAttributes, o => o.toJSON());\n        }\n        return output;\n    }\n}\nSafeBag.CLASS_NAME = \"SafeBag\";\n\nconst SAFE_BUGS = \"safeBags\";\nclass SafeContents extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.safeBags = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SAFE_BUGS, SafeContents.defaultValues(SAFE_BUGS));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case SAFE_BUGS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case SAFE_BUGS:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.safeBags || EMPTY_STRING),\n                    value: SafeBag.schema()\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, [\n            SAFE_BUGS\n        ]);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, SafeContents.schema({\n            names: {\n                safeBags: SAFE_BUGS\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.safeBags = Array.from(asn1.result.safeBags, element => new SafeBag({ schema: element }));\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.safeBags, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        return {\n            safeBags: Array.from(this.safeBags, o => o.toJSON())\n        };\n    }\n}\nSafeContents.CLASS_NAME = \"SafeContents\";\n\nconst OTHER_CERT_FORMAT = \"otherCertFormat\";\nconst OTHER_CERT = \"otherCert\";\nconst CLEAR_PROPS$H = [\n    OTHER_CERT_FORMAT,\n    OTHER_CERT\n];\nclass OtherCertificateFormat extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.otherCertFormat = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OTHER_CERT_FORMAT, OtherCertificateFormat.defaultValues(OTHER_CERT_FORMAT));\n        this.otherCert = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OTHER_CERT, OtherCertificateFormat.defaultValues(OTHER_CERT));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case OTHER_CERT_FORMAT:\n                return EMPTY_STRING;\n            case OTHER_CERT:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.otherCertFormat || OTHER_CERT_FORMAT) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ name: (names.otherCert || OTHER_CERT) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$H);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, OtherCertificateFormat.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.otherCertFormat = asn1.result.otherCertFormat.valueBlock.toString();\n        this.otherCert = asn1.result.otherCert;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.otherCertFormat }),\n                this.otherCert\n            ]\n        }));\n    }\n    toJSON() {\n        const res = {\n            otherCertFormat: this.otherCertFormat\n        };\n        if (!(this.otherCert instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any)) {\n            res.otherCert = this.otherCert.toJSON();\n        }\n        return res;\n    }\n}\n\nconst CERTIFICATES$1 = \"certificates\";\nconst CLEAR_PROPS$G = [\n    CERTIFICATES$1,\n];\nclass CertificateSet extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.certificates = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CERTIFICATES$1, CertificateSet.defaultValues(CERTIFICATES$1));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case CERTIFICATES$1:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.certificates || CERTIFICATES$1),\n                    value: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                        value: [\n                            Certificate.schema(),\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                                idBlock: {\n                                    tagClass: 3,\n                                    tagNumber: 0\n                                },\n                                value: [\n                                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any()\n                                ]\n                            }),\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                                idBlock: {\n                                    tagClass: 3,\n                                    tagNumber: 1\n                                },\n                                value: [\n                                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence\n                                ]\n                            }),\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                                idBlock: {\n                                    tagClass: 3,\n                                    tagNumber: 2\n                                },\n                                value: AttributeCertificateV2.schema().valueBlock.value\n                            }),\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                                idBlock: {\n                                    tagClass: 3,\n                                    tagNumber: 3\n                                },\n                                value: OtherCertificateFormat.schema().valueBlock.value\n                            })\n                        ]\n                    })\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$G);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, CertificateSet.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.certificates = Array.from(asn1.result.certificates || [], (element) => {\n            const initialTagNumber = element.idBlock.tagNumber;\n            if (element.idBlock.tagClass === 1)\n                return new Certificate({ schema: element });\n            const elementSequence = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                value: element.valueBlock.value\n            });\n            switch (initialTagNumber) {\n                case 1:\n                    if (elementSequence.valueBlock.value[0].valueBlock.value[0].valueBlock.valueDec === 1) {\n                        return new AttributeCertificateV2({ schema: elementSequence });\n                    }\n                    else {\n                        return new AttributeCertificateV1({ schema: elementSequence });\n                    }\n                case 2:\n                    return new AttributeCertificateV2({ schema: elementSequence });\n                case 3:\n                    return new OtherCertificateFormat({ schema: elementSequence });\n            }\n            return element;\n        });\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n            value: Array.from(this.certificates, element => {\n                switch (true) {\n                    case (element instanceof Certificate):\n                        return element.toSchema();\n                    case (element instanceof AttributeCertificateV1):\n                        return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 1\n                            },\n                            value: element.toSchema().valueBlock.value\n                        });\n                    case (element instanceof AttributeCertificateV2):\n                        return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 2\n                            },\n                            value: element.toSchema().valueBlock.value\n                        });\n                    case (element instanceof OtherCertificateFormat):\n                        return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 3\n                            },\n                            value: element.toSchema().valueBlock.value\n                        });\n                }\n                return element.toSchema();\n            })\n        }));\n    }\n    toJSON() {\n        return {\n            certificates: Array.from(this.certificates, o => o.toJSON())\n        };\n    }\n}\nCertificateSet.CLASS_NAME = \"CertificateSet\";\n\nconst OTHER_REV_INFO_FORMAT = \"otherRevInfoFormat\";\nconst OTHER_REV_INFO = \"otherRevInfo\";\nconst CLEAR_PROPS$F = [\n    OTHER_REV_INFO_FORMAT,\n    OTHER_REV_INFO\n];\nclass OtherRevocationInfoFormat extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.otherRevInfoFormat = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OTHER_REV_INFO_FORMAT, OtherRevocationInfoFormat.defaultValues(OTHER_REV_INFO_FORMAT));\n        this.otherRevInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OTHER_REV_INFO, OtherRevocationInfoFormat.defaultValues(OTHER_REV_INFO));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case OTHER_REV_INFO_FORMAT:\n                return EMPTY_STRING;\n            case OTHER_REV_INFO:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.otherRevInfoFormat || OTHER_REV_INFO_FORMAT) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ name: (names.otherRevInfo || OTHER_REV_INFO) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$F);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, OtherRevocationInfoFormat.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.otherRevInfoFormat = asn1.result.otherRevInfoFormat.valueBlock.toString();\n        this.otherRevInfo = asn1.result.otherRevInfo;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.otherRevInfoFormat }),\n                this.otherRevInfo\n            ]\n        }));\n    }\n    toJSON() {\n        const res = {\n            otherRevInfoFormat: this.otherRevInfoFormat\n        };\n        if (!(this.otherRevInfo instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any)) {\n            res.otherRevInfo = this.otherRevInfo.toJSON();\n        }\n        return res;\n    }\n}\nOtherRevocationInfoFormat.CLASS_NAME = \"OtherRevocationInfoFormat\";\n\nconst CRLS$3 = \"crls\";\nconst OTHER_REVOCATION_INFOS = \"otherRevocationInfos\";\nconst CLEAR_PROPS$E = [\n    CRLS$3\n];\nclass RevocationInfoChoices extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.crls = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CRLS$3, RevocationInfoChoices.defaultValues(CRLS$3));\n        this.otherRevocationInfos = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OTHER_REVOCATION_INFOS, RevocationInfoChoices.defaultValues(OTHER_REVOCATION_INFOS));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case CRLS$3:\n                return [];\n            case OTHER_REVOCATION_INFOS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.crls || EMPTY_STRING),\n                    value: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                        value: [\n                            CertificateRevocationList.schema(),\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                                idBlock: {\n                                    tagClass: 3,\n                                    tagNumber: 1\n                                },\n                                value: [\n                                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier(),\n                                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any()\n                                ]\n                            })\n                        ]\n                    })\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$E);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, RevocationInfoChoices.schema({\n            names: {\n                crls: CRLS$3\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (asn1.result.crls) {\n            for (const element of asn1.result.crls) {\n                if (element.idBlock.tagClass === 1)\n                    this.crls.push(new CertificateRevocationList({ schema: element }));\n                else\n                    this.otherRevocationInfos.push(new OtherRevocationInfoFormat({ schema: element }));\n            }\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(...Array.from(this.crls, o => o.toSchema()));\n        outputArray.push(...Array.from(this.otherRevocationInfos, element => {\n            const schema = element.toSchema();\n            schema.idBlock.tagClass = 3;\n            schema.idBlock.tagNumber = 1;\n            return schema;\n        }));\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        return {\n            crls: Array.from(this.crls, o => o.toJSON()),\n            otherRevocationInfos: Array.from(this.otherRevocationInfos, o => o.toJSON())\n        };\n    }\n}\nRevocationInfoChoices.CLASS_NAME = \"RevocationInfoChoices\";\n\nconst CERTS$3 = \"certs\";\nconst CRLS$2 = \"crls\";\nconst CLEAR_PROPS$D = [\n    CERTS$3,\n    CRLS$2,\n];\nclass OriginatorInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.crls = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CRLS$2, OriginatorInfo.defaultValues(CRLS$2));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case CERTS$3:\n                return new CertificateSet();\n            case CRLS$2:\n                return new RevocationInfoChoices();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case CERTS$3:\n                return (memberValue.certificates.length === 0);\n            case CRLS$2:\n                return ((memberValue.crls.length === 0) && (memberValue.otherRevocationInfos.length === 0));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.certs || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: CertificateSet.schema().valueBlock.value\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.crls || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: RevocationInfoChoices.schema().valueBlock.value\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$D);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, OriginatorInfo.schema({\n            names: {\n                certs: CERTS$3,\n                crls: CRLS$2\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (CERTS$3 in asn1.result) {\n            this.certs = new CertificateSet({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n                    value: asn1.result.certs.valueBlock.value\n                })\n            });\n        }\n        if (CRLS$2 in asn1.result) {\n            this.crls = new RevocationInfoChoices({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n                    value: asn1.result.crls.valueBlock.value\n                })\n            });\n        }\n    }\n    toSchema() {\n        const sequenceValue = [];\n        if (this.certs) {\n            sequenceValue.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: this.certs.toSchema().valueBlock.value\n            }));\n        }\n        if (this.crls) {\n            sequenceValue.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: this.crls.toSchema().valueBlock.value\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: sequenceValue\n        }));\n    }\n    toJSON() {\n        const res = {};\n        if (this.certs) {\n            res.certs = this.certs.toJSON();\n        }\n        if (this.crls) {\n            res.crls = this.crls.toJSON();\n        }\n        return res;\n    }\n}\nOriginatorInfo.CLASS_NAME = \"OriginatorInfo\";\n\nconst ISSUER = \"issuer\";\nconst SERIAL_NUMBER$2 = \"serialNumber\";\nconst CLEAR_PROPS$C = [\n    ISSUER,\n    SERIAL_NUMBER$2,\n];\nclass IssuerAndSerialNumber extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.issuer = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER, IssuerAndSerialNumber.defaultValues(ISSUER));\n        this.serialNumber = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SERIAL_NUMBER$2, IssuerAndSerialNumber.defaultValues(SERIAL_NUMBER$2));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ISSUER:\n                return new RelativeDistinguishedNames();\n            case SERIAL_NUMBER$2:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                RelativeDistinguishedNames.schema(names.issuer || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.serialNumber || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$C);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, IssuerAndSerialNumber.schema({\n            names: {\n                issuer: {\n                    names: {\n                        blockName: ISSUER\n                    }\n                },\n                serialNumber: SERIAL_NUMBER$2\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.issuer = new RelativeDistinguishedNames({ schema: asn1.result.issuer });\n        this.serialNumber = asn1.result.serialNumber;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.issuer.toSchema(),\n                this.serialNumber\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            issuer: this.issuer.toJSON(),\n            serialNumber: this.serialNumber.toJSON(),\n        };\n    }\n}\nIssuerAndSerialNumber.CLASS_NAME = \"IssuerAndSerialNumber\";\n\nconst VARIANT$3 = \"variant\";\nconst VALUE$3 = \"value\";\nconst CLEAR_PROPS$B = [\n    \"blockName\"\n];\nclass RecipientIdentifier extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.variant = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VARIANT$3, RecipientIdentifier.defaultValues(VARIANT$3));\n        if (VALUE$3 in parameters) {\n            this.value = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VALUE$3, RecipientIdentifier.defaultValues(VALUE$3));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VARIANT$3:\n                return (-1);\n            case VALUE$3:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VARIANT$3:\n                return (memberValue === (-1));\n            case VALUE$3:\n                return (Object.keys(memberValue).length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n            value: [\n                IssuerAndSerialNumber.schema({\n                    names: {\n                        blockName: (names.blockName || EMPTY_STRING)\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.blockName || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    }\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$B);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, RecipientIdentifier.schema({\n            names: {\n                blockName: \"blockName\"\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (asn1.result.blockName.idBlock.tagClass === 1) {\n            this.variant = 1;\n            this.value = new IssuerAndSerialNumber({ schema: asn1.result.blockName });\n        }\n        else {\n            this.variant = 2;\n            this.value = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: asn1.result.blockName.valueBlock.valueHex });\n        }\n    }\n    toSchema() {\n        switch (this.variant) {\n            case 1:\n                if (!(this.value instanceof IssuerAndSerialNumber)) {\n                    throw new Error(\"Incorrect type of RecipientIdentifier.value. It should be IssuerAndSerialNumber.\");\n                }\n                return this.value.toSchema();\n            case 2:\n                if (!(this.value instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString)) {\n                    throw new Error(\"Incorrect type of RecipientIdentifier.value. It should be ASN.1 OctetString.\");\n                }\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    valueHex: this.value.valueBlock.valueHexView\n                });\n            default:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any();\n        }\n    }\n    toJSON() {\n        const res = {\n            variant: this.variant\n        };\n        if ((this.variant === 1 || this.variant === 2) && this.value) {\n            res.value = this.value.toJSON();\n        }\n        return res;\n    }\n}\nRecipientIdentifier.CLASS_NAME = \"RecipientIdentifier\";\n\nconst VERSION$c = \"version\";\nconst RID$1 = \"rid\";\nconst KEY_ENCRYPTION_ALGORITHM$3 = \"keyEncryptionAlgorithm\";\nconst ENCRYPTED_KEY$3 = \"encryptedKey\";\nconst RECIPIENT_CERTIFICATE$1 = \"recipientCertificate\";\nconst CLEAR_PROPS$A = [\n    VERSION$c,\n    RID$1,\n    KEY_ENCRYPTION_ALGORITHM$3,\n    ENCRYPTED_KEY$3,\n];\nclass KeyTransRecipientInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$c, KeyTransRecipientInfo.defaultValues(VERSION$c));\n        this.rid = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RID$1, KeyTransRecipientInfo.defaultValues(RID$1));\n        this.keyEncryptionAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_ENCRYPTION_ALGORITHM$3, KeyTransRecipientInfo.defaultValues(KEY_ENCRYPTION_ALGORITHM$3));\n        this.encryptedKey = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENCRYPTED_KEY$3, KeyTransRecipientInfo.defaultValues(ENCRYPTED_KEY$3));\n        this.recipientCertificate = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RECIPIENT_CERTIFICATE$1, KeyTransRecipientInfo.defaultValues(RECIPIENT_CERTIFICATE$1));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$c:\n                return (-1);\n            case RID$1:\n                return {};\n            case KEY_ENCRYPTION_ALGORITHM$3:\n                return new AlgorithmIdentifier();\n            case ENCRYPTED_KEY$3:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case RECIPIENT_CERTIFICATE$1:\n                return new Certificate();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VERSION$c:\n                return (memberValue === KeyTransRecipientInfo.defaultValues(VERSION$c));\n            case RID$1:\n                return (Object.keys(memberValue).length === 0);\n            case KEY_ENCRYPTION_ALGORITHM$3:\n            case ENCRYPTED_KEY$3:\n                return memberValue.isEqual(KeyTransRecipientInfo.defaultValues(memberName));\n            case RECIPIENT_CERTIFICATE$1:\n                return false;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || EMPTY_STRING) }),\n                RecipientIdentifier.schema(names.rid || {}),\n                AlgorithmIdentifier.schema(names.keyEncryptionAlgorithm || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.encryptedKey || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$A);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, KeyTransRecipientInfo.schema({\n            names: {\n                version: VERSION$c,\n                rid: {\n                    names: {\n                        blockName: RID$1\n                    }\n                },\n                keyEncryptionAlgorithm: {\n                    names: {\n                        blockName: KEY_ENCRYPTION_ALGORITHM$3\n                    }\n                },\n                encryptedKey: ENCRYPTED_KEY$3\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result.version.valueBlock.valueDec;\n        if (asn1.result.rid.idBlock.tagClass === 3) {\n            this.rid = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: asn1.result.rid.valueBlock.valueHex });\n        }\n        else {\n            this.rid = new IssuerAndSerialNumber({ schema: asn1.result.rid });\n        }\n        this.keyEncryptionAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.keyEncryptionAlgorithm });\n        this.encryptedKey = asn1.result.encryptedKey;\n    }\n    toSchema() {\n        const outputArray = [];\n        if (this.rid instanceof IssuerAndSerialNumber) {\n            this.version = 0;\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }));\n            outputArray.push(this.rid.toSchema());\n        }\n        else {\n            this.version = 2;\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }));\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                valueHex: this.rid.valueBlock.valueHexView\n            }));\n        }\n        outputArray.push(this.keyEncryptionAlgorithm.toSchema());\n        outputArray.push(this.encryptedKey);\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        return {\n            version: this.version,\n            rid: this.rid.toJSON(),\n            keyEncryptionAlgorithm: this.keyEncryptionAlgorithm.toJSON(),\n            encryptedKey: this.encryptedKey.toJSON(),\n        };\n    }\n}\nKeyTransRecipientInfo.CLASS_NAME = \"KeyTransRecipientInfo\";\n\nconst ALGORITHM = \"algorithm\";\nconst PUBLIC_KEY = \"publicKey\";\nconst CLEAR_PROPS$z = [\n    ALGORITHM,\n    PUBLIC_KEY\n];\nclass OriginatorPublicKey extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.algorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ALGORITHM, OriginatorPublicKey.defaultValues(ALGORITHM));\n        this.publicKey = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PUBLIC_KEY, OriginatorPublicKey.defaultValues(PUBLIC_KEY));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ALGORITHM:\n                return new AlgorithmIdentifier();\n            case PUBLIC_KEY:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case ALGORITHM:\n            case PUBLIC_KEY:\n                return (memberValue.isEqual(OriginatorPublicKey.defaultValues(memberName)));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                AlgorithmIdentifier.schema(names.algorithm || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ name: (names.publicKey || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$z);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, OriginatorPublicKey.schema({\n            names: {\n                algorithm: {\n                    names: {\n                        blockName: ALGORITHM\n                    }\n                },\n                publicKey: PUBLIC_KEY\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.algorithm = new AlgorithmIdentifier({ schema: asn1.result.algorithm });\n        this.publicKey = asn1.result.publicKey;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.algorithm.toSchema(),\n                this.publicKey\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            algorithm: this.algorithm.toJSON(),\n            publicKey: this.publicKey.toJSON(),\n        };\n    }\n}\nOriginatorPublicKey.CLASS_NAME = \"OriginatorPublicKey\";\n\nconst VARIANT$2 = \"variant\";\nconst VALUE$2 = \"value\";\nconst CLEAR_PROPS$y = [\n    \"blockName\",\n];\nclass OriginatorIdentifierOrKey extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.variant = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VARIANT$2, OriginatorIdentifierOrKey.defaultValues(VARIANT$2));\n        if (VALUE$2 in parameters) {\n            this.value = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VALUE$2, OriginatorIdentifierOrKey.defaultValues(VALUE$2));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VARIANT$2:\n                return (-1);\n            case VALUE$2:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VARIANT$2:\n                return (memberValue === (-1));\n            case VALUE$2:\n                return (Object.keys(memberValue).length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n            value: [\n                IssuerAndSerialNumber.schema({\n                    names: {\n                        blockName: (names.blockName || EMPTY_STRING)\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    name: (names.blockName || EMPTY_STRING)\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    name: (names.blockName || EMPTY_STRING),\n                    value: OriginatorPublicKey.schema().valueBlock.value\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$y);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, OriginatorIdentifierOrKey.schema({\n            names: {\n                blockName: \"blockName\"\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (asn1.result.blockName.idBlock.tagClass === 1) {\n            this.variant = 1;\n            this.value = new IssuerAndSerialNumber({ schema: asn1.result.blockName });\n        }\n        else {\n            if (asn1.result.blockName.idBlock.tagNumber === 0) {\n                asn1.result.blockName.idBlock.tagClass = 1;\n                asn1.result.blockName.idBlock.tagNumber = 4;\n                this.variant = 2;\n                this.value = asn1.result.blockName;\n            }\n            else {\n                this.variant = 3;\n                this.value = new OriginatorPublicKey({\n                    schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                        value: asn1.result.blockName.valueBlock.value\n                    })\n                });\n            }\n        }\n    }\n    toSchema() {\n        switch (this.variant) {\n            case 1:\n                return this.value.toSchema();\n            case 2:\n                this.value.idBlock.tagClass = 3;\n                this.value.idBlock.tagNumber = 0;\n                return this.value;\n            case 3:\n                {\n                    const _schema = this.value.toSchema();\n                    _schema.idBlock.tagClass = 3;\n                    _schema.idBlock.tagNumber = 1;\n                    return _schema;\n                }\n            default:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any();\n        }\n    }\n    toJSON() {\n        const res = {\n            variant: this.variant\n        };\n        if ((this.variant === 1) || (this.variant === 2) || (this.variant === 3)) {\n            res.value = this.value.toJSON();\n        }\n        return res;\n    }\n}\nOriginatorIdentifierOrKey.CLASS_NAME = \"OriginatorIdentifierOrKey\";\n\nconst KEY_ATTR_ID = \"keyAttrId\";\nconst KEY_ATTR = \"keyAttr\";\nconst CLEAR_PROPS$x = [\n    KEY_ATTR_ID,\n    KEY_ATTR,\n];\nclass OtherKeyAttribute extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.keyAttrId = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_ATTR_ID, OtherKeyAttribute.defaultValues(KEY_ATTR_ID));\n        if (KEY_ATTR in parameters) {\n            this.keyAttr = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_ATTR, OtherKeyAttribute.defaultValues(KEY_ATTR));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case KEY_ATTR_ID:\n                return EMPTY_STRING;\n            case KEY_ATTR:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case KEY_ATTR_ID:\n                return (typeof memberValue === \"string\" && memberValue === EMPTY_STRING);\n            case KEY_ATTR:\n                return (Object.keys(memberValue).length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            optional: (names.optional || true),\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.keyAttrId || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({\n                    optional: true,\n                    name: (names.keyAttr || EMPTY_STRING)\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$x);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, OtherKeyAttribute.schema({\n            names: {\n                keyAttrId: KEY_ATTR_ID,\n                keyAttr: KEY_ATTR\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.keyAttrId = asn1.result.keyAttrId.valueBlock.toString();\n        if (KEY_ATTR in asn1.result) {\n            this.keyAttr = asn1.result.keyAttr;\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.keyAttrId }));\n        if (KEY_ATTR in this) {\n            outputArray.push(this.keyAttr);\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray,\n        }));\n    }\n    toJSON() {\n        const res = {\n            keyAttrId: this.keyAttrId\n        };\n        if (KEY_ATTR in this) {\n            res.keyAttr = this.keyAttr.toJSON();\n        }\n        return res;\n    }\n}\nOtherKeyAttribute.CLASS_NAME = \"OtherKeyAttribute\";\n\nconst SUBJECT_KEY_IDENTIFIER = \"subjectKeyIdentifier\";\nconst DATE$1 = \"date\";\nconst OTHER$1 = \"other\";\nconst CLEAR_PROPS$w = [\n    SUBJECT_KEY_IDENTIFIER,\n    DATE$1,\n    OTHER$1,\n];\nclass RecipientKeyIdentifier extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.subjectKeyIdentifier = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SUBJECT_KEY_IDENTIFIER, RecipientKeyIdentifier.defaultValues(SUBJECT_KEY_IDENTIFIER));\n        if (DATE$1 in parameters) {\n            this.date = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, DATE$1, RecipientKeyIdentifier.defaultValues(DATE$1));\n        }\n        if (OTHER$1 in parameters) {\n            this.other = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OTHER$1, RecipientKeyIdentifier.defaultValues(OTHER$1));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case SUBJECT_KEY_IDENTIFIER:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case DATE$1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime();\n            case OTHER$1:\n                return new OtherKeyAttribute();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case SUBJECT_KEY_IDENTIFIER:\n                return (memberValue.isEqual(RecipientKeyIdentifier.defaultValues(SUBJECT_KEY_IDENTIFIER)));\n            case DATE$1:\n                return ((memberValue.year === 0) &&\n                    (memberValue.month === 0) &&\n                    (memberValue.day === 0) &&\n                    (memberValue.hour === 0) &&\n                    (memberValue.minute === 0) &&\n                    (memberValue.second === 0) &&\n                    (memberValue.millisecond === 0));\n            case OTHER$1:\n                return ((memberValue.keyAttrId === EMPTY_STRING) && ((\"keyAttr\" in memberValue) === false));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.subjectKeyIdentifier || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({\n                    optional: true,\n                    name: (names.date || EMPTY_STRING)\n                }),\n                OtherKeyAttribute.schema(names.other || {})\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$w);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, RecipientKeyIdentifier.schema({\n            names: {\n                subjectKeyIdentifier: SUBJECT_KEY_IDENTIFIER,\n                date: DATE$1,\n                other: {\n                    names: {\n                        blockName: OTHER$1\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.subjectKeyIdentifier = asn1.result.subjectKeyIdentifier;\n        if (DATE$1 in asn1.result)\n            this.date = asn1.result.date;\n        if (OTHER$1 in asn1.result)\n            this.other = new OtherKeyAttribute({ schema: asn1.result.other });\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(this.subjectKeyIdentifier);\n        if (this.date) {\n            outputArray.push(this.date);\n        }\n        if (this.other) {\n            outputArray.push(this.other.toSchema());\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            subjectKeyIdentifier: this.subjectKeyIdentifier.toJSON()\n        };\n        if (this.date) {\n            res.date = this.date.toJSON();\n        }\n        if (this.other) {\n            res.other = this.other.toJSON();\n        }\n        return res;\n    }\n}\nRecipientKeyIdentifier.CLASS_NAME = \"RecipientKeyIdentifier\";\n\nconst VARIANT$1 = \"variant\";\nconst VALUE$1 = \"value\";\nconst CLEAR_PROPS$v = [\n    \"blockName\",\n];\nclass KeyAgreeRecipientIdentifier extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.variant = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VARIANT$1, KeyAgreeRecipientIdentifier.defaultValues(VARIANT$1));\n        this.value = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VALUE$1, KeyAgreeRecipientIdentifier.defaultValues(VALUE$1));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VARIANT$1:\n                return (-1);\n            case VALUE$1:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VARIANT$1:\n                return (memberValue === (-1));\n            case VALUE$1:\n                return (Object.keys(memberValue).length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n            value: [\n                IssuerAndSerialNumber.schema(names.issuerAndSerialNumber || {\n                    names: {\n                        blockName: (names.blockName || EMPTY_STRING)\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.blockName || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: RecipientKeyIdentifier.schema(names.rKeyId || {\n                        names: {\n                            blockName: (names.blockName || EMPTY_STRING)\n                        }\n                    }).valueBlock.value\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$v);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, KeyAgreeRecipientIdentifier.schema({\n            names: {\n                blockName: \"blockName\"\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (asn1.result.blockName.idBlock.tagClass === 1) {\n            this.variant = 1;\n            this.value = new IssuerAndSerialNumber({ schema: asn1.result.blockName });\n        }\n        else {\n            this.variant = 2;\n            this.value = new RecipientKeyIdentifier({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    value: asn1.result.blockName.valueBlock.value\n                })\n            });\n        }\n    }\n    toSchema() {\n        switch (this.variant) {\n            case 1:\n                return this.value.toSchema();\n            case 2:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: this.value.toSchema().valueBlock.value\n                });\n            default:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any();\n        }\n    }\n    toJSON() {\n        const res = {\n            variant: this.variant,\n        };\n        if ((this.variant === 1) || (this.variant === 2)) {\n            res.value = this.value.toJSON();\n        }\n        return res;\n    }\n}\nKeyAgreeRecipientIdentifier.CLASS_NAME = \"KeyAgreeRecipientIdentifier\";\n\nconst RID = \"rid\";\nconst ENCRYPTED_KEY$2 = \"encryptedKey\";\nconst CLEAR_PROPS$u = [\n    RID,\n    ENCRYPTED_KEY$2,\n];\nclass RecipientEncryptedKey extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.rid = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RID, RecipientEncryptedKey.defaultValues(RID));\n        this.encryptedKey = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENCRYPTED_KEY$2, RecipientEncryptedKey.defaultValues(ENCRYPTED_KEY$2));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case RID:\n                return new KeyAgreeRecipientIdentifier();\n            case ENCRYPTED_KEY$2:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case RID:\n                return ((memberValue.variant === (-1)) && ((\"value\" in memberValue) === false));\n            case ENCRYPTED_KEY$2:\n                return (memberValue.isEqual(RecipientEncryptedKey.defaultValues(ENCRYPTED_KEY$2)));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                KeyAgreeRecipientIdentifier.schema(names.rid || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.encryptedKey || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$u);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, RecipientEncryptedKey.schema({\n            names: {\n                rid: {\n                    names: {\n                        blockName: RID\n                    }\n                },\n                encryptedKey: ENCRYPTED_KEY$2\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.rid = new KeyAgreeRecipientIdentifier({ schema: asn1.result.rid });\n        this.encryptedKey = asn1.result.encryptedKey;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.rid.toSchema(),\n                this.encryptedKey\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            rid: this.rid.toJSON(),\n            encryptedKey: this.encryptedKey.toJSON(),\n        };\n    }\n}\nRecipientEncryptedKey.CLASS_NAME = \"RecipientEncryptedKey\";\n\nconst ENCRYPTED_KEYS = \"encryptedKeys\";\nconst RECIPIENT_ENCRYPTED_KEYS = \"RecipientEncryptedKeys\";\nconst CLEAR_PROPS$t = [\n    RECIPIENT_ENCRYPTED_KEYS,\n];\nclass RecipientEncryptedKeys extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.encryptedKeys = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENCRYPTED_KEYS, RecipientEncryptedKeys.defaultValues(ENCRYPTED_KEYS));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ENCRYPTED_KEYS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case ENCRYPTED_KEYS:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.RecipientEncryptedKeys || EMPTY_STRING),\n                    value: RecipientEncryptedKey.schema()\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$t);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, RecipientEncryptedKeys.schema({\n            names: {\n                RecipientEncryptedKeys: RECIPIENT_ENCRYPTED_KEYS\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.encryptedKeys = Array.from(asn1.result.RecipientEncryptedKeys, element => new RecipientEncryptedKey({ schema: element }));\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.encryptedKeys, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        return {\n            encryptedKeys: Array.from(this.encryptedKeys, o => o.toJSON())\n        };\n    }\n}\nRecipientEncryptedKeys.CLASS_NAME = \"RecipientEncryptedKeys\";\n\nconst VERSION$b = \"version\";\nconst ORIGINATOR = \"originator\";\nconst UKM = \"ukm\";\nconst KEY_ENCRYPTION_ALGORITHM$2 = \"keyEncryptionAlgorithm\";\nconst RECIPIENT_ENCRYPTED_KEY = \"recipientEncryptedKeys\";\nconst RECIPIENT_CERTIFICATE = \"recipientCertificate\";\nconst RECIPIENT_PUBLIC_KEY = \"recipientPublicKey\";\nconst CLEAR_PROPS$s = [\n    VERSION$b,\n    ORIGINATOR,\n    UKM,\n    KEY_ENCRYPTION_ALGORITHM$2,\n    RECIPIENT_ENCRYPTED_KEY,\n];\nclass KeyAgreeRecipientInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$b, KeyAgreeRecipientInfo.defaultValues(VERSION$b));\n        this.originator = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ORIGINATOR, KeyAgreeRecipientInfo.defaultValues(ORIGINATOR));\n        if (UKM in parameters) {\n            this.ukm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, UKM, KeyAgreeRecipientInfo.defaultValues(UKM));\n        }\n        this.keyEncryptionAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_ENCRYPTION_ALGORITHM$2, KeyAgreeRecipientInfo.defaultValues(KEY_ENCRYPTION_ALGORITHM$2));\n        this.recipientEncryptedKeys = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RECIPIENT_ENCRYPTED_KEY, KeyAgreeRecipientInfo.defaultValues(RECIPIENT_ENCRYPTED_KEY));\n        this.recipientCertificate = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RECIPIENT_CERTIFICATE, KeyAgreeRecipientInfo.defaultValues(RECIPIENT_CERTIFICATE));\n        this.recipientPublicKey = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RECIPIENT_PUBLIC_KEY, KeyAgreeRecipientInfo.defaultValues(RECIPIENT_PUBLIC_KEY));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$b:\n                return 0;\n            case ORIGINATOR:\n                return new OriginatorIdentifierOrKey();\n            case UKM:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case KEY_ENCRYPTION_ALGORITHM$2:\n                return new AlgorithmIdentifier();\n            case RECIPIENT_ENCRYPTED_KEY:\n                return new RecipientEncryptedKeys();\n            case RECIPIENT_CERTIFICATE:\n                return new Certificate();\n            case RECIPIENT_PUBLIC_KEY:\n                return null;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VERSION$b:\n                return (memberValue === 0);\n            case ORIGINATOR:\n                return ((memberValue.variant === (-1)) && ((\"value\" in memberValue) === false));\n            case UKM:\n                return (memberValue.isEqual(KeyAgreeRecipientInfo.defaultValues(UKM)));\n            case KEY_ENCRYPTION_ALGORITHM$2:\n                return ((memberValue.algorithmId === EMPTY_STRING) && ((\"algorithmParams\" in memberValue) === false));\n            case RECIPIENT_ENCRYPTED_KEY:\n                return (memberValue.encryptedKeys.length === 0);\n            case RECIPIENT_CERTIFICATE:\n                return false;\n            case RECIPIENT_PUBLIC_KEY:\n                return false;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: names.blockName || EMPTY_STRING,\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: names.version || EMPTY_STRING }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [\n                        OriginatorIdentifierOrKey.schema(names.originator || {})\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: names.ukm || EMPTY_STRING })]\n                }),\n                AlgorithmIdentifier.schema(names.keyEncryptionAlgorithm || {}),\n                RecipientEncryptedKeys.schema(names.recipientEncryptedKeys || {})\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$s);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, KeyAgreeRecipientInfo.schema({\n            names: {\n                version: VERSION$b,\n                originator: {\n                    names: {\n                        blockName: ORIGINATOR\n                    }\n                },\n                ukm: UKM,\n                keyEncryptionAlgorithm: {\n                    names: {\n                        blockName: KEY_ENCRYPTION_ALGORITHM$2\n                    }\n                },\n                recipientEncryptedKeys: {\n                    names: {\n                        blockName: RECIPIENT_ENCRYPTED_KEY\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result.version.valueBlock.valueDec;\n        this.originator = new OriginatorIdentifierOrKey({ schema: asn1.result.originator });\n        if (UKM in asn1.result)\n            this.ukm = asn1.result.ukm;\n        this.keyEncryptionAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.keyEncryptionAlgorithm });\n        this.recipientEncryptedKeys = new RecipientEncryptedKeys({ schema: asn1.result.recipientEncryptedKeys });\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }));\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n            idBlock: {\n                tagClass: 3,\n                tagNumber: 0\n            },\n            value: [this.originator.toSchema()]\n        }));\n        if (this.ukm) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: [this.ukm]\n            }));\n        }\n        outputArray.push(this.keyEncryptionAlgorithm.toSchema());\n        outputArray.push(this.recipientEncryptedKeys.toSchema());\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            version: this.version,\n            originator: this.originator.toJSON(),\n            keyEncryptionAlgorithm: this.keyEncryptionAlgorithm.toJSON(),\n            recipientEncryptedKeys: this.recipientEncryptedKeys.toJSON(),\n        };\n        if (this.ukm) {\n            res.ukm = this.ukm.toJSON();\n        }\n        return res;\n    }\n}\nKeyAgreeRecipientInfo.CLASS_NAME = \"KeyAgreeRecipientInfo\";\n\nconst KEY_IDENTIFIER = \"keyIdentifier\";\nconst DATE = \"date\";\nconst OTHER = \"other\";\nconst CLEAR_PROPS$r = [\n    KEY_IDENTIFIER,\n    DATE,\n    OTHER,\n];\nclass KEKIdentifier extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.keyIdentifier = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_IDENTIFIER, KEKIdentifier.defaultValues(KEY_IDENTIFIER));\n        if (DATE in parameters) {\n            this.date = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, DATE, KEKIdentifier.defaultValues(DATE));\n        }\n        if (OTHER in parameters) {\n            this.other = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OTHER, KEKIdentifier.defaultValues(OTHER));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case KEY_IDENTIFIER:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case DATE:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime();\n            case OTHER:\n                return new OtherKeyAttribute();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case KEY_IDENTIFIER:\n                return (memberValue.isEqual(KEKIdentifier.defaultValues(KEY_IDENTIFIER)));\n            case DATE:\n                return ((memberValue.year === 0) &&\n                    (memberValue.month === 0) &&\n                    (memberValue.day === 0) &&\n                    (memberValue.hour === 0) &&\n                    (memberValue.minute === 0) &&\n                    (memberValue.second === 0) &&\n                    (memberValue.millisecond === 0));\n            case OTHER:\n                return ((memberValue.compareWithDefault(\"keyAttrId\", memberValue.keyAttrId)) &&\n                    ((\"keyAttr\" in memberValue) === false));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.keyIdentifier || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({\n                    optional: true,\n                    name: (names.date || EMPTY_STRING)\n                }),\n                OtherKeyAttribute.schema(names.other || {})\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$r);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, KEKIdentifier.schema({\n            names: {\n                keyIdentifier: KEY_IDENTIFIER,\n                date: DATE,\n                other: {\n                    names: {\n                        blockName: OTHER\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.keyIdentifier = asn1.result.keyIdentifier;\n        if (DATE in asn1.result)\n            this.date = asn1.result.date;\n        if (OTHER in asn1.result)\n            this.other = new OtherKeyAttribute({ schema: asn1.result.other });\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(this.keyIdentifier);\n        if (this.date) {\n            outputArray.push(this.date);\n        }\n        if (this.other) {\n            outputArray.push(this.other.toSchema());\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            keyIdentifier: this.keyIdentifier.toJSON()\n        };\n        if (this.date) {\n            res.date = this.date;\n        }\n        if (this.other) {\n            res.other = this.other.toJSON();\n        }\n        return res;\n    }\n}\nKEKIdentifier.CLASS_NAME = \"KEKIdentifier\";\n\nconst VERSION$a = \"version\";\nconst KEK_ID = \"kekid\";\nconst KEY_ENCRYPTION_ALGORITHM$1 = \"keyEncryptionAlgorithm\";\nconst ENCRYPTED_KEY$1 = \"encryptedKey\";\nconst PER_DEFINED_KEK = \"preDefinedKEK\";\nconst CLEAR_PROPS$q = [\n    VERSION$a,\n    KEK_ID,\n    KEY_ENCRYPTION_ALGORITHM$1,\n    ENCRYPTED_KEY$1,\n];\nclass KEKRecipientInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$a, KEKRecipientInfo.defaultValues(VERSION$a));\n        this.kekid = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEK_ID, KEKRecipientInfo.defaultValues(KEK_ID));\n        this.keyEncryptionAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_ENCRYPTION_ALGORITHM$1, KEKRecipientInfo.defaultValues(KEY_ENCRYPTION_ALGORITHM$1));\n        this.encryptedKey = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENCRYPTED_KEY$1, KEKRecipientInfo.defaultValues(ENCRYPTED_KEY$1));\n        this.preDefinedKEK = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PER_DEFINED_KEK, KEKRecipientInfo.defaultValues(PER_DEFINED_KEK));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$a:\n                return 0;\n            case KEK_ID:\n                return new KEKIdentifier();\n            case KEY_ENCRYPTION_ALGORITHM$1:\n                return new AlgorithmIdentifier();\n            case ENCRYPTED_KEY$1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case PER_DEFINED_KEK:\n                return EMPTY_BUFFER;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case \"KEKRecipientInfo\":\n                return (memberValue === KEKRecipientInfo.defaultValues(VERSION$a));\n            case KEK_ID:\n                return ((memberValue.compareWithDefault(\"keyIdentifier\", memberValue.keyIdentifier)) &&\n                    ((\"date\" in memberValue) === false) &&\n                    ((\"other\" in memberValue) === false));\n            case KEY_ENCRYPTION_ALGORITHM$1:\n                return ((memberValue.algorithmId === EMPTY_STRING) && ((\"algorithmParams\" in memberValue) === false));\n            case ENCRYPTED_KEY$1:\n                return (memberValue.isEqual(KEKRecipientInfo.defaultValues(ENCRYPTED_KEY$1)));\n            case PER_DEFINED_KEK:\n                return (memberValue.byteLength === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || EMPTY_STRING) }),\n                KEKIdentifier.schema(names.kekid || {}),\n                AlgorithmIdentifier.schema(names.keyEncryptionAlgorithm || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.encryptedKey || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$q);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, KEKRecipientInfo.schema({\n            names: {\n                version: VERSION$a,\n                kekid: {\n                    names: {\n                        blockName: KEK_ID\n                    }\n                },\n                keyEncryptionAlgorithm: {\n                    names: {\n                        blockName: KEY_ENCRYPTION_ALGORITHM$1\n                    }\n                },\n                encryptedKey: ENCRYPTED_KEY$1\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result.version.valueBlock.valueDec;\n        this.kekid = new KEKIdentifier({ schema: asn1.result.kekid });\n        this.keyEncryptionAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.keyEncryptionAlgorithm });\n        this.encryptedKey = asn1.result.encryptedKey;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }),\n                this.kekid.toSchema(),\n                this.keyEncryptionAlgorithm.toSchema(),\n                this.encryptedKey\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            version: this.version,\n            kekid: this.kekid.toJSON(),\n            keyEncryptionAlgorithm: this.keyEncryptionAlgorithm.toJSON(),\n            encryptedKey: this.encryptedKey.toJSON(),\n        };\n    }\n}\nKEKRecipientInfo.CLASS_NAME = \"KEKRecipientInfo\";\n\nconst VERSION$9 = \"version\";\nconst KEY_DERIVATION_ALGORITHM = \"keyDerivationAlgorithm\";\nconst KEY_ENCRYPTION_ALGORITHM = \"keyEncryptionAlgorithm\";\nconst ENCRYPTED_KEY = \"encryptedKey\";\nconst PASSWORD = \"password\";\nconst CLEAR_PROPS$p = [\n    VERSION$9,\n    KEY_DERIVATION_ALGORITHM,\n    KEY_ENCRYPTION_ALGORITHM,\n    ENCRYPTED_KEY\n];\nclass PasswordRecipientinfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$9, PasswordRecipientinfo.defaultValues(VERSION$9));\n        if (KEY_DERIVATION_ALGORITHM in parameters) {\n            this.keyDerivationAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_DERIVATION_ALGORITHM, PasswordRecipientinfo.defaultValues(KEY_DERIVATION_ALGORITHM));\n        }\n        this.keyEncryptionAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_ENCRYPTION_ALGORITHM, PasswordRecipientinfo.defaultValues(KEY_ENCRYPTION_ALGORITHM));\n        this.encryptedKey = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENCRYPTED_KEY, PasswordRecipientinfo.defaultValues(ENCRYPTED_KEY));\n        this.password = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PASSWORD, PasswordRecipientinfo.defaultValues(PASSWORD));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$9:\n                return (-1);\n            case KEY_DERIVATION_ALGORITHM:\n                return new AlgorithmIdentifier();\n            case KEY_ENCRYPTION_ALGORITHM:\n                return new AlgorithmIdentifier();\n            case ENCRYPTED_KEY:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case PASSWORD:\n                return EMPTY_BUFFER;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VERSION$9:\n                return (memberValue === (-1));\n            case KEY_DERIVATION_ALGORITHM:\n            case KEY_ENCRYPTION_ALGORITHM:\n                return ((memberValue.algorithmId === EMPTY_STRING) && ((\"algorithmParams\" in memberValue) === false));\n            case ENCRYPTED_KEY:\n                return (memberValue.isEqual(PasswordRecipientinfo.defaultValues(ENCRYPTED_KEY)));\n            case PASSWORD:\n                return (memberValue.byteLength === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.keyDerivationAlgorithm || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: AlgorithmIdentifier.schema().valueBlock.value\n                }),\n                AlgorithmIdentifier.schema(names.keyEncryptionAlgorithm || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.encryptedKey || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$p);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PasswordRecipientinfo.schema({\n            names: {\n                version: VERSION$9,\n                keyDerivationAlgorithm: KEY_DERIVATION_ALGORITHM,\n                keyEncryptionAlgorithm: {\n                    names: {\n                        blockName: KEY_ENCRYPTION_ALGORITHM\n                    }\n                },\n                encryptedKey: ENCRYPTED_KEY\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result.version.valueBlock.valueDec;\n        if (KEY_DERIVATION_ALGORITHM in asn1.result) {\n            this.keyDerivationAlgorithm = new AlgorithmIdentifier({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    value: asn1.result.keyDerivationAlgorithm.valueBlock.value\n                })\n            });\n        }\n        this.keyEncryptionAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.keyEncryptionAlgorithm });\n        this.encryptedKey = asn1.result.encryptedKey;\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }));\n        if (this.keyDerivationAlgorithm) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: this.keyDerivationAlgorithm.toSchema().valueBlock.value\n            }));\n        }\n        outputArray.push(this.keyEncryptionAlgorithm.toSchema());\n        outputArray.push(this.encryptedKey);\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            version: this.version,\n            keyEncryptionAlgorithm: this.keyEncryptionAlgorithm.toJSON(),\n            encryptedKey: this.encryptedKey.toJSON(),\n        };\n        if (this.keyDerivationAlgorithm) {\n            res.keyDerivationAlgorithm = this.keyDerivationAlgorithm.toJSON();\n        }\n        return res;\n    }\n}\nPasswordRecipientinfo.CLASS_NAME = \"PasswordRecipientInfo\";\n\nconst ORI_TYPE = \"oriType\";\nconst ORI_VALUE = \"oriValue\";\nconst CLEAR_PROPS$o = [\n    ORI_TYPE,\n    ORI_VALUE\n];\nclass OtherRecipientInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.oriType = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ORI_TYPE, OtherRecipientInfo.defaultValues(ORI_TYPE));\n        this.oriValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ORI_VALUE, OtherRecipientInfo.defaultValues(ORI_VALUE));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ORI_TYPE:\n                return EMPTY_STRING;\n            case ORI_VALUE:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case ORI_TYPE:\n                return (memberValue === EMPTY_STRING);\n            case ORI_VALUE:\n                return (Object.keys(memberValue).length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.oriType || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ name: (names.oriValue || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$o);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, OtherRecipientInfo.schema({\n            names: {\n                oriType: ORI_TYPE,\n                oriValue: ORI_VALUE\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.oriType = asn1.result.oriType.valueBlock.toString();\n        this.oriValue = asn1.result.oriValue;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.oriType }),\n                this.oriValue\n            ]\n        }));\n    }\n    toJSON() {\n        const res = {\n            oriType: this.oriType\n        };\n        if (!OtherRecipientInfo.compareWithDefault(ORI_VALUE, this.oriValue)) {\n            res.oriValue = this.oriValue.toJSON();\n        }\n        return res;\n    }\n}\nOtherRecipientInfo.CLASS_NAME = \"OtherRecipientInfo\";\n\nconst VARIANT = \"variant\";\nconst VALUE = \"value\";\nconst CLEAR_PROPS$n = [\n    \"blockName\"\n];\nclass RecipientInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.variant = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VARIANT, RecipientInfo.defaultValues(VARIANT));\n        if (VALUE in parameters) {\n            this.value = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VALUE, RecipientInfo.defaultValues(VALUE));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VARIANT:\n                return (-1);\n            case VALUE:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VARIANT:\n                return (memberValue === RecipientInfo.defaultValues(memberName));\n            case VALUE:\n                return (Object.keys(memberValue).length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n            value: [\n                KeyTransRecipientInfo.schema({\n                    names: {\n                        blockName: (names.blockName || EMPTY_STRING)\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.blockName || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: KeyAgreeRecipientInfo.schema().valueBlock.value\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.blockName || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 2\n                    },\n                    value: KEKRecipientInfo.schema().valueBlock.value\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.blockName || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 3\n                    },\n                    value: PasswordRecipientinfo.schema().valueBlock.value\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.blockName || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 4\n                    },\n                    value: OtherRecipientInfo.schema().valueBlock.value\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$n);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, RecipientInfo.schema({\n            names: {\n                blockName: \"blockName\"\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (asn1.result.blockName.idBlock.tagClass === 1) {\n            this.variant = 1;\n            this.value = new KeyTransRecipientInfo({ schema: asn1.result.blockName });\n        }\n        else {\n            const blockSequence = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                value: asn1.result.blockName.valueBlock.value\n            });\n            switch (asn1.result.blockName.idBlock.tagNumber) {\n                case 1:\n                    this.variant = 2;\n                    this.value = new KeyAgreeRecipientInfo({ schema: blockSequence });\n                    break;\n                case 2:\n                    this.variant = 3;\n                    this.value = new KEKRecipientInfo({ schema: blockSequence });\n                    break;\n                case 3:\n                    this.variant = 4;\n                    this.value = new PasswordRecipientinfo({ schema: blockSequence });\n                    break;\n                case 4:\n                    this.variant = 5;\n                    this.value = new OtherRecipientInfo({ schema: blockSequence });\n                    break;\n                default:\n                    throw new Error(\"Incorrect structure of RecipientInfo block\");\n            }\n        }\n    }\n    toSchema() {\n        ParameterError.assertEmpty(this.value, \"value\", \"RecipientInfo\");\n        const _schema = this.value.toSchema();\n        switch (this.variant) {\n            case 1:\n                return _schema;\n            case 2:\n            case 3:\n            case 4:\n                _schema.idBlock.tagClass = 3;\n                _schema.idBlock.tagNumber = (this.variant - 1);\n                return _schema;\n            default:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any();\n        }\n    }\n    toJSON() {\n        const res = {\n            variant: this.variant\n        };\n        if (this.value && (this.variant >= 1) && (this.variant <= 4)) {\n            res.value = this.value.toJSON();\n        }\n        return res;\n    }\n}\nRecipientInfo.CLASS_NAME = \"RecipientInfo\";\n\nconst HASH_ALGORITHM$2 = \"hashAlgorithm\";\nconst MASK_GEN_ALGORITHM = \"maskGenAlgorithm\";\nconst P_SOURCE_ALGORITHM = \"pSourceAlgorithm\";\nconst CLEAR_PROPS$m = [\n    HASH_ALGORITHM$2,\n    MASK_GEN_ALGORITHM,\n    P_SOURCE_ALGORITHM\n];\nclass RSAESOAEPParams extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.hashAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, HASH_ALGORITHM$2, RSAESOAEPParams.defaultValues(HASH_ALGORITHM$2));\n        this.maskGenAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MASK_GEN_ALGORITHM, RSAESOAEPParams.defaultValues(MASK_GEN_ALGORITHM));\n        this.pSourceAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, P_SOURCE_ALGORITHM, RSAESOAEPParams.defaultValues(P_SOURCE_ALGORITHM));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case HASH_ALGORITHM$2:\n                return new AlgorithmIdentifier({\n                    algorithmId: \"1.3.14.3.2.26\",\n                    algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n                });\n            case MASK_GEN_ALGORITHM:\n                return new AlgorithmIdentifier({\n                    algorithmId: \"1.2.840.113549.1.1.8\",\n                    algorithmParams: (new AlgorithmIdentifier({\n                        algorithmId: \"1.3.14.3.2.26\",\n                        algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n                    })).toSchema()\n                });\n            case P_SOURCE_ALGORITHM:\n                return new AlgorithmIdentifier({\n                    algorithmId: \"1.2.840.113549.1.1.9\",\n                    algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: (new Uint8Array([0xda, 0x39, 0xa3, 0xee, 0x5e, 0x6b, 0x4b, 0x0d, 0x32, 0x55, 0xbf, 0xef, 0x95, 0x60, 0x18, 0x90, 0xaf, 0xd8, 0x07, 0x09])).buffer })\n                });\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    optional: true,\n                    value: [AlgorithmIdentifier.schema(names.hashAlgorithm || {})]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    optional: true,\n                    value: [AlgorithmIdentifier.schema(names.maskGenAlgorithm || {})]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 2\n                    },\n                    optional: true,\n                    value: [AlgorithmIdentifier.schema(names.pSourceAlgorithm || {})]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$m);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, RSAESOAEPParams.schema({\n            names: {\n                hashAlgorithm: {\n                    names: {\n                        blockName: HASH_ALGORITHM$2\n                    }\n                },\n                maskGenAlgorithm: {\n                    names: {\n                        blockName: MASK_GEN_ALGORITHM\n                    }\n                },\n                pSourceAlgorithm: {\n                    names: {\n                        blockName: P_SOURCE_ALGORITHM\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (HASH_ALGORITHM$2 in asn1.result)\n            this.hashAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.hashAlgorithm });\n        if (MASK_GEN_ALGORITHM in asn1.result)\n            this.maskGenAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.maskGenAlgorithm });\n        if (P_SOURCE_ALGORITHM in asn1.result)\n            this.pSourceAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.pSourceAlgorithm });\n    }\n    toSchema() {\n        const outputArray = [];\n        if (!this.hashAlgorithm.isEqual(RSAESOAEPParams.defaultValues(HASH_ALGORITHM$2))) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [this.hashAlgorithm.toSchema()]\n            }));\n        }\n        if (!this.maskGenAlgorithm.isEqual(RSAESOAEPParams.defaultValues(MASK_GEN_ALGORITHM))) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: [this.maskGenAlgorithm.toSchema()]\n            }));\n        }\n        if (!this.pSourceAlgorithm.isEqual(RSAESOAEPParams.defaultValues(P_SOURCE_ALGORITHM))) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 2\n                },\n                value: [this.pSourceAlgorithm.toSchema()]\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {};\n        if (!this.hashAlgorithm.isEqual(RSAESOAEPParams.defaultValues(HASH_ALGORITHM$2))) {\n            res.hashAlgorithm = this.hashAlgorithm.toJSON();\n        }\n        if (!this.maskGenAlgorithm.isEqual(RSAESOAEPParams.defaultValues(MASK_GEN_ALGORITHM))) {\n            res.maskGenAlgorithm = this.maskGenAlgorithm.toJSON();\n        }\n        if (!this.pSourceAlgorithm.isEqual(RSAESOAEPParams.defaultValues(P_SOURCE_ALGORITHM))) {\n            res.pSourceAlgorithm = this.pSourceAlgorithm.toJSON();\n        }\n        return res;\n    }\n}\nRSAESOAEPParams.CLASS_NAME = \"RSAESOAEPParams\";\n\nconst KEY_INFO = \"keyInfo\";\nconst ENTITY_U_INFO = \"entityUInfo\";\nconst SUPP_PUB_INFO = \"suppPubInfo\";\nconst CLEAR_PROPS$l = [\n    KEY_INFO,\n    ENTITY_U_INFO,\n    SUPP_PUB_INFO\n];\nclass ECCCMSSharedInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.keyInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_INFO, ECCCMSSharedInfo.defaultValues(KEY_INFO));\n        if (ENTITY_U_INFO in parameters) {\n            this.entityUInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENTITY_U_INFO, ECCCMSSharedInfo.defaultValues(ENTITY_U_INFO));\n        }\n        this.suppPubInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SUPP_PUB_INFO, ECCCMSSharedInfo.defaultValues(SUPP_PUB_INFO));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case KEY_INFO:\n                return new AlgorithmIdentifier();\n            case ENTITY_U_INFO:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case SUPP_PUB_INFO:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case KEY_INFO:\n            case ENTITY_U_INFO:\n            case SUPP_PUB_INFO:\n                return (memberValue.isEqual(ECCCMSSharedInfo.defaultValues(memberName)));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                AlgorithmIdentifier.schema(names.keyInfo || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.entityUInfo || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    optional: true,\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString()]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.suppPubInfo || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 2\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString()]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$l);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, ECCCMSSharedInfo.schema({\n            names: {\n                keyInfo: {\n                    names: {\n                        blockName: KEY_INFO\n                    }\n                },\n                entityUInfo: ENTITY_U_INFO,\n                suppPubInfo: SUPP_PUB_INFO\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.keyInfo = new AlgorithmIdentifier({ schema: asn1.result.keyInfo });\n        if (ENTITY_U_INFO in asn1.result)\n            this.entityUInfo = asn1.result.entityUInfo.valueBlock.value[0];\n        this.suppPubInfo = asn1.result.suppPubInfo.valueBlock.value[0];\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(this.keyInfo.toSchema());\n        if (this.entityUInfo) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [this.entityUInfo]\n            }));\n        }\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n            idBlock: {\n                tagClass: 3,\n                tagNumber: 2\n            },\n            value: [this.suppPubInfo]\n        }));\n        return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        });\n    }\n    toJSON() {\n        const res = {\n            keyInfo: this.keyInfo.toJSON(),\n            suppPubInfo: this.suppPubInfo.toJSON(),\n        };\n        if (this.entityUInfo) {\n            res.entityUInfo = this.entityUInfo.toJSON();\n        }\n        return res;\n    }\n}\nECCCMSSharedInfo.CLASS_NAME = \"ECCCMSSharedInfo\";\n\nconst VERSION$8 = \"version\";\nconst ORIGINATOR_INFO = \"originatorInfo\";\nconst RECIPIENT_INFOS = \"recipientInfos\";\nconst ENCRYPTED_CONTENT_INFO = \"encryptedContentInfo\";\nconst UNPROTECTED_ATTRS = \"unprotectedAttrs\";\nconst CLEAR_PROPS$k = [\n    VERSION$8,\n    ORIGINATOR_INFO,\n    RECIPIENT_INFOS,\n    ENCRYPTED_CONTENT_INFO,\n    UNPROTECTED_ATTRS\n];\nconst defaultEncryptionParams = {\n    kdfAlgorithm: \"SHA-512\",\n    kekEncryptionLength: 256\n};\nconst curveLengthByName = {\n    \"P-256\": 256,\n    \"P-384\": 384,\n    \"P-521\": 528\n};\nclass EnvelopedData extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$8, EnvelopedData.defaultValues(VERSION$8));\n        if (ORIGINATOR_INFO in parameters) {\n            this.originatorInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ORIGINATOR_INFO, EnvelopedData.defaultValues(ORIGINATOR_INFO));\n        }\n        this.recipientInfos = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RECIPIENT_INFOS, EnvelopedData.defaultValues(RECIPIENT_INFOS));\n        this.encryptedContentInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENCRYPTED_CONTENT_INFO, EnvelopedData.defaultValues(ENCRYPTED_CONTENT_INFO));\n        if (UNPROTECTED_ATTRS in parameters) {\n            this.unprotectedAttrs = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, UNPROTECTED_ATTRS, EnvelopedData.defaultValues(UNPROTECTED_ATTRS));\n        }\n        this.policy = {\n            disableSplit: !!parameters.disableSplit,\n        };\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$8:\n                return 0;\n            case ORIGINATOR_INFO:\n                return new OriginatorInfo();\n            case RECIPIENT_INFOS:\n                return [];\n            case ENCRYPTED_CONTENT_INFO:\n                return new EncryptedContentInfo();\n            case UNPROTECTED_ATTRS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VERSION$8:\n                return (memberValue === EnvelopedData.defaultValues(memberName));\n            case ORIGINATOR_INFO:\n                return ((memberValue.certs.certificates.length === 0) && (memberValue.crls.crls.length === 0));\n            case RECIPIENT_INFOS:\n            case UNPROTECTED_ATTRS:\n                return (memberValue.length === 0);\n            case ENCRYPTED_CONTENT_INFO:\n                return ((EncryptedContentInfo.compareWithDefault(\"contentType\", memberValue.contentType)) &&\n                    (EncryptedContentInfo.compareWithDefault(\"contentEncryptionAlgorithm\", memberValue.contentEncryptionAlgorithm) &&\n                        (EncryptedContentInfo.compareWithDefault(\"encryptedContent\", memberValue.encryptedContent))));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.originatorInfo || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: OriginatorInfo.schema().valueBlock.value\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.recipientInfos || EMPTY_STRING),\n                            value: RecipientInfo.schema()\n                        })\n                    ]\n                }),\n                EncryptedContentInfo.schema(names.encryptedContentInfo || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.unprotectedAttrs || EMPTY_STRING),\n                            value: Attribute.schema()\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$k);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, EnvelopedData.schema({\n            names: {\n                version: VERSION$8,\n                originatorInfo: ORIGINATOR_INFO,\n                recipientInfos: RECIPIENT_INFOS,\n                encryptedContentInfo: {\n                    names: {\n                        blockName: ENCRYPTED_CONTENT_INFO\n                    }\n                },\n                unprotectedAttrs: UNPROTECTED_ATTRS\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result.version.valueBlock.valueDec;\n        if (ORIGINATOR_INFO in asn1.result) {\n            this.originatorInfo = new OriginatorInfo({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    value: asn1.result.originatorInfo.valueBlock.value\n                })\n            });\n        }\n        this.recipientInfos = Array.from(asn1.result.recipientInfos, o => new RecipientInfo({ schema: o }));\n        this.encryptedContentInfo = new EncryptedContentInfo({ schema: asn1.result.encryptedContentInfo });\n        if (UNPROTECTED_ATTRS in asn1.result)\n            this.unprotectedAttrs = Array.from(asn1.result.unprotectedAttrs, o => new Attribute({ schema: o }));\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }));\n        if (this.originatorInfo) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: this.originatorInfo.toSchema().valueBlock.value\n            }));\n        }\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n            value: Array.from(this.recipientInfos, o => o.toSchema())\n        }));\n        outputArray.push(this.encryptedContentInfo.toSchema());\n        if (this.unprotectedAttrs) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: Array.from(this.unprotectedAttrs, o => o.toSchema())\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            version: this.version,\n            recipientInfos: Array.from(this.recipientInfos, o => o.toJSON()),\n            encryptedContentInfo: this.encryptedContentInfo.toJSON(),\n        };\n        if (this.originatorInfo)\n            res.originatorInfo = this.originatorInfo.toJSON();\n        if (this.unprotectedAttrs)\n            res.unprotectedAttrs = Array.from(this.unprotectedAttrs, o => o.toJSON());\n        return res;\n    }\n    addRecipientByCertificate(certificate, parameters, variant, crypto = getCrypto(true)) {\n        const encryptionParameters = Object.assign({ useOAEP: true, oaepHashAlgorithm: \"SHA-512\" }, defaultEncryptionParams, parameters || {});\n        if (certificate.subjectPublicKeyInfo.algorithm.algorithmId.indexOf(\"1.2.840.113549\") !== (-1))\n            variant = 1;\n        else {\n            if (certificate.subjectPublicKeyInfo.algorithm.algorithmId.indexOf(\"1.2.840.10045\") !== (-1))\n                variant = 2;\n            else\n                throw new Error(`Unknown type of certificate's public key: ${certificate.subjectPublicKeyInfo.algorithm.algorithmId}`);\n        }\n        switch (variant) {\n            case 1:\n                {\n                    let algorithmId;\n                    let algorithmParams;\n                    if (encryptionParameters.useOAEP === true) {\n                        algorithmId = crypto.getOIDByAlgorithm({\n                            name: \"RSA-OAEP\"\n                        }, true, \"keyEncryptionAlgorithm\");\n                        const hashOID = crypto.getOIDByAlgorithm({\n                            name: encryptionParameters.oaepHashAlgorithm\n                        }, true, \"RSAES-OAEP-params\");\n                        const hashAlgorithm = new AlgorithmIdentifier({\n                            algorithmId: hashOID,\n                            algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n                        });\n                        const rsaOAEPParams = new RSAESOAEPParams({\n                            hashAlgorithm,\n                            maskGenAlgorithm: new AlgorithmIdentifier({\n                                algorithmId: \"1.2.840.113549.1.1.8\",\n                                algorithmParams: hashAlgorithm.toSchema()\n                            })\n                        });\n                        algorithmParams = rsaOAEPParams.toSchema();\n                    }\n                    else {\n                        algorithmId = crypto.getOIDByAlgorithm({\n                            name: \"RSAES-PKCS1-v1_5\"\n                        });\n                        if (algorithmId === EMPTY_STRING)\n                            throw new Error(\"Can not find OID for RSAES-PKCS1-v1_5\");\n                        algorithmParams = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null();\n                    }\n                    const keyInfo = new KeyTransRecipientInfo({\n                        version: 0,\n                        rid: new IssuerAndSerialNumber({\n                            issuer: certificate.issuer,\n                            serialNumber: certificate.serialNumber\n                        }),\n                        keyEncryptionAlgorithm: new AlgorithmIdentifier({\n                            algorithmId,\n                            algorithmParams\n                        }),\n                        recipientCertificate: certificate,\n                    });\n                    this.recipientInfos.push(new RecipientInfo({\n                        variant: 1,\n                        value: keyInfo\n                    }));\n                }\n                break;\n            case 2:\n                {\n                    const recipientIdentifier = new KeyAgreeRecipientIdentifier({\n                        variant: 1,\n                        value: new IssuerAndSerialNumber({\n                            issuer: certificate.issuer,\n                            serialNumber: certificate.serialNumber\n                        })\n                    });\n                    this._addKeyAgreeRecipientInfo(recipientIdentifier, encryptionParameters, { recipientCertificate: certificate }, crypto);\n                }\n                break;\n            default:\n                throw new Error(`Unknown \"variant\" value: ${variant}`);\n        }\n        return true;\n    }\n    addRecipientByPreDefinedData(preDefinedData, parameters = {}, variant, crypto = getCrypto(true)) {\n        ArgumentError.assert(preDefinedData, \"preDefinedData\", \"ArrayBuffer\");\n        if (!preDefinedData.byteLength) {\n            throw new Error(\"Pre-defined data could have zero length\");\n        }\n        if (!parameters.keyIdentifier) {\n            const keyIdentifierBuffer = new ArrayBuffer(16);\n            const keyIdentifierView = new Uint8Array(keyIdentifierBuffer);\n            crypto.getRandomValues(keyIdentifierView);\n            parameters.keyIdentifier = keyIdentifierBuffer;\n        }\n        if (!parameters.hmacHashAlgorithm)\n            parameters.hmacHashAlgorithm = \"SHA-512\";\n        if (parameters.iterationCount === undefined) {\n            parameters.iterationCount = 2048;\n        }\n        if (!parameters.keyEncryptionAlgorithm) {\n            parameters.keyEncryptionAlgorithm = {\n                name: \"AES-KW\",\n                length: 256\n            };\n        }\n        if (!parameters.keyEncryptionAlgorithmParams)\n            parameters.keyEncryptionAlgorithmParams = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null();\n        switch (variant) {\n            case 1:\n                {\n                    const kekOID = crypto.getOIDByAlgorithm(parameters.keyEncryptionAlgorithm, true, \"keyEncryptionAlgorithm\");\n                    const keyInfo = new KEKRecipientInfo({\n                        version: 4,\n                        kekid: new KEKIdentifier({\n                            keyIdentifier: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: parameters.keyIdentifier })\n                        }),\n                        keyEncryptionAlgorithm: new AlgorithmIdentifier({\n                            algorithmId: kekOID,\n                            algorithmParams: parameters.keyEncryptionAlgorithmParams\n                        }),\n                        preDefinedKEK: preDefinedData\n                    });\n                    this.recipientInfos.push(new RecipientInfo({\n                        variant: 3,\n                        value: keyInfo\n                    }));\n                }\n                break;\n            case 2:\n                {\n                    const pbkdf2OID = crypto.getOIDByAlgorithm({ name: \"PBKDF2\" }, true, \"keyDerivationAlgorithm\");\n                    const saltBuffer = new ArrayBuffer(64);\n                    const saltView = new Uint8Array(saltBuffer);\n                    crypto.getRandomValues(saltView);\n                    const hmacOID = crypto.getOIDByAlgorithm({\n                        name: \"HMAC\",\n                        hash: {\n                            name: parameters.hmacHashAlgorithm\n                        }\n                    }, true, \"hmacHashAlgorithm\");\n                    const pbkdf2Params = new PBKDF2Params({\n                        salt: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: saltBuffer }),\n                        iterationCount: parameters.iterationCount,\n                        prf: new AlgorithmIdentifier({\n                            algorithmId: hmacOID,\n                            algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n                        })\n                    });\n                    const kekOID = crypto.getOIDByAlgorithm(parameters.keyEncryptionAlgorithm, true, \"keyEncryptionAlgorithm\");\n                    const keyInfo = new PasswordRecipientinfo({\n                        version: 0,\n                        keyDerivationAlgorithm: new AlgorithmIdentifier({\n                            algorithmId: pbkdf2OID,\n                            algorithmParams: pbkdf2Params.toSchema()\n                        }),\n                        keyEncryptionAlgorithm: new AlgorithmIdentifier({\n                            algorithmId: kekOID,\n                            algorithmParams: parameters.keyEncryptionAlgorithmParams\n                        }),\n                        password: preDefinedData\n                    });\n                    this.recipientInfos.push(new RecipientInfo({\n                        variant: 4,\n                        value: keyInfo\n                    }));\n                }\n                break;\n            default:\n                throw new Error(`Unknown value for \"variant\": ${variant}`);\n        }\n    }\n    addRecipientByKeyIdentifier(key, keyId, parameters, crypto = getCrypto(true)) {\n        const encryptionParameters = Object.assign({}, defaultEncryptionParams, parameters || {});\n        const recipientIdentifier = new KeyAgreeRecipientIdentifier({\n            variant: 2,\n            value: new RecipientKeyIdentifier({\n                subjectKeyIdentifier: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: keyId }),\n            })\n        });\n        this._addKeyAgreeRecipientInfo(recipientIdentifier, encryptionParameters, { recipientPublicKey: key }, crypto);\n    }\n    _addKeyAgreeRecipientInfo(recipientIdentifier, encryptionParameters, extraRecipientInfoParams, crypto = getCrypto(true)) {\n        const encryptedKey = new RecipientEncryptedKey({\n            rid: recipientIdentifier\n        });\n        const aesKWoid = crypto.getOIDByAlgorithm({\n            name: \"AES-KW\",\n            length: encryptionParameters.kekEncryptionLength\n        }, true, \"keyEncryptionAlgorithm\");\n        const aesKW = new AlgorithmIdentifier({\n            algorithmId: aesKWoid,\n        });\n        const ecdhOID = crypto.getOIDByAlgorithm({\n            name: \"ECDH\",\n            kdf: encryptionParameters.kdfAlgorithm\n        }, true, \"KeyAgreeRecipientInfo\");\n        const ukmBuffer = new ArrayBuffer(64);\n        const ukmView = new Uint8Array(ukmBuffer);\n        crypto.getRandomValues(ukmView);\n        const recipientInfoParams = {\n            version: 3,\n            ukm: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: ukmBuffer }),\n            keyEncryptionAlgorithm: new AlgorithmIdentifier({\n                algorithmId: ecdhOID,\n                algorithmParams: aesKW.toSchema()\n            }),\n            recipientEncryptedKeys: new RecipientEncryptedKeys({\n                encryptedKeys: [encryptedKey]\n            })\n        };\n        const keyInfo = new KeyAgreeRecipientInfo(Object.assign(recipientInfoParams, extraRecipientInfoParams));\n        this.recipientInfos.push(new RecipientInfo({\n            variant: 2,\n            value: keyInfo\n        }));\n    }\n    async encrypt(contentEncryptionAlgorithm, contentToEncrypt, crypto = getCrypto(true)) {\n        const ivBuffer = new ArrayBuffer(16);\n        const ivView = new Uint8Array(ivBuffer);\n        crypto.getRandomValues(ivView);\n        const contentView = new Uint8Array(contentToEncrypt);\n        const contentEncryptionOID = crypto.getOIDByAlgorithm(contentEncryptionAlgorithm, true, \"contentEncryptionAlgorithm\");\n        const sessionKey = await crypto.generateKey(contentEncryptionAlgorithm, true, [\"encrypt\"]);\n        const encryptedContent = await crypto.encrypt({\n            name: contentEncryptionAlgorithm.name,\n            iv: ivView\n        }, sessionKey, contentView);\n        const exportedSessionKey = await crypto.exportKey(\"raw\", sessionKey);\n        this.version = 2;\n        this.encryptedContentInfo = new EncryptedContentInfo({\n            disableSplit: this.policy.disableSplit,\n            contentType: \"1.2.840.113549.1.7.1\",\n            contentEncryptionAlgorithm: new AlgorithmIdentifier({\n                algorithmId: contentEncryptionOID,\n                algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: ivBuffer })\n            }),\n            encryptedContent: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: encryptedContent })\n        });\n        const SubKeyAgreeRecipientInfo = async (index) => {\n            const recipientInfo = this.recipientInfos[index].value;\n            let recipientCurve;\n            let recipientPublicKey;\n            if (recipientInfo.recipientPublicKey) {\n                recipientCurve = recipientInfo.recipientPublicKey.algorithm.namedCurve;\n                recipientPublicKey = recipientInfo.recipientPublicKey;\n            }\n            else if (recipientInfo.recipientCertificate) {\n                const curveObject = recipientInfo.recipientCertificate.subjectPublicKeyInfo.algorithm.algorithmParams;\n                if (curveObject.constructor.blockName() !== asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier.blockName())\n                    throw new Error(`Incorrect \"recipientCertificate\" for index ${index}`);\n                const curveOID = curveObject.valueBlock.toString();\n                switch (curveOID) {\n                    case \"1.2.840.10045.3.1.7\":\n                        recipientCurve = \"P-256\";\n                        break;\n                    case \"1.3.132.0.34\":\n                        recipientCurve = \"P-384\";\n                        break;\n                    case \"1.3.132.0.35\":\n                        recipientCurve = \"P-521\";\n                        break;\n                    default:\n                        throw new Error(`Incorrect curve OID for index ${index}`);\n                }\n                recipientPublicKey = await recipientInfo.recipientCertificate.getPublicKey({\n                    algorithm: {\n                        algorithm: {\n                            name: \"ECDH\",\n                            namedCurve: recipientCurve\n                        },\n                        usages: []\n                    }\n                }, crypto);\n            }\n            else {\n                throw new Error(\"Unsupported RecipientInfo\");\n            }\n            const recipientCurveLength = curveLengthByName[recipientCurve];\n            const ecdhKeys = await crypto.generateKey({ name: \"ECDH\", namedCurve: recipientCurve }, true, [\"deriveBits\"]);\n            const exportedECDHPublicKey = await crypto.exportKey(\"spki\", ecdhKeys.publicKey);\n            const derivedBits = await crypto.deriveBits({\n                name: \"ECDH\",\n                public: recipientPublicKey\n            }, ecdhKeys.privateKey, recipientCurveLength);\n            const aesKWAlgorithm = new AlgorithmIdentifier({ schema: recipientInfo.keyEncryptionAlgorithm.algorithmParams });\n            const kwAlgorithm = crypto.getAlgorithmByOID(aesKWAlgorithm.algorithmId, true, \"aesKWAlgorithm\");\n            let kwLength = kwAlgorithm.length;\n            const kwLengthBuffer = new ArrayBuffer(4);\n            const kwLengthView = new Uint8Array(kwLengthBuffer);\n            for (let j = 3; j >= 0; j--) {\n                kwLengthView[j] = kwLength;\n                kwLength >>= 8;\n            }\n            const eccInfo = new ECCCMSSharedInfo({\n                keyInfo: new AlgorithmIdentifier({\n                    algorithmId: aesKWAlgorithm.algorithmId\n                }),\n                entityUInfo: recipientInfo.ukm,\n                suppPubInfo: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: kwLengthBuffer })\n            });\n            const encodedInfo = eccInfo.toSchema().toBER(false);\n            const ecdhAlgorithm = crypto.getAlgorithmByOID(recipientInfo.keyEncryptionAlgorithm.algorithmId, true, \"ecdhAlgorithm\");\n            const derivedKeyRaw = await kdf(ecdhAlgorithm.kdf, derivedBits, kwAlgorithm.length, encodedInfo, crypto);\n            const awsKW = await crypto.importKey(\"raw\", derivedKeyRaw, { name: \"AES-KW\" }, true, [\"wrapKey\"]);\n            const wrappedKey = await crypto.wrapKey(\"raw\", sessionKey, awsKW, { name: \"AES-KW\" });\n            const originator = new OriginatorIdentifierOrKey();\n            originator.variant = 3;\n            originator.value = OriginatorPublicKey.fromBER(exportedECDHPublicKey);\n            recipientInfo.originator = originator;\n            recipientInfo.recipientEncryptedKeys.encryptedKeys[0].encryptedKey = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: wrappedKey });\n            return { ecdhPrivateKey: ecdhKeys.privateKey };\n        };\n        const SubKeyTransRecipientInfo = async (index) => {\n            const recipientInfo = this.recipientInfos[index].value;\n            const algorithmParameters = crypto.getAlgorithmByOID(recipientInfo.keyEncryptionAlgorithm.algorithmId, true, \"keyEncryptionAlgorithm\");\n            if (algorithmParameters.name === \"RSA-OAEP\") {\n                const schema = recipientInfo.keyEncryptionAlgorithm.algorithmParams;\n                const rsaOAEPParams = new RSAESOAEPParams({ schema });\n                algorithmParameters.hash = crypto.getAlgorithmByOID(rsaOAEPParams.hashAlgorithm.algorithmId);\n                if ((\"name\" in algorithmParameters.hash) === false)\n                    throw new Error(`Incorrect OID for hash algorithm: ${rsaOAEPParams.hashAlgorithm.algorithmId}`);\n            }\n            try {\n                const publicKey = await recipientInfo.recipientCertificate.getPublicKey({\n                    algorithm: {\n                        algorithm: algorithmParameters,\n                        usages: [\"encrypt\", \"wrapKey\"]\n                    }\n                }, crypto);\n                const encryptedKey = await crypto.encrypt(publicKey.algorithm, publicKey, exportedSessionKey);\n                recipientInfo.encryptedKey = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: encryptedKey });\n            }\n            catch {\n            }\n        };\n        const SubKEKRecipientInfo = async (index) => {\n            const recipientInfo = this.recipientInfos[index].value;\n            const kekAlgorithm = crypto.getAlgorithmByOID(recipientInfo.keyEncryptionAlgorithm.algorithmId, true, \"kekAlgorithm\");\n            const kekKey = await crypto.importKey(\"raw\", new Uint8Array(recipientInfo.preDefinedKEK), kekAlgorithm, true, [\"wrapKey\"]);\n            const wrappedKey = await crypto.wrapKey(\"raw\", sessionKey, kekKey, kekAlgorithm);\n            recipientInfo.encryptedKey = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: wrappedKey });\n        };\n        const SubPasswordRecipientinfo = async (index) => {\n            const recipientInfo = this.recipientInfos[index].value;\n            let pbkdf2Params;\n            if (!recipientInfo.keyDerivationAlgorithm)\n                throw new Error(\"Please append encoded \\\"keyDerivationAlgorithm\\\"\");\n            if (!recipientInfo.keyDerivationAlgorithm.algorithmParams)\n                throw new Error(\"Incorrectly encoded \\\"keyDerivationAlgorithm\\\"\");\n            try {\n                pbkdf2Params = new PBKDF2Params({ schema: recipientInfo.keyDerivationAlgorithm.algorithmParams });\n            }\n            catch {\n                throw new Error(\"Incorrectly encoded \\\"keyDerivationAlgorithm\\\"\");\n            }\n            const passwordView = new Uint8Array(recipientInfo.password);\n            const derivationKey = await crypto.importKey(\"raw\", passwordView, \"PBKDF2\", false, [\"deriveKey\"]);\n            const kekAlgorithm = crypto.getAlgorithmByOID(recipientInfo.keyEncryptionAlgorithm.algorithmId, true, \"kekAlgorithm\");\n            let hmacHashAlgorithm = \"SHA-1\";\n            if (pbkdf2Params.prf) {\n                const prfAlgorithm = crypto.getAlgorithmByOID(pbkdf2Params.prf.algorithmId, true, \"prfAlgorithm\");\n                hmacHashAlgorithm = prfAlgorithm.hash.name;\n            }\n            const saltView = new Uint8Array(pbkdf2Params.salt.valueBlock.valueHex);\n            const iterations = pbkdf2Params.iterationCount;\n            const derivedKey = await crypto.deriveKey({\n                name: \"PBKDF2\",\n                hash: {\n                    name: hmacHashAlgorithm\n                },\n                salt: saltView,\n                iterations\n            }, derivationKey, kekAlgorithm, true, [\"wrapKey\"]);\n            const wrappedKey = await crypto.wrapKey(\"raw\", sessionKey, derivedKey, kekAlgorithm);\n            recipientInfo.encryptedKey = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: wrappedKey });\n        };\n        const res = [];\n        for (let i = 0; i < this.recipientInfos.length; i++) {\n            switch (this.recipientInfos[i].variant) {\n                case 1:\n                    res.push(await SubKeyTransRecipientInfo(i));\n                    break;\n                case 2:\n                    res.push(await SubKeyAgreeRecipientInfo(i));\n                    break;\n                case 3:\n                    res.push(await SubKEKRecipientInfo(i));\n                    break;\n                case 4:\n                    res.push(await SubPasswordRecipientinfo(i));\n                    break;\n                default:\n                    throw new Error(`Unknown recipient type in array with index ${i}`);\n            }\n        }\n        return res;\n    }\n    async decrypt(recipientIndex, parameters, crypto = getCrypto(true)) {\n        const decryptionParameters = parameters || {};\n        if ((recipientIndex + 1) > this.recipientInfos.length) {\n            throw new Error(`Maximum value for \"index\" is: ${this.recipientInfos.length - 1}`);\n        }\n        const SubKeyAgreeRecipientInfo = async (index) => {\n            const recipientInfo = this.recipientInfos[index].value;\n            let curveOID;\n            let recipientCurve;\n            let recipientCurveLength;\n            const originator = recipientInfo.originator;\n            if (decryptionParameters.recipientCertificate) {\n                const curveObject = decryptionParameters.recipientCertificate.subjectPublicKeyInfo.algorithm.algorithmParams;\n                if (curveObject.constructor.blockName() !== asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier.blockName()) {\n                    throw new Error(`Incorrect \"recipientCertificate\" for index ${index}`);\n                }\n                curveOID = curveObject.valueBlock.toString();\n            }\n            else if (originator.value.algorithm.algorithmParams) {\n                const curveObject = originator.value.algorithm.algorithmParams;\n                if (curveObject.constructor.blockName() !== asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier.blockName()) {\n                    throw new Error(`Incorrect originator for index ${index}`);\n                }\n                curveOID = curveObject.valueBlock.toString();\n            }\n            else {\n                throw new Error(\"Parameter \\\"recipientCertificate\\\" is mandatory for \\\"KeyAgreeRecipientInfo\\\" if algorithm params are missing from originator\");\n            }\n            if (!decryptionParameters.recipientPrivateKey)\n                throw new Error(\"Parameter \\\"recipientPrivateKey\\\" is mandatory for \\\"KeyAgreeRecipientInfo\\\"\");\n            switch (curveOID) {\n                case \"1.2.840.10045.3.1.7\":\n                    recipientCurve = \"P-256\";\n                    recipientCurveLength = 256;\n                    break;\n                case \"1.3.132.0.34\":\n                    recipientCurve = \"P-384\";\n                    recipientCurveLength = 384;\n                    break;\n                case \"1.3.132.0.35\":\n                    recipientCurve = \"P-521\";\n                    recipientCurveLength = 528;\n                    break;\n                default:\n                    throw new Error(`Incorrect curve OID for index ${index}`);\n            }\n            let ecdhPrivateKey;\n            let keyCrypto = crypto;\n            if (pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isBufferSource(decryptionParameters.recipientPrivateKey)) {\n                ecdhPrivateKey = await crypto.importKey(\"pkcs8\", decryptionParameters.recipientPrivateKey, {\n                    name: \"ECDH\",\n                    namedCurve: recipientCurve\n                }, true, [\"deriveBits\"]);\n            }\n            else {\n                ecdhPrivateKey = decryptionParameters.recipientPrivateKey;\n                if (\"crypto\" in decryptionParameters && decryptionParameters.crypto) {\n                    keyCrypto = decryptionParameters.crypto.subtle;\n                }\n            }\n            if ((\"algorithmParams\" in originator.value.algorithm) === false)\n                originator.value.algorithm.algorithmParams = new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: curveOID });\n            const buffer = originator.value.toSchema().toBER(false);\n            const ecdhPublicKey = await crypto.importKey(\"spki\", buffer, {\n                name: \"ECDH\",\n                namedCurve: recipientCurve\n            }, true, []);\n            const sharedSecret = await keyCrypto.deriveBits({\n                name: \"ECDH\",\n                public: ecdhPublicKey\n            }, ecdhPrivateKey, recipientCurveLength);\n            async function applyKDF(includeAlgorithmParams) {\n                includeAlgorithmParams = includeAlgorithmParams || false;\n                const aesKWAlgorithm = new AlgorithmIdentifier({ schema: recipientInfo.keyEncryptionAlgorithm.algorithmParams });\n                const kwAlgorithm = crypto.getAlgorithmByOID(aesKWAlgorithm.algorithmId, true, \"kwAlgorithm\");\n                let kwLength = kwAlgorithm.length;\n                const kwLengthBuffer = new ArrayBuffer(4);\n                const kwLengthView = new Uint8Array(kwLengthBuffer);\n                for (let j = 3; j >= 0; j--) {\n                    kwLengthView[j] = kwLength;\n                    kwLength >>= 8;\n                }\n                const keyInfoAlgorithm = {\n                    algorithmId: aesKWAlgorithm.algorithmId\n                };\n                if (includeAlgorithmParams) {\n                    keyInfoAlgorithm.algorithmParams = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null();\n                }\n                const eccInfo = new ECCCMSSharedInfo({\n                    keyInfo: new AlgorithmIdentifier(keyInfoAlgorithm),\n                    entityUInfo: recipientInfo.ukm,\n                    suppPubInfo: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: kwLengthBuffer })\n                });\n                const encodedInfo = eccInfo.toSchema().toBER(false);\n                const ecdhAlgorithm = crypto.getAlgorithmByOID(recipientInfo.keyEncryptionAlgorithm.algorithmId, true, \"ecdhAlgorithm\");\n                if (!ecdhAlgorithm.name) {\n                    throw new Error(`Incorrect OID for key encryption algorithm: ${recipientInfo.keyEncryptionAlgorithm.algorithmId}`);\n                }\n                return kdf(ecdhAlgorithm.kdf, sharedSecret, kwAlgorithm.length, encodedInfo, crypto);\n            }\n            const kdfResult = await applyKDF();\n            const importAesKwKey = async (kdfResult) => {\n                return crypto.importKey(\"raw\", kdfResult, { name: \"AES-KW\" }, true, [\"unwrapKey\"]);\n            };\n            const aesKwKey = await importAesKwKey(kdfResult);\n            const unwrapSessionKey = async (aesKwKey) => {\n                const algorithmId = this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId;\n                const contentEncryptionAlgorithm = crypto.getAlgorithmByOID(algorithmId, true, \"contentEncryptionAlgorithm\");\n                return crypto.unwrapKey(\"raw\", recipientInfo.recipientEncryptedKeys.encryptedKeys[0].encryptedKey.valueBlock.valueHexView, aesKwKey, { name: \"AES-KW\" }, contentEncryptionAlgorithm, true, [\"decrypt\"]);\n            };\n            try {\n                return await unwrapSessionKey(aesKwKey);\n            }\n            catch {\n                const kdfResult = await applyKDF(true);\n                const aesKwKey = await importAesKwKey(kdfResult);\n                return unwrapSessionKey(aesKwKey);\n            }\n        };\n        const SubKeyTransRecipientInfo = async (index) => {\n            const recipientInfo = this.recipientInfos[index].value;\n            if (!decryptionParameters.recipientPrivateKey) {\n                throw new Error(\"Parameter \\\"recipientPrivateKey\\\" is mandatory for \\\"KeyTransRecipientInfo\\\"\");\n            }\n            const algorithmParameters = crypto.getAlgorithmByOID(recipientInfo.keyEncryptionAlgorithm.algorithmId, true, \"keyEncryptionAlgorithm\");\n            if (algorithmParameters.name === \"RSA-OAEP\") {\n                const schema = recipientInfo.keyEncryptionAlgorithm.algorithmParams;\n                const rsaOAEPParams = new RSAESOAEPParams({ schema });\n                algorithmParameters.hash = crypto.getAlgorithmByOID(rsaOAEPParams.hashAlgorithm.algorithmId);\n                if ((\"name\" in algorithmParameters.hash) === false)\n                    throw new Error(`Incorrect OID for hash algorithm: ${rsaOAEPParams.hashAlgorithm.algorithmId}`);\n            }\n            let privateKey;\n            let keyCrypto = crypto;\n            if (pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isBufferSource(decryptionParameters.recipientPrivateKey)) {\n                privateKey = await crypto.importKey(\"pkcs8\", decryptionParameters.recipientPrivateKey, algorithmParameters, true, [\"decrypt\"]);\n            }\n            else {\n                privateKey = decryptionParameters.recipientPrivateKey;\n                if (\"crypto\" in decryptionParameters && decryptionParameters.crypto) {\n                    keyCrypto = decryptionParameters.crypto.subtle;\n                }\n            }\n            const sessionKey = await keyCrypto.decrypt(privateKey.algorithm, privateKey, recipientInfo.encryptedKey.valueBlock.valueHexView);\n            const algorithmId = this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId;\n            const contentEncryptionAlgorithm = crypto.getAlgorithmByOID(algorithmId, true, \"contentEncryptionAlgorithm\");\n            if ((\"name\" in contentEncryptionAlgorithm) === false)\n                throw new Error(`Incorrect \"contentEncryptionAlgorithm\": ${algorithmId}`);\n            return crypto.importKey(\"raw\", sessionKey, contentEncryptionAlgorithm, true, [\"decrypt\"]);\n        };\n        const SubKEKRecipientInfo = async (index) => {\n            const recipientInfo = this.recipientInfos[index].value;\n            if (!decryptionParameters.preDefinedData)\n                throw new Error(\"Parameter \\\"preDefinedData\\\" is mandatory for \\\"KEKRecipientInfo\\\"\");\n            const kekAlgorithm = crypto.getAlgorithmByOID(recipientInfo.keyEncryptionAlgorithm.algorithmId, true, \"kekAlgorithm\");\n            const importedKey = await crypto.importKey(\"raw\", decryptionParameters.preDefinedData, kekAlgorithm, true, [\"unwrapKey\"]);\n            const algorithmId = this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId;\n            const contentEncryptionAlgorithm = crypto.getAlgorithmByOID(algorithmId, true, \"contentEncryptionAlgorithm\");\n            if (!contentEncryptionAlgorithm.name) {\n                throw new Error(`Incorrect \"contentEncryptionAlgorithm\": ${algorithmId}`);\n            }\n            return crypto.unwrapKey(\"raw\", recipientInfo.encryptedKey.valueBlock.valueHexView, importedKey, kekAlgorithm, contentEncryptionAlgorithm, true, [\"decrypt\"]);\n        };\n        const SubPasswordRecipientinfo = async (index) => {\n            const recipientInfo = this.recipientInfos[index].value;\n            let pbkdf2Params;\n            if (!decryptionParameters.preDefinedData) {\n                throw new Error(\"Parameter \\\"preDefinedData\\\" is mandatory for \\\"KEKRecipientInfo\\\"\");\n            }\n            if (!recipientInfo.keyDerivationAlgorithm) {\n                throw new Error(\"Please append encoded \\\"keyDerivationAlgorithm\\\"\");\n            }\n            if (!recipientInfo.keyDerivationAlgorithm.algorithmParams) {\n                throw new Error(\"Incorrectly encoded \\\"keyDerivationAlgorithm\\\"\");\n            }\n            try {\n                pbkdf2Params = new PBKDF2Params({ schema: recipientInfo.keyDerivationAlgorithm.algorithmParams });\n            }\n            catch {\n                throw new Error(\"Incorrectly encoded \\\"keyDerivationAlgorithm\\\"\");\n            }\n            const pbkdf2Key = await crypto.importKey(\"raw\", decryptionParameters.preDefinedData, \"PBKDF2\", false, [\"deriveKey\"]);\n            const kekAlgorithm = crypto.getAlgorithmByOID(recipientInfo.keyEncryptionAlgorithm.algorithmId, true, \"keyEncryptionAlgorithm\");\n            const hmacHashAlgorithm = pbkdf2Params.prf\n                ? crypto.getAlgorithmByOID(pbkdf2Params.prf.algorithmId, true, \"prfAlgorithm\").hash.name\n                : \"SHA-1\";\n            const saltView = new Uint8Array(pbkdf2Params.salt.valueBlock.valueHex);\n            const iterations = pbkdf2Params.iterationCount;\n            const kekKey = await crypto.deriveKey({\n                name: \"PBKDF2\",\n                hash: {\n                    name: hmacHashAlgorithm\n                },\n                salt: saltView,\n                iterations\n            }, pbkdf2Key, kekAlgorithm, true, [\"unwrapKey\"]);\n            const algorithmId = this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId;\n            const contentEncryptionAlgorithm = crypto.getAlgorithmByOID(algorithmId, true, \"contentEncryptionAlgorithm\");\n            return crypto.unwrapKey(\"raw\", recipientInfo.encryptedKey.valueBlock.valueHexView, kekKey, kekAlgorithm, contentEncryptionAlgorithm, true, [\"decrypt\"]);\n        };\n        let unwrappedKey;\n        switch (this.recipientInfos[recipientIndex].variant) {\n            case 1:\n                unwrappedKey = await SubKeyTransRecipientInfo(recipientIndex);\n                break;\n            case 2:\n                unwrappedKey = await SubKeyAgreeRecipientInfo(recipientIndex);\n                break;\n            case 3:\n                unwrappedKey = await SubKEKRecipientInfo(recipientIndex);\n                break;\n            case 4:\n                unwrappedKey = await SubPasswordRecipientinfo(recipientIndex);\n                break;\n            default:\n                throw new Error(`Unknown recipient type in array with index ${recipientIndex}`);\n        }\n        const algorithmId = this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId;\n        const contentEncryptionAlgorithm = crypto.getAlgorithmByOID(algorithmId, true, \"contentEncryptionAlgorithm\");\n        const ivBuffer = this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmParams.valueBlock.valueHex;\n        const ivView = new Uint8Array(ivBuffer);\n        if (!this.encryptedContentInfo.encryptedContent) {\n            throw new Error(\"Required property `encryptedContent` is empty\");\n        }\n        const dataBuffer = this.encryptedContentInfo.getEncryptedContent();\n        return crypto.decrypt({\n            name: contentEncryptionAlgorithm.name,\n            iv: ivView\n        }, unwrappedKey, dataBuffer);\n    }\n}\nEnvelopedData.CLASS_NAME = \"EnvelopedData\";\n\nconst SAFE_CONTENTS = \"safeContents\";\nconst PARSED_VALUE$1 = \"parsedValue\";\nconst CONTENT_INFOS = \"contentInfos\";\nclass AuthenticatedSafe extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.safeContents = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SAFE_CONTENTS, AuthenticatedSafe.defaultValues(SAFE_CONTENTS));\n        if (PARSED_VALUE$1 in parameters) {\n            this.parsedValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PARSED_VALUE$1, AuthenticatedSafe.defaultValues(PARSED_VALUE$1));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case SAFE_CONTENTS:\n                return [];\n            case PARSED_VALUE$1:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case SAFE_CONTENTS:\n                return (memberValue.length === 0);\n            case PARSED_VALUE$1:\n                return ((memberValue instanceof Object) && (Object.keys(memberValue).length === 0));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.contentInfos || EMPTY_STRING),\n                    value: ContentInfo.schema()\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, [\n            CONTENT_INFOS\n        ]);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, AuthenticatedSafe.schema({\n            names: {\n                contentInfos: CONTENT_INFOS\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.safeContents = Array.from(asn1.result.contentInfos, element => new ContentInfo({ schema: element }));\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.safeContents, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        return {\n            safeContents: Array.from(this.safeContents, o => o.toJSON())\n        };\n    }\n    async parseInternalValues(parameters, crypto = getCrypto(true)) {\n        ParameterError.assert(parameters, SAFE_CONTENTS);\n        ArgumentError.assert(parameters.safeContents, SAFE_CONTENTS, \"Array\");\n        if (parameters.safeContents.length !== this.safeContents.length) {\n            throw new ArgumentError(\"Length of \\\"parameters.safeContents\\\" must be equal to \\\"this.safeContents.length\\\"\");\n        }\n        this.parsedValue = {\n            safeContents: [],\n        };\n        for (const [index, content] of this.safeContents.entries()) {\n            const safeContent = parameters.safeContents[index];\n            const errorTarget = `parameters.safeContents[${index}]`;\n            switch (content.contentType) {\n                case id_ContentType_Data:\n                    {\n                        ArgumentError.assert(content.content, \"this.safeContents[j].content\", asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString);\n                        const authSafeContent = content.content.getValue();\n                        this.parsedValue.safeContents.push({\n                            privacyMode: 0,\n                            value: SafeContents.fromBER(authSafeContent)\n                        });\n                    }\n                    break;\n                case id_ContentType_EnvelopedData:\n                    {\n                        const cmsEnveloped = new EnvelopedData({ schema: content.content });\n                        ParameterError.assert(errorTarget, safeContent, \"recipientCertificate\", \"recipientKey\");\n                        const envelopedData = safeContent;\n                        const recipientCertificate = envelopedData.recipientCertificate;\n                        const recipientKey = envelopedData.recipientKey;\n                        const decrypted = await cmsEnveloped.decrypt(0, {\n                            recipientCertificate,\n                            recipientPrivateKey: recipientKey\n                        }, crypto);\n                        this.parsedValue.safeContents.push({\n                            privacyMode: 2,\n                            value: SafeContents.fromBER(decrypted),\n                        });\n                    }\n                    break;\n                case id_ContentType_EncryptedData:\n                    {\n                        const cmsEncrypted = new EncryptedData({ schema: content.content });\n                        ParameterError.assert(errorTarget, safeContent, \"password\");\n                        const password = safeContent.password;\n                        const decrypted = await cmsEncrypted.decrypt({\n                            password\n                        }, crypto);\n                        this.parsedValue.safeContents.push({\n                            privacyMode: 1,\n                            value: SafeContents.fromBER(decrypted),\n                        });\n                    }\n                    break;\n                default:\n                    throw new Error(`Unknown \"contentType\" for AuthenticatedSafe: \" ${content.contentType}`);\n            }\n        }\n    }\n    async makeInternalValues(parameters, crypto = getCrypto(true)) {\n        if (!(this.parsedValue)) {\n            throw new Error(\"Please run \\\"parseValues\\\" first or add \\\"parsedValue\\\" manually\");\n        }\n        ArgumentError.assert(this.parsedValue, \"this.parsedValue\", \"object\");\n        ArgumentError.assert(this.parsedValue.safeContents, \"this.parsedValue.safeContents\", \"Array\");\n        ArgumentError.assert(parameters, \"parameters\", \"object\");\n        ParameterError.assert(parameters, \"safeContents\");\n        ArgumentError.assert(parameters.safeContents, \"parameters.safeContents\", \"Array\");\n        if (parameters.safeContents.length !== this.parsedValue.safeContents.length) {\n            throw new ArgumentError(\"Length of \\\"parameters.safeContents\\\" must be equal to \\\"this.parsedValue.safeContents\\\"\");\n        }\n        this.safeContents = [];\n        for (const [index, content] of this.parsedValue.safeContents.entries()) {\n            ParameterError.assert(\"content\", content, \"privacyMode\", \"value\");\n            ArgumentError.assert(content.value, \"content.value\", SafeContents);\n            switch (content.privacyMode) {\n                case 0:\n                    {\n                        const contentBuffer = content.value.toSchema().toBER(false);\n                        this.safeContents.push(new ContentInfo({\n                            contentType: \"1.2.840.113549.1.7.1\",\n                            content: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: contentBuffer })\n                        }));\n                    }\n                    break;\n                case 1:\n                    {\n                        const cmsEncrypted = new EncryptedData();\n                        const currentParameters = parameters.safeContents[index];\n                        currentParameters.contentToEncrypt = content.value.toSchema().toBER(false);\n                        await cmsEncrypted.encrypt(currentParameters, crypto);\n                        this.safeContents.push(new ContentInfo({\n                            contentType: \"1.2.840.113549.1.7.6\",\n                            content: cmsEncrypted.toSchema()\n                        }));\n                    }\n                    break;\n                case 2:\n                    {\n                        const cmsEnveloped = new EnvelopedData();\n                        const contentToEncrypt = content.value.toSchema().toBER(false);\n                        const safeContent = parameters.safeContents[index];\n                        ParameterError.assert(`parameters.safeContents[${index}]`, safeContent, \"encryptingCertificate\", \"encryptionAlgorithm\");\n                        switch (true) {\n                            case (safeContent.encryptionAlgorithm.name.toLowerCase() === \"aes-cbc\"):\n                            case (safeContent.encryptionAlgorithm.name.toLowerCase() === \"aes-gcm\"):\n                                break;\n                            default:\n                                throw new Error(`Incorrect parameter \"encryptionAlgorithm\" in \"parameters.safeContents[i]\": ${safeContent.encryptionAlgorithm}`);\n                        }\n                        switch (true) {\n                            case (safeContent.encryptionAlgorithm.length === 128):\n                            case (safeContent.encryptionAlgorithm.length === 192):\n                            case (safeContent.encryptionAlgorithm.length === 256):\n                                break;\n                            default:\n                                throw new Error(`Incorrect parameter \"encryptionAlgorithm.length\" in \"parameters.safeContents[i]\": ${safeContent.encryptionAlgorithm.length}`);\n                        }\n                        const encryptionAlgorithm = safeContent.encryptionAlgorithm;\n                        cmsEnveloped.addRecipientByCertificate(safeContent.encryptingCertificate, {}, undefined, crypto);\n                        await cmsEnveloped.encrypt(encryptionAlgorithm, contentToEncrypt, crypto);\n                        this.safeContents.push(new ContentInfo({\n                            contentType: \"1.2.840.113549.1.7.3\",\n                            content: cmsEnveloped.toSchema()\n                        }));\n                    }\n                    break;\n                default:\n                    throw new Error(`Incorrect value for \"content.privacyMode\": ${content.privacyMode}`);\n            }\n        }\n        return this;\n    }\n}\nAuthenticatedSafe.CLASS_NAME = \"AuthenticatedSafe\";\n\nconst HASH_ALGORITHM$1 = \"hashAlgorithm\";\nconst ISSUER_NAME_HASH = \"issuerNameHash\";\nconst ISSUER_KEY_HASH = \"issuerKeyHash\";\nconst SERIAL_NUMBER$1 = \"serialNumber\";\nconst CLEAR_PROPS$j = [\n    HASH_ALGORITHM$1,\n    ISSUER_NAME_HASH,\n    ISSUER_KEY_HASH,\n    SERIAL_NUMBER$1,\n];\nclass CertID extends PkiObject {\n    static async create(certificate, parameters, crypto = getCrypto(true)) {\n        const certID = new CertID();\n        await certID.createForCertificate(certificate, parameters, crypto);\n        return certID;\n    }\n    constructor(parameters = {}) {\n        super();\n        this.hashAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, HASH_ALGORITHM$1, CertID.defaultValues(HASH_ALGORITHM$1));\n        this.issuerNameHash = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER_NAME_HASH, CertID.defaultValues(ISSUER_NAME_HASH));\n        this.issuerKeyHash = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER_KEY_HASH, CertID.defaultValues(ISSUER_KEY_HASH));\n        this.serialNumber = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SERIAL_NUMBER$1, CertID.defaultValues(SERIAL_NUMBER$1));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case HASH_ALGORITHM$1:\n                return new AlgorithmIdentifier();\n            case ISSUER_NAME_HASH:\n            case ISSUER_KEY_HASH:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case SERIAL_NUMBER$1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case HASH_ALGORITHM$1:\n                return ((memberValue.algorithmId === EMPTY_STRING) && ((\"algorithmParams\" in memberValue) === false));\n            case ISSUER_NAME_HASH:\n            case ISSUER_KEY_HASH:\n            case SERIAL_NUMBER$1:\n                return (memberValue.isEqual(CertID.defaultValues(SERIAL_NUMBER$1)));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                AlgorithmIdentifier.schema(names.hashAlgorithmObject || {\n                    names: {\n                        blockName: (names.hashAlgorithm || EMPTY_STRING)\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.issuerNameHash || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.issuerKeyHash || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.serialNumber || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$j);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, CertID.schema({\n            names: {\n                hashAlgorithm: HASH_ALGORITHM$1,\n                issuerNameHash: ISSUER_NAME_HASH,\n                issuerKeyHash: ISSUER_KEY_HASH,\n                serialNumber: SERIAL_NUMBER$1\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.hashAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.hashAlgorithm });\n        this.issuerNameHash = asn1.result.issuerNameHash;\n        this.issuerKeyHash = asn1.result.issuerKeyHash;\n        this.serialNumber = asn1.result.serialNumber;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.hashAlgorithm.toSchema(),\n                this.issuerNameHash,\n                this.issuerKeyHash,\n                this.serialNumber\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            hashAlgorithm: this.hashAlgorithm.toJSON(),\n            issuerNameHash: this.issuerNameHash.toJSON(),\n            issuerKeyHash: this.issuerKeyHash.toJSON(),\n            serialNumber: this.serialNumber.toJSON(),\n        };\n    }\n    isEqual(certificateID) {\n        if (this.hashAlgorithm.algorithmId !== certificateID.hashAlgorithm.algorithmId) {\n            return false;\n        }\n        if (!pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isEqual(this.issuerNameHash.valueBlock.valueHexView, certificateID.issuerNameHash.valueBlock.valueHexView)) {\n            return false;\n        }\n        if (!pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isEqual(this.issuerKeyHash.valueBlock.valueHexView, certificateID.issuerKeyHash.valueBlock.valueHexView)) {\n            return false;\n        }\n        if (!this.serialNumber.isEqual(certificateID.serialNumber)) {\n            return false;\n        }\n        return true;\n    }\n    async createForCertificate(certificate, parameters, crypto = getCrypto(true)) {\n        ParameterError.assert(parameters, HASH_ALGORITHM$1, \"issuerCertificate\");\n        const hashOID = crypto.getOIDByAlgorithm({ name: parameters.hashAlgorithm }, true, \"hashAlgorithm\");\n        this.hashAlgorithm = new AlgorithmIdentifier({\n            algorithmId: hashOID,\n            algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n        });\n        const issuerCertificate = parameters.issuerCertificate;\n        this.serialNumber = certificate.serialNumber;\n        const hashIssuerName = await crypto.digest({ name: parameters.hashAlgorithm }, issuerCertificate.subject.toSchema().toBER(false));\n        this.issuerNameHash = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: hashIssuerName });\n        const issuerKeyBuffer = issuerCertificate.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView;\n        const hashIssuerKey = await crypto.digest({ name: parameters.hashAlgorithm }, issuerKeyBuffer);\n        this.issuerKeyHash = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: hashIssuerKey });\n    }\n}\nCertID.CLASS_NAME = \"CertID\";\n\nconst CERT_ID = \"certID\";\nconst CERT_STATUS = \"certStatus\";\nconst THIS_UPDATE = \"thisUpdate\";\nconst NEXT_UPDATE = \"nextUpdate\";\nconst SINGLE_EXTENSIONS = \"singleExtensions\";\nconst CLEAR_PROPS$i = [\n    CERT_ID,\n    CERT_STATUS,\n    THIS_UPDATE,\n    NEXT_UPDATE,\n    SINGLE_EXTENSIONS,\n];\nclass SingleResponse extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.certID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CERT_ID, SingleResponse.defaultValues(CERT_ID));\n        this.certStatus = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CERT_STATUS, SingleResponse.defaultValues(CERT_STATUS));\n        this.thisUpdate = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, THIS_UPDATE, SingleResponse.defaultValues(THIS_UPDATE));\n        if (NEXT_UPDATE in parameters) {\n            this.nextUpdate = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NEXT_UPDATE, SingleResponse.defaultValues(NEXT_UPDATE));\n        }\n        if (SINGLE_EXTENSIONS in parameters) {\n            this.singleExtensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SINGLE_EXTENSIONS, SingleResponse.defaultValues(SINGLE_EXTENSIONS));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case CERT_ID:\n                return new CertID();\n            case CERT_STATUS:\n                return {};\n            case THIS_UPDATE:\n            case NEXT_UPDATE:\n                return new Date(0, 0, 0);\n            case SINGLE_EXTENSIONS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case CERT_ID:\n                return ((CertID.compareWithDefault(\"hashAlgorithm\", memberValue.hashAlgorithm)) &&\n                    (CertID.compareWithDefault(\"issuerNameHash\", memberValue.issuerNameHash)) &&\n                    (CertID.compareWithDefault(\"issuerKeyHash\", memberValue.issuerKeyHash)) &&\n                    (CertID.compareWithDefault(\"serialNumber\", memberValue.serialNumber)));\n            case CERT_STATUS:\n                return (Object.keys(memberValue).length === 0);\n            case THIS_UPDATE:\n            case NEXT_UPDATE:\n                return (memberValue === SingleResponse.defaultValues(memberName));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                CertID.schema(names.certID || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                            name: (names.certStatus || EMPTY_STRING),\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 0\n                            },\n                        }),\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            name: (names.certStatus || EMPTY_STRING),\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 1\n                            },\n                            value: [\n                                new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime(),\n                                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                                    optional: true,\n                                    idBlock: {\n                                        tagClass: 3,\n                                        tagNumber: 0\n                                    },\n                                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Enumerated()]\n                                })\n                            ]\n                        }),\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                            name: (names.certStatus || EMPTY_STRING),\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 2\n                            },\n                            lenBlock: { length: 1 }\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ name: (names.thisUpdate || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ name: (names.nextUpdate || EMPTY_STRING) })]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [Extensions.schema(names.singleExtensions || {})]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$i);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, SingleResponse.schema({\n            names: {\n                certID: {\n                    names: {\n                        blockName: CERT_ID\n                    }\n                },\n                certStatus: CERT_STATUS,\n                thisUpdate: THIS_UPDATE,\n                nextUpdate: NEXT_UPDATE,\n                singleExtensions: {\n                    names: {\n                        blockName: SINGLE_EXTENSIONS\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.certID = new CertID({ schema: asn1.result.certID });\n        this.certStatus = asn1.result.certStatus;\n        this.thisUpdate = asn1.result.thisUpdate.toDate();\n        if (NEXT_UPDATE in asn1.result)\n            this.nextUpdate = asn1.result.nextUpdate.toDate();\n        if (SINGLE_EXTENSIONS in asn1.result)\n            this.singleExtensions = Array.from(asn1.result.singleExtensions.valueBlock.value, element => new Extension({ schema: element }));\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(this.certID.toSchema());\n        outputArray.push(this.certStatus);\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ valueDate: this.thisUpdate }));\n        if (this.nextUpdate) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ valueDate: this.nextUpdate })]\n            }));\n        }\n        if (this.singleExtensions) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                value: Array.from(this.singleExtensions, o => o.toSchema())\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            certID: this.certID.toJSON(),\n            certStatus: this.certStatus.toJSON(),\n            thisUpdate: this.thisUpdate\n        };\n        if (this.nextUpdate) {\n            res.nextUpdate = this.nextUpdate;\n        }\n        if (this.singleExtensions) {\n            res.singleExtensions = Array.from(this.singleExtensions, o => o.toJSON());\n        }\n        return res;\n    }\n}\nSingleResponse.CLASS_NAME = \"SingleResponse\";\n\nconst TBS$2 = \"tbs\";\nconst VERSION$7 = \"version\";\nconst RESPONDER_ID = \"responderID\";\nconst PRODUCED_AT = \"producedAt\";\nconst RESPONSES = \"responses\";\nconst RESPONSE_EXTENSIONS = \"responseExtensions\";\nconst RESPONSE_DATA = \"ResponseData\";\nconst RESPONSE_DATA_VERSION = `${RESPONSE_DATA}.${VERSION$7}`;\nconst RESPONSE_DATA_RESPONDER_ID = `${RESPONSE_DATA}.${RESPONDER_ID}`;\nconst RESPONSE_DATA_PRODUCED_AT = `${RESPONSE_DATA}.${PRODUCED_AT}`;\nconst RESPONSE_DATA_RESPONSES = `${RESPONSE_DATA}.${RESPONSES}`;\nconst RESPONSE_DATA_RESPONSE_EXTENSIONS = `${RESPONSE_DATA}.${RESPONSE_EXTENSIONS}`;\nconst CLEAR_PROPS$h = [\n    RESPONSE_DATA,\n    RESPONSE_DATA_VERSION,\n    RESPONSE_DATA_RESPONDER_ID,\n    RESPONSE_DATA_PRODUCED_AT,\n    RESPONSE_DATA_RESPONSES,\n    RESPONSE_DATA_RESPONSE_EXTENSIONS\n];\nclass ResponseData extends PkiObject {\n    get tbs() {\n        return pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.toArrayBuffer(this.tbsView);\n    }\n    set tbs(value) {\n        this.tbsView = new Uint8Array(value);\n    }\n    constructor(parameters = {}) {\n        super();\n        this.tbsView = new Uint8Array(pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TBS$2, ResponseData.defaultValues(TBS$2)));\n        if (VERSION$7 in parameters) {\n            this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$7, ResponseData.defaultValues(VERSION$7));\n        }\n        this.responderID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RESPONDER_ID, ResponseData.defaultValues(RESPONDER_ID));\n        this.producedAt = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PRODUCED_AT, ResponseData.defaultValues(PRODUCED_AT));\n        this.responses = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RESPONSES, ResponseData.defaultValues(RESPONSES));\n        if (RESPONSE_EXTENSIONS in parameters) {\n            this.responseExtensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RESPONSE_EXTENSIONS, ResponseData.defaultValues(RESPONSE_EXTENSIONS));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$7:\n                return 0;\n            case TBS$2:\n                return EMPTY_BUFFER;\n            case RESPONDER_ID:\n                return {};\n            case PRODUCED_AT:\n                return new Date(0, 0, 0);\n            case RESPONSES:\n            case RESPONSE_EXTENSIONS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case TBS$2:\n                return (memberValue.byteLength === 0);\n            case RESPONDER_ID:\n                return (Object.keys(memberValue).length === 0);\n            case PRODUCED_AT:\n                return (memberValue === ResponseData.defaultValues(memberName));\n            case RESPONSES:\n            case RESPONSE_EXTENSIONS:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || RESPONSE_DATA),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || RESPONSE_DATA_VERSION) })]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            name: (names.responderID || RESPONSE_DATA_RESPONDER_ID),\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 1\n                            },\n                            value: [RelativeDistinguishedNames.schema(names.ResponseDataByName || {\n                                    names: {\n                                        blockName: \"ResponseData.byName\"\n                                    }\n                                })]\n                        }),\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            name: (names.responderID || RESPONSE_DATA_RESPONDER_ID),\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 2\n                            },\n                            value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.ResponseDataByKey || \"ResponseData.byKey\") })]\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ name: (names.producedAt || RESPONSE_DATA_PRODUCED_AT) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: RESPONSE_DATA_RESPONSES,\n                            value: SingleResponse.schema(names.response || {})\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [Extensions.schema(names.extensions || {\n                            names: {\n                                blockName: RESPONSE_DATA_RESPONSE_EXTENSIONS\n                            }\n                        })]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$h);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, ResponseData.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.tbsView = asn1.result.ResponseData.valueBeforeDecodeView;\n        if (RESPONSE_DATA_VERSION in asn1.result)\n            this.version = asn1.result[RESPONSE_DATA_VERSION].valueBlock.valueDec;\n        if (asn1.result[RESPONSE_DATA_RESPONDER_ID].idBlock.tagNumber === 1)\n            this.responderID = new RelativeDistinguishedNames({ schema: asn1.result[RESPONSE_DATA_RESPONDER_ID].valueBlock.value[0] });\n        else\n            this.responderID = asn1.result[RESPONSE_DATA_RESPONDER_ID].valueBlock.value[0];\n        this.producedAt = asn1.result[RESPONSE_DATA_PRODUCED_AT].toDate();\n        this.responses = Array.from(asn1.result[RESPONSE_DATA_RESPONSES], element => new SingleResponse({ schema: element }));\n        if (RESPONSE_DATA_RESPONSE_EXTENSIONS in asn1.result)\n            this.responseExtensions = Array.from(asn1.result[RESPONSE_DATA_RESPONSE_EXTENSIONS].valueBlock.value, element => new Extension({ schema: element }));\n    }\n    toSchema(encodeFlag = false) {\n        let tbsSchema;\n        if (encodeFlag === false) {\n            if (!this.tbsView.byteLength) {\n                return ResponseData.schema();\n            }\n            const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(this.tbsView);\n            AsnError.assert(asn1, \"TBS Response Data\");\n            tbsSchema = asn1.result;\n        }\n        else {\n            const outputArray = [];\n            if (VERSION$7 in this) {\n                outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version })]\n                }));\n            }\n            if (this.responderID instanceof RelativeDistinguishedNames) {\n                outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [this.responderID.toSchema()]\n                }));\n            }\n            else {\n                outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 2\n                    },\n                    value: [this.responderID]\n                }));\n            }\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ valueDate: this.producedAt }));\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                value: Array.from(this.responses, o => o.toSchema())\n            }));\n            if (this.responseExtensions) {\n                outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                            value: Array.from(this.responseExtensions, o => o.toSchema())\n                        })]\n                }));\n            }\n            tbsSchema = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                value: outputArray\n            });\n        }\n        return tbsSchema;\n    }\n    toJSON() {\n        const res = {};\n        if (VERSION$7 in this) {\n            res.version = this.version;\n        }\n        if (this.responderID) {\n            res.responderID = this.responderID;\n        }\n        if (this.producedAt) {\n            res.producedAt = this.producedAt;\n        }\n        if (this.responses) {\n            res.responses = Array.from(this.responses, o => o.toJSON());\n        }\n        if (this.responseExtensions) {\n            res.responseExtensions = Array.from(this.responseExtensions, o => o.toJSON());\n        }\n        return res;\n    }\n}\nResponseData.CLASS_NAME = \"ResponseData\";\n\nconst TRUSTED_CERTS = \"trustedCerts\";\nconst CERTS$2 = \"certs\";\nconst CRLS$1 = \"crls\";\nconst OCSPS$1 = \"ocsps\";\nconst CHECK_DATE = \"checkDate\";\nconst FIND_ORIGIN = \"findOrigin\";\nconst FIND_ISSUER = \"findIssuer\";\nvar ChainValidationCode;\n(function (ChainValidationCode) {\n    ChainValidationCode[ChainValidationCode[\"unknown\"] = -1] = \"unknown\";\n    ChainValidationCode[ChainValidationCode[\"success\"] = 0] = \"success\";\n    ChainValidationCode[ChainValidationCode[\"noRevocation\"] = 11] = \"noRevocation\";\n    ChainValidationCode[ChainValidationCode[\"noPath\"] = 60] = \"noPath\";\n    ChainValidationCode[ChainValidationCode[\"noValidPath\"] = 97] = \"noValidPath\";\n})(ChainValidationCode || (ChainValidationCode = {}));\nclass ChainValidationError extends Error {\n    constructor(code, message) {\n        super(message);\n        this.name = ChainValidationError.NAME;\n        this.code = code;\n        this.message = message;\n    }\n}\nChainValidationError.NAME = \"ChainValidationError\";\nfunction isTrusted(cert, trustedList) {\n    for (let i = 0; i < trustedList.length; i++) {\n        if (pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isEqual(cert.tbsView, trustedList[i].tbsView)) {\n            return true;\n        }\n    }\n    return false;\n}\nclass CertificateChainValidationEngine {\n    constructor(parameters = {}) {\n        this.trustedCerts = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TRUSTED_CERTS, this.defaultValues(TRUSTED_CERTS));\n        this.certs = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CERTS$2, this.defaultValues(CERTS$2));\n        this.crls = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CRLS$1, this.defaultValues(CRLS$1));\n        this.ocsps = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OCSPS$1, this.defaultValues(OCSPS$1));\n        this.checkDate = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CHECK_DATE, this.defaultValues(CHECK_DATE));\n        this.findOrigin = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, FIND_ORIGIN, this.defaultValues(FIND_ORIGIN));\n        this.findIssuer = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, FIND_ISSUER, this.defaultValues(FIND_ISSUER));\n    }\n    static defaultFindOrigin(certificate, validationEngine) {\n        if (certificate.tbsView.byteLength === 0) {\n            certificate.tbsView = new Uint8Array(certificate.encodeTBS().toBER());\n        }\n        for (const localCert of validationEngine.certs) {\n            if (localCert.tbsView.byteLength === 0) {\n                localCert.tbsView = new Uint8Array(localCert.encodeTBS().toBER());\n            }\n            if (pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isEqual(certificate.tbsView, localCert.tbsView))\n                return \"Intermediate Certificates\";\n        }\n        for (const trustedCert of validationEngine.trustedCerts) {\n            if (trustedCert.tbsView.byteLength === 0)\n                trustedCert.tbsView = new Uint8Array(trustedCert.encodeTBS().toBER());\n            if (pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isEqual(certificate.tbsView, trustedCert.tbsView))\n                return \"Trusted Certificates\";\n        }\n        return \"Unknown\";\n    }\n    async defaultFindIssuer(certificate, validationEngine, crypto = getCrypto(true)) {\n        const result = [];\n        let keyIdentifier = null;\n        let authorityCertIssuer = null;\n        let authorityCertSerialNumber = null;\n        if (certificate.subject.isEqual(certificate.issuer)) {\n            try {\n                const verificationResult = await certificate.verify(undefined, crypto);\n                if (verificationResult) {\n                    return [certificate];\n                }\n            }\n            catch {\n            }\n        }\n        if (certificate.extensions) {\n            for (const extension of certificate.extensions) {\n                if (extension.extnID === id_AuthorityKeyIdentifier && extension.parsedValue instanceof AuthorityKeyIdentifier) {\n                    if (extension.parsedValue.keyIdentifier) {\n                        keyIdentifier = extension.parsedValue.keyIdentifier;\n                    }\n                    else {\n                        if (extension.parsedValue.authorityCertIssuer) {\n                            authorityCertIssuer = extension.parsedValue.authorityCertIssuer;\n                        }\n                        if (extension.parsedValue.authorityCertSerialNumber) {\n                            authorityCertSerialNumber = extension.parsedValue.authorityCertSerialNumber;\n                        }\n                    }\n                    break;\n                }\n            }\n        }\n        function checkCertificate(possibleIssuer) {\n            if (keyIdentifier !== null) {\n                if (possibleIssuer.extensions) {\n                    let extensionFound = false;\n                    for (const extension of possibleIssuer.extensions) {\n                        if (extension.extnID === id_SubjectKeyIdentifier && extension.parsedValue) {\n                            extensionFound = true;\n                            if (pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isEqual(extension.parsedValue.valueBlock.valueHex, keyIdentifier.valueBlock.valueHexView)) {\n                                result.push(possibleIssuer);\n                            }\n                            break;\n                        }\n                    }\n                    if (extensionFound) {\n                        return;\n                    }\n                }\n            }\n            let authorityCertSerialNumberEqual = false;\n            if (authorityCertSerialNumber !== null)\n                authorityCertSerialNumberEqual = possibleIssuer.serialNumber.isEqual(authorityCertSerialNumber);\n            if (authorityCertIssuer !== null) {\n                if (possibleIssuer.subject.isEqual(authorityCertIssuer)) {\n                    if (authorityCertSerialNumberEqual)\n                        result.push(possibleIssuer);\n                }\n            }\n            else {\n                if (certificate.issuer.isEqual(possibleIssuer.subject))\n                    result.push(possibleIssuer);\n            }\n        }\n        for (const trustedCert of validationEngine.trustedCerts) {\n            checkCertificate(trustedCert);\n        }\n        for (const intermediateCert of validationEngine.certs) {\n            checkCertificate(intermediateCert);\n        }\n        for (let i = result.length - 1; i >= 0; i--) {\n            try {\n                const verificationResult = await certificate.verify(result[i], crypto);\n                if (verificationResult === false)\n                    result.splice(i, 1);\n            }\n            catch {\n                result.splice(i, 1);\n            }\n        }\n        return result;\n    }\n    defaultValues(memberName) {\n        switch (memberName) {\n            case TRUSTED_CERTS:\n                return [];\n            case CERTS$2:\n                return [];\n            case CRLS$1:\n                return [];\n            case OCSPS$1:\n                return [];\n            case CHECK_DATE:\n                return new Date();\n            case FIND_ORIGIN:\n                return CertificateChainValidationEngine.defaultFindOrigin;\n            case FIND_ISSUER:\n                return this.defaultFindIssuer;\n            default:\n                throw new Error(`Invalid member name for CertificateChainValidationEngine class: ${memberName}`);\n        }\n    }\n    async sort(passedWhenNotRevValues = false, crypto = getCrypto(true)) {\n        const localCerts = [];\n        const buildPath = async (certificate, crypto) => {\n            const result = [];\n            function checkUnique(array) {\n                let unique = true;\n                for (let i = 0; i < array.length; i++) {\n                    for (let j = 0; j < array.length; j++) {\n                        if (j === i)\n                            continue;\n                        if (array[i] === array[j]) {\n                            unique = false;\n                            break;\n                        }\n                    }\n                    if (!unique)\n                        break;\n                }\n                return unique;\n            }\n            if (isTrusted(certificate, this.trustedCerts)) {\n                return [[certificate]];\n            }\n            const findIssuerResult = await this.findIssuer(certificate, this, crypto);\n            if (findIssuerResult.length === 0) {\n                throw new Error(\"No valid certificate paths found\");\n            }\n            for (let i = 0; i < findIssuerResult.length; i++) {\n                if (pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isEqual(findIssuerResult[i].tbsView, certificate.tbsView)) {\n                    result.push([findIssuerResult[i]]);\n                    continue;\n                }\n                const buildPathResult = await buildPath(findIssuerResult[i], crypto);\n                for (let j = 0; j < buildPathResult.length; j++) {\n                    const copy = buildPathResult[j].slice();\n                    copy.splice(0, 0, findIssuerResult[i]);\n                    if (checkUnique(copy))\n                        result.push(copy);\n                    else\n                        result.push(buildPathResult[j]);\n                }\n            }\n            return result;\n        };\n        const findCRL = async (certificate) => {\n            const issuerCertificates = [];\n            const crls = [];\n            const crlsAndCertificates = [];\n            issuerCertificates.push(...localCerts.filter(element => certificate.issuer.isEqual(element.subject)));\n            if (issuerCertificates.length === 0) {\n                return {\n                    status: 1,\n                    statusMessage: \"No certificate's issuers\"\n                };\n            }\n            crls.push(...this.crls.filter(o => o.issuer.isEqual(certificate.issuer)));\n            if (crls.length === 0) {\n                return {\n                    status: 2,\n                    statusMessage: \"No CRLs for specific certificate issuer\"\n                };\n            }\n            for (let i = 0; i < crls.length; i++) {\n                const crl = crls[i];\n                if (crl.nextUpdate && crl.nextUpdate.value < this.checkDate) {\n                    continue;\n                }\n                for (let j = 0; j < issuerCertificates.length; j++) {\n                    try {\n                        const result = await crls[i].verify({ issuerCertificate: issuerCertificates[j] }, crypto);\n                        if (result) {\n                            crlsAndCertificates.push({\n                                crl: crls[i],\n                                certificate: issuerCertificates[j]\n                            });\n                            break;\n                        }\n                    }\n                    catch {\n                    }\n                }\n            }\n            if (crlsAndCertificates.length) {\n                return {\n                    status: 0,\n                    statusMessage: EMPTY_STRING,\n                    result: crlsAndCertificates\n                };\n            }\n            return {\n                status: 3,\n                statusMessage: \"No valid CRLs found\"\n            };\n        };\n        const findOCSP = async (certificate, issuerCertificate) => {\n            const hashAlgorithm = crypto.getAlgorithmByOID(certificate.signatureAlgorithm.algorithmId);\n            if (!hashAlgorithm.name) {\n                return 1;\n            }\n            if (!hashAlgorithm.hash) {\n                return 1;\n            }\n            for (let i = 0; i < this.ocsps.length; i++) {\n                const ocsp = this.ocsps[i];\n                const result = await ocsp.getCertificateStatus(certificate, issuerCertificate, crypto);\n                if (result.isForCertificate) {\n                    if (result.status === 0)\n                        return 0;\n                    return 1;\n                }\n            }\n            return 2;\n        };\n        async function checkForCA(certificate, needToCheckCRL = false) {\n            let isCA = false;\n            let mustBeCA = false;\n            let keyUsagePresent = false;\n            let cRLSign = false;\n            if (certificate.extensions) {\n                for (let j = 0; j < certificate.extensions.length; j++) {\n                    const extension = certificate.extensions[j];\n                    if (extension.critical && !extension.parsedValue) {\n                        return {\n                            result: false,\n                            resultCode: 6,\n                            resultMessage: `Unable to parse critical certificate extension: ${extension.extnID}`\n                        };\n                    }\n                    if (extension.extnID === id_KeyUsage) {\n                        keyUsagePresent = true;\n                        const view = new Uint8Array(extension.parsedValue.valueBlock.valueHex);\n                        if ((view[0] & 0x04) === 0x04)\n                            mustBeCA = true;\n                        if ((view[0] & 0x02) === 0x02)\n                            cRLSign = true;\n                    }\n                    if (extension.extnID === id_BasicConstraints) {\n                        if (\"cA\" in extension.parsedValue) {\n                            if (extension.parsedValue.cA === true)\n                                isCA = true;\n                        }\n                    }\n                }\n                if ((mustBeCA === true) && (isCA === false)) {\n                    return {\n                        result: false,\n                        resultCode: 3,\n                        resultMessage: \"Unable to build certificate chain - using \\\"keyCertSign\\\" flag set without BasicConstraints\"\n                    };\n                }\n                if ((keyUsagePresent === true) && (isCA === true) && (mustBeCA === false)) {\n                    return {\n                        result: false,\n                        resultCode: 4,\n                        resultMessage: \"Unable to build certificate chain - \\\"keyCertSign\\\" flag was not set\"\n                    };\n                }\n                if ((isCA === true) && (keyUsagePresent === true) && ((needToCheckCRL) && (cRLSign === false))) {\n                    return {\n                        result: false,\n                        resultCode: 5,\n                        resultMessage: \"Unable to build certificate chain - intermediate certificate must have \\\"cRLSign\\\" key usage flag\"\n                    };\n                }\n            }\n            if (isCA === false) {\n                return {\n                    result: false,\n                    resultCode: 7,\n                    resultMessage: \"Unable to build certificate chain - more than one possible end-user certificate\"\n                };\n            }\n            return {\n                result: true,\n                resultCode: 0,\n                resultMessage: EMPTY_STRING\n            };\n        }\n        const basicCheck = async (path, checkDate) => {\n            for (let i = 0; i < path.length; i++) {\n                if ((path[i].notBefore.value > checkDate) ||\n                    (path[i].notAfter.value < checkDate)) {\n                    return {\n                        result: false,\n                        resultCode: 8,\n                        resultMessage: \"The certificate is either not yet valid or expired\"\n                    };\n                }\n            }\n            if (path.length < 2) {\n                return {\n                    result: false,\n                    resultCode: 9,\n                    resultMessage: \"Too short certificate path\"\n                };\n            }\n            for (let i = (path.length - 2); i >= 0; i--) {\n                if (path[i].issuer.isEqual(path[i].subject) === false) {\n                    if (path[i].issuer.isEqual(path[i + 1].subject) === false) {\n                        return {\n                            result: false,\n                            resultCode: 10,\n                            resultMessage: \"Incorrect name chaining\"\n                        };\n                    }\n                }\n            }\n            if ((this.crls.length !== 0) || (this.ocsps.length !== 0)) {\n                for (let i = 0; i < (path.length - 1); i++) {\n                    let ocspResult = 2;\n                    let crlResult = {\n                        status: 0,\n                        statusMessage: EMPTY_STRING\n                    };\n                    if (this.ocsps.length !== 0) {\n                        ocspResult = await findOCSP(path[i], path[i + 1]);\n                        switch (ocspResult) {\n                            case 0:\n                                continue;\n                            case 1:\n                                return {\n                                    result: false,\n                                    resultCode: 12,\n                                    resultMessage: \"One of certificates was revoked via OCSP response\"\n                                };\n                        }\n                    }\n                    if (this.crls.length !== 0) {\n                        crlResult = await findCRL(path[i]);\n                        if (crlResult.status === 0 && crlResult.result) {\n                            for (let j = 0; j < crlResult.result.length; j++) {\n                                const isCertificateRevoked = crlResult.result[j].crl.isCertificateRevoked(path[i]);\n                                if (isCertificateRevoked) {\n                                    return {\n                                        result: false,\n                                        resultCode: 12,\n                                        resultMessage: \"One of certificates had been revoked\"\n                                    };\n                                }\n                                const isCertificateCA = await checkForCA(crlResult.result[j].certificate, true);\n                                if (isCertificateCA.result === false) {\n                                    return {\n                                        result: false,\n                                        resultCode: 13,\n                                        resultMessage: \"CRL issuer certificate is not a CA certificate or does not have crlSign flag\"\n                                    };\n                                }\n                            }\n                        }\n                        else {\n                            if (passedWhenNotRevValues === false) {\n                                throw new ChainValidationError(ChainValidationCode.noRevocation, `No revocation values found for one of certificates: ${crlResult.statusMessage}`);\n                            }\n                        }\n                    }\n                    else {\n                        if (ocspResult === 2) {\n                            return {\n                                result: false,\n                                resultCode: 11,\n                                resultMessage: \"No revocation values found for one of certificates\"\n                            };\n                        }\n                    }\n                    if ((ocspResult === 2) && (crlResult.status === 2) && passedWhenNotRevValues) {\n                        const issuerCertificate = path[i + 1];\n                        let extensionFound = false;\n                        if (issuerCertificate.extensions) {\n                            for (const extension of issuerCertificate.extensions) {\n                                switch (extension.extnID) {\n                                    case id_CRLDistributionPoints:\n                                    case id_FreshestCRL:\n                                    case id_AuthorityInfoAccess:\n                                        extensionFound = true;\n                                        break;\n                                }\n                            }\n                        }\n                        if (extensionFound) {\n                            throw new ChainValidationError(ChainValidationCode.noRevocation, `No revocation values found for one of certificates: ${crlResult.statusMessage}`);\n                        }\n                    }\n                }\n            }\n            for (const [i, cert] of path.entries()) {\n                if (!i) {\n                    continue;\n                }\n                const result = await checkForCA(cert);\n                if (!result.result) {\n                    return {\n                        result: false,\n                        resultCode: 14,\n                        resultMessage: \"One of intermediate certificates is not a CA certificate\"\n                    };\n                }\n            }\n            return {\n                result: true\n            };\n        };\n        localCerts.push(...this.trustedCerts);\n        localCerts.push(...this.certs);\n        for (let i = 0; i < localCerts.length; i++) {\n            for (let j = 0; j < localCerts.length; j++) {\n                if (i === j)\n                    continue;\n                if (pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isEqual(localCerts[i].tbsView, localCerts[j].tbsView)) {\n                    localCerts.splice(j, 1);\n                    i = 0;\n                    break;\n                }\n            }\n        }\n        const leafCert = localCerts[localCerts.length - 1];\n        let result;\n        const certificatePath = [leafCert];\n        result = await buildPath(leafCert, crypto);\n        if (result.length === 0) {\n            throw new ChainValidationError(ChainValidationCode.noPath, \"Unable to find certificate path\");\n        }\n        for (let i = result.length - 1; i >= 0; i--) {\n            let found = false;\n            for (let j = 0; j < (result[i]).length; j++) {\n                const certificate = (result[i])[j];\n                for (let k = 0; k < this.trustedCerts.length; k++) {\n                    if (pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isEqual(certificate.tbsView, this.trustedCerts[k].tbsView)) {\n                        found = true;\n                        break;\n                    }\n                }\n                if (found)\n                    break;\n            }\n            if (!found) {\n                result.splice(i, 1);\n            }\n        }\n        if (result.length === 0) {\n            throw new ChainValidationError(ChainValidationCode.noValidPath, \"No valid certificate paths found\");\n        }\n        let shortestLength = result[0].length;\n        let shortestIndex = 0;\n        for (let i = 0; i < result.length; i++) {\n            if (result[i].length < shortestLength) {\n                shortestLength = result[i].length;\n                shortestIndex = i;\n            }\n        }\n        for (let i = 0; i < result[shortestIndex].length; i++)\n            certificatePath.push((result[shortestIndex])[i]);\n        result = await basicCheck(certificatePath, this.checkDate);\n        if (result.result === false)\n            throw result;\n        return certificatePath;\n    }\n    async verify(parameters = {}, crypto = getCrypto(true)) {\n        function compareDNSName(name, constraint) {\n            const namePrepared = stringPrep(name);\n            const constraintPrepared = stringPrep(constraint);\n            const nameSplitted = namePrepared.split(\".\");\n            const constraintSplitted = constraintPrepared.split(\".\");\n            const nameLen = nameSplitted.length;\n            const constrLen = constraintSplitted.length;\n            if ((nameLen === 0) || (constrLen === 0) || (nameLen < constrLen)) {\n                return false;\n            }\n            for (let i = 0; i < nameLen; i++) {\n                if (nameSplitted[i].length === 0) {\n                    return false;\n                }\n            }\n            for (let i = 0; i < constrLen; i++) {\n                if (constraintSplitted[i].length === 0) {\n                    if (i === 0) {\n                        if (constrLen === 1) {\n                            return false;\n                        }\n                        continue;\n                    }\n                    return false;\n                }\n            }\n            for (let i = 0; i < constrLen; i++) {\n                if (constraintSplitted[constrLen - 1 - i].length === 0) {\n                    continue;\n                }\n                if (nameSplitted[nameLen - 1 - i].localeCompare(constraintSplitted[constrLen - 1 - i]) !== 0) {\n                    return false;\n                }\n            }\n            return true;\n        }\n        function compareRFC822Name(name, constraint) {\n            const namePrepared = stringPrep(name);\n            const constraintPrepared = stringPrep(constraint);\n            const nameSplitted = namePrepared.split(\"@\");\n            const constraintSplitted = constraintPrepared.split(\"@\");\n            if ((nameSplitted.length === 0) || (constraintSplitted.length === 0) || (nameSplitted.length < constraintSplitted.length))\n                return false;\n            if (constraintSplitted.length === 1) {\n                const result = compareDNSName(nameSplitted[1], constraintSplitted[0]);\n                if (result) {\n                    const ns = nameSplitted[1].split(\".\");\n                    const cs = constraintSplitted[0].split(\".\");\n                    if (cs[0].length === 0)\n                        return true;\n                    return ns.length === cs.length;\n                }\n                return false;\n            }\n            return (namePrepared.localeCompare(constraintPrepared) === 0);\n        }\n        function compareUniformResourceIdentifier(name, constraint) {\n            let namePrepared = stringPrep(name);\n            const constraintPrepared = stringPrep(constraint);\n            const ns = namePrepared.split(\"/\");\n            const cs = constraintPrepared.split(\"/\");\n            if (cs.length > 1)\n                return false;\n            if (ns.length > 1) {\n                for (let i = 0; i < ns.length; i++) {\n                    if ((ns[i].length > 0) && (ns[i].charAt(ns[i].length - 1) !== \":\")) {\n                        const nsPort = ns[i].split(\":\");\n                        namePrepared = nsPort[0];\n                        break;\n                    }\n                }\n            }\n            const result = compareDNSName(namePrepared, constraintPrepared);\n            if (result) {\n                const nameSplitted = namePrepared.split(\".\");\n                const constraintSplitted = constraintPrepared.split(\".\");\n                if (constraintSplitted[0].length === 0)\n                    return true;\n                return nameSplitted.length === constraintSplitted.length;\n            }\n            return false;\n        }\n        function compareIPAddress(name, constraint) {\n            const nameView = name.valueBlock.valueHexView;\n            const constraintView = constraint.valueBlock.valueHexView;\n            if ((nameView.length === 4) && (constraintView.length === 8)) {\n                for (let i = 0; i < 4; i++) {\n                    if ((nameView[i] ^ constraintView[i]) & constraintView[i + 4])\n                        return false;\n                }\n                return true;\n            }\n            if ((nameView.length === 16) && (constraintView.length === 32)) {\n                for (let i = 0; i < 16; i++) {\n                    if ((nameView[i] ^ constraintView[i]) & constraintView[i + 16])\n                        return false;\n                }\n                return true;\n            }\n            return false;\n        }\n        function compareDirectoryName(name, constraint) {\n            if ((name.typesAndValues.length === 0) || (constraint.typesAndValues.length === 0))\n                return true;\n            if (name.typesAndValues.length < constraint.typesAndValues.length)\n                return false;\n            let result = true;\n            let nameStart = 0;\n            for (let i = 0; i < constraint.typesAndValues.length; i++) {\n                let localResult = false;\n                for (let j = nameStart; j < name.typesAndValues.length; j++) {\n                    localResult = name.typesAndValues[j].isEqual(constraint.typesAndValues[i]);\n                    if (name.typesAndValues[j].type === constraint.typesAndValues[i].type)\n                        result = result && localResult;\n                    if (localResult === true) {\n                        if ((nameStart === 0) || (nameStart === j)) {\n                            nameStart = j + 1;\n                            break;\n                        }\n                        else\n                            return false;\n                    }\n                }\n                if (localResult === false)\n                    return false;\n            }\n            return (nameStart === 0) ? false : result;\n        }\n        try {\n            if (this.certs.length === 0)\n                throw new Error(\"Empty certificate array\");\n            const passedWhenNotRevValues = parameters.passedWhenNotRevValues || false;\n            const initialPolicySet = parameters.initialPolicySet || [id_AnyPolicy];\n            const initialExplicitPolicy = parameters.initialExplicitPolicy || false;\n            const initialPolicyMappingInhibit = parameters.initialPolicyMappingInhibit || false;\n            const initialInhibitPolicy = parameters.initialInhibitPolicy || false;\n            const initialPermittedSubtreesSet = parameters.initialPermittedSubtreesSet || [];\n            const initialExcludedSubtreesSet = parameters.initialExcludedSubtreesSet || [];\n            const initialRequiredNameForms = parameters.initialRequiredNameForms || [];\n            let explicitPolicyIndicator = initialExplicitPolicy;\n            let policyMappingInhibitIndicator = initialPolicyMappingInhibit;\n            let inhibitAnyPolicyIndicator = initialInhibitPolicy;\n            const pendingConstraints = [\n                false,\n                false,\n                false,\n            ];\n            let explicitPolicyPending = 0;\n            let policyMappingInhibitPending = 0;\n            let inhibitAnyPolicyPending = 0;\n            let permittedSubtrees = initialPermittedSubtreesSet;\n            let excludedSubtrees = initialExcludedSubtreesSet;\n            const requiredNameForms = initialRequiredNameForms;\n            let pathDepth = 1;\n            this.certs = await this.sort(passedWhenNotRevValues, crypto);\n            const allPolicies = [];\n            allPolicies.push(id_AnyPolicy);\n            const policiesAndCerts = [];\n            const anyPolicyArray = new Array(this.certs.length - 1);\n            for (let ii = 0; ii < (this.certs.length - 1); ii++)\n                anyPolicyArray[ii] = true;\n            policiesAndCerts.push(anyPolicyArray);\n            const policyMappings = new Array(this.certs.length - 1);\n            const certPolicies = new Array(this.certs.length - 1);\n            let explicitPolicyStart = (explicitPolicyIndicator) ? (this.certs.length - 1) : (-1);\n            for (let i = (this.certs.length - 2); i >= 0; i--, pathDepth++) {\n                const cert = this.certs[i];\n                if (cert.extensions) {\n                    for (let j = 0; j < cert.extensions.length; j++) {\n                        const extension = cert.extensions[j];\n                        if (extension.extnID === id_CertificatePolicies) {\n                            certPolicies[i] = extension.parsedValue;\n                            for (let s = 0; s < allPolicies.length; s++) {\n                                if (allPolicies[s] === id_AnyPolicy) {\n                                    delete (policiesAndCerts[s])[i];\n                                    break;\n                                }\n                            }\n                            for (let k = 0; k < extension.parsedValue.certificatePolicies.length; k++) {\n                                let policyIndex = (-1);\n                                const policyId = extension.parsedValue.certificatePolicies[k].policyIdentifier;\n                                for (let s = 0; s < allPolicies.length; s++) {\n                                    if (policyId === allPolicies[s]) {\n                                        policyIndex = s;\n                                        break;\n                                    }\n                                }\n                                if (policyIndex === (-1)) {\n                                    allPolicies.push(policyId);\n                                    const certArray = new Array(this.certs.length - 1);\n                                    certArray[i] = true;\n                                    policiesAndCerts.push(certArray);\n                                }\n                                else\n                                    (policiesAndCerts[policyIndex])[i] = true;\n                            }\n                        }\n                        if (extension.extnID === id_PolicyMappings) {\n                            if (policyMappingInhibitIndicator) {\n                                return {\n                                    result: false,\n                                    resultCode: 98,\n                                    resultMessage: \"Policy mapping prohibited\"\n                                };\n                            }\n                            policyMappings[i] = extension.parsedValue;\n                        }\n                        if (extension.extnID === id_PolicyConstraints) {\n                            if (explicitPolicyIndicator === false) {\n                                if (extension.parsedValue.requireExplicitPolicy === 0) {\n                                    explicitPolicyIndicator = true;\n                                    explicitPolicyStart = i;\n                                }\n                                else {\n                                    if (pendingConstraints[0] === false) {\n                                        pendingConstraints[0] = true;\n                                        explicitPolicyPending = extension.parsedValue.requireExplicitPolicy;\n                                    }\n                                    else\n                                        explicitPolicyPending = (explicitPolicyPending > extension.parsedValue.requireExplicitPolicy) ? extension.parsedValue.requireExplicitPolicy : explicitPolicyPending;\n                                }\n                                if (extension.parsedValue.inhibitPolicyMapping === 0)\n                                    policyMappingInhibitIndicator = true;\n                                else {\n                                    if (pendingConstraints[1] === false) {\n                                        pendingConstraints[1] = true;\n                                        policyMappingInhibitPending = extension.parsedValue.inhibitPolicyMapping + 1;\n                                    }\n                                    else\n                                        policyMappingInhibitPending = (policyMappingInhibitPending > (extension.parsedValue.inhibitPolicyMapping + 1)) ? (extension.parsedValue.inhibitPolicyMapping + 1) : policyMappingInhibitPending;\n                                }\n                            }\n                        }\n                        if (extension.extnID === id_InhibitAnyPolicy) {\n                            if (inhibitAnyPolicyIndicator === false) {\n                                if (extension.parsedValue.valueBlock.valueDec === 0)\n                                    inhibitAnyPolicyIndicator = true;\n                                else {\n                                    if (pendingConstraints[2] === false) {\n                                        pendingConstraints[2] = true;\n                                        inhibitAnyPolicyPending = extension.parsedValue.valueBlock.valueDec;\n                                    }\n                                    else\n                                        inhibitAnyPolicyPending = (inhibitAnyPolicyPending > extension.parsedValue.valueBlock.valueDec) ? extension.parsedValue.valueBlock.valueDec : inhibitAnyPolicyPending;\n                                }\n                            }\n                        }\n                    }\n                    if (inhibitAnyPolicyIndicator === true) {\n                        let policyIndex = (-1);\n                        for (let searchAnyPolicy = 0; searchAnyPolicy < allPolicies.length; searchAnyPolicy++) {\n                            if (allPolicies[searchAnyPolicy] === id_AnyPolicy) {\n                                policyIndex = searchAnyPolicy;\n                                break;\n                            }\n                        }\n                        if (policyIndex !== (-1))\n                            delete (policiesAndCerts[0])[i];\n                    }\n                    if (explicitPolicyIndicator === false) {\n                        if (pendingConstraints[0] === true) {\n                            explicitPolicyPending--;\n                            if (explicitPolicyPending === 0) {\n                                explicitPolicyIndicator = true;\n                                explicitPolicyStart = i;\n                                pendingConstraints[0] = false;\n                            }\n                        }\n                    }\n                    if (policyMappingInhibitIndicator === false) {\n                        if (pendingConstraints[1] === true) {\n                            policyMappingInhibitPending--;\n                            if (policyMappingInhibitPending === 0) {\n                                policyMappingInhibitIndicator = true;\n                                pendingConstraints[1] = false;\n                            }\n                        }\n                    }\n                    if (inhibitAnyPolicyIndicator === false) {\n                        if (pendingConstraints[2] === true) {\n                            inhibitAnyPolicyPending--;\n                            if (inhibitAnyPolicyPending === 0) {\n                                inhibitAnyPolicyIndicator = true;\n                                pendingConstraints[2] = false;\n                            }\n                        }\n                    }\n                }\n            }\n            for (let i = 0; i < (this.certs.length - 1); i++) {\n                if ((i < (this.certs.length - 2)) && (typeof policyMappings[i + 1] !== \"undefined\")) {\n                    for (let k = 0; k < policyMappings[i + 1].mappings.length; k++) {\n                        if ((policyMappings[i + 1].mappings[k].issuerDomainPolicy === id_AnyPolicy) || (policyMappings[i + 1].mappings[k].subjectDomainPolicy === id_AnyPolicy)) {\n                            return {\n                                result: false,\n                                resultCode: 99,\n                                resultMessage: \"The \\\"anyPolicy\\\" should not be a part of policy mapping scheme\"\n                            };\n                        }\n                        let issuerDomainPolicyIndex = (-1);\n                        let subjectDomainPolicyIndex = (-1);\n                        for (let n = 0; n < allPolicies.length; n++) {\n                            if (allPolicies[n] === policyMappings[i + 1].mappings[k].issuerDomainPolicy)\n                                issuerDomainPolicyIndex = n;\n                            if (allPolicies[n] === policyMappings[i + 1].mappings[k].subjectDomainPolicy)\n                                subjectDomainPolicyIndex = n;\n                        }\n                        if (typeof (policiesAndCerts[issuerDomainPolicyIndex])[i] !== \"undefined\")\n                            delete (policiesAndCerts[issuerDomainPolicyIndex])[i];\n                        for (let j = 0; j < certPolicies[i].certificatePolicies.length; j++) {\n                            if (policyMappings[i + 1].mappings[k].subjectDomainPolicy === certPolicies[i].certificatePolicies[j].policyIdentifier) {\n                                if ((issuerDomainPolicyIndex !== (-1)) && (subjectDomainPolicyIndex !== (-1))) {\n                                    for (let m = 0; m <= i; m++) {\n                                        if (typeof (policiesAndCerts[subjectDomainPolicyIndex])[m] !== \"undefined\") {\n                                            (policiesAndCerts[issuerDomainPolicyIndex])[m] = true;\n                                            delete (policiesAndCerts[subjectDomainPolicyIndex])[m];\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            for (let i = 0; i < allPolicies.length; i++) {\n                if (allPolicies[i] === id_AnyPolicy) {\n                    for (let j = 0; j < explicitPolicyStart; j++)\n                        delete (policiesAndCerts[i])[j];\n                }\n            }\n            const authConstrPolicies = [];\n            for (let i = 0; i < policiesAndCerts.length; i++) {\n                let found = true;\n                for (let j = 0; j < (this.certs.length - 1); j++) {\n                    let anyPolicyFound = false;\n                    if ((j < explicitPolicyStart) && (allPolicies[i] === id_AnyPolicy) && (allPolicies.length > 1)) {\n                        found = false;\n                        break;\n                    }\n                    if (typeof (policiesAndCerts[i])[j] === \"undefined\") {\n                        if (j >= explicitPolicyStart) {\n                            for (let k = 0; k < allPolicies.length; k++) {\n                                if (allPolicies[k] === id_AnyPolicy) {\n                                    if ((policiesAndCerts[k])[j] === true)\n                                        anyPolicyFound = true;\n                                    break;\n                                }\n                            }\n                        }\n                        if (!anyPolicyFound) {\n                            found = false;\n                            break;\n                        }\n                    }\n                }\n                if (found === true)\n                    authConstrPolicies.push(allPolicies[i]);\n            }\n            let userConstrPolicies = [];\n            if ((initialPolicySet.length === 1) && (initialPolicySet[0] === id_AnyPolicy) && (explicitPolicyIndicator === false))\n                userConstrPolicies = initialPolicySet;\n            else {\n                if ((authConstrPolicies.length === 1) && (authConstrPolicies[0] === id_AnyPolicy))\n                    userConstrPolicies = initialPolicySet;\n                else {\n                    for (let i = 0; i < authConstrPolicies.length; i++) {\n                        for (let j = 0; j < initialPolicySet.length; j++) {\n                            if ((initialPolicySet[j] === authConstrPolicies[i]) || (initialPolicySet[j] === id_AnyPolicy)) {\n                                userConstrPolicies.push(authConstrPolicies[i]);\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n            const policyResult = {\n                result: (userConstrPolicies.length > 0),\n                resultCode: 0,\n                resultMessage: (userConstrPolicies.length > 0) ? EMPTY_STRING : \"Zero \\\"userConstrPolicies\\\" array, no intersections with \\\"authConstrPolicies\\\"\",\n                authConstrPolicies,\n                userConstrPolicies,\n                explicitPolicyIndicator,\n                policyMappings,\n                certificatePath: this.certs\n            };\n            if (userConstrPolicies.length === 0)\n                return policyResult;\n            if (policyResult.result === false)\n                return policyResult;\n            pathDepth = 1;\n            for (let i = (this.certs.length - 2); i >= 0; i--, pathDepth++) {\n                const cert = this.certs[i];\n                let subjectAltNames = [];\n                let certPermittedSubtrees = [];\n                let certExcludedSubtrees = [];\n                if (cert.extensions) {\n                    for (let j = 0; j < cert.extensions.length; j++) {\n                        const extension = cert.extensions[j];\n                        if (extension.extnID === id_NameConstraints) {\n                            if (\"permittedSubtrees\" in extension.parsedValue)\n                                certPermittedSubtrees = certPermittedSubtrees.concat(extension.parsedValue.permittedSubtrees);\n                            if (\"excludedSubtrees\" in extension.parsedValue)\n                                certExcludedSubtrees = certExcludedSubtrees.concat(extension.parsedValue.excludedSubtrees);\n                        }\n                        if (extension.extnID === id_SubjectAltName)\n                            subjectAltNames = subjectAltNames.concat(extension.parsedValue.altNames);\n                    }\n                }\n                let formFound = (requiredNameForms.length <= 0);\n                for (let j = 0; j < requiredNameForms.length; j++) {\n                    switch (requiredNameForms[j].base.type) {\n                        case 4:\n                            {\n                                if (requiredNameForms[j].base.value.typesAndValues.length !== cert.subject.typesAndValues.length)\n                                    continue;\n                                formFound = true;\n                                for (let k = 0; k < cert.subject.typesAndValues.length; k++) {\n                                    if (cert.subject.typesAndValues[k].type !== requiredNameForms[j].base.value.typesAndValues[k].type) {\n                                        formFound = false;\n                                        break;\n                                    }\n                                }\n                                if (formFound === true)\n                                    break;\n                            }\n                            break;\n                        default:\n                    }\n                }\n                if (formFound === false) {\n                    policyResult.result = false;\n                    policyResult.resultCode = 21;\n                    policyResult.resultMessage = \"No necessary name form found\";\n                    throw policyResult;\n                }\n                const constrGroups = [\n                    [],\n                    [],\n                    [],\n                    [],\n                    [],\n                ];\n                for (let j = 0; j < permittedSubtrees.length; j++) {\n                    switch (permittedSubtrees[j].base.type) {\n                        case 1:\n                            constrGroups[0].push(permittedSubtrees[j]);\n                            break;\n                        case 2:\n                            constrGroups[1].push(permittedSubtrees[j]);\n                            break;\n                        case 4:\n                            constrGroups[2].push(permittedSubtrees[j]);\n                            break;\n                        case 6:\n                            constrGroups[3].push(permittedSubtrees[j]);\n                            break;\n                        case 7:\n                            constrGroups[4].push(permittedSubtrees[j]);\n                            break;\n                        default:\n                    }\n                }\n                for (let p = 0; p < 5; p++) {\n                    let groupPermitted = false;\n                    let valueExists = false;\n                    const group = constrGroups[p];\n                    for (let j = 0; j < group.length; j++) {\n                        switch (p) {\n                            case 0:\n                                if (subjectAltNames.length > 0) {\n                                    for (let k = 0; k < subjectAltNames.length; k++) {\n                                        if (subjectAltNames[k].type === 1) {\n                                            valueExists = true;\n                                            groupPermitted = groupPermitted || compareRFC822Name(subjectAltNames[k].value, group[j].base.value);\n                                        }\n                                    }\n                                }\n                                else {\n                                    for (let k = 0; k < cert.subject.typesAndValues.length; k++) {\n                                        if ((cert.subject.typesAndValues[k].type === \"1.2.840.113549.1.9.1\") ||\n                                            (cert.subject.typesAndValues[k].type === \"0.9.2342.19200300.100.1.3\")) {\n                                            valueExists = true;\n                                            groupPermitted = groupPermitted || compareRFC822Name(cert.subject.typesAndValues[k].value.valueBlock.value, group[j].base.value);\n                                        }\n                                    }\n                                }\n                                break;\n                            case 1:\n                                if (subjectAltNames.length > 0) {\n                                    for (let k = 0; k < subjectAltNames.length; k++) {\n                                        if (subjectAltNames[k].type === 2) {\n                                            valueExists = true;\n                                            groupPermitted = groupPermitted || compareDNSName(subjectAltNames[k].value, group[j].base.value);\n                                        }\n                                    }\n                                }\n                                break;\n                            case 2:\n                                valueExists = true;\n                                groupPermitted = compareDirectoryName(cert.subject, group[j].base.value);\n                                break;\n                            case 3:\n                                if (subjectAltNames.length > 0) {\n                                    for (let k = 0; k < subjectAltNames.length; k++) {\n                                        if (subjectAltNames[k].type === 6) {\n                                            valueExists = true;\n                                            groupPermitted = groupPermitted || compareUniformResourceIdentifier(subjectAltNames[k].value, group[j].base.value);\n                                        }\n                                    }\n                                }\n                                break;\n                            case 4:\n                                if (subjectAltNames.length > 0) {\n                                    for (let k = 0; k < subjectAltNames.length; k++) {\n                                        if (subjectAltNames[k].type === 7) {\n                                            valueExists = true;\n                                            groupPermitted = groupPermitted || compareIPAddress(subjectAltNames[k].value, group[j].base.value);\n                                        }\n                                    }\n                                }\n                                break;\n                            default:\n                        }\n                        if (groupPermitted)\n                            break;\n                    }\n                    if ((groupPermitted === false) && (group.length > 0) && valueExists) {\n                        policyResult.result = false;\n                        policyResult.resultCode = 41;\n                        policyResult.resultMessage = \"Failed to meet \\\"permitted sub-trees\\\" name constraint\";\n                        throw policyResult;\n                    }\n                }\n                let excluded = false;\n                for (let j = 0; j < excludedSubtrees.length; j++) {\n                    switch (excludedSubtrees[j].base.type) {\n                        case 1:\n                            if (subjectAltNames.length >= 0) {\n                                for (let k = 0; k < subjectAltNames.length; k++) {\n                                    if (subjectAltNames[k].type === 1)\n                                        excluded = excluded || compareRFC822Name(subjectAltNames[k].value, excludedSubtrees[j].base.value);\n                                }\n                            }\n                            else {\n                                for (let k = 0; k < cert.subject.typesAndValues.length; k++) {\n                                    if ((cert.subject.typesAndValues[k].type === \"1.2.840.113549.1.9.1\") ||\n                                        (cert.subject.typesAndValues[k].type === \"0.9.2342.19200300.100.1.3\"))\n                                        excluded = excluded || compareRFC822Name(cert.subject.typesAndValues[k].value.valueBlock.value, excludedSubtrees[j].base.value);\n                                }\n                            }\n                            break;\n                        case 2:\n                            if (subjectAltNames.length > 0) {\n                                for (let k = 0; k < subjectAltNames.length; k++) {\n                                    if (subjectAltNames[k].type === 2)\n                                        excluded = excluded || compareDNSName(subjectAltNames[k].value, excludedSubtrees[j].base.value);\n                                }\n                            }\n                            break;\n                        case 4:\n                            excluded = excluded || compareDirectoryName(cert.subject, excludedSubtrees[j].base.value);\n                            break;\n                        case 6:\n                            if (subjectAltNames.length > 0) {\n                                for (let k = 0; k < subjectAltNames.length; k++) {\n                                    if (subjectAltNames[k].type === 6)\n                                        excluded = excluded || compareUniformResourceIdentifier(subjectAltNames[k].value, excludedSubtrees[j].base.value);\n                                }\n                            }\n                            break;\n                        case 7:\n                            if (subjectAltNames.length > 0) {\n                                for (let k = 0; k < subjectAltNames.length; k++) {\n                                    if (subjectAltNames[k].type === 7)\n                                        excluded = excluded || compareIPAddress(subjectAltNames[k].value, excludedSubtrees[j].base.value);\n                                }\n                            }\n                            break;\n                        default:\n                    }\n                    if (excluded)\n                        break;\n                }\n                if (excluded === true) {\n                    policyResult.result = false;\n                    policyResult.resultCode = 42;\n                    policyResult.resultMessage = \"Failed to meet \\\"excluded sub-trees\\\" name constraint\";\n                    throw policyResult;\n                }\n                permittedSubtrees = permittedSubtrees.concat(certPermittedSubtrees);\n                excludedSubtrees = excludedSubtrees.concat(certExcludedSubtrees);\n            }\n            return policyResult;\n        }\n        catch (error) {\n            if (error instanceof Error) {\n                if (error instanceof ChainValidationError) {\n                    return {\n                        result: false,\n                        resultCode: error.code,\n                        resultMessage: error.message,\n                        error: error,\n                    };\n                }\n                return {\n                    result: false,\n                    resultCode: ChainValidationCode.unknown,\n                    resultMessage: error.message,\n                    error: error,\n                };\n            }\n            if (error && typeof error === \"object\" && \"resultMessage\" in error) {\n                return error;\n            }\n            return {\n                result: false,\n                resultCode: -1,\n                resultMessage: `${error}`,\n            };\n        }\n    }\n}\n\nconst TBS_RESPONSE_DATA = \"tbsResponseData\";\nconst SIGNATURE_ALGORITHM$3 = \"signatureAlgorithm\";\nconst SIGNATURE$2 = \"signature\";\nconst CERTS$1 = \"certs\";\nconst BASIC_OCSP_RESPONSE = \"BasicOCSPResponse\";\nconst BASIC_OCSP_RESPONSE_TBS_RESPONSE_DATA = `${BASIC_OCSP_RESPONSE}.${TBS_RESPONSE_DATA}`;\nconst BASIC_OCSP_RESPONSE_SIGNATURE_ALGORITHM = `${BASIC_OCSP_RESPONSE}.${SIGNATURE_ALGORITHM$3}`;\nconst BASIC_OCSP_RESPONSE_SIGNATURE = `${BASIC_OCSP_RESPONSE}.${SIGNATURE$2}`;\nconst BASIC_OCSP_RESPONSE_CERTS = `${BASIC_OCSP_RESPONSE}.${CERTS$1}`;\nconst CLEAR_PROPS$g = [\n    BASIC_OCSP_RESPONSE_TBS_RESPONSE_DATA,\n    BASIC_OCSP_RESPONSE_SIGNATURE_ALGORITHM,\n    BASIC_OCSP_RESPONSE_SIGNATURE,\n    BASIC_OCSP_RESPONSE_CERTS\n];\nclass BasicOCSPResponse extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.tbsResponseData = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TBS_RESPONSE_DATA, BasicOCSPResponse.defaultValues(TBS_RESPONSE_DATA));\n        this.signatureAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_ALGORITHM$3, BasicOCSPResponse.defaultValues(SIGNATURE_ALGORITHM$3));\n        this.signature = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE$2, BasicOCSPResponse.defaultValues(SIGNATURE$2));\n        if (CERTS$1 in parameters) {\n            this.certs = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CERTS$1, BasicOCSPResponse.defaultValues(CERTS$1));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TBS_RESPONSE_DATA:\n                return new ResponseData();\n            case SIGNATURE_ALGORITHM$3:\n                return new AlgorithmIdentifier();\n            case SIGNATURE$2:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            case CERTS$1:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case \"type\":\n                {\n                    let comparisonResult = ((ResponseData.compareWithDefault(\"tbs\", memberValue.tbs)) &&\n                        (ResponseData.compareWithDefault(\"responderID\", memberValue.responderID)) &&\n                        (ResponseData.compareWithDefault(\"producedAt\", memberValue.producedAt)) &&\n                        (ResponseData.compareWithDefault(\"responses\", memberValue.responses)));\n                    if (\"responseExtensions\" in memberValue)\n                        comparisonResult = comparisonResult && (ResponseData.compareWithDefault(\"responseExtensions\", memberValue.responseExtensions));\n                    return comparisonResult;\n                }\n            case SIGNATURE_ALGORITHM$3:\n                return ((memberValue.algorithmId === EMPTY_STRING) && ((\"algorithmParams\" in memberValue) === false));\n            case SIGNATURE$2:\n                return (memberValue.isEqual(BasicOCSPResponse.defaultValues(memberName)));\n            case CERTS$1:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || BASIC_OCSP_RESPONSE),\n            value: [\n                ResponseData.schema(names.tbsResponseData || {\n                    names: {\n                        blockName: BASIC_OCSP_RESPONSE_TBS_RESPONSE_DATA\n                    }\n                }),\n                AlgorithmIdentifier.schema(names.signatureAlgorithm || {\n                    names: {\n                        blockName: BASIC_OCSP_RESPONSE_SIGNATURE_ALGORITHM\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ name: (names.signature || BASIC_OCSP_RESPONSE_SIGNATURE) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                            value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                                    name: BASIC_OCSP_RESPONSE_CERTS,\n                                    value: Certificate.schema(names.certs || {})\n                                })]\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$g);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, BasicOCSPResponse.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.tbsResponseData = new ResponseData({ schema: asn1.result[BASIC_OCSP_RESPONSE_TBS_RESPONSE_DATA] });\n        this.signatureAlgorithm = new AlgorithmIdentifier({ schema: asn1.result[BASIC_OCSP_RESPONSE_SIGNATURE_ALGORITHM] });\n        this.signature = asn1.result[BASIC_OCSP_RESPONSE_SIGNATURE];\n        if (BASIC_OCSP_RESPONSE_CERTS in asn1.result) {\n            this.certs = Array.from(asn1.result[BASIC_OCSP_RESPONSE_CERTS], element => new Certificate({ schema: element }));\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(this.tbsResponseData.toSchema());\n        outputArray.push(this.signatureAlgorithm.toSchema());\n        outputArray.push(this.signature);\n        if (this.certs) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                        value: Array.from(this.certs, o => o.toSchema())\n                    })\n                ]\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            tbsResponseData: this.tbsResponseData.toJSON(),\n            signatureAlgorithm: this.signatureAlgorithm.toJSON(),\n            signature: this.signature.toJSON(),\n        };\n        if (this.certs) {\n            res.certs = Array.from(this.certs, o => o.toJSON());\n        }\n        return res;\n    }\n    async getCertificateStatus(certificate, issuerCertificate, crypto = getCrypto(true)) {\n        const result = {\n            isForCertificate: false,\n            status: 2\n        };\n        const hashesObject = {};\n        const certIDs = [];\n        for (const response of this.tbsResponseData.responses) {\n            const hashAlgorithm = crypto.getAlgorithmByOID(response.certID.hashAlgorithm.algorithmId, true, \"CertID.hashAlgorithm\");\n            if (!hashesObject[hashAlgorithm.name]) {\n                hashesObject[hashAlgorithm.name] = 1;\n                const certID = new CertID();\n                certIDs.push(certID);\n                await certID.createForCertificate(certificate, {\n                    hashAlgorithm: hashAlgorithm.name,\n                    issuerCertificate\n                }, crypto);\n            }\n        }\n        for (const response of this.tbsResponseData.responses) {\n            for (const id of certIDs) {\n                if (response.certID.isEqual(id)) {\n                    result.isForCertificate = true;\n                    try {\n                        switch (response.certStatus.idBlock.isConstructed) {\n                            case true:\n                                if (response.certStatus.idBlock.tagNumber === 1)\n                                    result.status = 1;\n                                break;\n                            case false:\n                                switch (response.certStatus.idBlock.tagNumber) {\n                                    case 0:\n                                        result.status = 0;\n                                        break;\n                                    case 2:\n                                        result.status = 2;\n                                        break;\n                                    default:\n                                }\n                                break;\n                            default:\n                        }\n                    }\n                    catch {\n                    }\n                    return result;\n                }\n            }\n        }\n        return result;\n    }\n    async sign(privateKey, hashAlgorithm = \"SHA-1\", crypto = getCrypto(true)) {\n        if (!privateKey) {\n            throw new Error(\"Need to provide a private key for signing\");\n        }\n        const signatureParams = await crypto.getSignatureParameters(privateKey, hashAlgorithm);\n        const algorithm = signatureParams.parameters.algorithm;\n        if (!(\"name\" in algorithm)) {\n            throw new Error(\"Empty algorithm\");\n        }\n        this.signatureAlgorithm = signatureParams.signatureAlgorithm;\n        this.tbsResponseData.tbsView = new Uint8Array(this.tbsResponseData.toSchema(true).toBER());\n        const signature = await crypto.signWithPrivateKey(this.tbsResponseData.tbsView, privateKey, { algorithm });\n        this.signature = new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ valueHex: signature });\n    }\n    async verify(params = {}, crypto = getCrypto(true)) {\n        let signerCert = null;\n        let certIndex = -1;\n        const trustedCerts = params.trustedCerts || [];\n        if (!this.certs) {\n            throw new Error(\"No certificates attached to the BasicOCSPResponse\");\n        }\n        switch (true) {\n            case (this.tbsResponseData.responderID instanceof RelativeDistinguishedNames):\n                for (const [index, certificate] of this.certs.entries()) {\n                    if (certificate.subject.isEqual(this.tbsResponseData.responderID)) {\n                        certIndex = index;\n                        break;\n                    }\n                }\n                break;\n            case (this.tbsResponseData.responderID instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString):\n                for (const [index, cert] of this.certs.entries()) {\n                    const hash = await crypto.digest({ name: \"sha-1\" }, cert.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView);\n                    if (pvutils__WEBPACK_IMPORTED_MODULE_2__.isEqualBuffer(hash, this.tbsResponseData.responderID.valueBlock.valueHex)) {\n                        certIndex = index;\n                        break;\n                    }\n                }\n                break;\n            default:\n                throw new Error(\"Wrong value for responderID\");\n        }\n        if (certIndex === (-1))\n            throw new Error(\"Correct certificate was not found in OCSP response\");\n        signerCert = this.certs[certIndex];\n        const additionalCerts = [signerCert];\n        for (const cert of this.certs) {\n            const caCert = await checkCA(cert, signerCert);\n            if (caCert) {\n                additionalCerts.push(caCert);\n            }\n        }\n        const certChain = new CertificateChainValidationEngine({\n            certs: additionalCerts,\n            trustedCerts,\n        });\n        const verificationResult = await certChain.verify({}, crypto);\n        if (!verificationResult.result) {\n            throw new Error(\"Validation of signer's certificate failed\");\n        }\n        return crypto.verifyWithPublicKey(this.tbsResponseData.tbsView, this.signature, this.certs[certIndex].subjectPublicKeyInfo, this.signatureAlgorithm);\n    }\n}\nBasicOCSPResponse.CLASS_NAME = \"BasicOCSPResponse\";\n\nconst TBS$1 = \"tbs\";\nconst VERSION$6 = \"version\";\nconst SUBJECT = \"subject\";\nconst SPKI = \"subjectPublicKeyInfo\";\nconst ATTRIBUTES$1 = \"attributes\";\nconst SIGNATURE_ALGORITHM$2 = \"signatureAlgorithm\";\nconst SIGNATURE_VALUE = \"signatureValue\";\nconst CSR_INFO = \"CertificationRequestInfo\";\nconst CSR_INFO_VERSION = `${CSR_INFO}.version`;\nconst CSR_INFO_SUBJECT = `${CSR_INFO}.subject`;\nconst CSR_INFO_SPKI = `${CSR_INFO}.subjectPublicKeyInfo`;\nconst CSR_INFO_ATTRS = `${CSR_INFO}.attributes`;\nconst CLEAR_PROPS$f = [\n    CSR_INFO,\n    CSR_INFO_VERSION,\n    CSR_INFO_SUBJECT,\n    CSR_INFO_SPKI,\n    CSR_INFO_ATTRS,\n    SIGNATURE_ALGORITHM$2,\n    SIGNATURE_VALUE\n];\nfunction CertificationRequestInfo(parameters = {}) {\n    const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n    return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n        name: (names.CertificationRequestInfo || CSR_INFO),\n        value: [\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.CertificationRequestInfoVersion || CSR_INFO_VERSION) }),\n            RelativeDistinguishedNames.schema(names.subject || {\n                names: {\n                    blockName: CSR_INFO_SUBJECT\n                }\n            }),\n            PublicKeyInfo.schema({\n                names: {\n                    blockName: CSR_INFO_SPKI\n                }\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                        optional: true,\n                        name: (names.CertificationRequestInfoAttributes || CSR_INFO_ATTRS),\n                        value: Attribute.schema(names.attributes || {})\n                    })\n                ]\n            })\n        ]\n    }));\n}\nclass CertificationRequest extends PkiObject {\n    get tbs() {\n        return pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.toArrayBuffer(this.tbsView);\n    }\n    set tbs(value) {\n        this.tbsView = new Uint8Array(value);\n    }\n    constructor(parameters = {}) {\n        super();\n        this.tbsView = new Uint8Array(pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TBS$1, CertificationRequest.defaultValues(TBS$1)));\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$6, CertificationRequest.defaultValues(VERSION$6));\n        this.subject = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SUBJECT, CertificationRequest.defaultValues(SUBJECT));\n        this.subjectPublicKeyInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SPKI, CertificationRequest.defaultValues(SPKI));\n        if (ATTRIBUTES$1 in parameters) {\n            this.attributes = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ATTRIBUTES$1, CertificationRequest.defaultValues(ATTRIBUTES$1));\n        }\n        this.signatureAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_ALGORITHM$2, CertificationRequest.defaultValues(SIGNATURE_ALGORITHM$2));\n        this.signatureValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_VALUE, CertificationRequest.defaultValues(SIGNATURE_VALUE));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TBS$1:\n                return EMPTY_BUFFER;\n            case VERSION$6:\n                return 0;\n            case SUBJECT:\n                return new RelativeDistinguishedNames();\n            case SPKI:\n                return new PublicKeyInfo();\n            case ATTRIBUTES$1:\n                return [];\n            case SIGNATURE_ALGORITHM$2:\n                return new AlgorithmIdentifier();\n            case SIGNATURE_VALUE:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                CertificationRequestInfo(names.certificationRequestInfo || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    name: (names.signatureAlgorithm || SIGNATURE_ALGORITHM$2),\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier(),\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ optional: true })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ name: (names.signatureValue || SIGNATURE_VALUE) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$f);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, CertificationRequest.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.tbsView = asn1.result.CertificationRequestInfo.valueBeforeDecodeView;\n        this.version = asn1.result[CSR_INFO_VERSION].valueBlock.valueDec;\n        this.subject = new RelativeDistinguishedNames({ schema: asn1.result[CSR_INFO_SUBJECT] });\n        this.subjectPublicKeyInfo = new PublicKeyInfo({ schema: asn1.result[CSR_INFO_SPKI] });\n        if (CSR_INFO_ATTRS in asn1.result) {\n            this.attributes = Array.from(asn1.result[CSR_INFO_ATTRS], element => new Attribute({ schema: element }));\n        }\n        this.signatureAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.signatureAlgorithm });\n        this.signatureValue = asn1.result.signatureValue;\n    }\n    encodeTBS() {\n        const outputArray = [\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }),\n            this.subject.toSchema(),\n            this.subjectPublicKeyInfo.toSchema()\n        ];\n        if (ATTRIBUTES$1 in this) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: Array.from(this.attributes || [], o => o.toSchema())\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toSchema(encodeFlag = false) {\n        let tbsSchema;\n        if (encodeFlag === false) {\n            if (this.tbsView.byteLength === 0) {\n                return CertificationRequest.schema();\n            }\n            const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(this.tbsView);\n            AsnError.assert(asn1, \"PKCS#10 Certificate Request\");\n            tbsSchema = asn1.result;\n        }\n        else {\n            tbsSchema = this.encodeTBS();\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                tbsSchema,\n                this.signatureAlgorithm.toSchema(),\n                this.signatureValue\n            ]\n        }));\n    }\n    toJSON() {\n        const object = {\n            tbs: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToHex(this.tbsView),\n            version: this.version,\n            subject: this.subject.toJSON(),\n            subjectPublicKeyInfo: this.subjectPublicKeyInfo.toJSON(),\n            signatureAlgorithm: this.signatureAlgorithm.toJSON(),\n            signatureValue: this.signatureValue.toJSON(),\n        };\n        if (ATTRIBUTES$1 in this) {\n            object.attributes = Array.from(this.attributes || [], o => o.toJSON());\n        }\n        return object;\n    }\n    async sign(privateKey, hashAlgorithm = \"SHA-1\", crypto = getCrypto(true)) {\n        if (!privateKey) {\n            throw new Error(\"Need to provide a private key for signing\");\n        }\n        const signatureParams = await crypto.getSignatureParameters(privateKey, hashAlgorithm);\n        const parameters = signatureParams.parameters;\n        this.signatureAlgorithm = signatureParams.signatureAlgorithm;\n        this.tbsView = new Uint8Array(this.encodeTBS().toBER());\n        const signature = await crypto.signWithPrivateKey(this.tbsView, privateKey, parameters);\n        this.signatureValue = new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ valueHex: signature });\n    }\n    async verify(crypto = getCrypto(true)) {\n        return crypto.verifyWithPublicKey(this.tbsView, this.signatureValue, this.subjectPublicKeyInfo, this.signatureAlgorithm);\n    }\n    async getPublicKey(parameters, crypto = getCrypto(true)) {\n        return crypto.getPublicKey(this.subjectPublicKeyInfo, this.signatureAlgorithm, parameters);\n    }\n}\nCertificationRequest.CLASS_NAME = \"CertificationRequest\";\n\nconst DIGEST_ALGORITHM$1 = \"digestAlgorithm\";\nconst DIGEST = \"digest\";\nconst CLEAR_PROPS$e = [\n    DIGEST_ALGORITHM$1,\n    DIGEST\n];\nclass DigestInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.digestAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, DIGEST_ALGORITHM$1, DigestInfo.defaultValues(DIGEST_ALGORITHM$1));\n        this.digest = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, DIGEST, DigestInfo.defaultValues(DIGEST));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case DIGEST_ALGORITHM$1:\n                return new AlgorithmIdentifier();\n            case DIGEST:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case DIGEST_ALGORITHM$1:\n                return ((AlgorithmIdentifier.compareWithDefault(\"algorithmId\", memberValue.algorithmId)) &&\n                    ((\"algorithmParams\" in memberValue) === false));\n            case DIGEST:\n                return (memberValue.isEqual(DigestInfo.defaultValues(memberName)));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                AlgorithmIdentifier.schema(names.digestAlgorithm || {\n                    names: {\n                        blockName: DIGEST_ALGORITHM$1\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.digest || DIGEST) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$e);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, DigestInfo.schema({\n            names: {\n                digestAlgorithm: {\n                    names: {\n                        blockName: DIGEST_ALGORITHM$1\n                    }\n                },\n                digest: DIGEST\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.digestAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.digestAlgorithm });\n        this.digest = asn1.result.digest;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.digestAlgorithm.toSchema(),\n                this.digest\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            digestAlgorithm: this.digestAlgorithm.toJSON(),\n            digest: this.digest.toJSON(),\n        };\n    }\n}\nDigestInfo.CLASS_NAME = \"DigestInfo\";\n\nconst E_CONTENT_TYPE = \"eContentType\";\nconst E_CONTENT = \"eContent\";\nconst CLEAR_PROPS$d = [\n    E_CONTENT_TYPE,\n    E_CONTENT,\n];\nclass EncapsulatedContentInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.eContentType = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, E_CONTENT_TYPE, EncapsulatedContentInfo.defaultValues(E_CONTENT_TYPE));\n        if (E_CONTENT in parameters) {\n            this.eContent = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, E_CONTENT, EncapsulatedContentInfo.defaultValues(E_CONTENT));\n            if ((this.eContent.idBlock.tagClass === 1) &&\n                (this.eContent.idBlock.tagNumber === 4)) {\n                if (this.eContent.idBlock.isConstructed === false) {\n                    const constrString = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({\n                        idBlock: { isConstructed: true },\n                        isConstructed: true\n                    });\n                    let offset = 0;\n                    const viewHex = this.eContent.valueBlock.valueHexView.slice().buffer;\n                    let length = viewHex.byteLength;\n                    while (length > 0) {\n                        const pieceView = new Uint8Array(viewHex, offset, ((offset + 65536) > viewHex.byteLength) ? (viewHex.byteLength - offset) : 65536);\n                        const _array = new ArrayBuffer(pieceView.length);\n                        const _view = new Uint8Array(_array);\n                        for (let i = 0; i < _view.length; i++) {\n                            _view[i] = pieceView[i];\n                        }\n                        constrString.valueBlock.value.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: _array }));\n                        length -= pieceView.length;\n                        offset += pieceView.length;\n                    }\n                    this.eContent = constrString;\n                }\n            }\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case E_CONTENT_TYPE:\n                return EMPTY_STRING;\n            case E_CONTENT:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case E_CONTENT_TYPE:\n                return (memberValue === EMPTY_STRING);\n            case E_CONTENT:\n                {\n                    if ((memberValue.idBlock.tagClass === 1) && (memberValue.idBlock.tagNumber === 4))\n                        return (memberValue.isEqual(EncapsulatedContentInfo.defaultValues(E_CONTENT)));\n                    return false;\n                }\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.eContentType || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ name: (names.eContent || EMPTY_STRING) })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$d);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, EncapsulatedContentInfo.schema({\n            names: {\n                eContentType: E_CONTENT_TYPE,\n                eContent: E_CONTENT\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.eContentType = asn1.result.eContentType.valueBlock.toString();\n        if (E_CONTENT in asn1.result)\n            this.eContent = asn1.result.eContent;\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.eContentType }));\n        if (this.eContent) {\n            if (EncapsulatedContentInfo.compareWithDefault(E_CONTENT, this.eContent) === false) {\n                outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [this.eContent]\n                }));\n            }\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            eContentType: this.eContentType\n        };\n        if (this.eContent && EncapsulatedContentInfo.compareWithDefault(E_CONTENT, this.eContent) === false) {\n            res.eContent = this.eContent.toJSON();\n        }\n        return res;\n    }\n}\nEncapsulatedContentInfo.CLASS_NAME = \"EncapsulatedContentInfo\";\n\nclass KeyBag extends PrivateKeyInfo {\n    constructor(parameters = {}) {\n        super(parameters);\n    }\n}\n\nconst MAC = \"mac\";\nconst MAC_SALT = \"macSalt\";\nconst ITERATIONS = \"iterations\";\nconst CLEAR_PROPS$c = [\n    MAC,\n    MAC_SALT,\n    ITERATIONS\n];\nclass MacData extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.mac = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MAC, MacData.defaultValues(MAC));\n        this.macSalt = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MAC_SALT, MacData.defaultValues(MAC_SALT));\n        if (ITERATIONS in parameters) {\n            this.iterations = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ITERATIONS, MacData.defaultValues(ITERATIONS));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case MAC:\n                return new DigestInfo();\n            case MAC_SALT:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case ITERATIONS:\n                return 1;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case MAC:\n                return ((DigestInfo.compareWithDefault(\"digestAlgorithm\", memberValue.digestAlgorithm)) &&\n                    (DigestInfo.compareWithDefault(\"digest\", memberValue.digest)));\n            case MAC_SALT:\n                return (memberValue.isEqual(MacData.defaultValues(memberName)));\n            case ITERATIONS:\n                return (memberValue === MacData.defaultValues(memberName));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            optional: (names.optional || true),\n            value: [\n                DigestInfo.schema(names.mac || {\n                    names: {\n                        blockName: MAC\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.macSalt || MAC_SALT) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({\n                    optional: true,\n                    name: (names.iterations || ITERATIONS)\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$c);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, MacData.schema({\n            names: {\n                mac: {\n                    names: {\n                        blockName: MAC\n                    }\n                },\n                macSalt: MAC_SALT,\n                iterations: ITERATIONS\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.mac = new DigestInfo({ schema: asn1.result.mac });\n        this.macSalt = asn1.result.macSalt;\n        if (ITERATIONS in asn1.result)\n            this.iterations = asn1.result.iterations.valueBlock.valueDec;\n    }\n    toSchema() {\n        const outputArray = [\n            this.mac.toSchema(),\n            this.macSalt\n        ];\n        if (this.iterations !== undefined) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.iterations }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            mac: this.mac.toJSON(),\n            macSalt: this.macSalt.toJSON(),\n        };\n        if (this.iterations !== undefined) {\n            res.iterations = this.iterations;\n        }\n        return res;\n    }\n}\nMacData.CLASS_NAME = \"MacData\";\n\nconst HASH_ALGORITHM = \"hashAlgorithm\";\nconst HASHED_MESSAGE = \"hashedMessage\";\nconst CLEAR_PROPS$b = [\n    HASH_ALGORITHM,\n    HASHED_MESSAGE,\n];\nclass MessageImprint extends PkiObject {\n    static async create(hashAlgorithm, message, crypto = getCrypto(true)) {\n        const hashAlgorithmOID = crypto.getOIDByAlgorithm({ name: hashAlgorithm }, true, \"hashAlgorithm\");\n        const hashedMessage = await crypto.digest(hashAlgorithm, message);\n        const res = new MessageImprint({\n            hashAlgorithm: new AlgorithmIdentifier({\n                algorithmId: hashAlgorithmOID,\n                algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null(),\n            }),\n            hashedMessage: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: hashedMessage })\n        });\n        return res;\n    }\n    constructor(parameters = {}) {\n        super();\n        this.hashAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, HASH_ALGORITHM, MessageImprint.defaultValues(HASH_ALGORITHM));\n        this.hashedMessage = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, HASHED_MESSAGE, MessageImprint.defaultValues(HASHED_MESSAGE));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case HASH_ALGORITHM:\n                return new AlgorithmIdentifier();\n            case HASHED_MESSAGE:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case HASH_ALGORITHM:\n                return ((memberValue.algorithmId === EMPTY_STRING) && ((\"algorithmParams\" in memberValue) === false));\n            case HASHED_MESSAGE:\n                return (memberValue.isEqual(MessageImprint.defaultValues(memberName)) === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                AlgorithmIdentifier.schema(names.hashAlgorithm || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.hashedMessage || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$b);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, MessageImprint.schema({\n            names: {\n                hashAlgorithm: {\n                    names: {\n                        blockName: HASH_ALGORITHM\n                    }\n                },\n                hashedMessage: HASHED_MESSAGE\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.hashAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.hashAlgorithm });\n        this.hashedMessage = asn1.result.hashedMessage;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.hashAlgorithm.toSchema(),\n                this.hashedMessage\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            hashAlgorithm: this.hashAlgorithm.toJSON(),\n            hashedMessage: this.hashedMessage.toJSON(),\n        };\n    }\n}\nMessageImprint.CLASS_NAME = \"MessageImprint\";\n\nconst REQ_CERT = \"reqCert\";\nconst SINGLE_REQUEST_EXTENSIONS = \"singleRequestExtensions\";\nconst CLEAR_PROPS$a = [\n    REQ_CERT,\n    SINGLE_REQUEST_EXTENSIONS,\n];\nclass Request extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.reqCert = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, REQ_CERT, Request.defaultValues(REQ_CERT));\n        if (SINGLE_REQUEST_EXTENSIONS in parameters) {\n            this.singleRequestExtensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SINGLE_REQUEST_EXTENSIONS, Request.defaultValues(SINGLE_REQUEST_EXTENSIONS));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case REQ_CERT:\n                return new CertID();\n            case SINGLE_REQUEST_EXTENSIONS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case REQ_CERT:\n                return (memberValue.isEqual(Request.defaultValues(memberName)));\n            case SINGLE_REQUEST_EXTENSIONS:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                CertID.schema(names.reqCert || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [Extension.schema(names.extensions || {\n                            names: {\n                                blockName: (names.singleRequestExtensions || EMPTY_STRING)\n                            }\n                        })]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$a);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, Request.schema({\n            names: {\n                reqCert: {\n                    names: {\n                        blockName: REQ_CERT\n                    }\n                },\n                extensions: {\n                    names: {\n                        blockName: SINGLE_REQUEST_EXTENSIONS\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.reqCert = new CertID({ schema: asn1.result.reqCert });\n        if (SINGLE_REQUEST_EXTENSIONS in asn1.result) {\n            this.singleRequestExtensions = Array.from(asn1.result.singleRequestExtensions.valueBlock.value, element => new Extension({ schema: element }));\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(this.reqCert.toSchema());\n        if (this.singleRequestExtensions) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                        value: Array.from(this.singleRequestExtensions, o => o.toSchema())\n                    })\n                ]\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            reqCert: this.reqCert.toJSON()\n        };\n        if (this.singleRequestExtensions) {\n            res.singleRequestExtensions = Array.from(this.singleRequestExtensions, o => o.toJSON());\n        }\n        return res;\n    }\n}\nRequest.CLASS_NAME = \"Request\";\n\nconst TBS = \"tbs\";\nconst VERSION$5 = \"version\";\nconst REQUESTOR_NAME = \"requestorName\";\nconst REQUEST_LIST = \"requestList\";\nconst REQUEST_EXTENSIONS = \"requestExtensions\";\nconst TBS_REQUEST$1 = \"TBSRequest\";\nconst TBS_REQUEST_VERSION = `${TBS_REQUEST$1}.${VERSION$5}`;\nconst TBS_REQUEST_REQUESTOR_NAME = `${TBS_REQUEST$1}.${REQUESTOR_NAME}`;\nconst TBS_REQUEST_REQUESTS = `${TBS_REQUEST$1}.requests`;\nconst TBS_REQUEST_REQUEST_EXTENSIONS = `${TBS_REQUEST$1}.${REQUEST_EXTENSIONS}`;\nconst CLEAR_PROPS$9 = [\n    TBS_REQUEST$1,\n    TBS_REQUEST_VERSION,\n    TBS_REQUEST_REQUESTOR_NAME,\n    TBS_REQUEST_REQUESTS,\n    TBS_REQUEST_REQUEST_EXTENSIONS\n];\nclass TBSRequest extends PkiObject {\n    get tbs() {\n        return pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.toArrayBuffer(this.tbsView);\n    }\n    set tbs(value) {\n        this.tbsView = new Uint8Array(value);\n    }\n    constructor(parameters = {}) {\n        super();\n        this.tbsView = new Uint8Array(pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TBS, TBSRequest.defaultValues(TBS)));\n        if (VERSION$5 in parameters) {\n            this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$5, TBSRequest.defaultValues(VERSION$5));\n        }\n        if (REQUESTOR_NAME in parameters) {\n            this.requestorName = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, REQUESTOR_NAME, TBSRequest.defaultValues(REQUESTOR_NAME));\n        }\n        this.requestList = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, REQUEST_LIST, TBSRequest.defaultValues(REQUEST_LIST));\n        if (REQUEST_EXTENSIONS in parameters) {\n            this.requestExtensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, REQUEST_EXTENSIONS, TBSRequest.defaultValues(REQUEST_EXTENSIONS));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TBS:\n                return EMPTY_BUFFER;\n            case VERSION$5:\n                return 0;\n            case REQUESTOR_NAME:\n                return new GeneralName();\n            case REQUEST_LIST:\n            case REQUEST_EXTENSIONS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case TBS:\n                return (memberValue.byteLength === 0);\n            case VERSION$5:\n                return (memberValue === TBSRequest.defaultValues(memberName));\n            case REQUESTOR_NAME:\n                return ((memberValue.type === GeneralName.defaultValues(\"type\")) && (Object.keys(memberValue.value).length === 0));\n            case REQUEST_LIST:\n            case REQUEST_EXTENSIONS:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || TBS_REQUEST$1),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.TBSRequestVersion || TBS_REQUEST_VERSION) })]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [GeneralName.schema(names.requestorName || {\n                            names: {\n                                blockName: TBS_REQUEST_REQUESTOR_NAME\n                            }\n                        })]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    name: (names.requestList || \"TBSRequest.requestList\"),\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.requests || TBS_REQUEST_REQUESTS),\n                            value: Request.schema(names.requestNames || {})\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 2\n                    },\n                    value: [Extensions.schema(names.extensions || {\n                            names: {\n                                blockName: (names.requestExtensions || TBS_REQUEST_REQUEST_EXTENSIONS)\n                            }\n                        })]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$9);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, TBSRequest.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.tbsView = asn1.result.TBSRequest.valueBeforeDecodeView;\n        if (TBS_REQUEST_VERSION in asn1.result)\n            this.version = asn1.result[TBS_REQUEST_VERSION].valueBlock.valueDec;\n        if (TBS_REQUEST_REQUESTOR_NAME in asn1.result)\n            this.requestorName = new GeneralName({ schema: asn1.result[TBS_REQUEST_REQUESTOR_NAME] });\n        this.requestList = Array.from(asn1.result[TBS_REQUEST_REQUESTS], element => new Request({ schema: element }));\n        if (TBS_REQUEST_REQUEST_EXTENSIONS in asn1.result)\n            this.requestExtensions = Array.from(asn1.result[TBS_REQUEST_REQUEST_EXTENSIONS].valueBlock.value, element => new Extension({ schema: element }));\n    }\n    toSchema(encodeFlag = false) {\n        let tbsSchema;\n        if (encodeFlag === false) {\n            if (this.tbsView.byteLength === 0)\n                return TBSRequest.schema();\n            const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(this.tbsView);\n            AsnError.assert(asn1, \"TBS Request\");\n            if (!(asn1.result instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence)) {\n                throw new Error(\"ASN.1 result should be SEQUENCE\");\n            }\n            tbsSchema = asn1.result;\n        }\n        else {\n            const outputArray = [];\n            if (this.version !== undefined) {\n                outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version })]\n                }));\n            }\n            if (this.requestorName) {\n                outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [this.requestorName.toSchema()]\n                }));\n            }\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                value: Array.from(this.requestList, o => o.toSchema())\n            }));\n            if (this.requestExtensions) {\n                outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 2\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                            value: Array.from(this.requestExtensions, o => o.toSchema())\n                        })\n                    ]\n                }));\n            }\n            tbsSchema = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                value: outputArray\n            });\n        }\n        return tbsSchema;\n    }\n    toJSON() {\n        const res = {};\n        if (this.version != undefined)\n            res.version = this.version;\n        if (this.requestorName) {\n            res.requestorName = this.requestorName.toJSON();\n        }\n        res.requestList = Array.from(this.requestList, o => o.toJSON());\n        if (this.requestExtensions) {\n            res.requestExtensions = Array.from(this.requestExtensions, o => o.toJSON());\n        }\n        return res;\n    }\n}\nTBSRequest.CLASS_NAME = \"TBSRequest\";\n\nconst SIGNATURE_ALGORITHM$1 = \"signatureAlgorithm\";\nconst SIGNATURE$1 = \"signature\";\nconst CERTS = \"certs\";\nclass Signature extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.signatureAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_ALGORITHM$1, Signature.defaultValues(SIGNATURE_ALGORITHM$1));\n        this.signature = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE$1, Signature.defaultValues(SIGNATURE$1));\n        if (CERTS in parameters) {\n            this.certs = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CERTS, Signature.defaultValues(CERTS));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case SIGNATURE_ALGORITHM$1:\n                return new AlgorithmIdentifier();\n            case SIGNATURE$1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            case CERTS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case SIGNATURE_ALGORITHM$1:\n                return ((memberValue.algorithmId === EMPTY_STRING) && ((\"algorithmParams\" in memberValue) === false));\n            case SIGNATURE$1:\n                return (memberValue.isEqual(Signature.defaultValues(memberName)));\n            case CERTS:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                AlgorithmIdentifier.schema(names.signatureAlgorithm || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ name: (names.signature || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                            value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                                    name: (names.certs || EMPTY_STRING),\n                                    value: Certificate.schema({})\n                                })]\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, [\n            SIGNATURE_ALGORITHM$1,\n            SIGNATURE$1,\n            CERTS\n        ]);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, Signature.schema({\n            names: {\n                signatureAlgorithm: {\n                    names: {\n                        blockName: SIGNATURE_ALGORITHM$1\n                    }\n                },\n                signature: SIGNATURE$1,\n                certs: CERTS\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.signatureAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.signatureAlgorithm });\n        this.signature = asn1.result.signature;\n        if (CERTS in asn1.result)\n            this.certs = Array.from(asn1.result.certs, element => new Certificate({ schema: element }));\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(this.signatureAlgorithm.toSchema());\n        outputArray.push(this.signature);\n        if (this.certs) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                        value: Array.from(this.certs, o => o.toSchema())\n                    })\n                ]\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            signatureAlgorithm: this.signatureAlgorithm.toJSON(),\n            signature: this.signature.toJSON(),\n        };\n        if (this.certs) {\n            res.certs = Array.from(this.certs, o => o.toJSON());\n        }\n        return res;\n    }\n}\nSignature.CLASS_NAME = \"Signature\";\n\nconst TBS_REQUEST = \"tbsRequest\";\nconst OPTIONAL_SIGNATURE = \"optionalSignature\";\nconst CLEAR_PROPS$8 = [\n    TBS_REQUEST,\n    OPTIONAL_SIGNATURE\n];\nclass OCSPRequest extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.tbsRequest = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TBS_REQUEST, OCSPRequest.defaultValues(TBS_REQUEST));\n        if (OPTIONAL_SIGNATURE in parameters) {\n            this.optionalSignature = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OPTIONAL_SIGNATURE, OCSPRequest.defaultValues(OPTIONAL_SIGNATURE));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TBS_REQUEST:\n                return new TBSRequest();\n            case OPTIONAL_SIGNATURE:\n                return new Signature();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case TBS_REQUEST:\n                return ((TBSRequest.compareWithDefault(\"tbs\", memberValue.tbs)) &&\n                    (TBSRequest.compareWithDefault(\"version\", memberValue.version)) &&\n                    (TBSRequest.compareWithDefault(\"requestorName\", memberValue.requestorName)) &&\n                    (TBSRequest.compareWithDefault(\"requestList\", memberValue.requestList)) &&\n                    (TBSRequest.compareWithDefault(\"requestExtensions\", memberValue.requestExtensions)));\n            case OPTIONAL_SIGNATURE:\n                return ((Signature.compareWithDefault(\"signatureAlgorithm\", memberValue.signatureAlgorithm)) &&\n                    (Signature.compareWithDefault(\"signature\", memberValue.signature)) &&\n                    (Signature.compareWithDefault(\"certs\", memberValue.certs)));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: names.blockName || \"OCSPRequest\",\n            value: [\n                TBSRequest.schema(names.tbsRequest || {\n                    names: {\n                        blockName: TBS_REQUEST\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [\n                        Signature.schema(names.optionalSignature || {\n                            names: {\n                                blockName: OPTIONAL_SIGNATURE\n                            }\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$8);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, OCSPRequest.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.tbsRequest = new TBSRequest({ schema: asn1.result.tbsRequest });\n        if (OPTIONAL_SIGNATURE in asn1.result)\n            this.optionalSignature = new Signature({ schema: asn1.result.optionalSignature });\n    }\n    toSchema(encodeFlag = false) {\n        const outputArray = [];\n        outputArray.push(this.tbsRequest.toSchema(encodeFlag));\n        if (this.optionalSignature)\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [\n                    this.optionalSignature.toSchema()\n                ]\n            }));\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            tbsRequest: this.tbsRequest.toJSON()\n        };\n        if (this.optionalSignature) {\n            res.optionalSignature = this.optionalSignature.toJSON();\n        }\n        return res;\n    }\n    async createForCertificate(certificate, parameters, crypto = getCrypto(true)) {\n        const certID = new CertID();\n        await certID.createForCertificate(certificate, parameters, crypto);\n        this.tbsRequest.requestList.push(new Request({\n            reqCert: certID,\n        }));\n    }\n    async sign(privateKey, hashAlgorithm = \"SHA-1\", crypto = getCrypto(true)) {\n        ParameterError.assertEmpty(privateKey, \"privateKey\", \"OCSPRequest.sign method\");\n        if (!this.optionalSignature) {\n            throw new Error(\"Need to create \\\"optionalSignature\\\" field before signing\");\n        }\n        const signatureParams = await crypto.getSignatureParameters(privateKey, hashAlgorithm);\n        const parameters = signatureParams.parameters;\n        this.optionalSignature.signatureAlgorithm = signatureParams.signatureAlgorithm;\n        const tbs = this.tbsRequest.toSchema(true).toBER(false);\n        const signature = await crypto.signWithPrivateKey(tbs, privateKey, parameters);\n        this.optionalSignature.signature = new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ valueHex: signature });\n    }\n    verify() {\n    }\n}\nOCSPRequest.CLASS_NAME = \"OCSPRequest\";\n\nconst RESPONSE_TYPE = \"responseType\";\nconst RESPONSE = \"response\";\nconst CLEAR_PROPS$7 = [\n    RESPONSE_TYPE,\n    RESPONSE\n];\nclass ResponseBytes extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.responseType = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RESPONSE_TYPE, ResponseBytes.defaultValues(RESPONSE_TYPE));\n        this.response = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RESPONSE, ResponseBytes.defaultValues(RESPONSE));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case RESPONSE_TYPE:\n                return EMPTY_STRING;\n            case RESPONSE:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case RESPONSE_TYPE:\n                return (memberValue === EMPTY_STRING);\n            case RESPONSE:\n                return (memberValue.isEqual(ResponseBytes.defaultValues(memberName)));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.responseType || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.response || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$7);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, ResponseBytes.schema({\n            names: {\n                responseType: RESPONSE_TYPE,\n                response: RESPONSE\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.responseType = asn1.result.responseType.valueBlock.toString();\n        this.response = asn1.result.response;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.responseType }),\n                this.response\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            responseType: this.responseType,\n            response: this.response.toJSON(),\n        };\n    }\n}\nResponseBytes.CLASS_NAME = \"ResponseBytes\";\n\nconst RESPONSE_STATUS = \"responseStatus\";\nconst RESPONSE_BYTES = \"responseBytes\";\nclass OCSPResponse extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.responseStatus = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RESPONSE_STATUS, OCSPResponse.defaultValues(RESPONSE_STATUS));\n        if (RESPONSE_BYTES in parameters) {\n            this.responseBytes = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RESPONSE_BYTES, OCSPResponse.defaultValues(RESPONSE_BYTES));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case RESPONSE_STATUS:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Enumerated();\n            case RESPONSE_BYTES:\n                return new ResponseBytes();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case RESPONSE_STATUS:\n                return (memberValue.isEqual(OCSPResponse.defaultValues(memberName)));\n            case RESPONSE_BYTES:\n                return ((ResponseBytes.compareWithDefault(\"responseType\", memberValue.responseType)) &&\n                    (ResponseBytes.compareWithDefault(\"response\", memberValue.response)));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || \"OCSPResponse\"),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Enumerated({ name: (names.responseStatus || RESPONSE_STATUS) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [\n                        ResponseBytes.schema(names.responseBytes || {\n                            names: {\n                                blockName: RESPONSE_BYTES\n                            }\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, [\n            RESPONSE_STATUS,\n            RESPONSE_BYTES\n        ]);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, OCSPResponse.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.responseStatus = asn1.result.responseStatus;\n        if (RESPONSE_BYTES in asn1.result)\n            this.responseBytes = new ResponseBytes({ schema: asn1.result.responseBytes });\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(this.responseStatus);\n        if (this.responseBytes) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [this.responseBytes.toSchema()]\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            responseStatus: this.responseStatus.toJSON()\n        };\n        if (this.responseBytes) {\n            res.responseBytes = this.responseBytes.toJSON();\n        }\n        return res;\n    }\n    async getCertificateStatus(certificate, issuerCertificate, crypto = getCrypto(true)) {\n        let basicResponse;\n        const result = {\n            isForCertificate: false,\n            status: 2\n        };\n        if (!this.responseBytes)\n            return result;\n        if (this.responseBytes.responseType !== id_PKIX_OCSP_Basic)\n            return result;\n        try {\n            const asn1Basic = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(this.responseBytes.response.valueBlock.valueHexView);\n            AsnError.assert(asn1Basic, \"Basic OCSP response\");\n            basicResponse = new BasicOCSPResponse({ schema: asn1Basic.result });\n        }\n        catch {\n            return result;\n        }\n        return basicResponse.getCertificateStatus(certificate, issuerCertificate, crypto);\n    }\n    async sign(privateKey, hashAlgorithm, crypto = getCrypto(true)) {\n        var _a;\n        if (this.responseBytes && this.responseBytes.responseType === id_PKIX_OCSP_Basic) {\n            const basicResponse = BasicOCSPResponse.fromBER(this.responseBytes.response.valueBlock.valueHexView);\n            return basicResponse.sign(privateKey, hashAlgorithm, crypto);\n        }\n        throw new Error(`Unknown ResponseBytes type: ${((_a = this.responseBytes) === null || _a === void 0 ? void 0 : _a.responseType) || \"Unknown\"}`);\n    }\n    async verify(issuerCertificate = null, crypto = getCrypto(true)) {\n        var _a;\n        if ((RESPONSE_BYTES in this) === false)\n            throw new Error(\"Empty ResponseBytes field\");\n        if (this.responseBytes && this.responseBytes.responseType === id_PKIX_OCSP_Basic) {\n            const basicResponse = BasicOCSPResponse.fromBER(this.responseBytes.response.valueBlock.valueHexView);\n            if (issuerCertificate !== null) {\n                if (!basicResponse.certs) {\n                    basicResponse.certs = [];\n                }\n                basicResponse.certs.push(issuerCertificate);\n            }\n            return basicResponse.verify({}, crypto);\n        }\n        throw new Error(`Unknown ResponseBytes type: ${((_a = this.responseBytes) === null || _a === void 0 ? void 0 : _a.responseType) || \"Unknown\"}`);\n    }\n}\nOCSPResponse.CLASS_NAME = \"OCSPResponse\";\n\nconst TYPE = \"type\";\nconst ATTRIBUTES = \"attributes\";\nconst ENCODED_VALUE = \"encodedValue\";\nconst CLEAR_PROPS$6 = [\n    ATTRIBUTES\n];\nclass SignedAndUnsignedAttributes extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.type = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TYPE, SignedAndUnsignedAttributes.defaultValues(TYPE));\n        this.attributes = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ATTRIBUTES, SignedAndUnsignedAttributes.defaultValues(ATTRIBUTES));\n        this.encodedValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENCODED_VALUE, SignedAndUnsignedAttributes.defaultValues(ENCODED_VALUE));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TYPE:\n                return (-1);\n            case ATTRIBUTES:\n                return [];\n            case ENCODED_VALUE:\n                return EMPTY_BUFFER;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case TYPE:\n                return (memberValue === SignedAndUnsignedAttributes.defaultValues(TYPE));\n            case ATTRIBUTES:\n                return (memberValue.length === 0);\n            case ENCODED_VALUE:\n                return (memberValue.byteLength === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n            name: (names.blockName || EMPTY_STRING),\n            optional: true,\n            idBlock: {\n                tagClass: 3,\n                tagNumber: names.tagNumber || 0\n            },\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.attributes || EMPTY_STRING),\n                    value: Attribute.schema()\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$6);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, SignedAndUnsignedAttributes.schema({\n            names: {\n                tagNumber: this.type,\n                attributes: ATTRIBUTES\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.type = asn1.result.idBlock.tagNumber;\n        this.encodedValue = pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.toArrayBuffer(asn1.result.valueBeforeDecodeView);\n        const encodedView = new Uint8Array(this.encodedValue);\n        encodedView[0] = 0x31;\n        if ((ATTRIBUTES in asn1.result) === false) {\n            if (this.type === 0)\n                throw new Error(\"Wrong structure of SignedUnsignedAttributes\");\n            else\n                return;\n        }\n        this.attributes = Array.from(asn1.result.attributes, element => new Attribute({ schema: element }));\n    }\n    toSchema() {\n        if (SignedAndUnsignedAttributes.compareWithDefault(TYPE, this.type) || SignedAndUnsignedAttributes.compareWithDefault(ATTRIBUTES, this.attributes))\n            throw new Error(\"Incorrectly initialized \\\"SignedAndUnsignedAttributes\\\" class\");\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n            optional: true,\n            idBlock: {\n                tagClass: 3,\n                tagNumber: this.type\n            },\n            value: Array.from(this.attributes, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        if (SignedAndUnsignedAttributes.compareWithDefault(TYPE, this.type) || SignedAndUnsignedAttributes.compareWithDefault(ATTRIBUTES, this.attributes))\n            throw new Error(\"Incorrectly initialized \\\"SignedAndUnsignedAttributes\\\" class\");\n        return {\n            type: this.type,\n            attributes: Array.from(this.attributes, o => o.toJSON())\n        };\n    }\n}\nSignedAndUnsignedAttributes.CLASS_NAME = \"SignedAndUnsignedAttributes\";\n\nconst VERSION$4 = \"version\";\nconst SID = \"sid\";\nconst DIGEST_ALGORITHM = \"digestAlgorithm\";\nconst SIGNED_ATTRS = \"signedAttrs\";\nconst SIGNATURE_ALGORITHM = \"signatureAlgorithm\";\nconst SIGNATURE = \"signature\";\nconst UNSIGNED_ATTRS = \"unsignedAttrs\";\nconst SIGNER_INFO = \"SignerInfo\";\nconst SIGNER_INFO_VERSION = `${SIGNER_INFO}.${VERSION$4}`;\nconst SIGNER_INFO_SID = `${SIGNER_INFO}.${SID}`;\nconst SIGNER_INFO_DIGEST_ALGORITHM = `${SIGNER_INFO}.${DIGEST_ALGORITHM}`;\nconst SIGNER_INFO_SIGNED_ATTRS = `${SIGNER_INFO}.${SIGNED_ATTRS}`;\nconst SIGNER_INFO_SIGNATURE_ALGORITHM = `${SIGNER_INFO}.${SIGNATURE_ALGORITHM}`;\nconst SIGNER_INFO_SIGNATURE = `${SIGNER_INFO}.${SIGNATURE}`;\nconst SIGNER_INFO_UNSIGNED_ATTRS = `${SIGNER_INFO}.${UNSIGNED_ATTRS}`;\nconst CLEAR_PROPS$5 = [\n    SIGNER_INFO_VERSION,\n    SIGNER_INFO_SID,\n    SIGNER_INFO_DIGEST_ALGORITHM,\n    SIGNER_INFO_SIGNED_ATTRS,\n    SIGNER_INFO_SIGNATURE_ALGORITHM,\n    SIGNER_INFO_SIGNATURE,\n    SIGNER_INFO_UNSIGNED_ATTRS\n];\nclass SignerInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$4, SignerInfo.defaultValues(VERSION$4));\n        this.sid = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SID, SignerInfo.defaultValues(SID));\n        this.digestAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, DIGEST_ALGORITHM, SignerInfo.defaultValues(DIGEST_ALGORITHM));\n        if (SIGNED_ATTRS in parameters) {\n            this.signedAttrs = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNED_ATTRS, SignerInfo.defaultValues(SIGNED_ATTRS));\n        }\n        this.signatureAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_ALGORITHM, SignerInfo.defaultValues(SIGNATURE_ALGORITHM));\n        this.signature = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE, SignerInfo.defaultValues(SIGNATURE));\n        if (UNSIGNED_ATTRS in parameters) {\n            this.unsignedAttrs = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, UNSIGNED_ATTRS, SignerInfo.defaultValues(UNSIGNED_ATTRS));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$4:\n                return 0;\n            case SID:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any();\n            case DIGEST_ALGORITHM:\n                return new AlgorithmIdentifier();\n            case SIGNED_ATTRS:\n                return new SignedAndUnsignedAttributes({ type: 0 });\n            case SIGNATURE_ALGORITHM:\n                return new AlgorithmIdentifier();\n            case SIGNATURE:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case UNSIGNED_ATTRS:\n                return new SignedAndUnsignedAttributes({ type: 1 });\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VERSION$4:\n                return (SignerInfo.defaultValues(VERSION$4) === memberValue);\n            case SID:\n                return (memberValue instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any);\n            case DIGEST_ALGORITHM:\n                if ((memberValue instanceof AlgorithmIdentifier) === false)\n                    return false;\n                return memberValue.isEqual(SignerInfo.defaultValues(DIGEST_ALGORITHM));\n            case SIGNED_ATTRS:\n                return ((SignedAndUnsignedAttributes.compareWithDefault(\"type\", memberValue.type))\n                    && (SignedAndUnsignedAttributes.compareWithDefault(\"attributes\", memberValue.attributes))\n                    && (SignedAndUnsignedAttributes.compareWithDefault(\"encodedValue\", memberValue.encodedValue)));\n            case SIGNATURE_ALGORITHM:\n                if ((memberValue instanceof AlgorithmIdentifier) === false)\n                    return false;\n                return memberValue.isEqual(SignerInfo.defaultValues(SIGNATURE_ALGORITHM));\n            case SIGNATURE:\n            case UNSIGNED_ATTRS:\n                return ((SignedAndUnsignedAttributes.compareWithDefault(\"type\", memberValue.type))\n                    && (SignedAndUnsignedAttributes.compareWithDefault(\"attributes\", memberValue.attributes))\n                    && (SignedAndUnsignedAttributes.compareWithDefault(\"encodedValue\", memberValue.encodedValue)));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: SIGNER_INFO,\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || SIGNER_INFO_VERSION) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                    value: [\n                        IssuerAndSerialNumber.schema(names.sidSchema || {\n                            names: {\n                                blockName: SIGNER_INFO_SID\n                            }\n                        }),\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                            value: [\n                                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                                    optional: true,\n                                    name: (names.sid || SIGNER_INFO_SID),\n                                    idBlock: {\n                                        tagClass: 3,\n                                        tagNumber: 0\n                                    },\n                                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString()]\n                                }),\n                                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                                    optional: true,\n                                    name: (names.sid || SIGNER_INFO_SID),\n                                    idBlock: {\n                                        tagClass: 3,\n                                        tagNumber: 0\n                                    }\n                                }),\n                            ]\n                        }),\n                    ]\n                }),\n                AlgorithmIdentifier.schema(names.digestAlgorithm || {\n                    names: {\n                        blockName: SIGNER_INFO_DIGEST_ALGORITHM\n                    }\n                }),\n                SignedAndUnsignedAttributes.schema(names.signedAttrs || {\n                    names: {\n                        blockName: SIGNER_INFO_SIGNED_ATTRS,\n                        tagNumber: 0\n                    }\n                }),\n                AlgorithmIdentifier.schema(names.signatureAlgorithm || {\n                    names: {\n                        blockName: SIGNER_INFO_SIGNATURE_ALGORITHM\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.signature || SIGNER_INFO_SIGNATURE) }),\n                SignedAndUnsignedAttributes.schema(names.unsignedAttrs || {\n                    names: {\n                        blockName: SIGNER_INFO_UNSIGNED_ATTRS,\n                        tagNumber: 1\n                    }\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$5);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, SignerInfo.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result[SIGNER_INFO_VERSION].valueBlock.valueDec;\n        const currentSid = asn1.result[SIGNER_INFO_SID];\n        if (currentSid.idBlock.tagClass === 1)\n            this.sid = new IssuerAndSerialNumber({ schema: currentSid });\n        else\n            this.sid = currentSid;\n        this.digestAlgorithm = new AlgorithmIdentifier({ schema: asn1.result[SIGNER_INFO_DIGEST_ALGORITHM] });\n        if (SIGNER_INFO_SIGNED_ATTRS in asn1.result)\n            this.signedAttrs = new SignedAndUnsignedAttributes({ type: 0, schema: asn1.result[SIGNER_INFO_SIGNED_ATTRS] });\n        this.signatureAlgorithm = new AlgorithmIdentifier({ schema: asn1.result[SIGNER_INFO_SIGNATURE_ALGORITHM] });\n        this.signature = asn1.result[SIGNER_INFO_SIGNATURE];\n        if (SIGNER_INFO_UNSIGNED_ATTRS in asn1.result)\n            this.unsignedAttrs = new SignedAndUnsignedAttributes({ type: 1, schema: asn1.result[SIGNER_INFO_UNSIGNED_ATTRS] });\n    }\n    toSchema() {\n        if (SignerInfo.compareWithDefault(SID, this.sid))\n            throw new Error(\"Incorrectly initialized \\\"SignerInfo\\\" class\");\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }));\n        if (this.sid instanceof IssuerAndSerialNumber)\n            outputArray.push(this.sid.toSchema());\n        else\n            outputArray.push(this.sid);\n        outputArray.push(this.digestAlgorithm.toSchema());\n        if (this.signedAttrs) {\n            if (SignerInfo.compareWithDefault(SIGNED_ATTRS, this.signedAttrs) === false)\n                outputArray.push(this.signedAttrs.toSchema());\n        }\n        outputArray.push(this.signatureAlgorithm.toSchema());\n        outputArray.push(this.signature);\n        if (this.unsignedAttrs) {\n            if (SignerInfo.compareWithDefault(UNSIGNED_ATTRS, this.unsignedAttrs) === false)\n                outputArray.push(this.unsignedAttrs.toSchema());\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        if (SignerInfo.compareWithDefault(SID, this.sid)) {\n            throw new Error(\"Incorrectly initialized \\\"SignerInfo\\\" class\");\n        }\n        const res = {\n            version: this.version,\n            digestAlgorithm: this.digestAlgorithm.toJSON(),\n            signatureAlgorithm: this.signatureAlgorithm.toJSON(),\n            signature: this.signature.toJSON(),\n        };\n        if (!(this.sid instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any))\n            res.sid = this.sid.toJSON();\n        if (this.signedAttrs && SignerInfo.compareWithDefault(SIGNED_ATTRS, this.signedAttrs) === false) {\n            res.signedAttrs = this.signedAttrs.toJSON();\n        }\n        if (this.unsignedAttrs && SignerInfo.compareWithDefault(UNSIGNED_ATTRS, this.unsignedAttrs) === false) {\n            res.unsignedAttrs = this.unsignedAttrs.toJSON();\n        }\n        return res;\n    }\n}\nSignerInfo.CLASS_NAME = \"SignerInfo\";\n\nconst VERSION$3 = \"version\";\nconst POLICY = \"policy\";\nconst MESSAGE_IMPRINT$1 = \"messageImprint\";\nconst SERIAL_NUMBER = \"serialNumber\";\nconst GEN_TIME = \"genTime\";\nconst ORDERING = \"ordering\";\nconst NONCE$1 = \"nonce\";\nconst ACCURACY = \"accuracy\";\nconst TSA = \"tsa\";\nconst EXTENSIONS$1 = \"extensions\";\nconst TST_INFO = \"TSTInfo\";\nconst TST_INFO_VERSION = `${TST_INFO}.${VERSION$3}`;\nconst TST_INFO_POLICY = `${TST_INFO}.${POLICY}`;\nconst TST_INFO_MESSAGE_IMPRINT = `${TST_INFO}.${MESSAGE_IMPRINT$1}`;\nconst TST_INFO_SERIAL_NUMBER = `${TST_INFO}.${SERIAL_NUMBER}`;\nconst TST_INFO_GEN_TIME = `${TST_INFO}.${GEN_TIME}`;\nconst TST_INFO_ACCURACY = `${TST_INFO}.${ACCURACY}`;\nconst TST_INFO_ORDERING = `${TST_INFO}.${ORDERING}`;\nconst TST_INFO_NONCE = `${TST_INFO}.${NONCE$1}`;\nconst TST_INFO_TSA = `${TST_INFO}.${TSA}`;\nconst TST_INFO_EXTENSIONS = `${TST_INFO}.${EXTENSIONS$1}`;\nconst CLEAR_PROPS$4 = [\n    TST_INFO_VERSION,\n    TST_INFO_POLICY,\n    TST_INFO_MESSAGE_IMPRINT,\n    TST_INFO_SERIAL_NUMBER,\n    TST_INFO_GEN_TIME,\n    TST_INFO_ACCURACY,\n    TST_INFO_ORDERING,\n    TST_INFO_NONCE,\n    TST_INFO_TSA,\n    TST_INFO_EXTENSIONS\n];\nclass TSTInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$3, TSTInfo.defaultValues(VERSION$3));\n        this.policy = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, POLICY, TSTInfo.defaultValues(POLICY));\n        this.messageImprint = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MESSAGE_IMPRINT$1, TSTInfo.defaultValues(MESSAGE_IMPRINT$1));\n        this.serialNumber = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SERIAL_NUMBER, TSTInfo.defaultValues(SERIAL_NUMBER));\n        this.genTime = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, GEN_TIME, TSTInfo.defaultValues(GEN_TIME));\n        if (ACCURACY in parameters) {\n            this.accuracy = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ACCURACY, TSTInfo.defaultValues(ACCURACY));\n        }\n        if (ORDERING in parameters) {\n            this.ordering = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ORDERING, TSTInfo.defaultValues(ORDERING));\n        }\n        if (NONCE$1 in parameters) {\n            this.nonce = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NONCE$1, TSTInfo.defaultValues(NONCE$1));\n        }\n        if (TSA in parameters) {\n            this.tsa = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TSA, TSTInfo.defaultValues(TSA));\n        }\n        if (EXTENSIONS$1 in parameters) {\n            this.extensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, EXTENSIONS$1, TSTInfo.defaultValues(EXTENSIONS$1));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$3:\n                return 0;\n            case POLICY:\n                return EMPTY_STRING;\n            case MESSAGE_IMPRINT$1:\n                return new MessageImprint();\n            case SERIAL_NUMBER:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case GEN_TIME:\n                return new Date(0, 0, 0);\n            case ACCURACY:\n                return new Accuracy();\n            case ORDERING:\n                return false;\n            case NONCE$1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case TSA:\n                return new GeneralName();\n            case EXTENSIONS$1:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VERSION$3:\n            case POLICY:\n            case GEN_TIME:\n            case ORDERING:\n                return (memberValue === TSTInfo.defaultValues(ORDERING));\n            case MESSAGE_IMPRINT$1:\n                return ((MessageImprint.compareWithDefault(HASH_ALGORITHM, memberValue.hashAlgorithm)) &&\n                    (MessageImprint.compareWithDefault(HASHED_MESSAGE, memberValue.hashedMessage)));\n            case SERIAL_NUMBER:\n            case NONCE$1:\n                return (memberValue.isEqual(TSTInfo.defaultValues(NONCE$1)));\n            case ACCURACY:\n                return ((Accuracy.compareWithDefault(SECONDS, memberValue.seconds)) &&\n                    (Accuracy.compareWithDefault(MILLIS, memberValue.millis)) &&\n                    (Accuracy.compareWithDefault(MICROS, memberValue.micros)));\n            case TSA:\n                return ((GeneralName.compareWithDefault(TYPE$4, memberValue.type)) &&\n                    (GeneralName.compareWithDefault(VALUE$5, memberValue.value)));\n            case EXTENSIONS$1:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || TST_INFO),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || TST_INFO_VERSION) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.policy || TST_INFO_POLICY) }),\n                MessageImprint.schema(names.messageImprint || {\n                    names: {\n                        blockName: TST_INFO_MESSAGE_IMPRINT\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.serialNumber || TST_INFO_SERIAL_NUMBER) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ name: (names.genTime || TST_INFO_GEN_TIME) }),\n                Accuracy.schema(names.accuracy || {\n                    names: {\n                        blockName: TST_INFO_ACCURACY\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Boolean({\n                    name: (names.ordering || TST_INFO_ORDERING),\n                    optional: true\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({\n                    name: (names.nonce || TST_INFO_NONCE),\n                    optional: true\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [GeneralName.schema(names.tsa || {\n                            names: {\n                                blockName: TST_INFO_TSA\n                            }\n                        })]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.extensions || TST_INFO_EXTENSIONS),\n                            value: Extension.schema(names.extension || {})\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$4);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, TSTInfo.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result[TST_INFO_VERSION].valueBlock.valueDec;\n        this.policy = asn1.result[TST_INFO_POLICY].valueBlock.toString();\n        this.messageImprint = new MessageImprint({ schema: asn1.result[TST_INFO_MESSAGE_IMPRINT] });\n        this.serialNumber = asn1.result[TST_INFO_SERIAL_NUMBER];\n        this.genTime = asn1.result[TST_INFO_GEN_TIME].toDate();\n        if (TST_INFO_ACCURACY in asn1.result)\n            this.accuracy = new Accuracy({ schema: asn1.result[TST_INFO_ACCURACY] });\n        if (TST_INFO_ORDERING in asn1.result)\n            this.ordering = asn1.result[TST_INFO_ORDERING].valueBlock.value;\n        if (TST_INFO_NONCE in asn1.result)\n            this.nonce = asn1.result[TST_INFO_NONCE];\n        if (TST_INFO_TSA in asn1.result)\n            this.tsa = new GeneralName({ schema: asn1.result[TST_INFO_TSA] });\n        if (TST_INFO_EXTENSIONS in asn1.result)\n            this.extensions = Array.from(asn1.result[TST_INFO_EXTENSIONS], element => new Extension({ schema: element }));\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }));\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.policy }));\n        outputArray.push(this.messageImprint.toSchema());\n        outputArray.push(this.serialNumber);\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ valueDate: this.genTime }));\n        if (this.accuracy)\n            outputArray.push(this.accuracy.toSchema());\n        if (this.ordering !== undefined)\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Boolean({ value: this.ordering }));\n        if (this.nonce)\n            outputArray.push(this.nonce);\n        if (this.tsa) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [this.tsa.toSchema()]\n            }));\n        }\n        if (this.extensions) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: Array.from(this.extensions, o => o.toSchema())\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            version: this.version,\n            policy: this.policy,\n            messageImprint: this.messageImprint.toJSON(),\n            serialNumber: this.serialNumber.toJSON(),\n            genTime: this.genTime\n        };\n        if (this.accuracy)\n            res.accuracy = this.accuracy.toJSON();\n        if (this.ordering !== undefined)\n            res.ordering = this.ordering;\n        if (this.nonce)\n            res.nonce = this.nonce.toJSON();\n        if (this.tsa)\n            res.tsa = this.tsa.toJSON();\n        if (this.extensions)\n            res.extensions = Array.from(this.extensions, o => o.toJSON());\n        return res;\n    }\n    async verify(params, crypto = getCrypto(true)) {\n        if (!params.data) {\n            throw new Error(\"\\\"data\\\" is a mandatory attribute for TST_INFO verification\");\n        }\n        const data = params.data;\n        if (params.notBefore) {\n            if (this.genTime < params.notBefore)\n                throw new Error(\"Generation time for TSTInfo object is less than notBefore value\");\n        }\n        if (params.notAfter) {\n            if (this.genTime > params.notAfter)\n                throw new Error(\"Generation time for TSTInfo object is more than notAfter value\");\n        }\n        const shaAlgorithm = crypto.getAlgorithmByOID(this.messageImprint.hashAlgorithm.algorithmId, true, \"MessageImprint.hashAlgorithm\");\n        const hash = await crypto.digest(shaAlgorithm.name, new Uint8Array(data));\n        return pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isEqual(hash, this.messageImprint.hashedMessage.valueBlock.valueHexView);\n    }\n}\nTSTInfo.CLASS_NAME = \"TSTInfo\";\n\nconst VERSION$2 = \"version\";\nconst DIGEST_ALGORITHMS = \"digestAlgorithms\";\nconst ENCAP_CONTENT_INFO = \"encapContentInfo\";\nconst CERTIFICATES = \"certificates\";\nconst CRLS = \"crls\";\nconst SIGNER_INFOS = \"signerInfos\";\nconst OCSPS = \"ocsps\";\nconst SIGNED_DATA = \"SignedData\";\nconst SIGNED_DATA_VERSION = `${SIGNED_DATA}.${VERSION$2}`;\nconst SIGNED_DATA_DIGEST_ALGORITHMS = `${SIGNED_DATA}.${DIGEST_ALGORITHMS}`;\nconst SIGNED_DATA_ENCAP_CONTENT_INFO = `${SIGNED_DATA}.${ENCAP_CONTENT_INFO}`;\nconst SIGNED_DATA_CERTIFICATES = `${SIGNED_DATA}.${CERTIFICATES}`;\nconst SIGNED_DATA_CRLS = `${SIGNED_DATA}.${CRLS}`;\nconst SIGNED_DATA_SIGNER_INFOS = `${SIGNED_DATA}.${SIGNER_INFOS}`;\nconst CLEAR_PROPS$3 = [\n    SIGNED_DATA_VERSION,\n    SIGNED_DATA_DIGEST_ALGORITHMS,\n    SIGNED_DATA_ENCAP_CONTENT_INFO,\n    SIGNED_DATA_CERTIFICATES,\n    SIGNED_DATA_CRLS,\n    SIGNED_DATA_SIGNER_INFOS\n];\nclass SignedDataVerifyError extends Error {\n    constructor({ message, code = 0, date = new Date(), signatureVerified = null, signerCertificate = null, signerCertificateVerified = null, timestampSerial = null, certificatePath = [], }) {\n        super(message);\n        this.name = \"SignedDataVerifyError\";\n        this.date = date;\n        this.code = code;\n        this.timestampSerial = timestampSerial;\n        this.signatureVerified = signatureVerified;\n        this.signerCertificate = signerCertificate;\n        this.signerCertificateVerified = signerCertificateVerified;\n        this.certificatePath = certificatePath;\n    }\n}\nclass SignedData extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$2, SignedData.defaultValues(VERSION$2));\n        this.digestAlgorithms = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, DIGEST_ALGORITHMS, SignedData.defaultValues(DIGEST_ALGORITHMS));\n        this.encapContentInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENCAP_CONTENT_INFO, SignedData.defaultValues(ENCAP_CONTENT_INFO));\n        if (CERTIFICATES in parameters) {\n            this.certificates = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CERTIFICATES, SignedData.defaultValues(CERTIFICATES));\n        }\n        if (CRLS in parameters) {\n            this.crls = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CRLS, SignedData.defaultValues(CRLS));\n        }\n        if (OCSPS in parameters) {\n            this.ocsps = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OCSPS, SignedData.defaultValues(OCSPS));\n        }\n        this.signerInfos = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNER_INFOS, SignedData.defaultValues(SIGNER_INFOS));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$2:\n                return 0;\n            case DIGEST_ALGORITHMS:\n                return [];\n            case ENCAP_CONTENT_INFO:\n                return new EncapsulatedContentInfo();\n            case CERTIFICATES:\n                return [];\n            case CRLS:\n                return [];\n            case OCSPS:\n                return [];\n            case SIGNER_INFOS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VERSION$2:\n                return (memberValue === SignedData.defaultValues(VERSION$2));\n            case ENCAP_CONTENT_INFO:\n                return EncapsulatedContentInfo.compareWithDefault(\"eContentType\", memberValue.eContentType) &&\n                    EncapsulatedContentInfo.compareWithDefault(\"eContent\", memberValue.eContent);\n            case DIGEST_ALGORITHMS:\n            case CERTIFICATES:\n            case CRLS:\n            case OCSPS:\n            case SIGNER_INFOS:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        if (names.optional === undefined) {\n            names.optional = false;\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || SIGNED_DATA),\n            optional: names.optional,\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || SIGNED_DATA_VERSION) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.digestAlgorithms || SIGNED_DATA_DIGEST_ALGORITHMS),\n                            value: AlgorithmIdentifier.schema()\n                        })\n                    ]\n                }),\n                EncapsulatedContentInfo.schema(names.encapContentInfo || {\n                    names: {\n                        blockName: SIGNED_DATA_ENCAP_CONTENT_INFO\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.certificates || SIGNED_DATA_CERTIFICATES),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: CertificateSet.schema().valueBlock.value\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: RevocationInfoChoices.schema(names.crls || {\n                        names: {\n                            crls: SIGNED_DATA_CRLS\n                        }\n                    }).valueBlock.value\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.signerInfos || SIGNED_DATA_SIGNER_INFOS),\n                            value: SignerInfo.schema()\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$3);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, SignedData.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result[SIGNED_DATA_VERSION].valueBlock.valueDec;\n        if (SIGNED_DATA_DIGEST_ALGORITHMS in asn1.result)\n            this.digestAlgorithms = Array.from(asn1.result[SIGNED_DATA_DIGEST_ALGORITHMS], algorithm => new AlgorithmIdentifier({ schema: algorithm }));\n        this.encapContentInfo = new EncapsulatedContentInfo({ schema: asn1.result[SIGNED_DATA_ENCAP_CONTENT_INFO] });\n        if (SIGNED_DATA_CERTIFICATES in asn1.result) {\n            const certificateSet = new CertificateSet({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n                    value: asn1.result[SIGNED_DATA_CERTIFICATES].valueBlock.value\n                })\n            });\n            this.certificates = certificateSet.certificates.slice(0);\n        }\n        if (SIGNED_DATA_CRLS in asn1.result) {\n            this.crls = Array.from(asn1.result[SIGNED_DATA_CRLS], (crl) => {\n                if (crl.idBlock.tagClass === 1)\n                    return new CertificateRevocationList({ schema: crl });\n                crl.idBlock.tagClass = 1;\n                crl.idBlock.tagNumber = 16;\n                return new OtherRevocationInfoFormat({ schema: crl });\n            });\n        }\n        if (SIGNED_DATA_SIGNER_INFOS in asn1.result)\n            this.signerInfos = Array.from(asn1.result[SIGNED_DATA_SIGNER_INFOS], signerInfoSchema => new SignerInfo({ schema: signerInfoSchema }));\n    }\n    toSchema(encodeFlag = false) {\n        const outputArray = [];\n        if ((this.certificates && this.certificates.length && this.certificates.some(o => o instanceof OtherCertificateFormat))\n            || (this.crls && this.crls.length && this.crls.some(o => o instanceof OtherRevocationInfoFormat))) {\n            this.version = 5;\n        }\n        else if (this.certificates && this.certificates.length && this.certificates.some(o => o instanceof AttributeCertificateV2)) {\n            this.version = 4;\n        }\n        else if ((this.certificates && this.certificates.length && this.certificates.some(o => o instanceof AttributeCertificateV1))\n            || this.signerInfos.some(o => o.version === 3)\n            || this.encapContentInfo.eContentType !== SignedData.ID_DATA) {\n            this.version = 3;\n        }\n        else {\n            this.version = 1;\n        }\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }));\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n            value: Array.from(this.digestAlgorithms, algorithm => algorithm.toSchema())\n        }));\n        outputArray.push(this.encapContentInfo.toSchema());\n        if (this.certificates) {\n            const certificateSet = new CertificateSet({ certificates: this.certificates });\n            const certificateSetSchema = certificateSet.toSchema();\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: certificateSetSchema.valueBlock.value\n            }));\n        }\n        if (this.crls) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: Array.from(this.crls, crl => {\n                    if (crl instanceof OtherRevocationInfoFormat) {\n                        const crlSchema = crl.toSchema();\n                        crlSchema.idBlock.tagClass = 3;\n                        crlSchema.idBlock.tagNumber = 1;\n                        return crlSchema;\n                    }\n                    return crl.toSchema(encodeFlag);\n                })\n            }));\n        }\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n            value: Array.from(this.signerInfos, signerInfo => signerInfo.toSchema())\n        }));\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            version: this.version,\n            digestAlgorithms: Array.from(this.digestAlgorithms, algorithm => algorithm.toJSON()),\n            encapContentInfo: this.encapContentInfo.toJSON(),\n            signerInfos: Array.from(this.signerInfos, signerInfo => signerInfo.toJSON()),\n        };\n        if (this.certificates) {\n            res.certificates = Array.from(this.certificates, certificate => certificate.toJSON());\n        }\n        if (this.crls) {\n            res.crls = Array.from(this.crls, crl => crl.toJSON());\n        }\n        return res;\n    }\n    async verify({ signer = (-1), data = (EMPTY_BUFFER), trustedCerts = [], checkDate = (new Date()), checkChain = false, passedWhenNotRevValues = false, extendedMode = false, findOrigin = null, findIssuer = null } = {}, crypto = getCrypto(true)) {\n        let signerCert = null;\n        let timestampSerial = null;\n        try {\n            let messageDigestValue = EMPTY_BUFFER;\n            let shaAlgorithm = EMPTY_STRING;\n            let certificatePath = [];\n            const signerInfo = this.signerInfos[signer];\n            if (!signerInfo) {\n                throw new SignedDataVerifyError({\n                    date: checkDate,\n                    code: 1,\n                    message: \"Unable to get signer by supplied index\",\n                });\n            }\n            if (!this.certificates) {\n                throw new SignedDataVerifyError({\n                    date: checkDate,\n                    code: 2,\n                    message: \"No certificates attached to this signed data\",\n                });\n            }\n            if (signerInfo.sid instanceof IssuerAndSerialNumber) {\n                for (const certificate of this.certificates) {\n                    if (!(certificate instanceof Certificate))\n                        continue;\n                    if ((certificate.issuer.isEqual(signerInfo.sid.issuer)) &&\n                        (certificate.serialNumber.isEqual(signerInfo.sid.serialNumber))) {\n                        signerCert = certificate;\n                        break;\n                    }\n                }\n            }\n            else {\n                const sid = signerInfo.sid;\n                const keyId = sid.idBlock.isConstructed\n                    ? sid.valueBlock.value[0].valueBlock.valueHex\n                    : sid.valueBlock.valueHex;\n                for (const certificate of this.certificates) {\n                    if (!(certificate instanceof Certificate)) {\n                        continue;\n                    }\n                    const digest = await crypto.digest({ name: \"sha-1\" }, certificate.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView);\n                    if (pvutils__WEBPACK_IMPORTED_MODULE_2__.isEqualBuffer(digest, keyId)) {\n                        signerCert = certificate;\n                        break;\n                    }\n                }\n            }\n            if (!signerCert) {\n                throw new SignedDataVerifyError({\n                    date: checkDate,\n                    code: 3,\n                    message: \"Unable to find signer certificate\",\n                });\n            }\n            if (this.encapContentInfo.eContentType === id_eContentType_TSTInfo) {\n                if (!this.encapContentInfo.eContent) {\n                    throw new SignedDataVerifyError({\n                        date: checkDate,\n                        code: 15,\n                        message: \"Error during verification: TSTInfo eContent is empty\",\n                        signatureVerified: null,\n                        signerCertificate: signerCert,\n                        timestampSerial,\n                        signerCertificateVerified: true\n                    });\n                }\n                let tstInfo;\n                try {\n                    tstInfo = TSTInfo.fromBER(this.encapContentInfo.eContent.valueBlock.valueHexView);\n                }\n                catch {\n                    throw new SignedDataVerifyError({\n                        date: checkDate,\n                        code: 15,\n                        message: \"Error during verification: TSTInfo wrong ASN.1 schema \",\n                        signatureVerified: null,\n                        signerCertificate: signerCert,\n                        timestampSerial,\n                        signerCertificateVerified: true\n                    });\n                }\n                checkDate = tstInfo.genTime;\n                timestampSerial = tstInfo.serialNumber.valueBlock.valueHexView.slice().buffer;\n                if (data.byteLength === 0) {\n                    throw new SignedDataVerifyError({\n                        date: checkDate,\n                        code: 4,\n                        message: \"Missed detached data input array\",\n                    });\n                }\n                if (!(await tstInfo.verify({ data }, crypto))) {\n                    throw new SignedDataVerifyError({\n                        date: checkDate,\n                        code: 15,\n                        message: \"Error during verification: TSTInfo verification is failed\",\n                        signatureVerified: false,\n                        signerCertificate: signerCert,\n                        timestampSerial,\n                        signerCertificateVerified: true\n                    });\n                }\n            }\n            if (checkChain) {\n                const certs = this.certificates.filter(certificate => (certificate instanceof Certificate && !!checkCA(certificate, signerCert)));\n                const chainParams = {\n                    checkDate,\n                    certs,\n                    trustedCerts,\n                };\n                if (findIssuer) {\n                    chainParams.findIssuer = findIssuer;\n                }\n                if (findOrigin) {\n                    chainParams.findOrigin = findOrigin;\n                }\n                const chainEngine = new CertificateChainValidationEngine(chainParams);\n                chainEngine.certs.push(signerCert);\n                if (this.crls) {\n                    for (const crl of this.crls) {\n                        if (\"thisUpdate\" in crl)\n                            chainEngine.crls.push(crl);\n                        else {\n                            if (crl.otherRevInfoFormat === id_PKIX_OCSP_Basic)\n                                chainEngine.ocsps.push(new BasicOCSPResponse({ schema: crl.otherRevInfo }));\n                        }\n                    }\n                }\n                if (this.ocsps) {\n                    chainEngine.ocsps.push(...(this.ocsps));\n                }\n                const verificationResult = await chainEngine.verify({ passedWhenNotRevValues }, crypto)\n                    .catch(e => {\n                    throw new SignedDataVerifyError({\n                        date: checkDate,\n                        code: 5,\n                        message: `Validation of signer's certificate failed with error: ${((e instanceof Object) ? e.resultMessage : e)}`,\n                        signerCertificate: signerCert,\n                        signerCertificateVerified: false\n                    });\n                });\n                if (verificationResult.certificatePath) {\n                    certificatePath = verificationResult.certificatePath;\n                }\n                if (!verificationResult.result)\n                    throw new SignedDataVerifyError({\n                        date: checkDate,\n                        code: 5,\n                        message: `Validation of signer's certificate failed: ${verificationResult.resultMessage}`,\n                        signerCertificate: signerCert,\n                        signerCertificateVerified: false\n                    });\n            }\n            const signerInfoHashAlgorithm = crypto.getAlgorithmByOID(signerInfo.digestAlgorithm.algorithmId);\n            if (!(\"name\" in signerInfoHashAlgorithm)) {\n                throw new SignedDataVerifyError({\n                    date: checkDate,\n                    code: 7,\n                    message: `Unsupported signature algorithm: ${signerInfo.digestAlgorithm.algorithmId}`,\n                    signerCertificate: signerCert,\n                    signerCertificateVerified: true\n                });\n            }\n            shaAlgorithm = signerInfoHashAlgorithm.name;\n            const eContent = this.encapContentInfo.eContent;\n            if (eContent) {\n                if ((eContent.idBlock.tagClass === 1) &&\n                    (eContent.idBlock.tagNumber === 4)) {\n                    data = eContent.getValue();\n                }\n                else\n                    data = eContent.valueBlock.valueBeforeDecodeView.slice().buffer;\n            }\n            else {\n                if (data.byteLength === 0) {\n                    throw new SignedDataVerifyError({\n                        date: checkDate,\n                        code: 8,\n                        message: \"Missed detached data input array\",\n                        signerCertificate: signerCert,\n                        signerCertificateVerified: true\n                    });\n                }\n            }\n            if (signerInfo.signedAttrs) {\n                let foundContentType = false;\n                let foundMessageDigest = false;\n                for (const attribute of signerInfo.signedAttrs.attributes) {\n                    if (attribute.type === \"1.2.840.113549.1.9.3\")\n                        foundContentType = true;\n                    if (attribute.type === \"1.2.840.113549.1.9.4\") {\n                        foundMessageDigest = true;\n                        messageDigestValue = attribute.values[0].valueBlock.valueHex;\n                    }\n                    if (foundContentType && foundMessageDigest)\n                        break;\n                }\n                if (foundContentType === false) {\n                    throw new SignedDataVerifyError({\n                        date: checkDate,\n                        code: 9,\n                        message: \"Attribute \\\"content-type\\\" is a mandatory attribute for \\\"signed attributes\\\"\",\n                        signerCertificate: signerCert,\n                        signerCertificateVerified: true\n                    });\n                }\n                if (foundMessageDigest === false) {\n                    throw new SignedDataVerifyError({\n                        date: checkDate,\n                        code: 10,\n                        message: \"Attribute \\\"message-digest\\\" is a mandatory attribute for \\\"signed attributes\\\"\",\n                        signatureVerified: null,\n                        signerCertificate: signerCert,\n                        signerCertificateVerified: true\n                    });\n                }\n            }\n            if (signerInfo.signedAttrs) {\n                const messageDigest = await crypto.digest(shaAlgorithm, new Uint8Array(data));\n                if (!pvutils__WEBPACK_IMPORTED_MODULE_2__.isEqualBuffer(messageDigest, messageDigestValue)) {\n                    throw new SignedDataVerifyError({\n                        date: checkDate,\n                        code: 15,\n                        message: \"Error during verification: Message digest doesn't match\",\n                        signatureVerified: null,\n                        signerCertificate: signerCert,\n                        timestampSerial,\n                        signerCertificateVerified: true\n                    });\n                }\n                data = signerInfo.signedAttrs.encodedValue;\n            }\n            const verifyResult = signerInfo.signatureAlgorithm.algorithmId === \"1.2.840.113549.1.1.1\"\n                ? await crypto.verifyWithPublicKey(data, signerInfo.signature, signerCert.subjectPublicKeyInfo, signerInfo.signatureAlgorithm, shaAlgorithm)\n                : await crypto.verifyWithPublicKey(data, signerInfo.signature, signerCert.subjectPublicKeyInfo, signerInfo.signatureAlgorithm);\n            if (extendedMode) {\n                return {\n                    date: checkDate,\n                    code: 14,\n                    message: EMPTY_STRING,\n                    signatureVerified: verifyResult,\n                    signerCertificate: signerCert,\n                    timestampSerial,\n                    signerCertificateVerified: true,\n                    certificatePath\n                };\n            }\n            else {\n                return verifyResult;\n            }\n        }\n        catch (e) {\n            if (e instanceof SignedDataVerifyError) {\n                throw e;\n            }\n            throw new SignedDataVerifyError({\n                date: checkDate,\n                code: 15,\n                message: `Error during verification: ${e instanceof Error ? e.message : e}`,\n                signatureVerified: null,\n                signerCertificate: signerCert,\n                timestampSerial,\n                signerCertificateVerified: true\n            });\n        }\n    }\n    async sign(privateKey, signerIndex, hashAlgorithm = \"SHA-1\", data = (EMPTY_BUFFER), crypto = getCrypto(true)) {\n        var _a;\n        if (!privateKey)\n            throw new Error(\"Need to provide a private key for signing\");\n        const signerInfo = this.signerInfos[signerIndex];\n        if (!signerInfo) {\n            throw new RangeError(\"SignerInfo index is out of range\");\n        }\n        if (!((_a = signerInfo.signedAttrs) === null || _a === void 0 ? void 0 : _a.attributes.length) && \"hash\" in privateKey.algorithm && \"hash\" in privateKey.algorithm && privateKey.algorithm.hash) {\n            hashAlgorithm = privateKey.algorithm.hash.name;\n        }\n        const hashAlgorithmOID = crypto.getOIDByAlgorithm({ name: hashAlgorithm }, true, \"hashAlgorithm\");\n        if ((this.digestAlgorithms.filter(algorithm => algorithm.algorithmId === hashAlgorithmOID)).length === 0) {\n            this.digestAlgorithms.push(new AlgorithmIdentifier({\n                algorithmId: hashAlgorithmOID,\n                algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n            }));\n        }\n        signerInfo.digestAlgorithm = new AlgorithmIdentifier({\n            algorithmId: hashAlgorithmOID,\n            algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n        });\n        const signatureParams = await crypto.getSignatureParameters(privateKey, hashAlgorithm);\n        const parameters = signatureParams.parameters;\n        signerInfo.signatureAlgorithm = signatureParams.signatureAlgorithm;\n        if (signerInfo.signedAttrs) {\n            if (signerInfo.signedAttrs.encodedValue.byteLength !== 0)\n                data = signerInfo.signedAttrs.encodedValue;\n            else {\n                data = signerInfo.signedAttrs.toSchema().toBER();\n                const view = pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.toUint8Array(data);\n                view[0] = 0x31;\n            }\n        }\n        else {\n            const eContent = this.encapContentInfo.eContent;\n            if (eContent) {\n                if ((eContent.idBlock.tagClass === 1) &&\n                    (eContent.idBlock.tagNumber === 4)) {\n                    data = eContent.getValue();\n                }\n                else\n                    data = eContent.valueBlock.valueBeforeDecodeView.slice().buffer;\n            }\n            else {\n                if (data.byteLength === 0)\n                    throw new Error(\"Missed detached data input array\");\n            }\n        }\n        const signature = await crypto.signWithPrivateKey(data, privateKey, parameters);\n        signerInfo.signature = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: signature });\n    }\n}\nSignedData.CLASS_NAME = \"SignedData\";\nSignedData.ID_DATA = id_ContentType_Data;\n\nconst VERSION$1 = \"version\";\nconst AUTH_SAFE = \"authSafe\";\nconst MAC_DATA = \"macData\";\nconst PARSED_VALUE = \"parsedValue\";\nconst CLERA_PROPS = [\n    VERSION$1,\n    AUTH_SAFE,\n    MAC_DATA\n];\nclass PFX extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$1, PFX.defaultValues(VERSION$1));\n        this.authSafe = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, AUTH_SAFE, PFX.defaultValues(AUTH_SAFE));\n        if (MAC_DATA in parameters) {\n            this.macData = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MAC_DATA, PFX.defaultValues(MAC_DATA));\n        }\n        if (PARSED_VALUE in parameters) {\n            this.parsedValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PARSED_VALUE, PFX.defaultValues(PARSED_VALUE));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$1:\n                return 3;\n            case AUTH_SAFE:\n                return (new ContentInfo());\n            case MAC_DATA:\n                return (new MacData());\n            case PARSED_VALUE:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VERSION$1:\n                return (memberValue === PFX.defaultValues(memberName));\n            case AUTH_SAFE:\n                return ((ContentInfo.compareWithDefault(\"contentType\", memberValue.contentType)) &&\n                    (ContentInfo.compareWithDefault(\"content\", memberValue.content)));\n            case MAC_DATA:\n                return ((MacData.compareWithDefault(\"mac\", memberValue.mac)) &&\n                    (MacData.compareWithDefault(\"macSalt\", memberValue.macSalt)) &&\n                    (MacData.compareWithDefault(\"iterations\", memberValue.iterations)));\n            case PARSED_VALUE:\n                return ((memberValue instanceof Object) && (Object.keys(memberValue).length === 0));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || VERSION$1) }),\n                ContentInfo.schema(names.authSafe || {\n                    names: {\n                        blockName: AUTH_SAFE\n                    }\n                }),\n                MacData.schema(names.macData || {\n                    names: {\n                        blockName: MAC_DATA,\n                        optional: true\n                    }\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLERA_PROPS);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PFX.schema({\n            names: {\n                version: VERSION$1,\n                authSafe: {\n                    names: {\n                        blockName: AUTH_SAFE\n                    }\n                },\n                macData: {\n                    names: {\n                        blockName: MAC_DATA\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result.version.valueBlock.valueDec;\n        this.authSafe = new ContentInfo({ schema: asn1.result.authSafe });\n        if (MAC_DATA in asn1.result)\n            this.macData = new MacData({ schema: asn1.result.macData });\n    }\n    toSchema() {\n        const outputArray = [\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }),\n            this.authSafe.toSchema()\n        ];\n        if (this.macData) {\n            outputArray.push(this.macData.toSchema());\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const output = {\n            version: this.version,\n            authSafe: this.authSafe.toJSON()\n        };\n        if (this.macData) {\n            output.macData = this.macData.toJSON();\n        }\n        return output;\n    }\n    async makeInternalValues(parameters = {}, crypto = getCrypto(true)) {\n        ArgumentError.assert(parameters, \"parameters\", \"object\");\n        if (!this.parsedValue) {\n            throw new Error(\"Please call \\\"parseValues\\\" function first in order to make \\\"parsedValue\\\" data\");\n        }\n        ParameterError.assertEmpty(this.parsedValue.integrityMode, \"integrityMode\", \"parsedValue\");\n        ParameterError.assertEmpty(this.parsedValue.authenticatedSafe, \"authenticatedSafe\", \"parsedValue\");\n        switch (this.parsedValue.integrityMode) {\n            case 0:\n                {\n                    if (!(\"iterations\" in parameters))\n                        throw new ParameterError(\"iterations\");\n                    ParameterError.assertEmpty(parameters.pbkdf2HashAlgorithm, \"pbkdf2HashAlgorithm\");\n                    ParameterError.assertEmpty(parameters.hmacHashAlgorithm, \"hmacHashAlgorithm\");\n                    ParameterError.assertEmpty(parameters.password, \"password\");\n                    const saltBuffer = new ArrayBuffer(64);\n                    const saltView = new Uint8Array(saltBuffer);\n                    crypto.getRandomValues(saltView);\n                    const data = this.parsedValue.authenticatedSafe.toSchema().toBER(false);\n                    this.authSafe = new ContentInfo({\n                        contentType: ContentInfo.DATA,\n                        content: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: data })\n                    });\n                    const result = await crypto.stampDataWithPassword({\n                        password: parameters.password,\n                        hashAlgorithm: parameters.hmacHashAlgorithm,\n                        salt: saltBuffer,\n                        iterationCount: parameters.iterations,\n                        contentToStamp: data\n                    });\n                    this.macData = new MacData({\n                        mac: new DigestInfo({\n                            digestAlgorithm: new AlgorithmIdentifier({\n                                algorithmId: crypto.getOIDByAlgorithm({ name: parameters.hmacHashAlgorithm }, true, \"hmacHashAlgorithm\"),\n                            }),\n                            digest: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: result })\n                        }),\n                        macSalt: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: saltBuffer }),\n                        iterations: parameters.iterations\n                    });\n                }\n                break;\n            case 1:\n                {\n                    if (!(\"signingCertificate\" in parameters)) {\n                        throw new ParameterError(\"signingCertificate\");\n                    }\n                    ParameterError.assertEmpty(parameters.privateKey, \"privateKey\");\n                    ParameterError.assertEmpty(parameters.hashAlgorithm, \"hashAlgorithm\");\n                    const toBeSigned = this.parsedValue.authenticatedSafe.toSchema().toBER(false);\n                    const cmsSigned = new SignedData({\n                        version: 1,\n                        encapContentInfo: new EncapsulatedContentInfo({\n                            eContentType: \"1.2.840.113549.1.7.1\",\n                            eContent: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: toBeSigned })\n                        }),\n                        certificates: [parameters.signingCertificate]\n                    });\n                    const result = await crypto.digest({ name: parameters.hashAlgorithm }, new Uint8Array(toBeSigned));\n                    const signedAttr = [];\n                    signedAttr.push(new Attribute({\n                        type: \"1.2.840.113549.1.9.3\",\n                        values: [\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: \"1.2.840.113549.1.7.1\" })\n                        ]\n                    }));\n                    signedAttr.push(new Attribute({\n                        type: \"1.2.840.113549.1.9.5\",\n                        values: [\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.UTCTime({ valueDate: new Date() })\n                        ]\n                    }));\n                    signedAttr.push(new Attribute({\n                        type: \"1.2.840.113549.1.9.4\",\n                        values: [\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: result })\n                        ]\n                    }));\n                    cmsSigned.signerInfos.push(new SignerInfo({\n                        version: 1,\n                        sid: new IssuerAndSerialNumber({\n                            issuer: parameters.signingCertificate.issuer,\n                            serialNumber: parameters.signingCertificate.serialNumber\n                        }),\n                        signedAttrs: new SignedAndUnsignedAttributes({\n                            type: 0,\n                            attributes: signedAttr\n                        })\n                    }));\n                    await cmsSigned.sign(parameters.privateKey, 0, parameters.hashAlgorithm, undefined, crypto);\n                    this.authSafe = new ContentInfo({\n                        contentType: \"1.2.840.113549.1.7.2\",\n                        content: cmsSigned.toSchema(true)\n                    });\n                }\n                break;\n            default:\n                throw new Error(`Parameter \"integrityMode\" has unknown value: ${this.parsedValue.integrityMode}`);\n        }\n    }\n    async parseInternalValues(parameters, crypto = getCrypto(true)) {\n        ArgumentError.assert(parameters, \"parameters\", \"object\");\n        if (parameters.checkIntegrity === undefined) {\n            parameters.checkIntegrity = true;\n        }\n        this.parsedValue = {};\n        switch (this.authSafe.contentType) {\n            case ContentInfo.DATA:\n                {\n                    ParameterError.assertEmpty(parameters.password, \"password\");\n                    this.parsedValue.integrityMode = 0;\n                    ArgumentError.assert(this.authSafe.content, \"authSafe.content\", asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString);\n                    const authSafeContent = this.authSafe.content.getValue();\n                    this.parsedValue.authenticatedSafe = AuthenticatedSafe.fromBER(authSafeContent);\n                    if (parameters.checkIntegrity) {\n                        if (!this.macData) {\n                            throw new Error(\"Absent \\\"macData\\\" value, can not check PKCS#12 data integrity\");\n                        }\n                        const hashAlgorithm = crypto.getAlgorithmByOID(this.macData.mac.digestAlgorithm.algorithmId, true, \"digestAlgorithm\");\n                        const result = await crypto.verifyDataStampedWithPassword({\n                            password: parameters.password,\n                            hashAlgorithm: hashAlgorithm.name,\n                            salt: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.toArrayBuffer(this.macData.macSalt.valueBlock.valueHexView),\n                            iterationCount: this.macData.iterations || 1,\n                            contentToVerify: authSafeContent,\n                            signatureToVerify: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.toArrayBuffer(this.macData.mac.digest.valueBlock.valueHexView),\n                        });\n                        if (!result) {\n                            throw new Error(\"Integrity for the PKCS#12 data is broken!\");\n                        }\n                    }\n                }\n                break;\n            case ContentInfo.SIGNED_DATA:\n                {\n                    this.parsedValue.integrityMode = 1;\n                    const cmsSigned = new SignedData({ schema: this.authSafe.content });\n                    const eContent = cmsSigned.encapContentInfo.eContent;\n                    ParameterError.assert(eContent, \"eContent\", \"cmsSigned.encapContentInfo\");\n                    ArgumentError.assert(eContent, \"eContent\", asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString);\n                    const data = eContent.getValue();\n                    this.parsedValue.authenticatedSafe = AuthenticatedSafe.fromBER(data);\n                    const ok = await cmsSigned.verify({ signer: 0, checkChain: false }, crypto);\n                    if (!ok) {\n                        throw new Error(\"Integrity for the PKCS#12 data is broken!\");\n                    }\n                }\n                break;\n            default:\n                throw new Error(`Incorrect value for \"this.authSafe.contentType\": ${this.authSafe.contentType}`);\n        }\n    }\n}\nPFX.CLASS_NAME = \"PFX\";\n\nconst STATUS$1 = \"status\";\nconst STATUS_STRINGS = \"statusStrings\";\nconst FAIL_INFO = \"failInfo\";\nconst CLEAR_PROPS$2 = [\n    STATUS$1,\n    STATUS_STRINGS,\n    FAIL_INFO\n];\nvar PKIStatus;\n(function (PKIStatus) {\n    PKIStatus[PKIStatus[\"granted\"] = 0] = \"granted\";\n    PKIStatus[PKIStatus[\"grantedWithMods\"] = 1] = \"grantedWithMods\";\n    PKIStatus[PKIStatus[\"rejection\"] = 2] = \"rejection\";\n    PKIStatus[PKIStatus[\"waiting\"] = 3] = \"waiting\";\n    PKIStatus[PKIStatus[\"revocationWarning\"] = 4] = \"revocationWarning\";\n    PKIStatus[PKIStatus[\"revocationNotification\"] = 5] = \"revocationNotification\";\n})(PKIStatus || (PKIStatus = {}));\nclass PKIStatusInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.status = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, STATUS$1, PKIStatusInfo.defaultValues(STATUS$1));\n        if (STATUS_STRINGS in parameters) {\n            this.statusStrings = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, STATUS_STRINGS, PKIStatusInfo.defaultValues(STATUS_STRINGS));\n        }\n        if (FAIL_INFO in parameters) {\n            this.failInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, FAIL_INFO, PKIStatusInfo.defaultValues(FAIL_INFO));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case STATUS$1:\n                return 2;\n            case STATUS_STRINGS:\n                return [];\n            case FAIL_INFO:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case STATUS$1:\n                return (memberValue === PKIStatusInfo.defaultValues(memberName));\n            case STATUS_STRINGS:\n                return (memberValue.length === 0);\n            case FAIL_INFO:\n                return (memberValue.isEqual(PKIStatusInfo.defaultValues(memberName)));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.status || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    optional: true,\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.statusStrings || EMPTY_STRING),\n                            value: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Utf8String()\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({\n                    name: (names.failInfo || EMPTY_STRING),\n                    optional: true\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$2);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PKIStatusInfo.schema({\n            names: {\n                status: STATUS$1,\n                statusStrings: STATUS_STRINGS,\n                failInfo: FAIL_INFO\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        const _status = asn1.result.status;\n        if ((_status.valueBlock.isHexOnly === true) ||\n            (_status.valueBlock.valueDec < 0) ||\n            (_status.valueBlock.valueDec > 5))\n            throw new Error(\"PKIStatusInfo \\\"status\\\" has invalid value\");\n        this.status = _status.valueBlock.valueDec;\n        if (STATUS_STRINGS in asn1.result)\n            this.statusStrings = asn1.result.statusStrings;\n        if (FAIL_INFO in asn1.result)\n            this.failInfo = asn1.result.failInfo;\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.status }));\n        if (this.statusStrings) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                optional: true,\n                value: this.statusStrings\n            }));\n        }\n        if (this.failInfo) {\n            outputArray.push(this.failInfo);\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            status: this.status\n        };\n        if (this.statusStrings) {\n            res.statusStrings = Array.from(this.statusStrings, o => o.toJSON());\n        }\n        if (this.failInfo) {\n            res.failInfo = this.failInfo.toJSON();\n        }\n        return res;\n    }\n}\nPKIStatusInfo.CLASS_NAME = \"PKIStatusInfo\";\n\nconst VERSION = \"version\";\nconst MESSAGE_IMPRINT = \"messageImprint\";\nconst REQ_POLICY = \"reqPolicy\";\nconst NONCE = \"nonce\";\nconst CERT_REQ = \"certReq\";\nconst EXTENSIONS = \"extensions\";\nconst TIME_STAMP_REQ = \"TimeStampReq\";\nconst TIME_STAMP_REQ_VERSION = `${TIME_STAMP_REQ}.${VERSION}`;\nconst TIME_STAMP_REQ_MESSAGE_IMPRINT = `${TIME_STAMP_REQ}.${MESSAGE_IMPRINT}`;\nconst TIME_STAMP_REQ_POLICY = `${TIME_STAMP_REQ}.${REQ_POLICY}`;\nconst TIME_STAMP_REQ_NONCE = `${TIME_STAMP_REQ}.${NONCE}`;\nconst TIME_STAMP_REQ_CERT_REQ = `${TIME_STAMP_REQ}.${CERT_REQ}`;\nconst TIME_STAMP_REQ_EXTENSIONS = `${TIME_STAMP_REQ}.${EXTENSIONS}`;\nconst CLEAR_PROPS$1 = [\n    TIME_STAMP_REQ_VERSION,\n    TIME_STAMP_REQ_MESSAGE_IMPRINT,\n    TIME_STAMP_REQ_POLICY,\n    TIME_STAMP_REQ_NONCE,\n    TIME_STAMP_REQ_CERT_REQ,\n    TIME_STAMP_REQ_EXTENSIONS,\n];\nclass TimeStampReq extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION, TimeStampReq.defaultValues(VERSION));\n        this.messageImprint = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MESSAGE_IMPRINT, TimeStampReq.defaultValues(MESSAGE_IMPRINT));\n        if (REQ_POLICY in parameters) {\n            this.reqPolicy = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, REQ_POLICY, TimeStampReq.defaultValues(REQ_POLICY));\n        }\n        if (NONCE in parameters) {\n            this.nonce = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NONCE, TimeStampReq.defaultValues(NONCE));\n        }\n        if (CERT_REQ in parameters) {\n            this.certReq = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CERT_REQ, TimeStampReq.defaultValues(CERT_REQ));\n        }\n        if (EXTENSIONS in parameters) {\n            this.extensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, EXTENSIONS, TimeStampReq.defaultValues(EXTENSIONS));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION:\n                return 0;\n            case MESSAGE_IMPRINT:\n                return new MessageImprint();\n            case REQ_POLICY:\n                return EMPTY_STRING;\n            case NONCE:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case CERT_REQ:\n                return false;\n            case EXTENSIONS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VERSION:\n            case REQ_POLICY:\n            case CERT_REQ:\n                return (memberValue === TimeStampReq.defaultValues(memberName));\n            case MESSAGE_IMPRINT:\n                return ((MessageImprint.compareWithDefault(\"hashAlgorithm\", memberValue.hashAlgorithm)) &&\n                    (MessageImprint.compareWithDefault(\"hashedMessage\", memberValue.hashedMessage)));\n            case NONCE:\n                return (memberValue.isEqual(TimeStampReq.defaultValues(memberName)));\n            case EXTENSIONS:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || TIME_STAMP_REQ),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || TIME_STAMP_REQ_VERSION) }),\n                MessageImprint.schema(names.messageImprint || {\n                    names: {\n                        blockName: TIME_STAMP_REQ_MESSAGE_IMPRINT\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({\n                    name: (names.reqPolicy || TIME_STAMP_REQ_POLICY),\n                    optional: true\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({\n                    name: (names.nonce || TIME_STAMP_REQ_NONCE),\n                    optional: true\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Boolean({\n                    name: (names.certReq || TIME_STAMP_REQ_CERT_REQ),\n                    optional: true\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.extensions || TIME_STAMP_REQ_EXTENSIONS),\n                            value: Extension.schema()\n                        })]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, TimeStampReq.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result[TIME_STAMP_REQ_VERSION].valueBlock.valueDec;\n        this.messageImprint = new MessageImprint({ schema: asn1.result[TIME_STAMP_REQ_MESSAGE_IMPRINT] });\n        if (TIME_STAMP_REQ_POLICY in asn1.result)\n            this.reqPolicy = asn1.result[TIME_STAMP_REQ_POLICY].valueBlock.toString();\n        if (TIME_STAMP_REQ_NONCE in asn1.result)\n            this.nonce = asn1.result[TIME_STAMP_REQ_NONCE];\n        if (TIME_STAMP_REQ_CERT_REQ in asn1.result)\n            this.certReq = asn1.result[TIME_STAMP_REQ_CERT_REQ].valueBlock.value;\n        if (TIME_STAMP_REQ_EXTENSIONS in asn1.result)\n            this.extensions = Array.from(asn1.result[TIME_STAMP_REQ_EXTENSIONS], element => new Extension({ schema: element }));\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }));\n        outputArray.push(this.messageImprint.toSchema());\n        if (this.reqPolicy)\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.reqPolicy }));\n        if (this.nonce)\n            outputArray.push(this.nonce);\n        if ((CERT_REQ in this) && (TimeStampReq.compareWithDefault(CERT_REQ, this.certReq) === false))\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Boolean({ value: this.certReq }));\n        if (this.extensions) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: Array.from(this.extensions, o => o.toSchema())\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            version: this.version,\n            messageImprint: this.messageImprint.toJSON()\n        };\n        if (this.reqPolicy !== undefined)\n            res.reqPolicy = this.reqPolicy;\n        if (this.nonce !== undefined)\n            res.nonce = this.nonce.toJSON();\n        if ((this.certReq !== undefined) && (TimeStampReq.compareWithDefault(CERT_REQ, this.certReq) === false))\n            res.certReq = this.certReq;\n        if (this.extensions) {\n            res.extensions = Array.from(this.extensions, o => o.toJSON());\n        }\n        return res;\n    }\n}\nTimeStampReq.CLASS_NAME = \"TimeStampReq\";\n\nconst STATUS = \"status\";\nconst TIME_STAMP_TOKEN = \"timeStampToken\";\nconst TIME_STAMP_RESP = \"TimeStampResp\";\nconst TIME_STAMP_RESP_STATUS = `${TIME_STAMP_RESP}.${STATUS}`;\nconst TIME_STAMP_RESP_TOKEN = `${TIME_STAMP_RESP}.${TIME_STAMP_TOKEN}`;\nconst CLEAR_PROPS = [\n    TIME_STAMP_RESP_STATUS,\n    TIME_STAMP_RESP_TOKEN\n];\nclass TimeStampResp extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.status = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, STATUS, TimeStampResp.defaultValues(STATUS));\n        if (TIME_STAMP_TOKEN in parameters) {\n            this.timeStampToken = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TIME_STAMP_TOKEN, TimeStampResp.defaultValues(TIME_STAMP_TOKEN));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case STATUS:\n                return new PKIStatusInfo();\n            case TIME_STAMP_TOKEN:\n                return new ContentInfo();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case STATUS:\n                return ((PKIStatusInfo.compareWithDefault(STATUS, memberValue.status)) &&\n                    ((\"statusStrings\" in memberValue) === false) &&\n                    ((\"failInfo\" in memberValue) === false));\n            case TIME_STAMP_TOKEN:\n                return ((memberValue.contentType === EMPTY_STRING) &&\n                    (memberValue.content instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || TIME_STAMP_RESP),\n            value: [\n                PKIStatusInfo.schema(names.status || {\n                    names: {\n                        blockName: TIME_STAMP_RESP_STATUS\n                    }\n                }),\n                ContentInfo.schema(names.timeStampToken || {\n                    names: {\n                        blockName: TIME_STAMP_RESP_TOKEN,\n                        optional: true\n                    }\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, TimeStampResp.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.status = new PKIStatusInfo({ schema: asn1.result[TIME_STAMP_RESP_STATUS] });\n        if (TIME_STAMP_RESP_TOKEN in asn1.result)\n            this.timeStampToken = new ContentInfo({ schema: asn1.result[TIME_STAMP_RESP_TOKEN] });\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(this.status.toSchema());\n        if (this.timeStampToken) {\n            outputArray.push(this.timeStampToken.toSchema());\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            status: this.status.toJSON()\n        };\n        if (this.timeStampToken) {\n            res.timeStampToken = this.timeStampToken.toJSON();\n        }\n        return res;\n    }\n    async sign(privateKey, hashAlgorithm, crypto = getCrypto(true)) {\n        this.assertContentType();\n        const signed = new SignedData({ schema: this.timeStampToken.content });\n        return signed.sign(privateKey, 0, hashAlgorithm, undefined, crypto);\n    }\n    async verify(verificationParameters = { signer: 0, trustedCerts: [], data: EMPTY_BUFFER }, crypto = getCrypto(true)) {\n        this.assertContentType();\n        const signed = new SignedData({ schema: this.timeStampToken.content });\n        return signed.verify(verificationParameters, crypto);\n    }\n    assertContentType() {\n        if (!this.timeStampToken) {\n            throw new Error(\"timeStampToken is absent in TSP response\");\n        }\n        if (this.timeStampToken.contentType !== id_ContentType_SignedData) {\n            throw new Error(`Wrong format of timeStampToken: ${this.timeStampToken.contentType}`);\n        }\n    }\n}\nTimeStampResp.CLASS_NAME = \"TimeStampResp\";\n\nfunction initCryptoEngine() {\n    if (typeof globalThis !== \"undefined\" && \"crypto\" in globalThis) {\n        let engineName = \"webcrypto\";\n        if (\"webkitSubtle\" in globalThis.crypto) {\n            engineName = \"safari\";\n        }\n        setEngine(engineName, new CryptoEngine({ name: engineName, crypto: globalThis.crypto }));\n    }\n    else if (typeof crypto !== \"undefined\" && \"webcrypto\" in crypto) {\n        const name = \"NodeJS ^15\";\n        const nodeCrypto = crypto.webcrypto;\n        setEngine(name, new CryptoEngine({ name, crypto: nodeCrypto }));\n    }\n}\n\ninitCryptoEngine();\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvcGtpanMvYnVpbGQvaW5kZXguZXMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsY0FBYztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFaUM7QUFDTTtBQUNXO0FBQ2Y7QUFDQTtBQUNPO0FBQ2tCOztBQUU1RDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEZBQTRGLEVBQUU7QUFDOUYsOENBQThDLEtBQUssbUJBQW1CLDJCQUEyQix1QkFBdUIsa0JBQWtCO0FBQzFJO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdFQUFnRSxnQkFBZ0IsUUFBUSxpQkFBaUIsSUFBSSxJQUFJO0FBQ2pIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFEQUFxRCxnQkFBZ0IsUUFBUSxpQkFBaUIsSUFBSSxlQUFlO0FBQ2pIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QyxpQkFBaUI7QUFDekQ7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkRBQTZELDRDQUE0QztBQUN6RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFD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O0FBQ0Esa0NBQWtDLHVEQUEwQjtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9ELHVDQUFVO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDLHNCQUFzQix1REFBMEIsd0JBQXdCO0FBQ3hFLG9CQUFvQiw0Q0FBZTtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsUUFBUSwrQ0FBa0I7QUFDMUIscUJBQXFCLGlEQUFvQjtBQUN6QztBQUNBLDBDQUEwQyw2Q0FBNkM7QUFDdkY7QUFDQSxvREFBb0QsNENBQTRDO0FBQ2hHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLDRDQUFlO0FBQ25DO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QyxxQ0FBcUM7QUFDN0U7QUFDQTtBQUNBLDRDQUE0QyxpREFBaUQ7QUFDN0Y7QUFDQSx3Q0FBd0MscUNBQXFDO0FBQzdFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0RBQStELGdDQUFnQztBQUMvRjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsNkNBQTZDO0FBQzlGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLDBCQUEwQjtBQUNyRTtBQUNBOztBQUVBOztBQUVxcEgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZWxmLXdvcmtzaG9wLy4vbm9kZV9tb2R1bGVzL3BraWpzL2J1aWxkL2luZGV4LmVzLmpzP2U5ODEiXSwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQsIEdsb2JhbFNpZ25cbiAqIENvcHlyaWdodCAoYykgMjAxNS0yMDE5LCBQZWN1bGlhciBWZW50dXJlc1xuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqIFxuICogQXV0aG9yIDIwMTQtMjAxOSwgWXVyeSBTdHJvemhldnNreVxuICogXG4gKiBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBhbmQgYmluYXJ5IGZvcm1zLCB3aXRoIG9yIHdpdGhvdXQgbW9kaWZpY2F0aW9uLFxuICogYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucyBhcmUgbWV0OlxuICogXG4gKiAqIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSwgdGhpc1xuICogICBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lci5cbiAqIFxuICogKiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UsIHRoaXNcbiAqICAgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4gdGhlIGRvY3VtZW50YXRpb24gYW5kL29yXG4gKiAgIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRoIHRoZSBkaXN0cmlidXRpb24uXG4gKiBcbiAqICogTmVpdGhlciB0aGUgbmFtZSBvZiB0aGUge29yZ2FuaXphdGlvbn0gbm9yIHRoZSBuYW1lcyBvZiBpdHNcbiAqICAgY29udHJpYnV0b3JzIG1heSBiZSB1c2VkIHRvIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0cyBkZXJpdmVkIGZyb21cbiAqICAgdGhpcyBzb2Z0d2FyZSB3aXRob3V0IHNwZWNpZmljIHByaW9yIHdyaXR0ZW4gcGVybWlzc2lvbi5cbiAqIFxuICogVEhJUyBTT0ZUV0FSRSBJUyBQUk9WSURFRCBCWSBUSEUgQ09QWVJJR0hUIEhPTERFUlMgQU5EIENPTlRSSUJVVE9SUyBcIkFTIElTXCIgQU5EXG4gKiBBTlkgRVhQUkVTUyBPUiBJTVBMSUVEIFdBUlJBTlRJRVMsIElOQ0xVRElORywgQlVUIE5PVCBMSU1JVEVEIFRPLCBUSEUgSU1QTElFRFxuICogV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFSRVxuICogRElTQ0xBSU1FRC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIENPUFlSSUdIVCBIT0xERVIgT1IgQ09OVFJJQlVUT1JTIEJFIExJQUJMRSBGT1JcbiAqIEFOWSBESVJFQ1QsIElORElSRUNULCBJTkNJREVOVEFMLCBTUEVDSUFMLCBFWEVNUExBUlksIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFU1xuICogKElOQ0xVRElORywgQlVUIE5PVCBMSU1JVEVEIFRPLCBQUk9DVVJFTUVOVCBPRiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTO1xuICogTE9TUyBPRiBVU0UsIERBVEEsIE9SIFBST0ZJVFM7IE9SIEJVU0lORVNTIElOVEVSUlVQVElPTikgSE9XRVZFUiBDQVVTRUQgQU5EIE9OXG4gKiBBTlkgVEhFT1JZIE9GIExJQUJJTElUWSwgV0hFVEhFUiBJTiBDT05UUkFDVCwgU1RSSUNUIExJQUJJTElUWSwgT1IgVE9SVFxuICogKElOQ0xVRElORyBORUdMSUdFTkNFIE9SIE9USEVSV0lTRSkgQVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUgVVNFIE9GIFRISVNcbiAqIFNPRlRXQVJFLCBFVkVOIElGIEFEVklTRUQgT0YgVEhFIFBPU1NJQklMSVRZIE9GIFNVQ0ggREFNQUdFLlxuICogXG4gKi9cblxuaW1wb3J0ICogYXMgYXNuMWpzIGZyb20gJ2FzbjFqcyc7XG5pbXBvcnQgKiBhcyBwdnRzdXRpbHMgZnJvbSAncHZ0c3V0aWxzJztcbmltcG9ydCB7IEJ1ZmZlclNvdXJjZUNvbnZlcnRlciB9IGZyb20gJ3B2dHN1dGlscyc7XG5pbXBvcnQgKiBhcyBwdnV0aWxzIGZyb20gJ3B2dXRpbHMnO1xuaW1wb3J0ICogYXMgYnMgZnJvbSAnYnl0ZXN0cmVhbWpzJztcbmltcG9ydCB7IHNoYTEgfSBmcm9tICdAbm9ibGUvaGFzaGVzL3NoYTEnO1xuaW1wb3J0IHsgc2hhNTEyLCBzaGEzODQsIHNoYTI1NiB9IGZyb20gJ0Bub2JsZS9oYXNoZXMvc2hhMic7XG5cbmNvbnN0IEVNUFRZX0JVRkZFUiA9IG5ldyBBcnJheUJ1ZmZlcigwKTtcbmNvbnN0IEVNUFRZX1NUUklORyA9IFwiXCI7XG5cbmNsYXNzIEFyZ3VtZW50RXJyb3IgZXh0ZW5kcyBUeXBlRXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlciguLi5hcmd1bWVudHMpO1xuICAgICAgICB0aGlzLm5hbWUgPSBBcmd1bWVudEVycm9yLk5BTUU7XG4gICAgfVxuICAgIHN0YXRpYyBpc1R5cGUodmFsdWUsIHR5cGUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0eXBlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gXCJBcnJheVwiICYmIEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlID09PSBcIkFycmF5QnVmZmVyXCIgJiYgdmFsdWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZSA9PT0gXCJBcnJheUJ1ZmZlclZpZXdcIiAmJiBBcnJheUJ1ZmZlci5pc1ZpZXcodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09IHR5cGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIHR5cGUpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgc3RhdGljIGFzc2VydCh2YWx1ZSwgbmFtZSwgLi4udHlwZXMpIHtcbiAgICAgICAgZm9yIChjb25zdCB0eXBlIG9mIHR5cGVzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc1R5cGUodmFsdWUsIHR5cGUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHR5cGVOYW1lcyA9IHR5cGVzLm1hcChvID0+IG8gaW5zdGFuY2VvZiBGdW5jdGlvbiAmJiBcIm5hbWVcIiBpbiBvID8gby5uYW1lIDogYCR7b31gKTtcbiAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50RXJyb3IoYFBhcmFtZXRlciAnJHtuYW1lfScgaXMgbm90IG9mIHR5cGUgJHt0eXBlTmFtZXMubGVuZ3RoID4gMSA/IGAoJHt0eXBlTmFtZXMuam9pbihcIiBvciBcIil9KWAgOiB0eXBlTmFtZXNbMF19YCk7XG4gICAgfVxufVxuQXJndW1lbnRFcnJvci5OQU1FID0gXCJBcmd1bWVudEVycm9yXCI7XG5cbmNsYXNzIFBhcmFtZXRlckVycm9yIGV4dGVuZHMgVHlwZUVycm9yIHtcbiAgICBzdGF0aWMgYXNzZXJ0KC4uLmFyZ3MpIHtcbiAgICAgICAgbGV0IHRhcmdldCA9IG51bGw7XG4gICAgICAgIGxldCBwYXJhbXM7XG4gICAgICAgIGxldCBmaWVsZHM7XG4gICAgICAgIGlmICh0eXBlb2YgYXJnc1swXSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdGFyZ2V0ID0gYXJnc1swXTtcbiAgICAgICAgICAgIHBhcmFtcyA9IGFyZ3NbMV07XG4gICAgICAgICAgICBmaWVsZHMgPSBhcmdzLnNsaWNlKDIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcGFyYW1zID0gYXJnc1swXTtcbiAgICAgICAgICAgIGZpZWxkcyA9IGFyZ3Muc2xpY2UoMSk7XG4gICAgICAgIH1cbiAgICAgICAgQXJndW1lbnRFcnJvci5hc3NlcnQocGFyYW1zLCBcInBhcmFtZXRlcnNcIiwgXCJvYmplY3RcIik7XG4gICAgICAgIGZvciAoY29uc3QgZmllbGQgb2YgZmllbGRzKSB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHBhcmFtc1tmaWVsZF07XG4gICAgICAgICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBQYXJhbWV0ZXJFcnJvcihmaWVsZCwgdGFyZ2V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgYXNzZXJ0RW1wdHkodmFsdWUsIG5hbWUsIHRhcmdldCkge1xuICAgICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFBhcmFtZXRlckVycm9yKG5hbWUsIHRhcmdldCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3RydWN0b3IoZmllbGQsIHRhcmdldCA9IG51bGwsIG1lc3NhZ2UpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5uYW1lID0gUGFyYW1ldGVyRXJyb3IuTkFNRTtcbiAgICAgICAgdGhpcy5maWVsZCA9IGZpZWxkO1xuICAgICAgICBpZiAodGFyZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLnRhcmdldCA9IHRhcmdldDtcbiAgICAgICAgfVxuICAgICAgICBpZiAobWVzc2FnZSkge1xuICAgICAgICAgICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZSA9IGBBYnNlbnQgbWFuZGF0b3J5IHBhcmFtZXRlciAnJHtmaWVsZH0nICR7dGFyZ2V0ID8gYCBpbiAnJHt0YXJnZXR9J2AgOiBFTVBUWV9TVFJJTkd9YDtcbiAgICAgICAgfVxuICAgIH1cbn1cblBhcmFtZXRlckVycm9yLk5BTUUgPSBcIlBhcmFtZXRlckVycm9yXCI7XG5cbmNsYXNzIEFzbkVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICAgIHN0YXRpYyBhc3NlcnRTY2hlbWEoYXNuMSwgdGFyZ2V0KSB7XG4gICAgICAgIGlmICghYXNuMS52ZXJpZmllZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBPYmplY3QncyBzY2hlbWEgd2FzIG5vdCB2ZXJpZmllZCBhZ2FpbnN0IGlucHV0IGRhdGEgZm9yICR7dGFyZ2V0fWApO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBhc3NlcnQoYXNuLCB0YXJnZXQpIHtcbiAgICAgICAgaWYgKGFzbi5vZmZzZXQgPT09IC0xKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQXNuRXJyb3IoYEVycm9yIGR1cmluZyBwYXJzaW5nIG9mIEFTTi4xIGRhdGEuIERhdGEgaXMgbm90IGNvcnJlY3QgZm9yICcke3RhcmdldH0nLmApO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0cnVjdG9yKG1lc3NhZ2UpIHtcbiAgICAgICAgc3VwZXIobWVzc2FnZSk7XG4gICAgICAgIHRoaXMubmFtZSA9IFwiQXNuRXJyb3JcIjtcbiAgICB9XG59XG5cbmNsYXNzIFBraU9iamVjdCB7XG4gICAgc3RhdGljIGJsb2NrTmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuQ0xBU1NfTkFNRTtcbiAgICB9XG4gICAgc3RhdGljIGZyb21CRVIocmF3KSB7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuZnJvbUJFUihyYXcpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnQoYXNuMSwgdGhpcy5uYW1lKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgdGhpcyh7IHNjaGVtYTogYXNuMS5yZXN1bHQgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBc25FcnJvcihgQ2Fubm90IGNyZWF0ZSAnJHt0aGlzLkNMQVNTX05BTUV9JyBmcm9tIEFTTi4xIG9iamVjdGApO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIG1lbWJlciBuYW1lIGZvciAke3RoaXMuQ0xBU1NfTkFNRX0gY2xhc3M6ICR7bWVtYmVyTmFtZX1gKTtcbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBNZXRob2QgJyR7dGhpcy5DTEFTU19OQU1FfS5zY2hlbWEnIHNob3VsZCBiZSBvdmVycmlkZGVuYCk7XG4gICAgfVxuICAgIGdldCBjbGFzc05hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdG9yLkNMQVNTX05BTUU7XG4gICAgfVxuICAgIHRvU3RyaW5nKGVuY29kaW5nID0gXCJoZXhcIikge1xuICAgICAgICBsZXQgc2NoZW1hO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgc2NoZW1hID0gdGhpcy50b1NjaGVtYSgpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIHtcbiAgICAgICAgICAgIHNjaGVtYSA9IHRoaXMudG9TY2hlbWEodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHB2dHN1dGlscy5Db252ZXJ0LlRvU3RyaW5nKHNjaGVtYS50b0JFUigpLCBlbmNvZGluZyk7XG4gICAgfVxufVxuUGtpT2JqZWN0LkNMQVNTX05BTUUgPSBcIlBraU9iamVjdFwiO1xuXG5mdW5jdGlvbiBzdHJpbmdQcmVwKGlucHV0U3RyaW5nKSB7XG4gICAgbGV0IGlzU3BhY2UgPSBmYWxzZTtcbiAgICBsZXQgY3V0UmVzdWx0ID0gRU1QVFlfU1RSSU5HO1xuICAgIGNvbnN0IHJlc3VsdCA9IGlucHV0U3RyaW5nLnRyaW0oKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlc3VsdC5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAocmVzdWx0LmNoYXJDb2RlQXQoaSkgPT09IDMyKSB7XG4gICAgICAgICAgICBpZiAoaXNTcGFjZSA9PT0gZmFsc2UpXG4gICAgICAgICAgICAgICAgaXNTcGFjZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoaXNTcGFjZSkge1xuICAgICAgICAgICAgICAgIGN1dFJlc3VsdCArPSBcIiBcIjtcbiAgICAgICAgICAgICAgICBpc1NwYWNlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjdXRSZXN1bHQgKz0gcmVzdWx0W2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjdXRSZXN1bHQudG9Mb3dlckNhc2UoKTtcbn1cblxuY29uc3QgVFlQRSQ1ID0gXCJ0eXBlXCI7XG5jb25zdCBWQUxVRSQ2ID0gXCJ2YWx1ZVwiO1xuY2xhc3MgQXR0cmlidXRlVHlwZUFuZFZhbHVlIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy50eXBlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVFlQRSQ1LCBBdHRyaWJ1dGVUeXBlQW5kVmFsdWUuZGVmYXVsdFZhbHVlcyhUWVBFJDUpKTtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZBTFVFJDYsIEF0dHJpYnV0ZVR5cGVBbmRWYWx1ZS5kZWZhdWx0VmFsdWVzKFZBTFVFJDYpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFRZUEUkNTpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfU1RSSU5HO1xuICAgICAgICAgICAgY2FzZSBWQUxVRSQ2OlxuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgbmFtZTogKG5hbWVzLnR5cGUgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkFueSh7IG5hbWU6IChuYW1lcy52YWx1ZSB8fCBFTVBUWV9TVFJJTkcpIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgW1xuICAgICAgICAgICAgVFlQRSQ1LFxuICAgICAgICAgICAgXCJ0eXBlVmFsdWVcIlxuICAgICAgICBdKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBBdHRyaWJ1dGVUeXBlQW5kVmFsdWUuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogVFlQRSQ1LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBcInR5cGVWYWx1ZVwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy50eXBlID0gYXNuMS5yZXN1bHQudHlwZS52YWx1ZUJsb2NrLnRvU3RyaW5nKCk7XG4gICAgICAgIHRoaXMudmFsdWUgPSBhc24xLnJlc3VsdC50eXBlVmFsdWU7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyB2YWx1ZTogdGhpcy50eXBlIH0pLFxuICAgICAgICAgICAgICAgIHRoaXMudmFsdWVcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IF9vYmplY3QgPSB7XG4gICAgICAgICAgICB0eXBlOiB0aGlzLnR5cGVcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKE9iamVjdC5rZXlzKHRoaXMudmFsdWUpLmxlbmd0aCAhPT0gMCkge1xuICAgICAgICAgICAgX29iamVjdC52YWx1ZSA9ICh0aGlzLnZhbHVlKS50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIF9vYmplY3QudmFsdWUgPSB0aGlzLnZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfb2JqZWN0O1xuICAgIH1cbiAgICBpc0VxdWFsKGNvbXBhcmVUbykge1xuICAgICAgICBjb25zdCBzdHJpbmdCbG9ja05hbWVzID0gW1xuICAgICAgICAgICAgYXNuMWpzLlV0ZjhTdHJpbmcuYmxvY2tOYW1lKCksXG4gICAgICAgICAgICBhc24xanMuQm1wU3RyaW5nLmJsb2NrTmFtZSgpLFxuICAgICAgICAgICAgYXNuMWpzLlVuaXZlcnNhbFN0cmluZy5ibG9ja05hbWUoKSxcbiAgICAgICAgICAgIGFzbjFqcy5OdW1lcmljU3RyaW5nLmJsb2NrTmFtZSgpLFxuICAgICAgICAgICAgYXNuMWpzLlByaW50YWJsZVN0cmluZy5ibG9ja05hbWUoKSxcbiAgICAgICAgICAgIGFzbjFqcy5UZWxldGV4U3RyaW5nLmJsb2NrTmFtZSgpLFxuICAgICAgICAgICAgYXNuMWpzLlZpZGVvdGV4U3RyaW5nLmJsb2NrTmFtZSgpLFxuICAgICAgICAgICAgYXNuMWpzLklBNVN0cmluZy5ibG9ja05hbWUoKSxcbiAgICAgICAgICAgIGFzbjFqcy5HcmFwaGljU3RyaW5nLmJsb2NrTmFtZSgpLFxuICAgICAgICAgICAgYXNuMWpzLlZpc2libGVTdHJpbmcuYmxvY2tOYW1lKCksXG4gICAgICAgICAgICBhc24xanMuR2VuZXJhbFN0cmluZy5ibG9ja05hbWUoKSxcbiAgICAgICAgICAgIGFzbjFqcy5DaGFyYWN0ZXJTdHJpbmcuYmxvY2tOYW1lKClcbiAgICAgICAgXTtcbiAgICAgICAgaWYgKGNvbXBhcmVUbyBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgICAgICAgICByZXR1cm4gcHZ0c3V0aWxzLkJ1ZmZlclNvdXJjZUNvbnZlcnRlci5pc0VxdWFsKHRoaXMudmFsdWUudmFsdWVCZWZvcmVEZWNvZGVWaWV3LCBjb21wYXJlVG8pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb21wYXJlVG8uY29uc3RydWN0b3IuYmxvY2tOYW1lKCkgPT09IEF0dHJpYnV0ZVR5cGVBbmRWYWx1ZS5ibG9ja05hbWUoKSkge1xuICAgICAgICAgICAgaWYgKHRoaXMudHlwZSAhPT0gY29tcGFyZVRvLnR5cGUpXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgY29uc3QgaXNTdHJpbmdQYWlyID0gW2ZhbHNlLCBmYWxzZV07XG4gICAgICAgICAgICBjb25zdCB0aGlzTmFtZSA9IHRoaXMudmFsdWUuY29uc3RydWN0b3IuYmxvY2tOYW1lKCk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG5hbWUgb2Ygc3RyaW5nQmxvY2tOYW1lcykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzTmFtZSA9PT0gbmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBpc1N0cmluZ1BhaXJbMF0gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoY29tcGFyZVRvLnZhbHVlLmNvbnN0cnVjdG9yLmJsb2NrTmFtZSgpID09PSBuYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzU3RyaW5nUGFpclsxXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlzU3RyaW5nUGFpclswXSAhPT0gaXNTdHJpbmdQYWlyWzFdKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgaXNTdHJpbmcgPSAoaXNTdHJpbmdQYWlyWzBdICYmIGlzU3RyaW5nUGFpclsxXSk7XG4gICAgICAgICAgICBpZiAoaXNTdHJpbmcpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZTEgPSBzdHJpbmdQcmVwKHRoaXMudmFsdWUudmFsdWVCbG9jay52YWx1ZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgdmFsdWUyID0gc3RyaW5nUHJlcChjb21wYXJlVG8udmFsdWUudmFsdWVCbG9jay52YWx1ZSk7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlMS5sb2NhbGVDb21wYXJlKHZhbHVlMikgIT09IDApXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICghcHZ0c3V0aWxzLkJ1ZmZlclNvdXJjZUNvbnZlcnRlci5pc0VxdWFsKHRoaXMudmFsdWUudmFsdWVCZWZvcmVEZWNvZGVWaWV3LCBjb21wYXJlVG8udmFsdWUudmFsdWVCZWZvcmVEZWNvZGVWaWV3KSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn1cbkF0dHJpYnV0ZVR5cGVBbmRWYWx1ZS5DTEFTU19OQU1FID0gXCJBdHRyaWJ1dGVUeXBlQW5kVmFsdWVcIjtcblxuY29uc3QgVFlQRV9BTkRfVkFMVUVTID0gXCJ0eXBlc0FuZFZhbHVlc1wiO1xuY29uc3QgVkFMVUVfQkVGT1JFX0RFQ09ERSA9IFwidmFsdWVCZWZvcmVEZWNvZGVcIjtcbmNvbnN0IFJETiA9IFwiUkROXCI7XG5jbGFzcyBSZWxhdGl2ZURpc3Rpbmd1aXNoZWROYW1lcyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudHlwZXNBbmRWYWx1ZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBUWVBFX0FORF9WQUxVRVMsIFJlbGF0aXZlRGlzdGluZ3Vpc2hlZE5hbWVzLmRlZmF1bHRWYWx1ZXMoVFlQRV9BTkRfVkFMVUVTKSk7XG4gICAgICAgIHRoaXMudmFsdWVCZWZvcmVEZWNvZGUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBWQUxVRV9CRUZPUkVfREVDT0RFLCBSZWxhdGl2ZURpc3Rpbmd1aXNoZWROYW1lcy5kZWZhdWx0VmFsdWVzKFZBTFVFX0JFRk9SRV9ERUNPREUpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFRZUEVfQU5EX1ZBTFVFUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBjYXNlIFZBTFVFX0JFRk9SRV9ERUNPREU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX0JVRkZFUjtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVFlQRV9BTkRfVkFMVUVTOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUubGVuZ3RoID09PSAwKTtcbiAgICAgICAgICAgIGNhc2UgVkFMVUVfQkVGT1JFX0RFQ09ERTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmJ5dGVMZW5ndGggPT09IDApO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnJlcGVhdGVkU2VxdWVuY2UgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IG5ldyBhc24xanMuU2V0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5yZXBlYXRlZFNldCB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQXR0cmlidXRlVHlwZUFuZFZhbHVlLnNjaGVtYShuYW1lcy50eXBlQW5kVmFsdWUgfHwge30pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIFtcbiAgICAgICAgICAgIFJETixcbiAgICAgICAgICAgIFRZUEVfQU5EX1ZBTFVFU1xuICAgICAgICBdKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBSZWxhdGl2ZURpc3Rpbmd1aXNoZWROYW1lcy5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBibG9ja05hbWU6IFJETixcbiAgICAgICAgICAgICAgICByZXBlYXRlZFNldDogVFlQRV9BTkRfVkFMVUVTXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgaWYgKFRZUEVfQU5EX1ZBTFVFUyBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy50eXBlc0FuZFZhbHVlcyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHQudHlwZXNBbmRWYWx1ZXMsIGVsZW1lbnQgPT4gbmV3IEF0dHJpYnV0ZVR5cGVBbmRWYWx1ZSh7IHNjaGVtYTogZWxlbWVudCB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy52YWx1ZUJlZm9yZURlY29kZSA9IGFzbjEucmVzdWx0LlJETi52YWx1ZUJlZm9yZURlY29kZVZpZXcuc2xpY2UoKS5idWZmZXI7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBpZiAodGhpcy52YWx1ZUJlZm9yZURlY29kZS5ieXRlTGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgICAgIHZhbHVlOiBbbmV3IGFzbjFqcy5TZXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy50eXBlc0FuZFZhbHVlcywgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgICAgICAgICAgICAgIH0pXVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuZnJvbUJFUih0aGlzLnZhbHVlQmVmb3JlRGVjb2RlKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0KGFzbjEsIFwiUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZXNcIik7XG4gICAgICAgIGlmICghKGFzbjEucmVzdWx0IGluc3RhbmNlb2YgYXNuMWpzLlNlcXVlbmNlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQVNOLjEgcmVzdWx0IHNob3VsZCBiZSBTRVFVRU5DRVwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXNuMS5yZXN1bHQ7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGVzQW5kVmFsdWVzOiBBcnJheS5mcm9tKHRoaXMudHlwZXNBbmRWYWx1ZXMsIG8gPT4gby50b0pTT04oKSlcbiAgICAgICAgfTtcbiAgICB9XG4gICAgaXNFcXVhbChjb21wYXJlVG8pIHtcbiAgICAgICAgaWYgKGNvbXBhcmVUbyBpbnN0YW5jZW9mIFJlbGF0aXZlRGlzdGluZ3Vpc2hlZE5hbWVzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy50eXBlc0FuZFZhbHVlcy5sZW5ndGggIT09IGNvbXBhcmVUby50eXBlc0FuZFZhbHVlcy5sZW5ndGgpXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgZm9yIChjb25zdCBbaW5kZXgsIHR5cGVBbmRWYWx1ZV0gb2YgdGhpcy50eXBlc0FuZFZhbHVlcy5lbnRyaWVzKCkpIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZUFuZFZhbHVlLmlzRXF1YWwoY29tcGFyZVRvLnR5cGVzQW5kVmFsdWVzW2luZGV4XSkgPT09IGZhbHNlKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29tcGFyZVRvIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBwdnV0aWxzLmlzRXF1YWxCdWZmZXIodGhpcy52YWx1ZUJlZm9yZURlY29kZSwgY29tcGFyZVRvKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZXMuQ0xBU1NfTkFNRSA9IFwiUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZXNcIjtcblxuY29uc3QgVFlQRSQ0ID0gXCJ0eXBlXCI7XG5jb25zdCBWQUxVRSQ1ID0gXCJ2YWx1ZVwiO1xuZnVuY3Rpb24gYnVpbHRJblN0YW5kYXJkQXR0cmlidXRlcyhwYXJhbWV0ZXJzID0ge30sIG9wdGlvbmFsID0gZmFsc2UpIHtcbiAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgIG9wdGlvbmFsLFxuICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMixcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuY291bnRyeV9uYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5DaG9pY2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk51bWVyaWNTdHJpbmcoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlByaW50YWJsZVN0cmluZygpXG4gICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAyLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5hZG1pbmlzdHJhdGlvbl9kb21haW5fbmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ2hvaWNlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5OdW1lcmljU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmludGFibGVTdHJpbmcoKVxuICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLm5ldHdvcmtfYWRkcmVzcyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgIGlzSGV4T25seTogdHJ1ZVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMudGVybWluYWxfaWRlbnRpZmllciB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgIGlzSGV4T25seTogdHJ1ZVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5wcml2YXRlX2RvbWFpbl9uYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5DaG9pY2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk51bWVyaWNTdHJpbmcoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlByaW50YWJsZVN0cmluZygpXG4gICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAzXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMub3JnYW5pemF0aW9uX25hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICBpc0hleE9ubHk6IHRydWVcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5udW1lcmljX3VzZXJfaWRlbnRpZmllciB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogNFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgaXNIZXhPbmx5OiB0cnVlXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5wZXJzb25hbF9uYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiA1XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgaXNIZXhPbmx5OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0hleE9ubHk6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzSGV4T25seTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAzXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgaXNIZXhPbmx5OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMub3JnYW5pemF0aW9uYWxfdW5pdF9uYW1lcyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogNlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogbmV3IGFzbjFqcy5QcmludGFibGVTdHJpbmcoKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIF1cbiAgICB9KSk7XG59XG5mdW5jdGlvbiBidWlsdEluRG9tYWluRGVmaW5lZEF0dHJpYnV0ZXMob3B0aW9uYWwgPSBmYWxzZSkge1xuICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgIG9wdGlvbmFsLFxuICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmludGFibGVTdHJpbmcoKSxcbiAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbnRhYmxlU3RyaW5nKClcbiAgICAgICAgXVxuICAgIH0pKTtcbn1cbmZ1bmN0aW9uIGV4dGVuc2lvbkF0dHJpYnV0ZXMob3B0aW9uYWwgPSBmYWxzZSkge1xuICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXQoe1xuICAgICAgICBvcHRpb25hbCxcbiAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGlzSGV4T25seTogdHJ1ZVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBbbmV3IGFzbjFqcy5BbnkoKV1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIF1cbiAgICB9KSk7XG59XG5jbGFzcyBHZW5lcmFsTmFtZSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudHlwZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFRZUEUkNCwgR2VuZXJhbE5hbWUuZGVmYXVsdFZhbHVlcyhUWVBFJDQpKTtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZBTFVFJDUsIEdlbmVyYWxOYW1lLmRlZmF1bHRWYWx1ZXMoVkFMVUUkNSkpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVFlQRSQ0OlxuICAgICAgICAgICAgICAgIHJldHVybiA5O1xuICAgICAgICAgICAgY2FzZSBWQUxVRSQ1OlxuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVFlQRSQ0OlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgPT09IEdlbmVyYWxOYW1lLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkpO1xuICAgICAgICAgICAgY2FzZSBWQUxVRSQ1OlxuICAgICAgICAgICAgICAgIHJldHVybiAoT2JqZWN0LmtleXMobWVtYmVyVmFsdWUpLmxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5DaG9pY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbbmV3IGFzbjFqcy5BbnkoKV1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAzXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWx0SW5TdGFuZGFyZEF0dHJpYnV0ZXMoKG5hbWVzLmJ1aWx0SW5TdGFuZGFyZEF0dHJpYnV0ZXMgfHwge30pLCBmYWxzZSksXG4gICAgICAgICAgICAgICAgICAgICAgICBidWlsdEluRG9tYWluRGVmaW5lZEF0dHJpYnV0ZXModHJ1ZSksXG4gICAgICAgICAgICAgICAgICAgICAgICBleHRlbnNpb25BdHRyaWJ1dGVzKHRydWUpXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDRcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1JlbGF0aXZlRGlzdGluZ3Vpc2hlZE5hbWVzLnNjaGVtYShuYW1lcy5kaXJlY3RvcnlOYW1lIHx8IHt9KV1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDVcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNob2ljZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuVGVsZXRleFN0cmluZygpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbnRhYmxlU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Vbml2ZXJzYWxTdHJpbmcoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlV0ZjhTdHJpbmcoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkJtcFN0cmluZygpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ2hvaWNlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5UZWxldGV4U3RyaW5nKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmludGFibGVTdHJpbmcoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlVuaXZlcnNhbFN0cmluZygpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuVXRmOFN0cmluZygpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQm1wU3RyaW5nKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiA2XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDdcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogOFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBbXG4gICAgICAgICAgICBcImJsb2NrTmFtZVwiLFxuICAgICAgICAgICAgXCJvdGhlck5hbWVcIixcbiAgICAgICAgICAgIFwicmZjODIyTmFtZVwiLFxuICAgICAgICAgICAgXCJkTlNOYW1lXCIsXG4gICAgICAgICAgICBcIng0MDBBZGRyZXNzXCIsXG4gICAgICAgICAgICBcImRpcmVjdG9yeU5hbWVcIixcbiAgICAgICAgICAgIFwiZWRpUGFydHlOYW1lXCIsXG4gICAgICAgICAgICBcInVuaWZvcm1SZXNvdXJjZUlkZW50aWZpZXJcIixcbiAgICAgICAgICAgIFwiaVBBZGRyZXNzXCIsXG4gICAgICAgICAgICBcInJlZ2lzdGVyZWRJRFwiXG4gICAgICAgIF0pO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIEdlbmVyYWxOYW1lLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogXCJibG9ja05hbWVcIixcbiAgICAgICAgICAgICAgICBvdGhlck5hbWU6IFwib3RoZXJOYW1lXCIsXG4gICAgICAgICAgICAgICAgcmZjODIyTmFtZTogXCJyZmM4MjJOYW1lXCIsXG4gICAgICAgICAgICAgICAgZE5TTmFtZTogXCJkTlNOYW1lXCIsXG4gICAgICAgICAgICAgICAgeDQwMEFkZHJlc3M6IFwieDQwMEFkZHJlc3NcIixcbiAgICAgICAgICAgICAgICBkaXJlY3RvcnlOYW1lOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFwiZGlyZWN0b3J5TmFtZVwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVkaVBhcnR5TmFtZTogXCJlZGlQYXJ0eU5hbWVcIixcbiAgICAgICAgICAgICAgICB1bmlmb3JtUmVzb3VyY2VJZGVudGlmaWVyOiBcInVuaWZvcm1SZXNvdXJjZUlkZW50aWZpZXJcIixcbiAgICAgICAgICAgICAgICBpUEFkZHJlc3M6IFwiaVBBZGRyZXNzXCIsXG4gICAgICAgICAgICAgICAgcmVnaXN0ZXJlZElEOiBcInJlZ2lzdGVyZWRJRFwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy50eXBlID0gYXNuMS5yZXN1bHQuYmxvY2tOYW1lLmlkQmxvY2sudGFnTnVtYmVyO1xuICAgICAgICBzd2l0Y2ggKHRoaXMudHlwZSkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSBhc24xLnJlc3VsdC5ibG9ja05hbWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGFzbjEucmVzdWx0LmJsb2NrTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUuaWRCbG9jay50YWdDbGFzcyA9IDE7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlLmlkQmxvY2sudGFnTnVtYmVyID0gMjI7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlQkVSID0gdmFsdWUudG9CRVIoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBhc25WYWx1ZSA9IGFzbjFqcy5mcm9tQkVSKHZhbHVlQkVSKTtcbiAgICAgICAgICAgICAgICAgICAgQXNuRXJyb3IuYXNzZXJ0KGFzblZhbHVlLCBcIkdlbmVyYWxOYW1lIHZhbHVlXCIpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gYXNuVmFsdWUucmVzdWx0LnZhbHVlQmxvY2sudmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSBhc24xLnJlc3VsdC5ibG9ja05hbWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IG5ldyBSZWxhdGl2ZURpc3Rpbmd1aXNoZWROYW1lcyh7IHNjaGVtYTogYXNuMS5yZXN1bHQuZGlyZWN0b3J5TmFtZSB9KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gYXNuMS5yZXN1bHQuZWRpUGFydHlOYW1lO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgdmFsdWVIZXg6IGFzbjEucmVzdWx0LmJsb2NrTmFtZS52YWx1ZUJsb2NrLnZhbHVlSGV4IH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBhc24xLnJlc3VsdC5ibG9ja05hbWU7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlLmlkQmxvY2sudGFnQ2xhc3MgPSAxO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZS5pZEJsb2NrLnRhZ051bWJlciA9IDY7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlQkVSID0gdmFsdWUudG9CRVIoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBhc25WYWx1ZSA9IGFzbjFqcy5mcm9tQkVSKHZhbHVlQkVSKTtcbiAgICAgICAgICAgICAgICAgICAgQXNuRXJyb3IuYXNzZXJ0KGFzblZhbHVlLCBcIkdlbmVyYWxOYW1lIHJlZ2lzdGVyZWRJRFwiKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IGFzblZhbHVlLnJlc3VsdC52YWx1ZUJsb2NrLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBzd2l0Y2ggKHRoaXMudHlwZSkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IHRoaXMudHlwZVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IG5ldyBhc24xanMuSUE1U3RyaW5nKHsgdmFsdWU6IHRoaXMudmFsdWUgfSk7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlLmlkQmxvY2sudGFnQ2xhc3MgPSAzO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZS5pZEJsb2NrLnRhZ051bWJlciA9IHRoaXMudHlwZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiA0XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbdGhpcy52YWx1ZS50b1NjaGVtYSgpXVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZS5pZEJsb2NrLnRhZ0NsYXNzID0gMztcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUuaWRCbG9jay50YWdOdW1iZXIgPSB0aGlzLnR5cGU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLnZhbHVlIH0pO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZS5pZEJsb2NrLnRhZ0NsYXNzID0gMztcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUuaWRCbG9jay50YWdOdW1iZXIgPSB0aGlzLnR5cGU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBHZW5lcmFsTmFtZS5zY2hlbWEoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IF9vYmplY3QgPSB7XG4gICAgICAgICAgICB0eXBlOiB0aGlzLnR5cGUsXG4gICAgICAgICAgICB2YWx1ZTogRU1QVFlfU1RSSU5HXG4gICAgICAgIH07XG4gICAgICAgIGlmICgodHlwZW9mIHRoaXMudmFsdWUpID09PSBcInN0cmluZ1wiKVxuICAgICAgICAgICAgX29iamVjdC52YWx1ZSA9IHRoaXMudmFsdWU7XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBfb2JqZWN0LnZhbHVlID0gdGhpcy52YWx1ZS50b0pTT04oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIHtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX29iamVjdDtcbiAgICB9XG59XG5HZW5lcmFsTmFtZS5DTEFTU19OQU1FID0gXCJHZW5lcmFsTmFtZVwiO1xuXG5jb25zdCBBQ0NFU1NfTUVUSE9EID0gXCJhY2Nlc3NNZXRob2RcIjtcbmNvbnN0IEFDQ0VTU19MT0NBVElPTiA9IFwiYWNjZXNzTG9jYXRpb25cIjtcbmNvbnN0IENMRUFSX1BST1BTJDF2ID0gW1xuICAgIEFDQ0VTU19NRVRIT0QsXG4gICAgQUNDRVNTX0xPQ0FUSU9OLFxuXTtcbmNsYXNzIEFjY2Vzc0Rlc2NyaXB0aW9uIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5hY2Nlc3NNZXRob2QgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBBQ0NFU1NfTUVUSE9ELCBBY2Nlc3NEZXNjcmlwdGlvbi5kZWZhdWx0VmFsdWVzKEFDQ0VTU19NRVRIT0QpKTtcbiAgICAgICAgdGhpcy5hY2Nlc3NMb2NhdGlvbiA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEFDQ0VTU19MT0NBVElPTiwgQWNjZXNzRGVzY3JpcHRpb24uZGVmYXVsdFZhbHVlcyhBQ0NFU1NfTE9DQVRJT04pKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIEFDQ0VTU19NRVRIT0Q6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX1NUUklORztcbiAgICAgICAgICAgIGNhc2UgQUNDRVNTX0xPQ0FUSU9OOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgR2VuZXJhbE5hbWUoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgbmFtZTogKG5hbWVzLmFjY2Vzc01ldGhvZCB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIEdlbmVyYWxOYW1lLnNjaGVtYShuYW1lcy5hY2Nlc3NMb2NhdGlvbiB8fCB7fSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQxdik7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgQWNjZXNzRGVzY3JpcHRpb24uc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgYWNjZXNzTWV0aG9kOiBBQ0NFU1NfTUVUSE9ELFxuICAgICAgICAgICAgICAgIGFjY2Vzc0xvY2F0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IEFDQ0VTU19MT0NBVElPTlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuYWNjZXNzTWV0aG9kID0gYXNuMS5yZXN1bHQuYWNjZXNzTWV0aG9kLnZhbHVlQmxvY2sudG9TdHJpbmcoKTtcbiAgICAgICAgdGhpcy5hY2Nlc3NMb2NhdGlvbiA9IG5ldyBHZW5lcmFsTmFtZSh7IHNjaGVtYTogYXNuMS5yZXN1bHQuYWNjZXNzTG9jYXRpb24gfSk7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyB2YWx1ZTogdGhpcy5hY2Nlc3NNZXRob2QgfSksXG4gICAgICAgICAgICAgICAgdGhpcy5hY2Nlc3NMb2NhdGlvbi50b1NjaGVtYSgpXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYWNjZXNzTWV0aG9kOiB0aGlzLmFjY2Vzc01ldGhvZCxcbiAgICAgICAgICAgIGFjY2Vzc0xvY2F0aW9uOiB0aGlzLmFjY2Vzc0xvY2F0aW9uLnRvSlNPTigpXG4gICAgICAgIH07XG4gICAgfVxufVxuQWNjZXNzRGVzY3JpcHRpb24uQ0xBU1NfTkFNRSA9IFwiQWNjZXNzRGVzY3JpcHRpb25cIjtcblxuY29uc3QgU0VDT05EUyA9IFwic2Vjb25kc1wiO1xuY29uc3QgTUlMTElTID0gXCJtaWxsaXNcIjtcbmNvbnN0IE1JQ1JPUyA9IFwibWljcm9zXCI7XG5jbGFzcyBBY2N1cmFjeSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIGlmIChTRUNPTkRTIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuc2Vjb25kcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNFQ09ORFMsIEFjY3VyYWN5LmRlZmF1bHRWYWx1ZXMoU0VDT05EUykpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChNSUxMSVMgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5taWxsaXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBNSUxMSVMsIEFjY3VyYWN5LmRlZmF1bHRWYWx1ZXMoTUlMTElTKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE1JQ1JPUyBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLm1pY3JvcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE1JQ1JPUywgQWNjdXJhY3kuZGVmYXVsdFZhbHVlcyhNSUNST1MpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgU0VDT05EUzpcbiAgICAgICAgICAgIGNhc2UgTUlMTElTOlxuICAgICAgICAgICAgY2FzZSBNSUNST1M6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFNFQ09ORFM6XG4gICAgICAgICAgICBjYXNlIE1JTExJUzpcbiAgICAgICAgICAgIGNhc2UgTUlDUk9TOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgPT09IEFjY3VyYWN5LmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuc2Vjb25kcyB8fCBFTVBUWV9TVFJJTkcpXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMubWlsbGlzIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMubWljcm9zIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBbXG4gICAgICAgICAgICBTRUNPTkRTLFxuICAgICAgICAgICAgTUlMTElTLFxuICAgICAgICAgICAgTUlDUk9TLFxuICAgICAgICBdKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBBY2N1cmFjeS5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBzZWNvbmRzOiBTRUNPTkRTLFxuICAgICAgICAgICAgICAgIG1pbGxpczogTUlMTElTLFxuICAgICAgICAgICAgICAgIG1pY3JvczogTUlDUk9TLFxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIGlmIChcInNlY29uZHNcIiBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5zZWNvbmRzID0gYXNuMS5yZXN1bHQuc2Vjb25kcy52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgICAgICB9XG4gICAgICAgIGlmIChcIm1pbGxpc1wiIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICBjb25zdCBpbnRNaWxsaXMgPSBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZUhleDogYXNuMS5yZXN1bHQubWlsbGlzLnZhbHVlQmxvY2sudmFsdWVIZXggfSk7XG4gICAgICAgICAgICB0aGlzLm1pbGxpcyA9IGludE1pbGxpcy52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgICAgICB9XG4gICAgICAgIGlmIChcIm1pY3Jvc1wiIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICBjb25zdCBpbnRNaWNyb3MgPSBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZUhleDogYXNuMS5yZXN1bHQubWljcm9zLnZhbHVlQmxvY2sudmFsdWVIZXggfSk7XG4gICAgICAgICAgICB0aGlzLm1pY3JvcyA9IGludE1pY3Jvcy52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBpZiAodGhpcy5zZWNvbmRzICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlOiB0aGlzLnNlY29uZHMgfSkpO1xuICAgICAgICBpZiAodGhpcy5taWxsaXMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29uc3QgaW50TWlsbGlzID0gbmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWU6IHRoaXMubWlsbGlzIH0pO1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZUhleDogaW50TWlsbGlzLnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubWljcm9zICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IGludE1pY3JvcyA9IG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlOiB0aGlzLm1pY3JvcyB9KTtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWVIZXg6IGludE1pY3Jvcy52YWx1ZUJsb2NrLnZhbHVlSGV4Vmlld1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IF9vYmplY3QgPSB7fTtcbiAgICAgICAgaWYgKHRoaXMuc2Vjb25kcyAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgX29iamVjdC5zZWNvbmRzID0gdGhpcy5zZWNvbmRzO1xuICAgICAgICBpZiAodGhpcy5taWxsaXMgIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIF9vYmplY3QubWlsbGlzID0gdGhpcy5taWxsaXM7XG4gICAgICAgIGlmICh0aGlzLm1pY3JvcyAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgX29iamVjdC5taWNyb3MgPSB0aGlzLm1pY3JvcztcbiAgICAgICAgcmV0dXJuIF9vYmplY3Q7XG4gICAgfVxufVxuQWNjdXJhY3kuQ0xBU1NfTkFNRSA9IFwiQWNjdXJhY3lcIjtcblxuY29uc3QgQUxHT1JJVEhNX0lEID0gXCJhbGdvcml0aG1JZFwiO1xuY29uc3QgQUxHT1JJVEhNX1BBUkFNUyA9IFwiYWxnb3JpdGhtUGFyYW1zXCI7XG5jb25zdCBBTEdPUklUSE0kMiA9IFwiYWxnb3JpdGhtXCI7XG5jb25zdCBQQVJBTVMgPSBcInBhcmFtc1wiO1xuY29uc3QgQ0xFQVJfUFJPUFMkMXUgPSBbXG4gICAgQUxHT1JJVEhNJDIsXG4gICAgUEFSQU1TXG5dO1xuY2xhc3MgQWxnb3JpdGhtSWRlbnRpZmllciBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuYWxnb3JpdGhtSWQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBBTEdPUklUSE1fSUQsIEFsZ29yaXRobUlkZW50aWZpZXIuZGVmYXVsdFZhbHVlcyhBTEdPUklUSE1fSUQpKTtcbiAgICAgICAgaWYgKEFMR09SSVRITV9QQVJBTVMgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5hbGdvcml0aG1QYXJhbXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBBTEdPUklUSE1fUEFSQU1TLCBBbGdvcml0aG1JZGVudGlmaWVyLmRlZmF1bHRWYWx1ZXMoQUxHT1JJVEhNX1BBUkFNUykpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBBTEdPUklUSE1fSUQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX1NUUklORztcbiAgICAgICAgICAgIGNhc2UgQUxHT1JJVEhNX1BBUkFNUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5BbnkoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgQUxHT1JJVEhNX0lEOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgPT09IEVNUFRZX1NUUklORyk7XG4gICAgICAgICAgICBjYXNlIEFMR09SSVRITV9QQVJBTVM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSBpbnN0YW5jZW9mIGFzbjFqcy5BbnkpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgb3B0aW9uYWw6IChuYW1lcy5vcHRpb25hbCB8fCBmYWxzZSksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IG5hbWU6IChuYW1lcy5hbGdvcml0aG1JZGVudGlmaWVyIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5BbnkoeyBuYW1lOiAobmFtZXMuYWxnb3JpdGhtUGFyYW1zIHx8IEVNUFRZX1NUUklORyksIG9wdGlvbmFsOiB0cnVlIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkMXUpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIEFsZ29yaXRobUlkZW50aWZpZXIuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgYWxnb3JpdGhtSWRlbnRpZmllcjogQUxHT1JJVEhNJDIsXG4gICAgICAgICAgICAgICAgYWxnb3JpdGhtUGFyYW1zOiBQQVJBTVNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmFsZ29yaXRobUlkID0gYXNuMS5yZXN1bHQuYWxnb3JpdGhtLnZhbHVlQmxvY2sudG9TdHJpbmcoKTtcbiAgICAgICAgaWYgKFBBUkFNUyBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5hbGdvcml0aG1QYXJhbXMgPSBhc24xLnJlc3VsdC5wYXJhbXM7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgdmFsdWU6IHRoaXMuYWxnb3JpdGhtSWQgfSkpO1xuICAgICAgICBpZiAodGhpcy5hbGdvcml0aG1QYXJhbXMgJiYgISh0aGlzLmFsZ29yaXRobVBhcmFtcyBpbnN0YW5jZW9mIGFzbjFqcy5BbnkpKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMuYWxnb3JpdGhtUGFyYW1zKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCBvYmplY3QgPSB7XG4gICAgICAgICAgICBhbGdvcml0aG1JZDogdGhpcy5hbGdvcml0aG1JZFxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5hbGdvcml0aG1QYXJhbXMgJiYgISh0aGlzLmFsZ29yaXRobVBhcmFtcyBpbnN0YW5jZW9mIGFzbjFqcy5BbnkpKSB7XG4gICAgICAgICAgICBvYmplY3QuYWxnb3JpdGhtUGFyYW1zID0gdGhpcy5hbGdvcml0aG1QYXJhbXMudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9iamVjdDtcbiAgICB9XG4gICAgaXNFcXVhbChhbGdvcml0aG1JZGVudGlmaWVyKSB7XG4gICAgICAgIGlmICghKGFsZ29yaXRobUlkZW50aWZpZXIgaW5zdGFuY2VvZiBBbGdvcml0aG1JZGVudGlmaWVyKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmFsZ29yaXRobUlkICE9PSBhbGdvcml0aG1JZGVudGlmaWVyLmFsZ29yaXRobUlkKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYWxnb3JpdGhtUGFyYW1zKSB7XG4gICAgICAgICAgICBpZiAoYWxnb3JpdGhtSWRlbnRpZmllci5hbGdvcml0aG1QYXJhbXMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcy5hbGdvcml0aG1QYXJhbXMpID09PSBKU09OLnN0cmluZ2lmeShhbGdvcml0aG1JZGVudGlmaWVyLmFsZ29yaXRobVBhcmFtcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFsZ29yaXRobUlkZW50aWZpZXIuYWxnb3JpdGhtUGFyYW1zKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxufVxuQWxnb3JpdGhtSWRlbnRpZmllci5DTEFTU19OQU1FID0gXCJBbGdvcml0aG1JZGVudGlmaWVyXCI7XG5cbmNvbnN0IEFMVF9OQU1FUyA9IFwiYWx0TmFtZXNcIjtcbmNvbnN0IENMRUFSX1BST1BTJDF0ID0gW1xuICAgIEFMVF9OQU1FU1xuXTtcbmNsYXNzIEFsdE5hbWUgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmFsdE5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQUxUX05BTUVTLCBBbHROYW1lLmRlZmF1bHRWYWx1ZXMoQUxUX05BTUVTKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBBTFRfTkFNRVM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmFsdE5hbWVzIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBHZW5lcmFsTmFtZS5zY2hlbWEoKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkMXQpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIEFsdE5hbWUuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgYWx0TmFtZXM6IEFMVF9OQU1FU1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIGlmIChBTFRfTkFNRVMgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHRoaXMuYWx0TmFtZXMgPSBBcnJheS5mcm9tKGFzbjEucmVzdWx0LmFsdE5hbWVzLCBlbGVtZW50ID0+IG5ldyBHZW5lcmFsTmFtZSh7IHNjaGVtYTogZWxlbWVudCB9KSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLmFsdE5hbWVzLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhbHROYW1lczogQXJyYXkuZnJvbSh0aGlzLmFsdE5hbWVzLCBvID0+IG8udG9KU09OKCkpXG4gICAgICAgIH07XG4gICAgfVxufVxuQWx0TmFtZS5DTEFTU19OQU1FID0gXCJBbHROYW1lXCI7XG5cbmNvbnN0IFRZUEUkMyA9IFwidHlwZVwiO1xuY29uc3QgVkFMVUVTJDEgPSBcInZhbHVlc1wiO1xuY29uc3QgQ0xFQVJfUFJPUFMkMXMgPSBbXG4gICAgVFlQRSQzLFxuICAgIFZBTFVFUyQxXG5dO1xuY2xhc3MgQXR0cmlidXRlIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy50eXBlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVFlQRSQzLCBBdHRyaWJ1dGUuZGVmYXVsdFZhbHVlcyhUWVBFJDMpKTtcbiAgICAgICAgdGhpcy52YWx1ZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBWQUxVRVMkMSwgQXR0cmlidXRlLmRlZmF1bHRWYWx1ZXMoVkFMVUVTJDEpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFRZUEUkMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfU1RSSU5HO1xuICAgICAgICAgICAgY2FzZSBWQUxVRVMkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFRZUEUkMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlID09PSBFTVBUWV9TVFJJTkcpO1xuICAgICAgICAgICAgY2FzZSBWQUxVRVMkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IG5hbWU6IChuYW1lcy50eXBlIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5TZXQoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuc2V0TmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnZhbHVlcyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBuZXcgYXNuMWpzLkFueSgpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQxcyk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgQXR0cmlidXRlLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIHR5cGU6IFRZUEUkMyxcbiAgICAgICAgICAgICAgICB2YWx1ZXM6IFZBTFVFUyQxXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy50eXBlID0gYXNuMS5yZXN1bHQudHlwZS52YWx1ZUJsb2NrLnRvU3RyaW5nKCk7XG4gICAgICAgIHRoaXMudmFsdWVzID0gYXNuMS5yZXN1bHQudmFsdWVzO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgdmFsdWU6IHRoaXMudHlwZSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlNldCh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLnZhbHVlc1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogdGhpcy50eXBlLFxuICAgICAgICAgICAgdmFsdWVzOiBBcnJheS5mcm9tKHRoaXMudmFsdWVzLCBvID0+IG8udG9KU09OKCkpXG4gICAgICAgIH07XG4gICAgfVxufVxuQXR0cmlidXRlLkNMQVNTX05BTUUgPSBcIkF0dHJpYnV0ZVwiO1xuXG5jb25zdCBOT1RfQkVGT1JFX1RJTUUgPSBcIm5vdEJlZm9yZVRpbWVcIjtcbmNvbnN0IE5PVF9BRlRFUl9USU1FID0gXCJub3RBZnRlclRpbWVcIjtcbmNvbnN0IENMRUFSX1BST1BTJDFyID0gW1xuICAgIE5PVF9CRUZPUkVfVElNRSxcbiAgICBOT1RfQUZURVJfVElNRSxcbl07XG5jbGFzcyBBdHRDZXJ0VmFsaWRpdHlQZXJpb2QgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLm5vdEJlZm9yZVRpbWUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBOT1RfQkVGT1JFX1RJTUUsIEF0dENlcnRWYWxpZGl0eVBlcmlvZC5kZWZhdWx0VmFsdWVzKE5PVF9CRUZPUkVfVElNRSkpO1xuICAgICAgICB0aGlzLm5vdEFmdGVyVGltZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE5PVF9BRlRFUl9USU1FLCBBdHRDZXJ0VmFsaWRpdHlQZXJpb2QuZGVmYXVsdFZhbHVlcyhOT1RfQUZURVJfVElNRSkpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgTk9UX0JFRk9SRV9USU1FOlxuICAgICAgICAgICAgY2FzZSBOT1RfQUZURVJfVElNRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoMCwgMCwgMCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuR2VuZXJhbGl6ZWRUaW1lKHsgbmFtZTogKG5hbWVzLm5vdEJlZm9yZVRpbWUgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkdlbmVyYWxpemVkVGltZSh7IG5hbWU6IChuYW1lcy5ub3RBZnRlclRpbWUgfHwgRU1QVFlfU1RSSU5HKSB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDFyKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBBdHRDZXJ0VmFsaWRpdHlQZXJpb2Quc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgbm90QmVmb3JlVGltZTogTk9UX0JFRk9SRV9USU1FLFxuICAgICAgICAgICAgICAgIG5vdEFmdGVyVGltZTogTk9UX0FGVEVSX1RJTUVcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLm5vdEJlZm9yZVRpbWUgPSBhc24xLnJlc3VsdC5ub3RCZWZvcmVUaW1lLnRvRGF0ZSgpO1xuICAgICAgICB0aGlzLm5vdEFmdGVyVGltZSA9IGFzbjEucmVzdWx0Lm5vdEFmdGVyVGltZS50b0RhdGUoKTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuR2VuZXJhbGl6ZWRUaW1lKHsgdmFsdWVEYXRlOiB0aGlzLm5vdEJlZm9yZVRpbWUgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5HZW5lcmFsaXplZFRpbWUoeyB2YWx1ZURhdGU6IHRoaXMubm90QWZ0ZXJUaW1lIH0pLFxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG5vdEJlZm9yZVRpbWU6IHRoaXMubm90QmVmb3JlVGltZSxcbiAgICAgICAgICAgIG5vdEFmdGVyVGltZTogdGhpcy5ub3RBZnRlclRpbWVcbiAgICAgICAgfTtcbiAgICB9XG59XG5BdHRDZXJ0VmFsaWRpdHlQZXJpb2QuQ0xBU1NfTkFNRSA9IFwiQXR0Q2VydFZhbGlkaXR5UGVyaW9kXCI7XG5cbmNvbnN0IE5BTUVTID0gXCJuYW1lc1wiO1xuY29uc3QgR0VORVJBTF9OQU1FUyA9IFwiZ2VuZXJhbE5hbWVzXCI7XG5jbGFzcyBHZW5lcmFsTmFtZXMgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLm5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgTkFNRVMsIEdlbmVyYWxOYW1lcy5kZWZhdWx0VmFsdWVzKE5BTUVTKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBcIm5hbWVzXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSwgb3B0aW9uYWwgPSBmYWxzZSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE5BTUVTLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBvcHRpb25hbCxcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5nZW5lcmFsTmFtZXMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IEdlbmVyYWxOYW1lLnNjaGVtYSgpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBbXG4gICAgICAgICAgICBOQU1FUyxcbiAgICAgICAgICAgIEdFTkVSQUxfTkFNRVNcbiAgICAgICAgXSk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgR2VuZXJhbE5hbWVzLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogTkFNRVMsXG4gICAgICAgICAgICAgICAgZ2VuZXJhbE5hbWVzOiBHRU5FUkFMX05BTUVTXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5uYW1lcyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHQuZ2VuZXJhbE5hbWVzLCBlbGVtZW50ID0+IG5ldyBHZW5lcmFsTmFtZSh7IHNjaGVtYTogZWxlbWVudCB9KSk7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy5uYW1lcywgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbmFtZXM6IEFycmF5LmZyb20odGhpcy5uYW1lcywgbyA9PiBvLnRvSlNPTigpKVxuICAgICAgICB9O1xuICAgIH1cbn1cbkdlbmVyYWxOYW1lcy5DTEFTU19OQU1FID0gXCJHZW5lcmFsTmFtZXNcIjtcblxuY29uc3QgaWRfU3ViamVjdERpcmVjdG9yeUF0dHJpYnV0ZXMgPSBcIjIuNS4yOS45XCI7XG5jb25zdCBpZF9TdWJqZWN0S2V5SWRlbnRpZmllciA9IFwiMi41LjI5LjE0XCI7XG5jb25zdCBpZF9LZXlVc2FnZSA9IFwiMi41LjI5LjE1XCI7XG5jb25zdCBpZF9Qcml2YXRlS2V5VXNhZ2VQZXJpb2QgPSBcIjIuNS4yOS4xNlwiO1xuY29uc3QgaWRfU3ViamVjdEFsdE5hbWUgPSBcIjIuNS4yOS4xN1wiO1xuY29uc3QgaWRfSXNzdWVyQWx0TmFtZSA9IFwiMi41LjI5LjE4XCI7XG5jb25zdCBpZF9CYXNpY0NvbnN0cmFpbnRzID0gXCIyLjUuMjkuMTlcIjtcbmNvbnN0IGlkX0NSTE51bWJlciA9IFwiMi41LjI5LjIwXCI7XG5jb25zdCBpZF9CYXNlQ1JMTnVtYmVyID0gXCIyLjUuMjkuMjdcIjtcbmNvbnN0IGlkX0NSTFJlYXNvbiA9IFwiMi41LjI5LjIxXCI7XG5jb25zdCBpZF9JbnZhbGlkaXR5RGF0ZSA9IFwiMi41LjI5LjI0XCI7XG5jb25zdCBpZF9Jc3N1aW5nRGlzdHJpYnV0aW9uUG9pbnQgPSBcIjIuNS4yOS4yOFwiO1xuY29uc3QgaWRfQ2VydGlmaWNhdGVJc3N1ZXIgPSBcIjIuNS4yOS4yOVwiO1xuY29uc3QgaWRfTmFtZUNvbnN0cmFpbnRzID0gXCIyLjUuMjkuMzBcIjtcbmNvbnN0IGlkX0NSTERpc3RyaWJ1dGlvblBvaW50cyA9IFwiMi41LjI5LjMxXCI7XG5jb25zdCBpZF9GcmVzaGVzdENSTCA9IFwiMi41LjI5LjQ2XCI7XG5jb25zdCBpZF9DZXJ0aWZpY2F0ZVBvbGljaWVzID0gXCIyLjUuMjkuMzJcIjtcbmNvbnN0IGlkX0FueVBvbGljeSA9IFwiMi41LjI5LjMyLjBcIjtcbmNvbnN0IGlkX01pY3Jvc29mdEFwcFBvbGljaWVzID0gXCIxLjMuNi4xLjQuMS4zMTEuMjEuMTBcIjtcbmNvbnN0IGlkX1BvbGljeU1hcHBpbmdzID0gXCIyLjUuMjkuMzNcIjtcbmNvbnN0IGlkX0F1dGhvcml0eUtleUlkZW50aWZpZXIgPSBcIjIuNS4yOS4zNVwiO1xuY29uc3QgaWRfUG9saWN5Q29uc3RyYWludHMgPSBcIjIuNS4yOS4zNlwiO1xuY29uc3QgaWRfRXh0S2V5VXNhZ2UgPSBcIjIuNS4yOS4zN1wiO1xuY29uc3QgaWRfSW5oaWJpdEFueVBvbGljeSA9IFwiMi41LjI5LjU0XCI7XG5jb25zdCBpZF9BdXRob3JpdHlJbmZvQWNjZXNzID0gXCIxLjMuNi4xLjUuNS43LjEuMVwiO1xuY29uc3QgaWRfU3ViamVjdEluZm9BY2Nlc3MgPSBcIjEuMy42LjEuNS41LjcuMS4xMVwiO1xuY29uc3QgaWRfU2lnbmVkQ2VydGlmaWNhdGVUaW1lc3RhbXBMaXN0ID0gXCIxLjMuNi4xLjQuMS4xMTEyOS4yLjQuMlwiO1xuY29uc3QgaWRfTWljcm9zb2Z0Q2VydFRlbXBsYXRlVjEgPSBcIjEuMy42LjEuNC4xLjMxMS4yMC4yXCI7XG5jb25zdCBpZF9NaWNyb3NvZnRQcmV2Q2FDZXJ0SGFzaCA9IFwiMS4zLjYuMS40LjEuMzExLjIxLjJcIjtcbmNvbnN0IGlkX01pY3Jvc29mdENlcnRUZW1wbGF0ZVYyID0gXCIxLjMuNi4xLjQuMS4zMTEuMjEuN1wiO1xuY29uc3QgaWRfTWljcm9zb2Z0Q2FWZXJzaW9uID0gXCIxLjMuNi4xLjQuMS4zMTEuMjEuMVwiO1xuY29uc3QgaWRfUUNTdGF0ZW1lbnRzID0gXCIxLjMuNi4xLjUuNS43LjEuM1wiO1xuY29uc3QgaWRfQ29udGVudFR5cGVfRGF0YSA9IFwiMS4yLjg0MC4xMTM1NDkuMS43LjFcIjtcbmNvbnN0IGlkX0NvbnRlbnRUeXBlX1NpZ25lZERhdGEgPSBcIjEuMi44NDAuMTEzNTQ5LjEuNy4yXCI7XG5jb25zdCBpZF9Db250ZW50VHlwZV9FbnZlbG9wZWREYXRhID0gXCIxLjIuODQwLjExMzU0OS4xLjcuM1wiO1xuY29uc3QgaWRfQ29udGVudFR5cGVfRW5jcnlwdGVkRGF0YSA9IFwiMS4yLjg0MC4xMTM1NDkuMS43LjZcIjtcbmNvbnN0IGlkX2VDb250ZW50VHlwZV9UU1RJbmZvID0gXCIxLjIuODQwLjExMzU0OS4xLjkuMTYuMS40XCI7XG5jb25zdCBpZF9DZXJ0QmFnX1g1MDlDZXJ0aWZpY2F0ZSA9IFwiMS4yLjg0MC4xMTM1NDkuMS45LjIyLjFcIjtcbmNvbnN0IGlkX0NlcnRCYWdfU0RTSUNlcnRpZmljYXRlID0gXCIxLjIuODQwLjExMzU0OS4xLjkuMjIuMlwiO1xuY29uc3QgaWRfQ2VydEJhZ19BdHRyaWJ1dGVDZXJ0aWZpY2F0ZSA9IFwiMS4yLjg0MC4xMTM1NDkuMS45LjIyLjNcIjtcbmNvbnN0IGlkX0NSTEJhZ19YNTA5Q1JMID0gXCIxLjIuODQwLjExMzU0OS4xLjkuMjMuMVwiO1xuY29uc3QgaWRfcGtpeCA9IFwiMS4zLjYuMS41LjUuN1wiO1xuY29uc3QgaWRfYWQgPSBgJHtpZF9wa2l4fS40OGA7XG5jb25zdCBpZF9QS0lYX09DU1BfQmFzaWMgPSBgJHtpZF9hZH0uMS4xYDtcbmNvbnN0IGlkX2FkX2NhSXNzdWVycyA9IGAke2lkX2FkfS4yYDtcbmNvbnN0IGlkX2FkX29jc3AgPSBgJHtpZF9hZH0uMWA7XG5jb25zdCBpZF9zaGExID0gXCIxLjMuMTQuMy4yLjI2XCI7XG5jb25zdCBpZF9zaGEyNTYgPSBcIjIuMTYuODQwLjEuMTAxLjMuNC4yLjFcIjtcbmNvbnN0IGlkX3NoYTM4NCA9IFwiMi4xNi44NDAuMS4xMDEuMy40LjIuMlwiO1xuY29uc3QgaWRfc2hhNTEyID0gXCIyLjE2Ljg0MC4xLjEwMS4zLjQuMi4zXCI7XG5cbmNvbnN0IEtFWV9JREVOVElGSUVSJDEgPSBcImtleUlkZW50aWZpZXJcIjtcbmNvbnN0IEFVVEhPUklUWV9DRVJUX0lTU1VFUiA9IFwiYXV0aG9yaXR5Q2VydElzc3VlclwiO1xuY29uc3QgQVVUSE9SSVRZX0NFUlRfU0VSSUFMX05VTUJFUiA9IFwiYXV0aG9yaXR5Q2VydFNlcmlhbE51bWJlclwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkMXEgPSBbXG4gICAgS0VZX0lERU5USUZJRVIkMSxcbiAgICBBVVRIT1JJVFlfQ0VSVF9JU1NVRVIsXG4gICAgQVVUSE9SSVRZX0NFUlRfU0VSSUFMX05VTUJFUixcbl07XG5jbGFzcyBBdXRob3JpdHlLZXlJZGVudGlmaWVyIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgaWYgKEtFWV9JREVOVElGSUVSJDEgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5rZXlJZGVudGlmaWVyID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgS0VZX0lERU5USUZJRVIkMSwgQXV0aG9yaXR5S2V5SWRlbnRpZmllci5kZWZhdWx0VmFsdWVzKEtFWV9JREVOVElGSUVSJDEpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoQVVUSE9SSVRZX0NFUlRfSVNTVUVSIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuYXV0aG9yaXR5Q2VydElzc3VlciA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEFVVEhPUklUWV9DRVJUX0lTU1VFUiwgQXV0aG9yaXR5S2V5SWRlbnRpZmllci5kZWZhdWx0VmFsdWVzKEFVVEhPUklUWV9DRVJUX0lTU1VFUikpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChBVVRIT1JJVFlfQ0VSVF9TRVJJQUxfTlVNQkVSIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuYXV0aG9yaXR5Q2VydFNlcmlhbE51bWJlciA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEFVVEhPUklUWV9DRVJUX1NFUklBTF9OVU1CRVIsIEF1dGhvcml0eUtleUlkZW50aWZpZXIuZGVmYXVsdFZhbHVlcyhBVVRIT1JJVFlfQ0VSVF9TRVJJQUxfTlVNQkVSKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIEtFWV9JREVOVElGSUVSJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoKTtcbiAgICAgICAgICAgIGNhc2UgQVVUSE9SSVRZX0NFUlRfSVNTVUVSOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGNhc2UgQVVUSE9SSVRZX0NFUlRfU0VSSUFMX05VTUJFUjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5JbnRlZ2VyKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmtleUlkZW50aWZpZXIgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuYXV0aG9yaXR5Q2VydElzc3VlciB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBHZW5lcmFsTmFtZS5zY2hlbWEoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmF1dGhvcml0eUNlcnRTZXJpYWxOdW1iZXIgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAyXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDFxKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBBdXRob3JpdHlLZXlJZGVudGlmaWVyLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGtleUlkZW50aWZpZXI6IEtFWV9JREVOVElGSUVSJDEsXG4gICAgICAgICAgICAgICAgYXV0aG9yaXR5Q2VydElzc3VlcjogQVVUSE9SSVRZX0NFUlRfSVNTVUVSLFxuICAgICAgICAgICAgICAgIGF1dGhvcml0eUNlcnRTZXJpYWxOdW1iZXI6IEFVVEhPUklUWV9DRVJUX1NFUklBTF9OVU1CRVJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICBpZiAoS0VZX0lERU5USUZJRVIkMSBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMua2V5SWRlbnRpZmllciA9IG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyB2YWx1ZUhleDogYXNuMS5yZXN1bHQua2V5SWRlbnRpZmllci52YWx1ZUJsb2NrLnZhbHVlSGV4IH0pO1xuICAgICAgICBpZiAoQVVUSE9SSVRZX0NFUlRfSVNTVUVSIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5hdXRob3JpdHlDZXJ0SXNzdWVyID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdC5hdXRob3JpdHlDZXJ0SXNzdWVyLCBvID0+IG5ldyBHZW5lcmFsTmFtZSh7IHNjaGVtYTogbyB9KSk7XG4gICAgICAgIGlmIChBVVRIT1JJVFlfQ0VSVF9TRVJJQUxfTlVNQkVSIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5hdXRob3JpdHlDZXJ0U2VyaWFsTnVtYmVyID0gbmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWVIZXg6IGFzbjEucmVzdWx0LmF1dGhvcml0eUNlcnRTZXJpYWxOdW1iZXIudmFsdWVCbG9jay52YWx1ZUhleCB9KTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgIGlmICh0aGlzLmtleUlkZW50aWZpZXIpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWVIZXg6IHRoaXMua2V5SWRlbnRpZmllci52YWx1ZUJsb2NrLnZhbHVlSGV4Vmlld1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmF1dGhvcml0eUNlcnRJc3N1ZXIpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLmF1dGhvcml0eUNlcnRJc3N1ZXIsIG8gPT4gby50b1NjaGVtYSgpKVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmF1dGhvcml0eUNlcnRTZXJpYWxOdW1iZXIpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWVIZXg6IHRoaXMuYXV0aG9yaXR5Q2VydFNlcmlhbE51bWJlci52YWx1ZUJsb2NrLnZhbHVlSGV4Vmlld1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IG9iamVjdCA9IHt9O1xuICAgICAgICBpZiAodGhpcy5rZXlJZGVudGlmaWVyKSB7XG4gICAgICAgICAgICBvYmplY3Qua2V5SWRlbnRpZmllciA9IHRoaXMua2V5SWRlbnRpZmllci50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5hdXRob3JpdHlDZXJ0SXNzdWVyKSB7XG4gICAgICAgICAgICBvYmplY3QuYXV0aG9yaXR5Q2VydElzc3VlciA9IEFycmF5LmZyb20odGhpcy5hdXRob3JpdHlDZXJ0SXNzdWVyLCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmF1dGhvcml0eUNlcnRTZXJpYWxOdW1iZXIpIHtcbiAgICAgICAgICAgIG9iamVjdC5hdXRob3JpdHlDZXJ0U2VyaWFsTnVtYmVyID0gdGhpcy5hdXRob3JpdHlDZXJ0U2VyaWFsTnVtYmVyLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvYmplY3Q7XG4gICAgfVxufVxuQXV0aG9yaXR5S2V5SWRlbnRpZmllci5DTEFTU19OQU1FID0gXCJBdXRob3JpdHlLZXlJZGVudGlmaWVyXCI7XG5cbmNvbnN0IFBBVEhfTEVOR1RIX0NPTlNUUkFJTlQgPSBcInBhdGhMZW5Db25zdHJhaW50XCI7XG5jb25zdCBDQSA9IFwiY0FcIjtcbmNsYXNzIEJhc2ljQ29uc3RyYWludHMgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmNBID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQ0EsIGZhbHNlKTtcbiAgICAgICAgaWYgKFBBVEhfTEVOR1RIX0NPTlNUUkFJTlQgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5wYXRoTGVuQ29uc3RyYWludCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFBBVEhfTEVOR1RIX0NPTlNUUkFJTlQsIDApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBDQTpcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQm9vbGVhbih7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuY0EgfHwgRU1QVFlfU1RSSU5HKVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMucGF0aExlbkNvbnN0cmFpbnQgfHwgRU1QVFlfU1RSSU5HKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgW1xuICAgICAgICAgICAgQ0EsXG4gICAgICAgICAgICBQQVRIX0xFTkdUSF9DT05TVFJBSU5UXG4gICAgICAgIF0pO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIEJhc2ljQ29uc3RyYWludHMuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgY0E6IENBLFxuICAgICAgICAgICAgICAgIHBhdGhMZW5Db25zdHJhaW50OiBQQVRIX0xFTkdUSF9DT05TVFJBSU5UXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgaWYgKENBIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLmNBID0gYXNuMS5yZXN1bHQuY0EudmFsdWVCbG9jay52YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoUEFUSF9MRU5HVEhfQ09OU1RSQUlOVCBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgaWYgKGFzbjEucmVzdWx0LnBhdGhMZW5Db25zdHJhaW50LnZhbHVlQmxvY2suaXNIZXhPbmx5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXRoTGVuQ29uc3RyYWludCA9IGFzbjEucmVzdWx0LnBhdGhMZW5Db25zdHJhaW50O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXRoTGVuQ29uc3RyYWludCA9IGFzbjEucmVzdWx0LnBhdGhMZW5Db25zdHJhaW50LnZhbHVlQmxvY2sudmFsdWVEZWM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgIGlmICh0aGlzLmNBICE9PSBCYXNpY0NvbnN0cmFpbnRzLmRlZmF1bHRWYWx1ZXMoQ0EpKVxuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkJvb2xlYW4oeyB2YWx1ZTogdGhpcy5jQSB9KSk7XG4gICAgICAgIGlmIChQQVRIX0xFTkdUSF9DT05TVFJBSU5UIGluIHRoaXMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhdGhMZW5Db25zdHJhaW50IGluc3RhbmNlb2YgYXNuMWpzLkludGVnZXIpIHtcbiAgICAgICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMucGF0aExlbkNvbnN0cmFpbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy5wYXRoTGVuQ29uc3RyYWludCB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3Qgb2JqZWN0ID0ge307XG4gICAgICAgIGlmICh0aGlzLmNBICE9PSBCYXNpY0NvbnN0cmFpbnRzLmRlZmF1bHRWYWx1ZXMoQ0EpKSB7XG4gICAgICAgICAgICBvYmplY3QuY0EgPSB0aGlzLmNBO1xuICAgICAgICB9XG4gICAgICAgIGlmIChQQVRIX0xFTkdUSF9DT05TVFJBSU5UIGluIHRoaXMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhdGhMZW5Db25zdHJhaW50IGluc3RhbmNlb2YgYXNuMWpzLkludGVnZXIpIHtcbiAgICAgICAgICAgICAgICBvYmplY3QucGF0aExlbkNvbnN0cmFpbnQgPSB0aGlzLnBhdGhMZW5Db25zdHJhaW50LnRvSlNPTigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb2JqZWN0LnBhdGhMZW5Db25zdHJhaW50ID0gdGhpcy5wYXRoTGVuQ29uc3RyYWludDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb2JqZWN0O1xuICAgIH1cbn1cbkJhc2ljQ29uc3RyYWludHMuQ0xBU1NfTkFNRSA9IFwiQmFzaWNDb25zdHJhaW50c1wiO1xuXG5jb25zdCBDRVJUSUZJQ0FURV9JTkRFWCA9IFwiY2VydGlmaWNhdGVJbmRleFwiO1xuY29uc3QgS0VZX0lOREVYID0gXCJrZXlJbmRleFwiO1xuY2xhc3MgQ0FWZXJzaW9uIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5jZXJ0aWZpY2F0ZUluZGV4ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQ0VSVElGSUNBVEVfSU5ERVgsIENBVmVyc2lvbi5kZWZhdWx0VmFsdWVzKENFUlRJRklDQVRFX0lOREVYKSk7XG4gICAgICAgIHRoaXMua2V5SW5kZXggPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBLRVlfSU5ERVgsIENBVmVyc2lvbi5kZWZhdWx0VmFsdWVzKEtFWV9JTkRFWCkpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgQ0VSVElGSUNBVEVfSU5ERVg6XG4gICAgICAgICAgICBjYXNlIEtFWV9JTkRFWDpcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLkludGVnZXIoKSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIGlmIChzY2hlbWEuY29uc3RydWN0b3IuYmxvY2tOYW1lKCkgIT09IGFzbjFqcy5JbnRlZ2VyLmJsb2NrTmFtZSgpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJPYmplY3QncyBzY2hlbWEgd2FzIG5vdCB2ZXJpZmllZCBhZ2FpbnN0IGlucHV0IGRhdGEgZm9yIENBVmVyc2lvblwiKTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgdmFsdWUgPSBzY2hlbWEudmFsdWVCbG9jay52YWx1ZUhleC5zbGljZSgwKTtcbiAgICAgICAgY29uc3QgdmFsdWVWaWV3ID0gbmV3IFVpbnQ4QXJyYXkodmFsdWUpO1xuICAgICAgICBzd2l0Y2ggKHRydWUpIHtcbiAgICAgICAgICAgIGNhc2UgKHZhbHVlLmJ5dGVMZW5ndGggPCA0KTpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRlbXBWYWx1ZSA9IG5ldyBBcnJheUJ1ZmZlcig0KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGVtcFZhbHVlVmlldyA9IG5ldyBVaW50OEFycmF5KHRlbXBWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBWYWx1ZVZpZXcuc2V0KHZhbHVlVmlldywgNCAtIHZhbHVlLmJ5dGVMZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHRlbXBWYWx1ZS5zbGljZSgwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICh2YWx1ZS5ieXRlTGVuZ3RoID4gNCk6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZW1wVmFsdWUgPSBuZXcgQXJyYXlCdWZmZXIoNCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRlbXBWYWx1ZVZpZXcgPSBuZXcgVWludDhBcnJheSh0ZW1wVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB0ZW1wVmFsdWVWaWV3LnNldCh2YWx1ZVZpZXcuc2xpY2UoMCwgNCkpO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHRlbXBWYWx1ZS5zbGljZSgwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qga2V5SW5kZXhCdWZmZXIgPSB2YWx1ZS5zbGljZSgwLCAyKTtcbiAgICAgICAgY29uc3Qga2V5SW5kZXhWaWV3OCA9IG5ldyBVaW50OEFycmF5KGtleUluZGV4QnVmZmVyKTtcbiAgICAgICAgbGV0IHRlbXAgPSBrZXlJbmRleFZpZXc4WzBdO1xuICAgICAgICBrZXlJbmRleFZpZXc4WzBdID0ga2V5SW5kZXhWaWV3OFsxXTtcbiAgICAgICAga2V5SW5kZXhWaWV3OFsxXSA9IHRlbXA7XG4gICAgICAgIGNvbnN0IGtleUluZGV4VmlldzE2ID0gbmV3IFVpbnQxNkFycmF5KGtleUluZGV4QnVmZmVyKTtcbiAgICAgICAgdGhpcy5rZXlJbmRleCA9IGtleUluZGV4VmlldzE2WzBdO1xuICAgICAgICBjb25zdCBjZXJ0aWZpY2F0ZUluZGV4QnVmZmVyID0gdmFsdWUuc2xpY2UoMik7XG4gICAgICAgIGNvbnN0IGNlcnRpZmljYXRlSW5kZXhWaWV3OCA9IG5ldyBVaW50OEFycmF5KGNlcnRpZmljYXRlSW5kZXhCdWZmZXIpO1xuICAgICAgICB0ZW1wID0gY2VydGlmaWNhdGVJbmRleFZpZXc4WzBdO1xuICAgICAgICBjZXJ0aWZpY2F0ZUluZGV4VmlldzhbMF0gPSBjZXJ0aWZpY2F0ZUluZGV4VmlldzhbMV07XG4gICAgICAgIGNlcnRpZmljYXRlSW5kZXhWaWV3OFsxXSA9IHRlbXA7XG4gICAgICAgIGNvbnN0IGNlcnRpZmljYXRlSW5kZXhWaWV3MTYgPSBuZXcgVWludDE2QXJyYXkoY2VydGlmaWNhdGVJbmRleEJ1ZmZlcik7XG4gICAgICAgIHRoaXMuY2VydGlmaWNhdGVJbmRleCA9IGNlcnRpZmljYXRlSW5kZXhWaWV3MTZbMF07XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBjZXJ0aWZpY2F0ZUluZGV4QnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKDIpO1xuICAgICAgICBjb25zdCBjZXJ0aWZpY2F0ZUluZGV4VmlldyA9IG5ldyBVaW50MTZBcnJheShjZXJ0aWZpY2F0ZUluZGV4QnVmZmVyKTtcbiAgICAgICAgY2VydGlmaWNhdGVJbmRleFZpZXdbMF0gPSB0aGlzLmNlcnRpZmljYXRlSW5kZXg7XG4gICAgICAgIGNvbnN0IGNlcnRpZmljYXRlSW5kZXhWaWV3OCA9IG5ldyBVaW50OEFycmF5KGNlcnRpZmljYXRlSW5kZXhCdWZmZXIpO1xuICAgICAgICBsZXQgdGVtcCA9IGNlcnRpZmljYXRlSW5kZXhWaWV3OFswXTtcbiAgICAgICAgY2VydGlmaWNhdGVJbmRleFZpZXc4WzBdID0gY2VydGlmaWNhdGVJbmRleFZpZXc4WzFdO1xuICAgICAgICBjZXJ0aWZpY2F0ZUluZGV4VmlldzhbMV0gPSB0ZW1wO1xuICAgICAgICBjb25zdCBrZXlJbmRleEJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcigyKTtcbiAgICAgICAgY29uc3Qga2V5SW5kZXhWaWV3ID0gbmV3IFVpbnQxNkFycmF5KGtleUluZGV4QnVmZmVyKTtcbiAgICAgICAga2V5SW5kZXhWaWV3WzBdID0gdGhpcy5rZXlJbmRleDtcbiAgICAgICAgY29uc3Qga2V5SW5kZXhWaWV3OCA9IG5ldyBVaW50OEFycmF5KGtleUluZGV4QnVmZmVyKTtcbiAgICAgICAgdGVtcCA9IGtleUluZGV4VmlldzhbMF07XG4gICAgICAgIGtleUluZGV4VmlldzhbMF0gPSBrZXlJbmRleFZpZXc4WzFdO1xuICAgICAgICBrZXlJbmRleFZpZXc4WzFdID0gdGVtcDtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLkludGVnZXIoe1xuICAgICAgICAgICAgdmFsdWVIZXg6IHB2dXRpbHMudXRpbENvbmNhdEJ1ZihrZXlJbmRleEJ1ZmZlciwgY2VydGlmaWNhdGVJbmRleEJ1ZmZlcilcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjZXJ0aWZpY2F0ZUluZGV4OiB0aGlzLmNlcnRpZmljYXRlSW5kZXgsXG4gICAgICAgICAgICBrZXlJbmRleDogdGhpcy5rZXlJbmRleFxuICAgICAgICB9O1xuICAgIH1cbn1cbkNBVmVyc2lvbi5DTEFTU19OQU1FID0gXCJDQVZlcnNpb25cIjtcblxuY29uc3QgUE9MSUNZX1FVQUxJRklFUl9JRCA9IFwicG9saWN5UXVhbGlmaWVySWRcIjtcbmNvbnN0IFFVQUxJRklFUiA9IFwicXVhbGlmaWVyXCI7XG5jb25zdCBDTEVBUl9QUk9QUyQxcCA9IFtcbiAgICBQT0xJQ1lfUVVBTElGSUVSX0lELFxuICAgIFFVQUxJRklFUlxuXTtcbmNsYXNzIFBvbGljeVF1YWxpZmllckluZm8gZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnBvbGljeVF1YWxpZmllcklkID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUE9MSUNZX1FVQUxJRklFUl9JRCwgUG9saWN5UXVhbGlmaWVySW5mby5kZWZhdWx0VmFsdWVzKFBPTElDWV9RVUFMSUZJRVJfSUQpKTtcbiAgICAgICAgdGhpcy5xdWFsaWZpZXIgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBRVUFMSUZJRVIsIFBvbGljeVF1YWxpZmllckluZm8uZGVmYXVsdFZhbHVlcyhRVUFMSUZJRVIpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFBPTElDWV9RVUFMSUZJRVJfSUQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX1NUUklORztcbiAgICAgICAgICAgIGNhc2UgUVVBTElGSUVSOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkFueSgpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyBuYW1lOiAobmFtZXMucG9saWN5UXVhbGlmaWVySWQgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkFueSh7IG5hbWU6IChuYW1lcy5xdWFsaWZpZXIgfHwgRU1QVFlfU1RSSU5HKSB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDFwKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBQb2xpY3lRdWFsaWZpZXJJbmZvLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIHBvbGljeVF1YWxpZmllcklkOiBQT0xJQ1lfUVVBTElGSUVSX0lELFxuICAgICAgICAgICAgICAgIHF1YWxpZmllcjogUVVBTElGSUVSXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5wb2xpY3lRdWFsaWZpZXJJZCA9IGFzbjEucmVzdWx0LnBvbGljeVF1YWxpZmllcklkLnZhbHVlQmxvY2sudG9TdHJpbmcoKTtcbiAgICAgICAgdGhpcy5xdWFsaWZpZXIgPSBhc24xLnJlc3VsdC5xdWFsaWZpZXI7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyB2YWx1ZTogdGhpcy5wb2xpY3lRdWFsaWZpZXJJZCB9KSxcbiAgICAgICAgICAgICAgICB0aGlzLnF1YWxpZmllclxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHBvbGljeVF1YWxpZmllcklkOiB0aGlzLnBvbGljeVF1YWxpZmllcklkLFxuICAgICAgICAgICAgcXVhbGlmaWVyOiB0aGlzLnF1YWxpZmllci50b0pTT04oKVxuICAgICAgICB9O1xuICAgIH1cbn1cblBvbGljeVF1YWxpZmllckluZm8uQ0xBU1NfTkFNRSA9IFwiUG9saWN5UXVhbGlmaWVySW5mb1wiO1xuXG5jb25zdCBQT0xJQ1lfSURFTlRJRklFUiA9IFwicG9saWN5SWRlbnRpZmllclwiO1xuY29uc3QgUE9MSUNZX1FVQUxJRklFUlMgPSBcInBvbGljeVF1YWxpZmllcnNcIjtcbmNvbnN0IENMRUFSX1BST1BTJDFvID0gW1xuICAgIFBPTElDWV9JREVOVElGSUVSLFxuICAgIFBPTElDWV9RVUFMSUZJRVJTXG5dO1xuY2xhc3MgUG9saWN5SW5mb3JtYXRpb24gZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnBvbGljeUlkZW50aWZpZXIgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBQT0xJQ1lfSURFTlRJRklFUiwgUG9saWN5SW5mb3JtYXRpb24uZGVmYXVsdFZhbHVlcyhQT0xJQ1lfSURFTlRJRklFUikpO1xuICAgICAgICBpZiAoUE9MSUNZX1FVQUxJRklFUlMgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5wb2xpY3lRdWFsaWZpZXJzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUE9MSUNZX1FVQUxJRklFUlMsIFBvbGljeUluZm9ybWF0aW9uLmRlZmF1bHRWYWx1ZXMoUE9MSUNZX1FVQUxJRklFUlMpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgUE9MSUNZX0lERU5USUZJRVI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX1NUUklORztcbiAgICAgICAgICAgIGNhc2UgUE9MSUNZX1FVQUxJRklFUlM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyBuYW1lOiAobmFtZXMucG9saWN5SWRlbnRpZmllciB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUmVwZWF0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5wb2xpY3lRdWFsaWZpZXJzIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFBvbGljeVF1YWxpZmllckluZm8uc2NoZW1hKClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDFvKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBQb2xpY3lJbmZvcm1hdGlvbi5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBwb2xpY3lJZGVudGlmaWVyOiBQT0xJQ1lfSURFTlRJRklFUixcbiAgICAgICAgICAgICAgICBwb2xpY3lRdWFsaWZpZXJzOiBQT0xJQ1lfUVVBTElGSUVSU1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMucG9saWN5SWRlbnRpZmllciA9IGFzbjEucmVzdWx0LnBvbGljeUlkZW50aWZpZXIudmFsdWVCbG9jay50b1N0cmluZygpO1xuICAgICAgICBpZiAoUE9MSUNZX1FVQUxJRklFUlMgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHRoaXMucG9saWN5UXVhbGlmaWVycyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHQucG9saWN5UXVhbGlmaWVycywgZWxlbWVudCA9PiBuZXcgUG9saWN5UXVhbGlmaWVySW5mbyh7IHNjaGVtYTogZWxlbWVudCB9KSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgdmFsdWU6IHRoaXMucG9saWN5SWRlbnRpZmllciB9KSk7XG4gICAgICAgIGlmICh0aGlzLnBvbGljeVF1YWxpZmllcnMpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy5wb2xpY3lRdWFsaWZpZXJzLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICBwb2xpY3lJZGVudGlmaWVyOiB0aGlzLnBvbGljeUlkZW50aWZpZXJcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMucG9saWN5UXVhbGlmaWVycylcbiAgICAgICAgICAgIHJlcy5wb2xpY3lRdWFsaWZpZXJzID0gQXJyYXkuZnJvbSh0aGlzLnBvbGljeVF1YWxpZmllcnMsIG8gPT4gby50b0pTT04oKSk7XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxufVxuUG9saWN5SW5mb3JtYXRpb24uQ0xBU1NfTkFNRSA9IFwiUG9saWN5SW5mb3JtYXRpb25cIjtcblxuY29uc3QgQ0VSVElGSUNBVEVfUE9MSUNJRVMgPSBcImNlcnRpZmljYXRlUG9saWNpZXNcIjtcbmNvbnN0IENMRUFSX1BST1BTJDFuID0gW1xuICAgIENFUlRJRklDQVRFX1BPTElDSUVTLFxuXTtcbmNsYXNzIENlcnRpZmljYXRlUG9saWNpZXMgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmNlcnRpZmljYXRlUG9saWNpZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBDRVJUSUZJQ0FURV9QT0xJQ0lFUywgQ2VydGlmaWNhdGVQb2xpY2llcy5kZWZhdWx0VmFsdWVzKENFUlRJRklDQVRFX1BPTElDSUVTKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBDRVJUSUZJQ0FURV9QT0xJQ0lFUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUmVwZWF0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuY2VydGlmaWNhdGVQb2xpY2llcyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogUG9saWN5SW5mb3JtYXRpb24uc2NoZW1hKClcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDFuKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBDZXJ0aWZpY2F0ZVBvbGljaWVzLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGNlcnRpZmljYXRlUG9saWNpZXM6IENFUlRJRklDQVRFX1BPTElDSUVTXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5jZXJ0aWZpY2F0ZVBvbGljaWVzID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdC5jZXJ0aWZpY2F0ZVBvbGljaWVzLCBlbGVtZW50ID0+IG5ldyBQb2xpY3lJbmZvcm1hdGlvbih7IHNjaGVtYTogZWxlbWVudCB9KSk7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy5jZXJ0aWZpY2F0ZVBvbGljaWVzLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjZXJ0aWZpY2F0ZVBvbGljaWVzOiBBcnJheS5mcm9tKHRoaXMuY2VydGlmaWNhdGVQb2xpY2llcywgbyA9PiBvLnRvSlNPTigpKVxuICAgICAgICB9O1xuICAgIH1cbn1cbkNlcnRpZmljYXRlUG9saWNpZXMuQ0xBU1NfTkFNRSA9IFwiQ2VydGlmaWNhdGVQb2xpY2llc1wiO1xuXG5jb25zdCBURU1QTEFURV9JRCA9IFwidGVtcGxhdGVJRFwiO1xuY29uc3QgVEVNUExBVEVfTUFKT1JfVkVSU0lPTiA9IFwidGVtcGxhdGVNYWpvclZlcnNpb25cIjtcbmNvbnN0IFRFTVBMQVRFX01JTk9SX1ZFUlNJT04gPSBcInRlbXBsYXRlTWlub3JWZXJzaW9uXCI7XG5jb25zdCBDTEVBUl9QUk9QUyQxbSA9IFtcbiAgICBURU1QTEFURV9JRCxcbiAgICBURU1QTEFURV9NQUpPUl9WRVJTSU9OLFxuICAgIFRFTVBMQVRFX01JTk9SX1ZFUlNJT05cbl07XG5jbGFzcyBDZXJ0aWZpY2F0ZVRlbXBsYXRlIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy50ZW1wbGF0ZUlEID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVEVNUExBVEVfSUQsIENlcnRpZmljYXRlVGVtcGxhdGUuZGVmYXVsdFZhbHVlcyhURU1QTEFURV9JRCkpO1xuICAgICAgICBpZiAoVEVNUExBVEVfTUFKT1JfVkVSU0lPTiBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnRlbXBsYXRlTWFqb3JWZXJzaW9uID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVEVNUExBVEVfTUFKT1JfVkVSU0lPTiwgQ2VydGlmaWNhdGVUZW1wbGF0ZS5kZWZhdWx0VmFsdWVzKFRFTVBMQVRFX01BSk9SX1ZFUlNJT04pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoVEVNUExBVEVfTUlOT1JfVkVSU0lPTiBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnRlbXBsYXRlTWlub3JWZXJzaW9uID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVEVNUExBVEVfTUlOT1JfVkVSU0lPTiwgQ2VydGlmaWNhdGVUZW1wbGF0ZS5kZWZhdWx0VmFsdWVzKFRFTVBMQVRFX01JTk9SX1ZFUlNJT04pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVEVNUExBVEVfSUQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX1NUUklORztcbiAgICAgICAgICAgIGNhc2UgVEVNUExBVEVfTUFKT1JfVkVSU0lPTjpcbiAgICAgICAgICAgIGNhc2UgVEVNUExBVEVfTUlOT1JfVkVSU0lPTjpcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgbmFtZTogKG5hbWVzLnRlbXBsYXRlSUQgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMudGVtcGxhdGVNYWpvclZlcnNpb24gfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWVcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMudGVtcGxhdGVNaW5vclZlcnNpb24gfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWVcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQxbSk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgQ2VydGlmaWNhdGVUZW1wbGF0ZS5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZUlEOiBURU1QTEFURV9JRCxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZU1ham9yVmVyc2lvbjogVEVNUExBVEVfTUFKT1JfVkVSU0lPTixcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZU1pbm9yVmVyc2lvbjogVEVNUExBVEVfTUlOT1JfVkVSU0lPTlxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMudGVtcGxhdGVJRCA9IGFzbjEucmVzdWx0LnRlbXBsYXRlSUQudmFsdWVCbG9jay50b1N0cmluZygpO1xuICAgICAgICBpZiAoVEVNUExBVEVfTUFKT1JfVkVSU0lPTiBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZU1ham9yVmVyc2lvbiA9IGFzbjEucmVzdWx0LnRlbXBsYXRlTWFqb3JWZXJzaW9uLnZhbHVlQmxvY2sudmFsdWVEZWM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFRFTVBMQVRFX01JTk9SX1ZFUlNJT04gaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHRoaXMudGVtcGxhdGVNaW5vclZlcnNpb24gPSBhc24xLnJlc3VsdC50ZW1wbGF0ZU1pbm9yVmVyc2lvbi52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLnRlbXBsYXRlSUQgfSkpO1xuICAgICAgICBpZiAoVEVNUExBVEVfTUFKT1JfVkVSU0lPTiBpbiB0aGlzKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlOiB0aGlzLnRlbXBsYXRlTWFqb3JWZXJzaW9uIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoVEVNUExBVEVfTUlOT1JfVkVSU0lPTiBpbiB0aGlzKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlOiB0aGlzLnRlbXBsYXRlTWlub3JWZXJzaW9uIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICB0ZW1wbGF0ZUlEOiB0aGlzLnRlbXBsYXRlSURcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKFRFTVBMQVRFX01BSk9SX1ZFUlNJT04gaW4gdGhpcylcbiAgICAgICAgICAgIHJlcy50ZW1wbGF0ZU1ham9yVmVyc2lvbiA9IHRoaXMudGVtcGxhdGVNYWpvclZlcnNpb247XG4gICAgICAgIGlmIChURU1QTEFURV9NSU5PUl9WRVJTSU9OIGluIHRoaXMpXG4gICAgICAgICAgICByZXMudGVtcGxhdGVNaW5vclZlcnNpb24gPSB0aGlzLnRlbXBsYXRlTWlub3JWZXJzaW9uO1xuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbn1cblxuY29uc3QgRElTVFJJQlVUSU9OX1BPSU5UJDEgPSBcImRpc3RyaWJ1dGlvblBvaW50XCI7XG5jb25zdCBESVNUUklCVVRJT05fUE9JTlRfTkFNRVMkMSA9IFwiZGlzdHJpYnV0aW9uUG9pbnROYW1lc1wiO1xuY29uc3QgUkVBU09OUyA9IFwicmVhc29uc1wiO1xuY29uc3QgQ1JMX0lTU1VFUiA9IFwiY1JMSXNzdWVyXCI7XG5jb25zdCBDUkxfSVNTVUVSX05BTUVTID0gXCJjUkxJc3N1ZXJOYW1lc1wiO1xuY29uc3QgQ0xFQVJfUFJPUFMkMWwgPSBbXG4gICAgRElTVFJJQlVUSU9OX1BPSU5UJDEsXG4gICAgRElTVFJJQlVUSU9OX1BPSU5UX05BTUVTJDEsXG4gICAgUkVBU09OUyxcbiAgICBDUkxfSVNTVUVSLFxuICAgIENSTF9JU1NVRVJfTkFNRVMsXG5dO1xuY2xhc3MgRGlzdHJpYnV0aW9uUG9pbnQgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICBpZiAoRElTVFJJQlVUSU9OX1BPSU5UJDEgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5kaXN0cmlidXRpb25Qb2ludCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIERJU1RSSUJVVElPTl9QT0lOVCQxLCBEaXN0cmlidXRpb25Qb2ludC5kZWZhdWx0VmFsdWVzKERJU1RSSUJVVElPTl9QT0lOVCQxKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFJFQVNPTlMgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5yZWFzb25zID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUkVBU09OUywgRGlzdHJpYnV0aW9uUG9pbnQuZGVmYXVsdFZhbHVlcyhSRUFTT05TKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKENSTF9JU1NVRVIgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5jUkxJc3N1ZXIgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBDUkxfSVNTVUVSLCBEaXN0cmlidXRpb25Qb2ludC5kZWZhdWx0VmFsdWVzKENSTF9JU1NVRVIpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgRElTVFJJQlVUSU9OX1BPSU5UJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgY2FzZSBSRUFTT05TOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkJpdFN0cmluZygpO1xuICAgICAgICAgICAgY2FzZSBDUkxfSVNTVUVSOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5DaG9pY2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmRpc3RyaWJ1dGlvblBvaW50IHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUmVwZWF0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuZGlzdHJpYnV0aW9uUG9pbnROYW1lcyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogR2VuZXJhbE5hbWUuc2NoZW1hKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuZGlzdHJpYnV0aW9uUG9pbnQgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBSZWxhdGl2ZURpc3Rpbmd1aXNoZWROYW1lcy5zY2hlbWEoKS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnJlYXNvbnMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmNSTElzc3VlciB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUmVwZWF0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5jUkxJc3N1ZXJOYW1lcyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBHZW5lcmFsTmFtZS5zY2hlbWEoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkMWwpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIERpc3RyaWJ1dGlvblBvaW50LnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGRpc3RyaWJ1dGlvblBvaW50OiBESVNUUklCVVRJT05fUE9JTlQkMSxcbiAgICAgICAgICAgICAgICBkaXN0cmlidXRpb25Qb2ludE5hbWVzOiBESVNUUklCVVRJT05fUE9JTlRfTkFNRVMkMSxcbiAgICAgICAgICAgICAgICByZWFzb25zOiBSRUFTT05TLFxuICAgICAgICAgICAgICAgIGNSTElzc3VlcjogQ1JMX0lTU1VFUixcbiAgICAgICAgICAgICAgICBjUkxJc3N1ZXJOYW1lczogQ1JMX0lTU1VFUl9OQU1FU1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIGlmIChESVNUUklCVVRJT05fUE9JTlQkMSBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgaWYgKGFzbjEucmVzdWx0LmRpc3RyaWJ1dGlvblBvaW50LmlkQmxvY2sudGFnTnVtYmVyID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXN0cmlidXRpb25Qb2ludCA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHQuZGlzdHJpYnV0aW9uUG9pbnROYW1lcywgZWxlbWVudCA9PiBuZXcgR2VuZXJhbE5hbWUoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFzbjEucmVzdWx0LmRpc3RyaWJ1dGlvblBvaW50LmlkQmxvY2sudGFnTnVtYmVyID09PSAxKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXN0cmlidXRpb25Qb2ludCA9IG5ldyBSZWxhdGl2ZURpc3Rpbmd1aXNoZWROYW1lcyh7XG4gICAgICAgICAgICAgICAgICAgIHNjaGVtYTogbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogYXNuMS5yZXN1bHQuZGlzdHJpYnV0aW9uUG9pbnQudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChSRUFTT05TIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLnJlYXNvbnMgPSBuZXcgYXNuMWpzLkJpdFN0cmluZyh7IHZhbHVlSGV4OiBhc24xLnJlc3VsdC5yZWFzb25zLnZhbHVlQmxvY2sudmFsdWVIZXggfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKENSTF9JU1NVRVIgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHRoaXMuY1JMSXNzdWVyID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdC5jUkxJc3N1ZXJOYW1lcywgZWxlbWVudCA9PiBuZXcgR2VuZXJhbE5hbWUoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBpZiAodGhpcy5kaXN0cmlidXRpb25Qb2ludCkge1xuICAgICAgICAgICAgbGV0IGludGVybmFsVmFsdWU7XG4gICAgICAgICAgICBpZiAodGhpcy5kaXN0cmlidXRpb25Qb2ludCBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgICAgICAgaW50ZXJuYWxWYWx1ZSA9IG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLmRpc3RyaWJ1dGlvblBvaW50LCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGludGVybmFsVmFsdWUgPSBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFt0aGlzLmRpc3RyaWJ1dGlvblBvaW50LnRvU2NoZW1hKCldXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFtpbnRlcm5hbFZhbHVlXVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnJlYXNvbnMpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWVIZXg6IHRoaXMucmVhc29ucy52YWx1ZUJsb2NrLnZhbHVlSGV4Vmlld1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmNSTElzc3Vlcikge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMuY1JMSXNzdWVyLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCBvYmplY3QgPSB7fTtcbiAgICAgICAgaWYgKHRoaXMuZGlzdHJpYnV0aW9uUG9pbnQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmRpc3RyaWJ1dGlvblBvaW50IGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgICAgICAgICBvYmplY3QuZGlzdHJpYnV0aW9uUG9pbnQgPSBBcnJheS5mcm9tKHRoaXMuZGlzdHJpYnV0aW9uUG9pbnQsIG8gPT4gby50b0pTT04oKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvYmplY3QuZGlzdHJpYnV0aW9uUG9pbnQgPSB0aGlzLmRpc3RyaWJ1dGlvblBvaW50LnRvSlNPTigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnJlYXNvbnMpIHtcbiAgICAgICAgICAgIG9iamVjdC5yZWFzb25zID0gdGhpcy5yZWFzb25zLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmNSTElzc3Vlcikge1xuICAgICAgICAgICAgb2JqZWN0LmNSTElzc3VlciA9IEFycmF5LmZyb20odGhpcy5jUkxJc3N1ZXIsIG8gPT4gby50b0pTT04oKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9iamVjdDtcbiAgICB9XG59XG5EaXN0cmlidXRpb25Qb2ludC5DTEFTU19OQU1FID0gXCJEaXN0cmlidXRpb25Qb2ludFwiO1xuXG5jb25zdCBESVNUUklCVVRJT05fUE9JTlRTID0gXCJkaXN0cmlidXRpb25Qb2ludHNcIjtcbmNvbnN0IENMRUFSX1BST1BTJDFrID0gW1xuICAgIERJU1RSSUJVVElPTl9QT0lOVFNcbl07XG5jbGFzcyBDUkxEaXN0cmlidXRpb25Qb2ludHMgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmRpc3RyaWJ1dGlvblBvaW50cyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIERJU1RSSUJVVElPTl9QT0lOVFMsIENSTERpc3RyaWJ1dGlvblBvaW50cy5kZWZhdWx0VmFsdWVzKERJU1RSSUJVVElPTl9QT0lOVFMpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIERJU1RSSUJVVElPTl9QT0lOVFM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmRpc3RyaWJ1dGlvblBvaW50cyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogRGlzdHJpYnV0aW9uUG9pbnQuc2NoZW1hKClcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDFrKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBDUkxEaXN0cmlidXRpb25Qb2ludHMuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgZGlzdHJpYnV0aW9uUG9pbnRzOiBESVNUUklCVVRJT05fUE9JTlRTXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5kaXN0cmlidXRpb25Qb2ludHMgPSBBcnJheS5mcm9tKGFzbjEucmVzdWx0LmRpc3RyaWJ1dGlvblBvaW50cywgZWxlbWVudCA9PiBuZXcgRGlzdHJpYnV0aW9uUG9pbnQoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMuZGlzdHJpYnV0aW9uUG9pbnRzLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBkaXN0cmlidXRpb25Qb2ludHM6IEFycmF5LmZyb20odGhpcy5kaXN0cmlidXRpb25Qb2ludHMsIG8gPT4gby50b0pTT04oKSlcbiAgICAgICAgfTtcbiAgICB9XG59XG5DUkxEaXN0cmlidXRpb25Qb2ludHMuQ0xBU1NfTkFNRSA9IFwiQ1JMRGlzdHJpYnV0aW9uUG9pbnRzXCI7XG5cbmNvbnN0IEtFWV9QVVJQT1NFUyA9IFwia2V5UHVycG9zZXNcIjtcbmNvbnN0IENMRUFSX1BST1BTJDFqID0gW1xuICAgIEtFWV9QVVJQT1NFUyxcbl07XG5jbGFzcyBFeHRLZXlVc2FnZSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMua2V5UHVycG9zZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBLRVlfUFVSUE9TRVMsIEV4dEtleVVzYWdlLmRlZmF1bHRWYWx1ZXMoS0VZX1BVUlBPU0VTKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBLRVlfUFVSUE9TRVM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmtleVB1cnBvc2VzIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkMWopO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIEV4dEtleVVzYWdlLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGtleVB1cnBvc2VzOiBLRVlfUFVSUE9TRVNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmtleVB1cnBvc2VzID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdC5rZXlQdXJwb3NlcywgKGVsZW1lbnQpID0+IGVsZW1lbnQudmFsdWVCbG9jay50b1N0cmluZygpKTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLmtleVB1cnBvc2VzLCBlbGVtZW50ID0+IG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiBlbGVtZW50IH0pKVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGtleVB1cnBvc2VzOiBBcnJheS5mcm9tKHRoaXMua2V5UHVycG9zZXMpXG4gICAgICAgIH07XG4gICAgfVxufVxuRXh0S2V5VXNhZ2UuQ0xBU1NfTkFNRSA9IFwiRXh0S2V5VXNhZ2VcIjtcblxuY29uc3QgQUNDRVNTX0RFU0NSSVBUSU9OUyA9IFwiYWNjZXNzRGVzY3JpcHRpb25zXCI7XG5jbGFzcyBJbmZvQWNjZXNzIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5hY2Nlc3NEZXNjcmlwdGlvbnMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBBQ0NFU1NfREVTQ1JJUFRJT05TLCBJbmZvQWNjZXNzLmRlZmF1bHRWYWx1ZXMoQUNDRVNTX0RFU0NSSVBUSU9OUykpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgQUNDRVNTX0RFU0NSSVBUSU9OUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUmVwZWF0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuYWNjZXNzRGVzY3JpcHRpb25zIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBBY2Nlc3NEZXNjcmlwdGlvbi5zY2hlbWEoKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgW1xuICAgICAgICAgICAgQUNDRVNTX0RFU0NSSVBUSU9OU1xuICAgICAgICBdKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBJbmZvQWNjZXNzLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGFjY2Vzc0Rlc2NyaXB0aW9uczogQUNDRVNTX0RFU0NSSVBUSU9OU1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuYWNjZXNzRGVzY3JpcHRpb25zID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdC5hY2Nlc3NEZXNjcmlwdGlvbnMsIGVsZW1lbnQgPT4gbmV3IEFjY2Vzc0Rlc2NyaXB0aW9uKHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLmFjY2Vzc0Rlc2NyaXB0aW9ucywgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYWNjZXNzRGVzY3JpcHRpb25zOiBBcnJheS5mcm9tKHRoaXMuYWNjZXNzRGVzY3JpcHRpb25zLCBvID0+IG8udG9KU09OKCkpXG4gICAgICAgIH07XG4gICAgfVxufVxuSW5mb0FjY2Vzcy5DTEFTU19OQU1FID0gXCJJbmZvQWNjZXNzXCI7XG5cbmNvbnN0IERJU1RSSUJVVElPTl9QT0lOVCA9IFwiZGlzdHJpYnV0aW9uUG9pbnRcIjtcbmNvbnN0IERJU1RSSUJVVElPTl9QT0lOVF9OQU1FUyA9IFwiZGlzdHJpYnV0aW9uUG9pbnROYW1lc1wiO1xuY29uc3QgT05MWV9DT05UQUlOU19VU0VSX0NFUlRTID0gXCJvbmx5Q29udGFpbnNVc2VyQ2VydHNcIjtcbmNvbnN0IE9OTFlfQ09OVEFJTlNfQ0FfQ0VSVFMgPSBcIm9ubHlDb250YWluc0NBQ2VydHNcIjtcbmNvbnN0IE9OTFlfU09NRV9SRUFTT04gPSBcIm9ubHlTb21lUmVhc29uc1wiO1xuY29uc3QgSU5ESVJFQ1RfQ1JMID0gXCJpbmRpcmVjdENSTFwiO1xuY29uc3QgT05MWV9DT05UQUlOU19BVFRSSUJVVEVfQ0VSVFMgPSBcIm9ubHlDb250YWluc0F0dHJpYnV0ZUNlcnRzXCI7XG5jb25zdCBDTEVBUl9QUk9QUyQxaSA9IFtcbiAgICBESVNUUklCVVRJT05fUE9JTlQsXG4gICAgRElTVFJJQlVUSU9OX1BPSU5UX05BTUVTLFxuICAgIE9OTFlfQ09OVEFJTlNfVVNFUl9DRVJUUyxcbiAgICBPTkxZX0NPTlRBSU5TX0NBX0NFUlRTLFxuICAgIE9OTFlfU09NRV9SRUFTT04sXG4gICAgSU5ESVJFQ1RfQ1JMLFxuICAgIE9OTFlfQ09OVEFJTlNfQVRUUklCVVRFX0NFUlRTLFxuXTtcbmNsYXNzIElzc3VpbmdEaXN0cmlidXRpb25Qb2ludCBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIGlmIChESVNUUklCVVRJT05fUE9JTlQgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5kaXN0cmlidXRpb25Qb2ludCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIERJU1RSSUJVVElPTl9QT0lOVCwgSXNzdWluZ0Rpc3RyaWJ1dGlvblBvaW50LmRlZmF1bHRWYWx1ZXMoRElTVFJJQlVUSU9OX1BPSU5UKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vbmx5Q29udGFpbnNVc2VyQ2VydHMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBPTkxZX0NPTlRBSU5TX1VTRVJfQ0VSVFMsIElzc3VpbmdEaXN0cmlidXRpb25Qb2ludC5kZWZhdWx0VmFsdWVzKE9OTFlfQ09OVEFJTlNfVVNFUl9DRVJUUykpO1xuICAgICAgICB0aGlzLm9ubHlDb250YWluc0NBQ2VydHMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBPTkxZX0NPTlRBSU5TX0NBX0NFUlRTLCBJc3N1aW5nRGlzdHJpYnV0aW9uUG9pbnQuZGVmYXVsdFZhbHVlcyhPTkxZX0NPTlRBSU5TX0NBX0NFUlRTKSk7XG4gICAgICAgIGlmIChPTkxZX1NPTUVfUkVBU09OIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMub25seVNvbWVSZWFzb25zID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgT05MWV9TT01FX1JFQVNPTiwgSXNzdWluZ0Rpc3RyaWJ1dGlvblBvaW50LmRlZmF1bHRWYWx1ZXMoT05MWV9TT01FX1JFQVNPTikpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaW5kaXJlY3RDUkwgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBJTkRJUkVDVF9DUkwsIElzc3VpbmdEaXN0cmlidXRpb25Qb2ludC5kZWZhdWx0VmFsdWVzKElORElSRUNUX0NSTCkpO1xuICAgICAgICB0aGlzLm9ubHlDb250YWluc0F0dHJpYnV0ZUNlcnRzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgT05MWV9DT05UQUlOU19BVFRSSUJVVEVfQ0VSVFMsIElzc3VpbmdEaXN0cmlidXRpb25Qb2ludC5kZWZhdWx0VmFsdWVzKE9OTFlfQ09OVEFJTlNfQVRUUklCVVRFX0NFUlRTKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBESVNUUklCVVRJT05fUE9JTlQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgY2FzZSBPTkxZX0NPTlRBSU5TX1VTRVJfQ0VSVFM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgY2FzZSBPTkxZX0NPTlRBSU5TX0NBX0NFUlRTOlxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIGNhc2UgT05MWV9TT01FX1JFQVNPTjpcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGNhc2UgSU5ESVJFQ1RfQ1JMOlxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIGNhc2UgT05MWV9DT05UQUlOU19BVFRSSUJVVEVfQ0VSVFM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNob2ljZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuZGlzdHJpYnV0aW9uUG9pbnQgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUmVwZWF0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuZGlzdHJpYnV0aW9uUG9pbnROYW1lcyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogR2VuZXJhbE5hbWUuc2NoZW1hKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuZGlzdHJpYnV0aW9uUG9pbnQgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZXMuc2NoZW1hKCkudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5vbmx5Q29udGFpbnNVc2VyQ2VydHMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5vbmx5Q29udGFpbnNDQUNlcnRzIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMub25seVNvbWVSZWFzb25zIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogM1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuaW5kaXJlY3RDUkwgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiA0XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5vbmx5Q29udGFpbnNBdHRyaWJ1dGVDZXJ0cyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkMWkpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIElzc3VpbmdEaXN0cmlidXRpb25Qb2ludC5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBkaXN0cmlidXRpb25Qb2ludDogRElTVFJJQlVUSU9OX1BPSU5ULFxuICAgICAgICAgICAgICAgIGRpc3RyaWJ1dGlvblBvaW50TmFtZXM6IERJU1RSSUJVVElPTl9QT0lOVF9OQU1FUyxcbiAgICAgICAgICAgICAgICBvbmx5Q29udGFpbnNVc2VyQ2VydHM6IE9OTFlfQ09OVEFJTlNfVVNFUl9DRVJUUyxcbiAgICAgICAgICAgICAgICBvbmx5Q29udGFpbnNDQUNlcnRzOiBPTkxZX0NPTlRBSU5TX0NBX0NFUlRTLFxuICAgICAgICAgICAgICAgIG9ubHlTb21lUmVhc29uczogT05MWV9TT01FX1JFQVNPTixcbiAgICAgICAgICAgICAgICBpbmRpcmVjdENSTDogSU5ESVJFQ1RfQ1JMLFxuICAgICAgICAgICAgICAgIG9ubHlDb250YWluc0F0dHJpYnV0ZUNlcnRzOiBPTkxZX0NPTlRBSU5TX0FUVFJJQlVURV9DRVJUU1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIGlmIChESVNUUklCVVRJT05fUE9JTlQgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHN3aXRjaCAodHJ1ZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgKGFzbjEucmVzdWx0LmRpc3RyaWJ1dGlvblBvaW50LmlkQmxvY2sudGFnTnVtYmVyID09PSAwKTpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXN0cmlidXRpb25Qb2ludCA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHQuZGlzdHJpYnV0aW9uUG9pbnROYW1lcywgZWxlbWVudCA9PiBuZXcgR2VuZXJhbE5hbWUoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIChhc24xLnJlc3VsdC5kaXN0cmlidXRpb25Qb2ludC5pZEJsb2NrLnRhZ051bWJlciA9PT0gMSk6XG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzdHJpYnV0aW9uUG9pbnQgPSBuZXcgUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZXMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYTogbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBhc24xLnJlc3VsdC5kaXN0cmlidXRpb25Qb2ludC52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVua25vd24gdGFnTnVtYmVyIGZvciBkaXN0cmlidXRpb25Qb2ludDogeyRhc24xLnJlc3VsdC5kaXN0cmlidXRpb25Qb2ludC5pZEJsb2NrLnRhZ051bWJlcn1cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE9OTFlfQ09OVEFJTlNfVVNFUl9DRVJUUyBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgY29uc3QgdmlldyA9IG5ldyBVaW50OEFycmF5KGFzbjEucmVzdWx0Lm9ubHlDb250YWluc1VzZXJDZXJ0cy52YWx1ZUJsb2NrLnZhbHVlSGV4KTtcbiAgICAgICAgICAgIHRoaXMub25seUNvbnRhaW5zVXNlckNlcnRzID0gKHZpZXdbMF0gIT09IDB4MDApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChPTkxZX0NPTlRBSU5TX0NBX0NFUlRTIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICBjb25zdCB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkoYXNuMS5yZXN1bHQub25seUNvbnRhaW5zQ0FDZXJ0cy52YWx1ZUJsb2NrLnZhbHVlSGV4KTtcbiAgICAgICAgICAgIHRoaXMub25seUNvbnRhaW5zQ0FDZXJ0cyA9ICh2aWV3WzBdICE9PSAweDAwKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoT05MWV9TT01FX1JFQVNPTiBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgY29uc3QgdmlldyA9IG5ldyBVaW50OEFycmF5KGFzbjEucmVzdWx0Lm9ubHlTb21lUmVhc29ucy52YWx1ZUJsb2NrLnZhbHVlSGV4KTtcbiAgICAgICAgICAgIHRoaXMub25seVNvbWVSZWFzb25zID0gdmlld1swXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoSU5ESVJFQ1RfQ1JMIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICBjb25zdCB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkoYXNuMS5yZXN1bHQuaW5kaXJlY3RDUkwudmFsdWVCbG9jay52YWx1ZUhleCk7XG4gICAgICAgICAgICB0aGlzLmluZGlyZWN0Q1JMID0gKHZpZXdbMF0gIT09IDB4MDApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChPTkxZX0NPTlRBSU5TX0FUVFJJQlVURV9DRVJUUyBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgY29uc3QgdmlldyA9IG5ldyBVaW50OEFycmF5KGFzbjEucmVzdWx0Lm9ubHlDb250YWluc0F0dHJpYnV0ZUNlcnRzLnZhbHVlQmxvY2sudmFsdWVIZXgpO1xuICAgICAgICAgICAgdGhpcy5vbmx5Q29udGFpbnNBdHRyaWJ1dGVDZXJ0cyA9ICh2aWV3WzBdICE9PSAweDAwKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgaWYgKHRoaXMuZGlzdHJpYnV0aW9uUG9pbnQpIHtcbiAgICAgICAgICAgIGxldCB2YWx1ZTtcbiAgICAgICAgICAgIGlmICh0aGlzLmRpc3RyaWJ1dGlvblBvaW50IGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLmRpc3RyaWJ1dGlvblBvaW50LCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gdGhpcy5kaXN0cmlidXRpb25Qb2ludC50b1NjaGVtYSgpO1xuICAgICAgICAgICAgICAgIHZhbHVlLmlkQmxvY2sudGFnQ2xhc3MgPSAzO1xuICAgICAgICAgICAgICAgIHZhbHVlLmlkQmxvY2sudGFnTnVtYmVyID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW3ZhbHVlXVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm9ubHlDb250YWluc1VzZXJDZXJ0cyAhPT0gSXNzdWluZ0Rpc3RyaWJ1dGlvblBvaW50LmRlZmF1bHRWYWx1ZXMoT05MWV9DT05UQUlOU19VU0VSX0NFUlRTKSkge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZUhleDogKG5ldyBVaW50OEFycmF5KFsweEZGXSkpLmJ1ZmZlclxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm9ubHlDb250YWluc0NBQ2VydHMgIT09IElzc3VpbmdEaXN0cmlidXRpb25Qb2ludC5kZWZhdWx0VmFsdWVzKE9OTFlfQ09OVEFJTlNfQ0FfQ0VSVFMpKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlSGV4OiAobmV3IFVpbnQ4QXJyYXkoWzB4RkZdKSkuYnVmZmVyXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMub25seVNvbWVSZWFzb25zICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IGJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcigxKTtcbiAgICAgICAgICAgIGNvbnN0IHZpZXcgPSBuZXcgVWludDhBcnJheShidWZmZXIpO1xuICAgICAgICAgICAgdmlld1swXSA9IHRoaXMub25seVNvbWVSZWFzb25zO1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAzXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZUhleDogYnVmZmVyXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaW5kaXJlY3RDUkwgIT09IElzc3VpbmdEaXN0cmlidXRpb25Qb2ludC5kZWZhdWx0VmFsdWVzKElORElSRUNUX0NSTCkpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogNFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWVIZXg6IChuZXcgVWludDhBcnJheShbMHhGRl0pKS5idWZmZXJcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5vbmx5Q29udGFpbnNBdHRyaWJ1dGVDZXJ0cyAhPT0gSXNzdWluZ0Rpc3RyaWJ1dGlvblBvaW50LmRlZmF1bHRWYWx1ZXMoT05MWV9DT05UQUlOU19BVFRSSUJVVEVfQ0VSVFMpKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDVcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlSGV4OiAobmV3IFVpbnQ4QXJyYXkoWzB4RkZdKSkuYnVmZmVyXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3Qgb2JqID0ge307XG4gICAgICAgIGlmICh0aGlzLmRpc3RyaWJ1dGlvblBvaW50KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5kaXN0cmlidXRpb25Qb2ludCBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgICAgICAgb2JqLmRpc3RyaWJ1dGlvblBvaW50ID0gQXJyYXkuZnJvbSh0aGlzLmRpc3RyaWJ1dGlvblBvaW50LCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb2JqLmRpc3RyaWJ1dGlvblBvaW50ID0gdGhpcy5kaXN0cmlidXRpb25Qb2ludC50b0pTT04oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5vbmx5Q29udGFpbnNVc2VyQ2VydHMgIT09IElzc3VpbmdEaXN0cmlidXRpb25Qb2ludC5kZWZhdWx0VmFsdWVzKE9OTFlfQ09OVEFJTlNfVVNFUl9DRVJUUykpIHtcbiAgICAgICAgICAgIG9iai5vbmx5Q29udGFpbnNVc2VyQ2VydHMgPSB0aGlzLm9ubHlDb250YWluc1VzZXJDZXJ0cztcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5vbmx5Q29udGFpbnNDQUNlcnRzICE9PSBJc3N1aW5nRGlzdHJpYnV0aW9uUG9pbnQuZGVmYXVsdFZhbHVlcyhPTkxZX0NPTlRBSU5TX0NBX0NFUlRTKSkge1xuICAgICAgICAgICAgb2JqLm9ubHlDb250YWluc0NBQ2VydHMgPSB0aGlzLm9ubHlDb250YWluc0NBQ2VydHM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE9OTFlfU09NRV9SRUFTT04gaW4gdGhpcykge1xuICAgICAgICAgICAgb2JqLm9ubHlTb21lUmVhc29ucyA9IHRoaXMub25seVNvbWVSZWFzb25zO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmluZGlyZWN0Q1JMICE9PSBJc3N1aW5nRGlzdHJpYnV0aW9uUG9pbnQuZGVmYXVsdFZhbHVlcyhJTkRJUkVDVF9DUkwpKSB7XG4gICAgICAgICAgICBvYmouaW5kaXJlY3RDUkwgPSB0aGlzLmluZGlyZWN0Q1JMO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm9ubHlDb250YWluc0F0dHJpYnV0ZUNlcnRzICE9PSBJc3N1aW5nRGlzdHJpYnV0aW9uUG9pbnQuZGVmYXVsdFZhbHVlcyhPTkxZX0NPTlRBSU5TX0FUVFJJQlVURV9DRVJUUykpIHtcbiAgICAgICAgICAgIG9iai5vbmx5Q29udGFpbnNBdHRyaWJ1dGVDZXJ0cyA9IHRoaXMub25seUNvbnRhaW5zQXR0cmlidXRlQ2VydHM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICB9XG59XG5Jc3N1aW5nRGlzdHJpYnV0aW9uUG9pbnQuQ0xBU1NfTkFNRSA9IFwiSXNzdWluZ0Rpc3RyaWJ1dGlvblBvaW50XCI7XG5cbmNvbnN0IEJBU0UgPSBcImJhc2VcIjtcbmNvbnN0IE1JTklNVU0gPSBcIm1pbmltdW1cIjtcbmNvbnN0IE1BWElNVU0gPSBcIm1heGltdW1cIjtcbmNvbnN0IENMRUFSX1BST1BTJDFoID0gW1xuICAgIEJBU0UsXG4gICAgTUlOSU1VTSxcbiAgICBNQVhJTVVNXG5dO1xuY2xhc3MgR2VuZXJhbFN1YnRyZWUgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmJhc2UgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBCQVNFLCBHZW5lcmFsU3VidHJlZS5kZWZhdWx0VmFsdWVzKEJBU0UpKTtcbiAgICAgICAgdGhpcy5taW5pbXVtID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgTUlOSU1VTSwgR2VuZXJhbFN1YnRyZWUuZGVmYXVsdFZhbHVlcyhNSU5JTVVNKSk7XG4gICAgICAgIGlmIChNQVhJTVVNIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMubWF4aW11bSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE1BWElNVU0sIEdlbmVyYWxTdWJ0cmVlLmRlZmF1bHRWYWx1ZXMoTUFYSU1VTSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBCQVNFOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgR2VuZXJhbE5hbWUoKTtcbiAgICAgICAgICAgIGNhc2UgTUlOSU1VTTpcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGNhc2UgTUFYSU1VTTpcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgR2VuZXJhbE5hbWUuc2NoZW1hKG5hbWVzLmJhc2UgfHwge30pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMubWluaW11bSB8fCBFTVBUWV9TVFJJTkcpIH0pXVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMubWF4aW11bSB8fCBFTVBUWV9TVFJJTkcpIH0pXVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkMWgpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIEdlbmVyYWxTdWJ0cmVlLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGJhc2U6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogQkFTRVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBtaW5pbXVtOiBNSU5JTVVNLFxuICAgICAgICAgICAgICAgIG1heGltdW06IE1BWElNVU1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmJhc2UgPSBuZXcgR2VuZXJhbE5hbWUoeyBzY2hlbWE6IGFzbjEucmVzdWx0LmJhc2UgfSk7XG4gICAgICAgIGlmIChNSU5JTVVNIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICBpZiAoYXNuMS5yZXN1bHQubWluaW11bS52YWx1ZUJsb2NrLmlzSGV4T25seSlcbiAgICAgICAgICAgICAgICB0aGlzLm1pbmltdW0gPSBhc24xLnJlc3VsdC5taW5pbXVtO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHRoaXMubWluaW11bSA9IGFzbjEucmVzdWx0Lm1pbmltdW0udmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgfVxuICAgICAgICBpZiAoTUFYSU1VTSBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgaWYgKGFzbjEucmVzdWx0Lm1heGltdW0udmFsdWVCbG9jay5pc0hleE9ubHkpXG4gICAgICAgICAgICAgICAgdGhpcy5tYXhpbXVtID0gYXNuMS5yZXN1bHQubWF4aW11bTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB0aGlzLm1heGltdW0gPSBhc24xLnJlc3VsdC5tYXhpbXVtLnZhbHVlQmxvY2sudmFsdWVEZWM7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5iYXNlLnRvU2NoZW1hKCkpO1xuICAgICAgICBpZiAodGhpcy5taW5pbXVtICE9PSAwKSB7XG4gICAgICAgICAgICBsZXQgdmFsdWVNaW5pbXVtID0gMDtcbiAgICAgICAgICAgIGlmICh0aGlzLm1pbmltdW0gaW5zdGFuY2VvZiBhc24xanMuSW50ZWdlcikge1xuICAgICAgICAgICAgICAgIHZhbHVlTWluaW11bSA9IHRoaXMubWluaW11bTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhbHVlTWluaW11bSA9IG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlOiB0aGlzLm1pbmltdW0gfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFt2YWx1ZU1pbmltdW1dXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE1BWElNVU0gaW4gdGhpcykge1xuICAgICAgICAgICAgbGV0IHZhbHVlTWF4aW11bSA9IDA7XG4gICAgICAgICAgICBpZiAodGhpcy5tYXhpbXVtIGluc3RhbmNlb2YgYXNuMWpzLkludGVnZXIpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZU1heGltdW0gPSB0aGlzLm1heGltdW07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YWx1ZU1heGltdW0gPSBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy5tYXhpbXVtIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBbdmFsdWVNYXhpbXVtXVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICAgIGJhc2U6IHRoaXMuYmFzZS50b0pTT04oKVxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5taW5pbXVtICE9PSAwKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMubWluaW11bSA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgICAgIHJlcy5taW5pbXVtID0gdGhpcy5taW5pbXVtO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzLm1pbmltdW0gPSB0aGlzLm1pbmltdW0udG9KU09OKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubWF4aW11bSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMubWF4aW11bSA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgICAgIHJlcy5tYXhpbXVtID0gdGhpcy5tYXhpbXVtO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzLm1heGltdW0gPSB0aGlzLm1heGltdW0udG9KU09OKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5HZW5lcmFsU3VidHJlZS5DTEFTU19OQU1FID0gXCJHZW5lcmFsU3VidHJlZVwiO1xuXG5jb25zdCBQRVJNSVRURURfU1VCVFJFRVMgPSBcInBlcm1pdHRlZFN1YnRyZWVzXCI7XG5jb25zdCBFWENMVURFRF9TVUJUUkVFUyA9IFwiZXhjbHVkZWRTdWJ0cmVlc1wiO1xuY29uc3QgQ0xFQVJfUFJPUFMkMWcgPSBbXG4gICAgUEVSTUlUVEVEX1NVQlRSRUVTLFxuICAgIEVYQ0xVREVEX1NVQlRSRUVTXG5dO1xuY2xhc3MgTmFtZUNvbnN0cmFpbnRzIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgaWYgKFBFUk1JVFRFRF9TVUJUUkVFUyBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnBlcm1pdHRlZFN1YnRyZWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUEVSTUlUVEVEX1NVQlRSRUVTLCBOYW1lQ29uc3RyYWludHMuZGVmYXVsdFZhbHVlcyhQRVJNSVRURURfU1VCVFJFRVMpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoRVhDTFVERURfU1VCVFJFRVMgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5leGNsdWRlZFN1YnRyZWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgRVhDTFVERURfU1VCVFJFRVMsIE5hbWVDb25zdHJhaW50cy5kZWZhdWx0VmFsdWVzKEVYQ0xVREVEX1NVQlRSRUVTKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFBFUk1JVFRFRF9TVUJUUkVFUzpcbiAgICAgICAgICAgIGNhc2UgRVhDTFVERURfU1VCVFJFRVM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMucGVybWl0dGVkU3VidHJlZXMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogR2VuZXJhbFN1YnRyZWUuc2NoZW1hKClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuZXhjbHVkZWRTdWJ0cmVlcyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBHZW5lcmFsU3VidHJlZS5zY2hlbWEoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkMWcpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIE5hbWVDb25zdHJhaW50cy5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBwZXJtaXR0ZWRTdWJ0cmVlczogUEVSTUlUVEVEX1NVQlRSRUVTLFxuICAgICAgICAgICAgICAgIGV4Y2x1ZGVkU3VidHJlZXM6IEVYQ0xVREVEX1NVQlRSRUVTXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgaWYgKFBFUk1JVFRFRF9TVUJUUkVFUyBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMucGVybWl0dGVkU3VidHJlZXMgPSBBcnJheS5mcm9tKGFzbjEucmVzdWx0LnBlcm1pdHRlZFN1YnRyZWVzLCBlbGVtZW50ID0+IG5ldyBHZW5lcmFsU3VidHJlZSh7IHNjaGVtYTogZWxlbWVudCB9KSk7XG4gICAgICAgIGlmIChFWENMVURFRF9TVUJUUkVFUyBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMuZXhjbHVkZWRTdWJ0cmVlcyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHQuZXhjbHVkZWRTdWJ0cmVlcywgZWxlbWVudCA9PiBuZXcgR2VuZXJhbFN1YnRyZWUoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgaWYgKHRoaXMucGVybWl0dGVkU3VidHJlZXMpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLnBlcm1pdHRlZFN1YnRyZWVzLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5leGNsdWRlZFN1YnRyZWVzKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy5leGNsdWRlZFN1YnRyZWVzLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCBvYmplY3QgPSB7fTtcbiAgICAgICAgaWYgKHRoaXMucGVybWl0dGVkU3VidHJlZXMpIHtcbiAgICAgICAgICAgIG9iamVjdC5wZXJtaXR0ZWRTdWJ0cmVlcyA9IEFycmF5LmZyb20odGhpcy5wZXJtaXR0ZWRTdWJ0cmVlcywgbyA9PiBvLnRvSlNPTigpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5leGNsdWRlZFN1YnRyZWVzKSB7XG4gICAgICAgICAgICBvYmplY3QuZXhjbHVkZWRTdWJ0cmVlcyA9IEFycmF5LmZyb20odGhpcy5leGNsdWRlZFN1YnRyZWVzLCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvYmplY3Q7XG4gICAgfVxufVxuTmFtZUNvbnN0cmFpbnRzLkNMQVNTX05BTUUgPSBcIk5hbWVDb25zdHJhaW50c1wiO1xuXG5jb25zdCBSRVFVSVJFX0VYUExJQ0lUX1BPTElDWSA9IFwicmVxdWlyZUV4cGxpY2l0UG9saWN5XCI7XG5jb25zdCBJTkhJQklUX1BPTElDWV9NQVBQSU5HID0gXCJpbmhpYml0UG9saWN5TWFwcGluZ1wiO1xuY29uc3QgQ0xFQVJfUFJPUFMkMWYgPSBbXG4gICAgUkVRVUlSRV9FWFBMSUNJVF9QT0xJQ1ksXG4gICAgSU5ISUJJVF9QT0xJQ1lfTUFQUElORyxcbl07XG5jbGFzcyBQb2xpY3lDb25zdHJhaW50cyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIGlmIChSRVFVSVJFX0VYUExJQ0lUX1BPTElDWSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnJlcXVpcmVFeHBsaWNpdFBvbGljeSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFJFUVVJUkVfRVhQTElDSVRfUE9MSUNZLCBQb2xpY3lDb25zdHJhaW50cy5kZWZhdWx0VmFsdWVzKFJFUVVJUkVfRVhQTElDSVRfUE9MSUNZKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKElOSElCSVRfUE9MSUNZX01BUFBJTkcgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5pbmhpYml0UG9saWN5TWFwcGluZyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIElOSElCSVRfUE9MSUNZX01BUFBJTkcsIFBvbGljeUNvbnN0cmFpbnRzLmRlZmF1bHRWYWx1ZXMoSU5ISUJJVF9QT0xJQ1lfTUFQUElORykpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBSRVFVSVJFX0VYUExJQ0lUX1BPTElDWTpcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGNhc2UgSU5ISUJJVF9QT0xJQ1lfTUFQUElORzpcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMucmVxdWlyZUV4cGxpY2l0UG9saWN5IHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuaW5oaWJpdFBvbGljeU1hcHBpbmcgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDFmKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBQb2xpY3lDb25zdHJhaW50cy5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICByZXF1aXJlRXhwbGljaXRQb2xpY3k6IFJFUVVJUkVfRVhQTElDSVRfUE9MSUNZLFxuICAgICAgICAgICAgICAgIGluaGliaXRQb2xpY3lNYXBwaW5nOiBJTkhJQklUX1BPTElDWV9NQVBQSU5HXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgaWYgKFJFUVVJUkVfRVhQTElDSVRfUE9MSUNZIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZDEgPSBhc24xLnJlc3VsdC5yZXF1aXJlRXhwbGljaXRQb2xpY3k7XG4gICAgICAgICAgICBmaWVsZDEuaWRCbG9jay50YWdDbGFzcyA9IDE7XG4gICAgICAgICAgICBmaWVsZDEuaWRCbG9jay50YWdOdW1iZXIgPSAyO1xuICAgICAgICAgICAgY29uc3QgYmVyMSA9IGZpZWxkMS50b0JFUihmYWxzZSk7XG4gICAgICAgICAgICBjb25zdCBpbnQxID0gYXNuMWpzLmZyb21CRVIoYmVyMSk7XG4gICAgICAgICAgICBBc25FcnJvci5hc3NlcnQoaW50MSwgXCJJbnRlZ2VyXCIpO1xuICAgICAgICAgICAgdGhpcy5yZXF1aXJlRXhwbGljaXRQb2xpY3kgPSBpbnQxLnJlc3VsdC52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgICAgICB9XG4gICAgICAgIGlmIChJTkhJQklUX1BPTElDWV9NQVBQSU5HIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZDIgPSBhc24xLnJlc3VsdC5pbmhpYml0UG9saWN5TWFwcGluZztcbiAgICAgICAgICAgIGZpZWxkMi5pZEJsb2NrLnRhZ0NsYXNzID0gMTtcbiAgICAgICAgICAgIGZpZWxkMi5pZEJsb2NrLnRhZ051bWJlciA9IDI7XG4gICAgICAgICAgICBjb25zdCBiZXIyID0gZmllbGQyLnRvQkVSKGZhbHNlKTtcbiAgICAgICAgICAgIGNvbnN0IGludDIgPSBhc24xanMuZnJvbUJFUihiZXIyKTtcbiAgICAgICAgICAgIEFzbkVycm9yLmFzc2VydChpbnQyLCBcIkludGVnZXJcIik7XG4gICAgICAgICAgICB0aGlzLmluaGliaXRQb2xpY3lNYXBwaW5nID0gaW50Mi5yZXN1bHQudmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgaWYgKFJFUVVJUkVfRVhQTElDSVRfUE9MSUNZIGluIHRoaXMpIHtcbiAgICAgICAgICAgIGNvbnN0IGludDEgPSBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy5yZXF1aXJlRXhwbGljaXRQb2xpY3kgfSk7XG4gICAgICAgICAgICBpbnQxLmlkQmxvY2sudGFnQ2xhc3MgPSAzO1xuICAgICAgICAgICAgaW50MS5pZEJsb2NrLnRhZ051bWJlciA9IDA7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKGludDEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChJTkhJQklUX1BPTElDWV9NQVBQSU5HIGluIHRoaXMpIHtcbiAgICAgICAgICAgIGNvbnN0IGludDIgPSBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy5pbmhpYml0UG9saWN5TWFwcGluZyB9KTtcbiAgICAgICAgICAgIGludDIuaWRCbG9jay50YWdDbGFzcyA9IDM7XG4gICAgICAgICAgICBpbnQyLmlkQmxvY2sudGFnTnVtYmVyID0gMTtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2goaW50Mik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge307XG4gICAgICAgIGlmIChSRVFVSVJFX0VYUExJQ0lUX1BPTElDWSBpbiB0aGlzKSB7XG4gICAgICAgICAgICByZXMucmVxdWlyZUV4cGxpY2l0UG9saWN5ID0gdGhpcy5yZXF1aXJlRXhwbGljaXRQb2xpY3k7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKElOSElCSVRfUE9MSUNZX01BUFBJTkcgaW4gdGhpcykge1xuICAgICAgICAgICAgcmVzLmluaGliaXRQb2xpY3lNYXBwaW5nID0gdGhpcy5pbmhpYml0UG9saWN5TWFwcGluZztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbn1cblBvbGljeUNvbnN0cmFpbnRzLkNMQVNTX05BTUUgPSBcIlBvbGljeUNvbnN0cmFpbnRzXCI7XG5cbmNvbnN0IElTU1VFUl9ET01BSU5fUE9MSUNZID0gXCJpc3N1ZXJEb21haW5Qb2xpY3lcIjtcbmNvbnN0IFNVQkpFQ1RfRE9NQUlOX1BPTElDWSA9IFwic3ViamVjdERvbWFpblBvbGljeVwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkMWUgPSBbXG4gICAgSVNTVUVSX0RPTUFJTl9QT0xJQ1ksXG4gICAgU1VCSkVDVF9ET01BSU5fUE9MSUNZXG5dO1xuY2xhc3MgUG9saWN5TWFwcGluZyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuaXNzdWVyRG9tYWluUG9saWN5ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgSVNTVUVSX0RPTUFJTl9QT0xJQ1ksIFBvbGljeU1hcHBpbmcuZGVmYXVsdFZhbHVlcyhJU1NVRVJfRE9NQUlOX1BPTElDWSkpO1xuICAgICAgICB0aGlzLnN1YmplY3REb21haW5Qb2xpY3kgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTVUJKRUNUX0RPTUFJTl9QT0xJQ1ksIFBvbGljeU1hcHBpbmcuZGVmYXVsdFZhbHVlcyhTVUJKRUNUX0RPTUFJTl9QT0xJQ1kpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIElTU1VFUl9ET01BSU5fUE9MSUNZOlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9TVFJJTkc7XG4gICAgICAgICAgICBjYXNlIFNVQkpFQ1RfRE9NQUlOX1BPTElDWTpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfU1RSSU5HO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyBuYW1lOiAobmFtZXMuaXNzdWVyRG9tYWluUG9saWN5IHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgbmFtZTogKG5hbWVzLnN1YmplY3REb21haW5Qb2xpY3kgfHwgRU1QVFlfU1RSSU5HKSB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDFlKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBQb2xpY3lNYXBwaW5nLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGlzc3VlckRvbWFpblBvbGljeTogSVNTVUVSX0RPTUFJTl9QT0xJQ1ksXG4gICAgICAgICAgICAgICAgc3ViamVjdERvbWFpblBvbGljeTogU1VCSkVDVF9ET01BSU5fUE9MSUNZXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5pc3N1ZXJEb21haW5Qb2xpY3kgPSBhc24xLnJlc3VsdC5pc3N1ZXJEb21haW5Qb2xpY3kudmFsdWVCbG9jay50b1N0cmluZygpO1xuICAgICAgICB0aGlzLnN1YmplY3REb21haW5Qb2xpY3kgPSBhc24xLnJlc3VsdC5zdWJqZWN0RG9tYWluUG9saWN5LnZhbHVlQmxvY2sudG9TdHJpbmcoKTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLmlzc3VlckRvbWFpblBvbGljeSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyB2YWx1ZTogdGhpcy5zdWJqZWN0RG9tYWluUG9saWN5IH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaXNzdWVyRG9tYWluUG9saWN5OiB0aGlzLmlzc3VlckRvbWFpblBvbGljeSxcbiAgICAgICAgICAgIHN1YmplY3REb21haW5Qb2xpY3k6IHRoaXMuc3ViamVjdERvbWFpblBvbGljeVxuICAgICAgICB9O1xuICAgIH1cbn1cblBvbGljeU1hcHBpbmcuQ0xBU1NfTkFNRSA9IFwiUG9saWN5TWFwcGluZ1wiO1xuXG5jb25zdCBNQVBQSU5HUyA9IFwibWFwcGluZ3NcIjtcbmNvbnN0IENMRUFSX1BST1BTJDFkID0gW1xuICAgIE1BUFBJTkdTLFxuXTtcbmNsYXNzIFBvbGljeU1hcHBpbmdzIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5tYXBwaW5ncyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE1BUFBJTkdTLCBQb2xpY3lNYXBwaW5ncy5kZWZhdWx0VmFsdWVzKE1BUFBJTkdTKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBNQVBQSU5HUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUmVwZWF0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMubWFwcGluZ3MgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFBvbGljeU1hcHBpbmcuc2NoZW1hKClcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDFkKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBQb2xpY3lNYXBwaW5ncy5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBtYXBwaW5nczogTUFQUElOR1NcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLm1hcHBpbmdzID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdC5tYXBwaW5ncywgZWxlbWVudCA9PiBuZXcgUG9saWN5TWFwcGluZyh7IHNjaGVtYTogZWxlbWVudCB9KSk7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy5tYXBwaW5ncywgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbWFwcGluZ3M6IEFycmF5LmZyb20odGhpcy5tYXBwaW5ncywgbyA9PiBvLnRvSlNPTigpKVxuICAgICAgICB9O1xuICAgIH1cbn1cblBvbGljeU1hcHBpbmdzLkNMQVNTX05BTUUgPSBcIlBvbGljeU1hcHBpbmdzXCI7XG5cbmNvbnN0IE5PVF9CRUZPUkUkMSA9IFwibm90QmVmb3JlXCI7XG5jb25zdCBOT1RfQUZURVIkMSA9IFwibm90QWZ0ZXJcIjtcbmNvbnN0IENMRUFSX1BST1BTJDFjID0gW1xuICAgIE5PVF9CRUZPUkUkMSxcbiAgICBOT1RfQUZURVIkMVxuXTtcbmNsYXNzIFByaXZhdGVLZXlVc2FnZVBlcmlvZCBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIGlmIChOT1RfQkVGT1JFJDEgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5ub3RCZWZvcmUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBOT1RfQkVGT1JFJDEsIFByaXZhdGVLZXlVc2FnZVBlcmlvZC5kZWZhdWx0VmFsdWVzKE5PVF9CRUZPUkUkMSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOT1RfQUZURVIkMSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLm5vdEFmdGVyID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgTk9UX0FGVEVSJDEsIFByaXZhdGVLZXlVc2FnZVBlcmlvZC5kZWZhdWx0VmFsdWVzKE5PVF9BRlRFUiQxKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIE5PVF9CRUZPUkUkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoKTtcbiAgICAgICAgICAgIGNhc2UgTk9UX0FGVEVSJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLm5vdEJlZm9yZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLm5vdEFmdGVyIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQxYyk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgUHJpdmF0ZUtleVVzYWdlUGVyaW9kLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIG5vdEJlZm9yZTogTk9UX0JFRk9SRSQxLFxuICAgICAgICAgICAgICAgIG5vdEFmdGVyOiBOT1RfQUZURVIkMVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIGlmIChOT1RfQkVGT1JFJDEgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGxvY2FsTm90QmVmb3JlID0gbmV3IGFzbjFqcy5HZW5lcmFsaXplZFRpbWUoKTtcbiAgICAgICAgICAgIGxvY2FsTm90QmVmb3JlLmZyb21CdWZmZXIoYXNuMS5yZXN1bHQubm90QmVmb3JlLnZhbHVlQmxvY2sudmFsdWVIZXgpO1xuICAgICAgICAgICAgdGhpcy5ub3RCZWZvcmUgPSBsb2NhbE5vdEJlZm9yZS50b0RhdGUoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTk9UX0FGVEVSJDEgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGxvY2FsTm90QWZ0ZXIgPSBuZXcgYXNuMWpzLkdlbmVyYWxpemVkVGltZSh7IHZhbHVlSGV4OiBhc24xLnJlc3VsdC5ub3RBZnRlci52YWx1ZUJsb2NrLnZhbHVlSGV4IH0pO1xuICAgICAgICAgICAgbG9jYWxOb3RBZnRlci5mcm9tQnVmZmVyKGFzbjEucmVzdWx0Lm5vdEFmdGVyLnZhbHVlQmxvY2sudmFsdWVIZXgpO1xuICAgICAgICAgICAgdGhpcy5ub3RBZnRlciA9IGxvY2FsTm90QWZ0ZXIudG9EYXRlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgIGlmIChOT1RfQkVGT1JFJDEgaW4gdGhpcykge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZUhleDogKG5ldyBhc24xanMuR2VuZXJhbGl6ZWRUaW1lKHsgdmFsdWVEYXRlOiB0aGlzLm5vdEJlZm9yZSB9KSkudmFsdWVCbG9jay52YWx1ZUhleFZpZXdcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTk9UX0FGVEVSJDEgaW4gdGhpcykge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZUhleDogKG5ldyBhc24xanMuR2VuZXJhbGl6ZWRUaW1lKHsgdmFsdWVEYXRlOiB0aGlzLm5vdEFmdGVyIH0pKS52YWx1ZUJsb2NrLnZhbHVlSGV4Vmlld1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHt9O1xuICAgICAgICBpZiAodGhpcy5ub3RCZWZvcmUpIHtcbiAgICAgICAgICAgIHJlcy5ub3RCZWZvcmUgPSB0aGlzLm5vdEJlZm9yZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5ub3RBZnRlcikge1xuICAgICAgICAgICAgcmVzLm5vdEFmdGVyID0gdGhpcy5ub3RBZnRlcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbn1cblByaXZhdGVLZXlVc2FnZVBlcmlvZC5DTEFTU19OQU1FID0gXCJQcml2YXRlS2V5VXNhZ2VQZXJpb2RcIjtcblxuY29uc3QgSUQgPSBcImlkXCI7XG5jb25zdCBUWVBFJDIgPSBcInR5cGVcIjtcbmNvbnN0IFZBTFVFUyA9IFwidmFsdWVzXCI7XG5jb25zdCBRQ19TVEFURU1FTlRfQ0xFQVJfUFJPUFMgPSBbXG4gICAgSUQsXG4gICAgVFlQRSQyXG5dO1xuY29uc3QgUUNfU1RBVEVNRU5UU19DTEVBUl9QUk9QUyA9IFtcbiAgICBWQUxVRVNcbl07XG5jbGFzcyBRQ1N0YXRlbWVudCBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuaWQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBJRCwgUUNTdGF0ZW1lbnQuZGVmYXVsdFZhbHVlcyhJRCkpO1xuICAgICAgICBpZiAoVFlQRSQyIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMudHlwZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFRZUEUkMiwgUUNTdGF0ZW1lbnQuZGVmYXVsdFZhbHVlcyhUWVBFJDIpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgSUQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX1NUUklORztcbiAgICAgICAgICAgIGNhc2UgVFlQRSQyOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLk51bGwoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgSUQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gRU1QVFlfU1RSSU5HKTtcbiAgICAgICAgICAgIGNhc2UgVFlQRSQyOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgaW5zdGFuY2VvZiBhc24xanMuTnVsbCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IG5hbWU6IChuYW1lcy5pZCB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQW55KHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnR5cGUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIFFDX1NUQVRFTUVOVF9DTEVBUl9QUk9QUyk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgUUNTdGF0ZW1lbnQuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgaWQ6IElELFxuICAgICAgICAgICAgICAgIHR5cGU6IFRZUEUkMlxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuaWQgPSBhc24xLnJlc3VsdC5pZC52YWx1ZUJsb2NrLnRvU3RyaW5nKCk7XG4gICAgICAgIGlmIChUWVBFJDIgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLnR5cGUgPSBhc24xLnJlc3VsdC50eXBlO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBbXG4gICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyB2YWx1ZTogdGhpcy5pZCB9KVxuICAgICAgICBdO1xuICAgICAgICBpZiAoVFlQRSQyIGluIHRoaXMpXG4gICAgICAgICAgICB2YWx1ZS5wdXNoKHRoaXMudHlwZSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IG9iamVjdCA9IHtcbiAgICAgICAgICAgIGlkOiB0aGlzLmlkXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLnR5cGUpIHtcbiAgICAgICAgICAgIG9iamVjdC50eXBlID0gdGhpcy50eXBlLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvYmplY3Q7XG4gICAgfVxufVxuUUNTdGF0ZW1lbnQuQ0xBU1NfTkFNRSA9IFwiUUNTdGF0ZW1lbnRcIjtcbmNsYXNzIFFDU3RhdGVtZW50cyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudmFsdWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVkFMVUVTLCBRQ1N0YXRlbWVudHMuZGVmYXVsdFZhbHVlcyhWQUxVRVMpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFZBTFVFUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFZBTFVFUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUmVwZWF0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMudmFsdWVzIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBRQ1N0YXRlbWVudC5zY2hlbWEobmFtZXMudmFsdWUgfHwge30pXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgUUNfU1RBVEVNRU5UU19DTEVBUl9QUk9QUyk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgUUNTdGF0ZW1lbnRzLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIHZhbHVlczogVkFMVUVTXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy52YWx1ZXMgPSBBcnJheS5mcm9tKGFzbjEucmVzdWx0LnZhbHVlcywgZWxlbWVudCA9PiBuZXcgUUNTdGF0ZW1lbnQoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMudmFsdWVzLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2YWx1ZXM6IEFycmF5LmZyb20odGhpcy52YWx1ZXMsIG8gPT4gby50b0pTT04oKSlcbiAgICAgICAgfTtcbiAgICB9XG59XG5RQ1N0YXRlbWVudHMuQ0xBU1NfTkFNRSA9IFwiUUNTdGF0ZW1lbnRzXCI7XG5cbnZhciBfYTtcbmNsYXNzIEVDTmFtZWRDdXJ2ZXMge1xuICAgIHN0YXRpYyByZWdpc3RlcihuYW1lLCBpZCwgc2l6ZSkge1xuICAgICAgICB0aGlzLm5hbWVkQ3VydmVzW25hbWUudG9Mb3dlckNhc2UoKV0gPSB0aGlzLm5hbWVkQ3VydmVzW2lkXSA9IHsgbmFtZSwgaWQsIHNpemUgfTtcbiAgICB9XG4gICAgc3RhdGljIGZpbmQobmFtZU9ySWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmFtZWRDdXJ2ZXNbbmFtZU9ySWQudG9Mb3dlckNhc2UoKV0gfHwgbnVsbDtcbiAgICB9XG59XG5fYSA9IEVDTmFtZWRDdXJ2ZXM7XG5FQ05hbWVkQ3VydmVzLm5hbWVkQ3VydmVzID0ge307XG4oKCkgPT4ge1xuICAgIF9hLnJlZ2lzdGVyKFwiUC0yNTZcIiwgXCIxLjIuODQwLjEwMDQ1LjMuMS43XCIsIDMyKTtcbiAgICBfYS5yZWdpc3RlcihcIlAtMzg0XCIsIFwiMS4zLjEzMi4wLjM0XCIsIDQ4KTtcbiAgICBfYS5yZWdpc3RlcihcIlAtNTIxXCIsIFwiMS4zLjEzMi4wLjM1XCIsIDY2KTtcbiAgICBfYS5yZWdpc3RlcihcImJyYWlucG9vbFAyNTZyMVwiLCBcIjEuMy4zNi4zLjMuMi44LjEuMS43XCIsIDMyKTtcbiAgICBfYS5yZWdpc3RlcihcImJyYWlucG9vbFAzODRyMVwiLCBcIjEuMy4zNi4zLjMuMi44LjEuMS4xMVwiLCA0OCk7XG4gICAgX2EucmVnaXN0ZXIoXCJicmFpbnBvb2xQNTEycjFcIiwgXCIxLjMuMzYuMy4zLjIuOC4xLjEuMTNcIiwgNjQpO1xufSkoKTtcblxuY29uc3QgWCA9IFwieFwiO1xuY29uc3QgWSA9IFwieVwiO1xuY29uc3QgTkFNRURfQ1VSVkUkMSA9IFwibmFtZWRDdXJ2ZVwiO1xuY2xhc3MgRUNQdWJsaWNLZXkgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnggPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBYLCBFQ1B1YmxpY0tleS5kZWZhdWx0VmFsdWVzKFgpKTtcbiAgICAgICAgdGhpcy55ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgWSwgRUNQdWJsaWNLZXkuZGVmYXVsdFZhbHVlcyhZKSk7XG4gICAgICAgIHRoaXMubmFtZWRDdXJ2ZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE5BTUVEX0NVUlZFJDEsIEVDUHVibGljS2V5LmRlZmF1bHRWYWx1ZXMoTkFNRURfQ1VSVkUkMSkpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5qc29uKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21KU09OKHBhcmFtZXRlcnMuanNvbik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFg6XG4gICAgICAgICAgICBjYXNlIFk6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX0JVRkZFUjtcbiAgICAgICAgICAgIGNhc2UgTkFNRURfQ1VSVkUkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfU1RSSU5HO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBYOlxuICAgICAgICAgICAgY2FzZSBZOlxuICAgICAgICAgICAgICAgIHJldHVybiBtZW1iZXJWYWx1ZSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyICYmXG4gICAgICAgICAgICAgICAgICAgIChwdnV0aWxzLmlzRXF1YWxCdWZmZXIobWVtYmVyVmFsdWUsIEVDUHVibGljS2V5LmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkpKTtcbiAgICAgICAgICAgIGNhc2UgTkFNRURfQ1VSVkUkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gdHlwZW9mIG1lbWJlclZhbHVlID09PSBcInN0cmluZ1wiICYmXG4gICAgICAgICAgICAgICAgICAgIG1lbWJlclZhbHVlID09PSBFQ1B1YmxpY0tleS5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5SYXdEYXRhKCk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hMSkge1xuICAgICAgICBjb25zdCB2aWV3ID0gQnVmZmVyU291cmNlQ29udmVydGVyLnRvVWludDhBcnJheShzY2hlbWExKTtcbiAgICAgICAgaWYgKHZpZXdbMF0gIT09IDB4MDQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk9iamVjdCdzIHNjaGVtYSB3YXMgbm90IHZlcmlmaWVkIGFnYWluc3QgaW5wdXQgZGF0YSBmb3IgRUNQdWJsaWNLZXlcIik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbmFtZWRDdXJ2ZSA9IEVDTmFtZWRDdXJ2ZXMuZmluZCh0aGlzLm5hbWVkQ3VydmUpO1xuICAgICAgICBpZiAoIW5hbWVkQ3VydmUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5jb3JyZWN0IGN1cnZlIE9JRDogJHt0aGlzLm5hbWVkQ3VydmV9YCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY29vcmRpbmF0ZUxlbmd0aCA9IG5hbWVkQ3VydmUuc2l6ZTtcbiAgICAgICAgaWYgKHZpZXcuYnl0ZUxlbmd0aCAhPT0gKGNvb3JkaW5hdGVMZW5ndGggKiAyICsgMSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk9iamVjdCdzIHNjaGVtYSB3YXMgbm90IHZlcmlmaWVkIGFnYWluc3QgaW5wdXQgZGF0YSBmb3IgRUNQdWJsaWNLZXlcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uYW1lZEN1cnZlID0gbmFtZWRDdXJ2ZS5uYW1lO1xuICAgICAgICB0aGlzLnggPSB2aWV3LnNsaWNlKDEsIGNvb3JkaW5hdGVMZW5ndGggKyAxKS5idWZmZXI7XG4gICAgICAgIHRoaXMueSA9IHZpZXcuc2xpY2UoMSArIGNvb3JkaW5hdGVMZW5ndGgsIGNvb3JkaW5hdGVMZW5ndGggKiAyICsgMSkuYnVmZmVyO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuUmF3RGF0YSh7XG4gICAgICAgICAgICBkYXRhOiBwdnV0aWxzLnV0aWxDb25jYXRCdWYoKG5ldyBVaW50OEFycmF5KFsweDA0XSkpLmJ1ZmZlciwgdGhpcy54LCB0aGlzLnkpXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IG5hbWVkQ3VydmUgPSBFQ05hbWVkQ3VydmVzLmZpbmQodGhpcy5uYW1lZEN1cnZlKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNydjogbmFtZWRDdXJ2ZSA/IG5hbWVkQ3VydmUubmFtZSA6IHRoaXMubmFtZWRDdXJ2ZSxcbiAgICAgICAgICAgIHg6IHB2dXRpbHMudG9CYXNlNjQocHZ1dGlscy5hcnJheUJ1ZmZlclRvU3RyaW5nKHRoaXMueCksIHRydWUsIHRydWUsIGZhbHNlKSxcbiAgICAgICAgICAgIHk6IHB2dXRpbHMudG9CYXNlNjQocHZ1dGlscy5hcnJheUJ1ZmZlclRvU3RyaW5nKHRoaXMueSksIHRydWUsIHRydWUsIGZhbHNlKVxuICAgICAgICB9O1xuICAgIH1cbiAgICBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIFBhcmFtZXRlckVycm9yLmFzc2VydChcImpzb25cIiwganNvbiwgXCJjcnZcIiwgXCJ4XCIsIFwieVwiKTtcbiAgICAgICAgbGV0IGNvb3JkaW5hdGVMZW5ndGggPSAwO1xuICAgICAgICBjb25zdCBuYW1lZEN1cnZlID0gRUNOYW1lZEN1cnZlcy5maW5kKGpzb24uY3J2KTtcbiAgICAgICAgaWYgKG5hbWVkQ3VydmUpIHtcbiAgICAgICAgICAgIHRoaXMubmFtZWRDdXJ2ZSA9IG5hbWVkQ3VydmUuaWQ7XG4gICAgICAgICAgICBjb29yZGluYXRlTGVuZ3RoID0gbmFtZWRDdXJ2ZS5zaXplO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHhDb252ZXJ0QnVmZmVyID0gcHZ1dGlscy5zdHJpbmdUb0FycmF5QnVmZmVyKHB2dXRpbHMuZnJvbUJhc2U2NChqc29uLngsIHRydWUpKTtcbiAgICAgICAgaWYgKHhDb252ZXJ0QnVmZmVyLmJ5dGVMZW5ndGggPCBjb29yZGluYXRlTGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLnggPSBuZXcgQXJyYXlCdWZmZXIoY29vcmRpbmF0ZUxlbmd0aCk7XG4gICAgICAgICAgICBjb25zdCB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkodGhpcy54KTtcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnRCdWZmZXJWaWV3ID0gbmV3IFVpbnQ4QXJyYXkoeENvbnZlcnRCdWZmZXIpO1xuICAgICAgICAgICAgdmlldy5zZXQoY29udmVydEJ1ZmZlclZpZXcsIDEpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy54ID0geENvbnZlcnRCdWZmZXIuc2xpY2UoMCwgY29vcmRpbmF0ZUxlbmd0aCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgeUNvbnZlcnRCdWZmZXIgPSBwdnV0aWxzLnN0cmluZ1RvQXJyYXlCdWZmZXIocHZ1dGlscy5mcm9tQmFzZTY0KGpzb24ueSwgdHJ1ZSkpO1xuICAgICAgICBpZiAoeUNvbnZlcnRCdWZmZXIuYnl0ZUxlbmd0aCA8IGNvb3JkaW5hdGVMZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMueSA9IG5ldyBBcnJheUJ1ZmZlcihjb29yZGluYXRlTGVuZ3RoKTtcbiAgICAgICAgICAgIGNvbnN0IHZpZXcgPSBuZXcgVWludDhBcnJheSh0aGlzLnkpO1xuICAgICAgICAgICAgY29uc3QgY29udmVydEJ1ZmZlclZpZXcgPSBuZXcgVWludDhBcnJheSh5Q29udmVydEJ1ZmZlcik7XG4gICAgICAgICAgICB2aWV3LnNldChjb252ZXJ0QnVmZmVyVmlldywgMSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnkgPSB5Q29udmVydEJ1ZmZlci5zbGljZSgwLCBjb29yZGluYXRlTGVuZ3RoKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbkVDUHVibGljS2V5LkNMQVNTX05BTUUgPSBcIkVDUHVibGljS2V5XCI7XG5cbmNvbnN0IE1PRFVMVVMkMSA9IFwibW9kdWx1c1wiO1xuY29uc3QgUFVCTElDX0VYUE9ORU5UJDEgPSBcInB1YmxpY0V4cG9uZW50XCI7XG5jb25zdCBDTEVBUl9QUk9QUyQxYiA9IFtNT0RVTFVTJDEsIFBVQkxJQ19FWFBPTkVOVCQxXTtcbmNsYXNzIFJTQVB1YmxpY0tleSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMubW9kdWx1cyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE1PRFVMVVMkMSwgUlNBUHVibGljS2V5LmRlZmF1bHRWYWx1ZXMoTU9EVUxVUyQxKSk7XG4gICAgICAgIHRoaXMucHVibGljRXhwb25lbnQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBQVUJMSUNfRVhQT05FTlQkMSwgUlNBUHVibGljS2V5LmRlZmF1bHRWYWx1ZXMoUFVCTElDX0VYUE9ORU5UJDEpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuanNvbikge1xuICAgICAgICAgICAgdGhpcy5mcm9tSlNPTihwYXJhbWV0ZXJzLmpzb24pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBNT0RVTFVTJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuSW50ZWdlcigpO1xuICAgICAgICAgICAgY2FzZSBQVUJMSUNfRVhQT05FTlQkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5JbnRlZ2VyKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy5tb2R1bHVzIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLnB1YmxpY0V4cG9uZW50IHx8IEVNUFRZX1NUUklORykgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQxYik7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgUlNBUHVibGljS2V5LnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIG1vZHVsdXM6IE1PRFVMVVMkMSxcbiAgICAgICAgICAgICAgICBwdWJsaWNFeHBvbmVudDogUFVCTElDX0VYUE9ORU5UJDFcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLm1vZHVsdXMgPSBhc24xLnJlc3VsdC5tb2R1bHVzLmNvbnZlcnRGcm9tREVSKDI1Nik7XG4gICAgICAgIHRoaXMucHVibGljRXhwb25lbnQgPSBhc24xLnJlc3VsdC5wdWJsaWNFeHBvbmVudDtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIHRoaXMubW9kdWx1cy5jb252ZXJ0VG9ERVIoKSxcbiAgICAgICAgICAgICAgICB0aGlzLnB1YmxpY0V4cG9uZW50XG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbjogcHZ0c3V0aWxzLkNvbnZlcnQuVG9CYXNlNjRVcmwodGhpcy5tb2R1bHVzLnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3KSxcbiAgICAgICAgICAgIGU6IHB2dHN1dGlscy5Db252ZXJ0LlRvQmFzZTY0VXJsKHRoaXMucHVibGljRXhwb25lbnQudmFsdWVCbG9jay52YWx1ZUhleFZpZXcpLFxuICAgICAgICB9O1xuICAgIH1cbiAgICBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIFBhcmFtZXRlckVycm9yLmFzc2VydChcImpzb25cIiwganNvbiwgXCJuXCIsIFwiZVwiKTtcbiAgICAgICAgY29uc3QgYXJyYXkgPSBwdnV0aWxzLnN0cmluZ1RvQXJyYXlCdWZmZXIocHZ1dGlscy5mcm9tQmFzZTY0KGpzb24ubiwgdHJ1ZSkpO1xuICAgICAgICB0aGlzLm1vZHVsdXMgPSBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZUhleDogYXJyYXkuc2xpY2UoMCwgTWF0aC5wb3coMiwgcHZ1dGlscy5uZWFyZXN0UG93ZXJPZjIoYXJyYXkuYnl0ZUxlbmd0aCkpKSB9KTtcbiAgICAgICAgdGhpcy5wdWJsaWNFeHBvbmVudCA9IG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlSGV4OiBwdnV0aWxzLnN0cmluZ1RvQXJyYXlCdWZmZXIocHZ1dGlscy5mcm9tQmFzZTY0KGpzb24uZSwgdHJ1ZSkpLnNsaWNlKDAsIDMpIH0pO1xuICAgIH1cbn1cblJTQVB1YmxpY0tleS5DTEFTU19OQU1FID0gXCJSU0FQdWJsaWNLZXlcIjtcblxuY29uc3QgQUxHT1JJVEhNJDEgPSBcImFsZ29yaXRobVwiO1xuY29uc3QgU1VCSkVDVF9QVUJMSUNfS0VZID0gXCJzdWJqZWN0UHVibGljS2V5XCI7XG5jb25zdCBDTEVBUl9QUk9QUyQxYSA9IFtBTEdPUklUSE0kMSwgU1VCSkVDVF9QVUJMSUNfS0VZXTtcbmNsYXNzIFB1YmxpY0tleUluZm8gZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGdldCBwYXJzZWRLZXkoKSB7XG4gICAgICAgIGlmICh0aGlzLl9wYXJzZWRLZXkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgc3dpdGNoICh0aGlzLmFsZ29yaXRobS5hbGdvcml0aG1JZCkge1xuICAgICAgICAgICAgICAgIGNhc2UgXCIxLjIuODQwLjEwMDQ1LjIuMVwiOlxuICAgICAgICAgICAgICAgICAgICBpZiAoXCJhbGdvcml0aG1QYXJhbXNcIiBpbiB0aGlzLmFsZ29yaXRobSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcy5jb25zdHJ1Y3Rvci5ibG9ja05hbWUoKSA9PT0gYXNuMWpzLk9iamVjdElkZW50aWZpZXIuYmxvY2tOYW1lKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wYXJzZWRLZXkgPSBuZXcgRUNQdWJsaWNLZXkoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZWRDdXJ2ZTogdGhpcy5hbGdvcml0aG0uYWxnb3JpdGhtUGFyYW1zLnZhbHVlQmxvY2sudG9TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYTogdGhpcy5zdWJqZWN0UHVibGljS2V5LnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCIxLjIuODQwLjExMzU0OS4xLjEuMVwiOlxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwdWJsaWNLZXlBU04xID0gYXNuMWpzLmZyb21CRVIodGhpcy5zdWJqZWN0UHVibGljS2V5LnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwdWJsaWNLZXlBU04xLm9mZnNldCAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wYXJzZWRLZXkgPSBuZXcgUlNBUHVibGljS2V5KHsgc2NoZW1hOiBwdWJsaWNLZXlBU04xLnJlc3VsdCB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2gge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3BhcnNlZEtleSB8fCAodGhpcy5fcGFyc2VkS2V5ID0gbnVsbCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX3BhcnNlZEtleSB8fCB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHNldCBwYXJzZWRLZXkodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fcGFyc2VkS2V5ID0gdmFsdWU7XG4gICAgfVxuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmFsZ29yaXRobSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEFMR09SSVRITSQxLCBQdWJsaWNLZXlJbmZvLmRlZmF1bHRWYWx1ZXMoQUxHT1JJVEhNJDEpKTtcbiAgICAgICAgdGhpcy5zdWJqZWN0UHVibGljS2V5ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU1VCSkVDVF9QVUJMSUNfS0VZLCBQdWJsaWNLZXlJbmZvLmRlZmF1bHRWYWx1ZXMoU1VCSkVDVF9QVUJMSUNfS0VZKSk7XG4gICAgICAgIGNvbnN0IHBhcnNlZEtleSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwicGFyc2VkS2V5XCIsIG51bGwpO1xuICAgICAgICBpZiAocGFyc2VkS2V5KSB7XG4gICAgICAgICAgICB0aGlzLnBhcnNlZEtleSA9IHBhcnNlZEtleTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5qc29uKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21KU09OKHBhcmFtZXRlcnMuanNvbik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIEFMR09SSVRITSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcigpO1xuICAgICAgICAgICAgY2FzZSBTVUJKRUNUX1BVQkxJQ19LRVk6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuQml0U3RyaW5nKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIEFsZ29yaXRobUlkZW50aWZpZXIuc2NoZW1hKG5hbWVzLmFsZ29yaXRobSB8fCB7fSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5CaXRTdHJpbmcoeyBuYW1lOiAobmFtZXMuc3ViamVjdFB1YmxpY0tleSB8fCBFTVBUWV9TVFJJTkcpIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkMWEpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFB1YmxpY0tleUluZm8uc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IEFMR09SSVRITSQxXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHN1YmplY3RQdWJsaWNLZXk6IFNVQkpFQ1RfUFVCTElDX0tFWVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuYWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0LmFsZ29yaXRobSB9KTtcbiAgICAgICAgdGhpcy5zdWJqZWN0UHVibGljS2V5ID0gYXNuMS5yZXN1bHQuc3ViamVjdFB1YmxpY0tleTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIHRoaXMuYWxnb3JpdGhtLnRvU2NoZW1hKCksXG4gICAgICAgICAgICAgICAgdGhpcy5zdWJqZWN0UHVibGljS2V5XG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBpZiAoIXRoaXMucGFyc2VkS2V5KSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGFsZ29yaXRobTogdGhpcy5hbGdvcml0aG0udG9KU09OKCksXG4gICAgICAgICAgICAgICAgc3ViamVjdFB1YmxpY0tleTogdGhpcy5zdWJqZWN0UHVibGljS2V5LnRvSlNPTigpLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBqd2sgPSB7fTtcbiAgICAgICAgc3dpdGNoICh0aGlzLmFsZ29yaXRobS5hbGdvcml0aG1JZCkge1xuICAgICAgICAgICAgY2FzZSBcIjEuMi44NDAuMTAwNDUuMi4xXCI6XG4gICAgICAgICAgICAgICAgandrLmt0eSA9IFwiRUNcIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCIxLjIuODQwLjExMzU0OS4xLjEuMVwiOlxuICAgICAgICAgICAgICAgIGp3ay5rdHkgPSBcIlJTQVwiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHB1YmxpY0tleUpXSyA9IHRoaXMucGFyc2VkS2V5LnRvSlNPTigpO1xuICAgICAgICBPYmplY3QuYXNzaWduKGp3aywgcHVibGljS2V5SldLKTtcbiAgICAgICAgcmV0dXJuIGp3aztcbiAgICB9XG4gICAgZnJvbUpTT04oanNvbikge1xuICAgICAgICBpZiAoXCJrdHlcIiBpbiBqc29uKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKGpzb24ua3R5LnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwiRUNcIjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJzZWRLZXkgPSBuZXcgRUNQdWJsaWNLZXkoeyBqc29uIH0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFsZ29yaXRobSA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobUlkOiBcIjEuMi44NDAuMTAwNDUuMi4xXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1QYXJhbXM6IG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLnBhcnNlZEtleS5uYW1lZEN1cnZlIH0pXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwiUlNBXCI6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyc2VkS2V5ID0gbmV3IFJTQVB1YmxpY0tleSh7IGpzb24gfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoe1xuICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtSWQ6IFwiMS4yLjg0MC4xMTM1NDkuMS4xLjFcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogbmV3IGFzbjFqcy5OdWxsKClcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCB2YWx1ZSBmb3IgXCJrdHlcIiBwYXJhbWV0ZXI6ICR7anNvbi5rdHl9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnN1YmplY3RQdWJsaWNLZXkgPSBuZXcgYXNuMWpzLkJpdFN0cmluZyh7IHZhbHVlSGV4OiB0aGlzLnBhcnNlZEtleS50b1NjaGVtYSgpLnRvQkVSKGZhbHNlKSB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyBpbXBvcnRLZXkocHVibGljS2V5LCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICghcHVibGljS2V5KSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTmVlZCB0byBwcm92aWRlIHB1YmxpY0tleSBpbnB1dCBwYXJhbWV0ZXJcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBleHBvcnRlZEtleSA9IGF3YWl0IGNyeXB0by5leHBvcnRLZXkoXCJzcGtpXCIsIHB1YmxpY0tleSk7XG4gICAgICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmZyb21CRVIoZXhwb3J0ZWRLZXkpO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEoYXNuMS5yZXN1bHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2gge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkVycm9yIGR1cmluZyBpbml0aWFsaXppbmcgb2JqZWN0IGZyb20gc2NoZW1hXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlID0gZSBpbnN0YW5jZW9mIEVycm9yID8gZS5tZXNzYWdlIDogYCR7ZX1gO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciBkdXJpbmcgZXhwb3J0aW5nIHB1YmxpYyBrZXk6ICR7bWVzc2FnZX1gKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblB1YmxpY0tleUluZm8uQ0xBU1NfTkFNRSA9IFwiUHVibGljS2V5SW5mb1wiO1xuXG5jb25zdCBWRVJTSU9OJGwgPSBcInZlcnNpb25cIjtcbmNvbnN0IFBSSVZBVEVfS0VZJDEgPSBcInByaXZhdGVLZXlcIjtcbmNvbnN0IE5BTUVEX0NVUlZFID0gXCJuYW1lZEN1cnZlXCI7XG5jb25zdCBQVUJMSUNfS0VZJDEgPSBcInB1YmxpY0tleVwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkMTkgPSBbXG4gICAgVkVSU0lPTiRsLFxuICAgIFBSSVZBVEVfS0VZJDEsXG4gICAgTkFNRURfQ1VSVkUsXG4gICAgUFVCTElDX0tFWSQxXG5dO1xuY2xhc3MgRUNQcml2YXRlS2V5IGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVkVSU0lPTiRsLCBFQ1ByaXZhdGVLZXkuZGVmYXVsdFZhbHVlcyhWRVJTSU9OJGwpKTtcbiAgICAgICAgdGhpcy5wcml2YXRlS2V5ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUFJJVkFURV9LRVkkMSwgRUNQcml2YXRlS2V5LmRlZmF1bHRWYWx1ZXMoUFJJVkFURV9LRVkkMSkpO1xuICAgICAgICBpZiAoTkFNRURfQ1VSVkUgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5uYW1lZEN1cnZlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgTkFNRURfQ1VSVkUsIEVDUHJpdmF0ZUtleS5kZWZhdWx0VmFsdWVzKE5BTUVEX0NVUlZFKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFBVQkxJQ19LRVkkMSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnB1YmxpY0tleSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFBVQkxJQ19LRVkkMSwgRUNQcml2YXRlS2V5LmRlZmF1bHRWYWx1ZXMoUFVCTElDX0tFWSQxKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuanNvbikge1xuICAgICAgICAgICAgdGhpcy5mcm9tSlNPTihwYXJhbWV0ZXJzLmpzb24pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJGw6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICBjYXNlIFBSSVZBVEVfS0VZJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoKTtcbiAgICAgICAgICAgIGNhc2UgTkFNRURfQ1VSVkU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX1NUUklORztcbiAgICAgICAgICAgIGNhc2UgUFVCTElDX0tFWSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRUNQdWJsaWNLZXkoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkVSU0lPTiRsOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgPT09IEVDUHJpdmF0ZUtleS5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKTtcbiAgICAgICAgICAgIGNhc2UgUFJJVkFURV9LRVkkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmlzRXF1YWwoRUNQcml2YXRlS2V5LmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkpKTtcbiAgICAgICAgICAgIGNhc2UgTkFNRURfQ1VSVkU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gRU1QVFlfU1RSSU5HKTtcbiAgICAgICAgICAgIGNhc2UgUFVCTElDX0tFWSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKEVDUHVibGljS2V5LmNvbXBhcmVXaXRoRGVmYXVsdChOQU1FRF9DVVJWRSwgbWVtYmVyVmFsdWUubmFtZWRDdXJ2ZSkpICYmXG4gICAgICAgICAgICAgICAgICAgIChFQ1B1YmxpY0tleS5jb21wYXJlV2l0aERlZmF1bHQoXCJ4XCIsIG1lbWJlclZhbHVlLngpKSAmJlxuICAgICAgICAgICAgICAgICAgICAoRUNQdWJsaWNLZXkuY29tcGFyZVdpdGhEZWZhdWx0KFwieVwiLCBtZW1iZXJWYWx1ZS55KSkpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMudmVyc2lvbiB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyBuYW1lOiAobmFtZXMucHJpdmF0ZUtleSB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IG5hbWU6IChuYW1lcy5uYW1lZEN1cnZlIHx8IEVNUFRZX1NUUklORykgfSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQml0U3RyaW5nKHsgbmFtZTogKG5hbWVzLnB1YmxpY0tleSB8fCBFTVBUWV9TVFJJTkcpIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDE5KTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBFQ1ByaXZhdGVLZXkuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgdmVyc2lvbjogVkVSU0lPTiRsLFxuICAgICAgICAgICAgICAgIHByaXZhdGVLZXk6IFBSSVZBVEVfS0VZJDEsXG4gICAgICAgICAgICAgICAgbmFtZWRDdXJ2ZTogTkFNRURfQ1VSVkUsXG4gICAgICAgICAgICAgICAgcHVibGljS2V5OiBQVUJMSUNfS0VZJDFcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLnZlcnNpb24gPSBhc24xLnJlc3VsdC52ZXJzaW9uLnZhbHVlQmxvY2sudmFsdWVEZWM7XG4gICAgICAgIHRoaXMucHJpdmF0ZUtleSA9IGFzbjEucmVzdWx0LnByaXZhdGVLZXk7XG4gICAgICAgIGlmIChOQU1FRF9DVVJWRSBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5uYW1lZEN1cnZlID0gYXNuMS5yZXN1bHQubmFtZWRDdXJ2ZS52YWx1ZUJsb2NrLnRvU3RyaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFBVQkxJQ19LRVkkMSBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgY29uc3QgcHVibGljS2V5RGF0YSA9IHsgc2NoZW1hOiBhc24xLnJlc3VsdC5wdWJsaWNLZXkudmFsdWVCbG9jay52YWx1ZUhleCB9O1xuICAgICAgICAgICAgaWYgKE5BTUVEX0NVUlZFIGluIHRoaXMpIHtcbiAgICAgICAgICAgICAgICBwdWJsaWNLZXlEYXRhLm5hbWVkQ3VydmUgPSB0aGlzLm5hbWVkQ3VydmU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnB1YmxpY0tleSA9IG5ldyBFQ1B1YmxpY0tleShwdWJsaWNLZXlEYXRhKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXG4gICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy52ZXJzaW9uIH0pLFxuICAgICAgICAgICAgdGhpcy5wcml2YXRlS2V5XG4gICAgICAgIF07XG4gICAgICAgIGlmICh0aGlzLm5hbWVkQ3VydmUpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyB2YWx1ZTogdGhpcy5uYW1lZEN1cnZlIH0pXG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnB1YmxpY0tleSkge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQml0U3RyaW5nKHsgdmFsdWVIZXg6IHRoaXMucHVibGljS2V5LnRvU2NoZW1hKCkudG9CRVIoZmFsc2UpIH0pXG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBpZiAoIXRoaXMubmFtZWRDdXJ2ZSB8fCBFQ1ByaXZhdGVLZXkuY29tcGFyZVdpdGhEZWZhdWx0KE5BTUVEX0NVUlZFLCB0aGlzLm5hbWVkQ3VydmUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJOb3QgZW5vdWdoIGluZm9ybWF0aW9uIGZvciBtYWtpbmcgSlNPTjogYWJzZW50IFxcXCJuYW1lZEN1cnZlXFxcIiB2YWx1ZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjdXJ2ZSA9IEVDTmFtZWRDdXJ2ZXMuZmluZCh0aGlzLm5hbWVkQ3VydmUpO1xuICAgICAgICBjb25zdCBwcml2YXRlS2V5SlNPTiA9IHtcbiAgICAgICAgICAgIGNydjogY3VydmUgPyBjdXJ2ZS5uYW1lIDogdGhpcy5uYW1lZEN1cnZlLFxuICAgICAgICAgICAgZDogcHZ0c3V0aWxzLkNvbnZlcnQuVG9CYXNlNjRVcmwodGhpcy5wcml2YXRlS2V5LnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3KSxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMucHVibGljS2V5KSB7XG4gICAgICAgICAgICBjb25zdCBwdWJsaWNLZXlKU09OID0gdGhpcy5wdWJsaWNLZXkudG9KU09OKCk7XG4gICAgICAgICAgICBwcml2YXRlS2V5SlNPTi54ID0gcHVibGljS2V5SlNPTi54O1xuICAgICAgICAgICAgcHJpdmF0ZUtleUpTT04ueSA9IHB1YmxpY0tleUpTT04ueTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHJpdmF0ZUtleUpTT047XG4gICAgfVxuICAgIGZyb21KU09OKGpzb24pIHtcbiAgICAgICAgUGFyYW1ldGVyRXJyb3IuYXNzZXJ0KFwianNvblwiLCBqc29uLCBcImNydlwiLCBcImRcIik7XG4gICAgICAgIGxldCBjb29yZGluYXRlTGVuZ3RoID0gMDtcbiAgICAgICAgY29uc3QgY3VydmUgPSBFQ05hbWVkQ3VydmVzLmZpbmQoanNvbi5jcnYpO1xuICAgICAgICBpZiAoY3VydmUpIHtcbiAgICAgICAgICAgIHRoaXMubmFtZWRDdXJ2ZSA9IGN1cnZlLmlkO1xuICAgICAgICAgICAgY29vcmRpbmF0ZUxlbmd0aCA9IGN1cnZlLnNpemU7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY29udmVydEJ1ZmZlciA9IHB2dHN1dGlscy5Db252ZXJ0LkZyb21CYXNlNjRVcmwoanNvbi5kKTtcbiAgICAgICAgaWYgKGNvbnZlcnRCdWZmZXIuYnl0ZUxlbmd0aCA8IGNvb3JkaW5hdGVMZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IGJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcihjb29yZGluYXRlTGVuZ3RoKTtcbiAgICAgICAgICAgIGNvbnN0IHZpZXcgPSBuZXcgVWludDhBcnJheShidWZmZXIpO1xuICAgICAgICAgICAgY29uc3QgY29udmVydEJ1ZmZlclZpZXcgPSBuZXcgVWludDhBcnJheShjb252ZXJ0QnVmZmVyKTtcbiAgICAgICAgICAgIHZpZXcuc2V0KGNvbnZlcnRCdWZmZXJWaWV3LCAxKTtcbiAgICAgICAgICAgIHRoaXMucHJpdmF0ZUtleSA9IG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyB2YWx1ZUhleDogYnVmZmVyIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5wcml2YXRlS2V5ID0gbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiBjb252ZXJ0QnVmZmVyLnNsaWNlKDAsIGNvb3JkaW5hdGVMZW5ndGgpIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChqc29uLnggJiYganNvbi55KSB7XG4gICAgICAgICAgICB0aGlzLnB1YmxpY0tleSA9IG5ldyBFQ1B1YmxpY0tleSh7IGpzb24gfSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5FQ1ByaXZhdGVLZXkuQ0xBU1NfTkFNRSA9IFwiRUNQcml2YXRlS2V5XCI7XG5cbmNvbnN0IFBSSU1FID0gXCJwcmltZVwiO1xuY29uc3QgRVhQT05FTlQgPSBcImV4cG9uZW50XCI7XG5jb25zdCBDT0VGRklDSUVOVCQxID0gXCJjb2VmZmljaWVudFwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkMTggPSBbXG4gICAgUFJJTUUsXG4gICAgRVhQT05FTlQsXG4gICAgQ09FRkZJQ0lFTlQkMSxcbl07XG5jbGFzcyBPdGhlclByaW1lSW5mbyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMucHJpbWUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBQUklNRSwgT3RoZXJQcmltZUluZm8uZGVmYXVsdFZhbHVlcyhQUklNRSkpO1xuICAgICAgICB0aGlzLmV4cG9uZW50ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgRVhQT05FTlQsIE90aGVyUHJpbWVJbmZvLmRlZmF1bHRWYWx1ZXMoRVhQT05FTlQpKTtcbiAgICAgICAgdGhpcy5jb2VmZmljaWVudCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIENPRUZGSUNJRU5UJDEsIE90aGVyUHJpbWVJbmZvLmRlZmF1bHRWYWx1ZXMoQ09FRkZJQ0lFTlQkMSkpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5qc29uKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21KU09OKHBhcmFtZXRlcnMuanNvbik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFBSSU1FOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkludGVnZXIoKTtcbiAgICAgICAgICAgIGNhc2UgRVhQT05FTlQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuSW50ZWdlcigpO1xuICAgICAgICAgICAgY2FzZSBDT0VGRklDSUVOVCQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkludGVnZXIoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLnByaW1lIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLmV4cG9uZW50IHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLmNvZWZmaWNpZW50IHx8IEVNUFRZX1NUUklORykgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQxOCk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgT3RoZXJQcmltZUluZm8uc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgcHJpbWU6IFBSSU1FLFxuICAgICAgICAgICAgICAgIGV4cG9uZW50OiBFWFBPTkVOVCxcbiAgICAgICAgICAgICAgICBjb2VmZmljaWVudDogQ09FRkZJQ0lFTlQkMVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMucHJpbWUgPSBhc24xLnJlc3VsdC5wcmltZS5jb252ZXJ0RnJvbURFUigpO1xuICAgICAgICB0aGlzLmV4cG9uZW50ID0gYXNuMS5yZXN1bHQuZXhwb25lbnQuY29udmVydEZyb21ERVIoKTtcbiAgICAgICAgdGhpcy5jb2VmZmljaWVudCA9IGFzbjEucmVzdWx0LmNvZWZmaWNpZW50LmNvbnZlcnRGcm9tREVSKCk7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICB0aGlzLnByaW1lLmNvbnZlcnRUb0RFUigpLFxuICAgICAgICAgICAgICAgIHRoaXMuZXhwb25lbnQuY29udmVydFRvREVSKCksXG4gICAgICAgICAgICAgICAgdGhpcy5jb2VmZmljaWVudC5jb252ZXJ0VG9ERVIoKVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHI6IHB2dHN1dGlscy5Db252ZXJ0LlRvQmFzZTY0VXJsKHRoaXMucHJpbWUudmFsdWVCbG9jay52YWx1ZUhleFZpZXcpLFxuICAgICAgICAgICAgZDogcHZ0c3V0aWxzLkNvbnZlcnQuVG9CYXNlNjRVcmwodGhpcy5leHBvbmVudC52YWx1ZUJsb2NrLnZhbHVlSGV4VmlldyksXG4gICAgICAgICAgICB0OiBwdnRzdXRpbHMuQ29udmVydC5Ub0Jhc2U2NFVybCh0aGlzLmNvZWZmaWNpZW50LnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3KSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZnJvbUpTT04oanNvbikge1xuICAgICAgICBQYXJhbWV0ZXJFcnJvci5hc3NlcnQoXCJqc29uXCIsIGpzb24sIFwiclwiLCBcImRcIiwgXCJyXCIpO1xuICAgICAgICB0aGlzLnByaW1lID0gbmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWVIZXg6IHB2dHN1dGlscy5Db252ZXJ0LkZyb21CYXNlNjRVcmwoanNvbi5yKSB9KTtcbiAgICAgICAgdGhpcy5leHBvbmVudCA9IG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlSGV4OiBwdnRzdXRpbHMuQ29udmVydC5Gcm9tQmFzZTY0VXJsKGpzb24uZCkgfSk7XG4gICAgICAgIHRoaXMuY29lZmZpY2llbnQgPSBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZUhleDogcHZ0c3V0aWxzLkNvbnZlcnQuRnJvbUJhc2U2NFVybChqc29uLnQpIH0pO1xuICAgIH1cbn1cbk90aGVyUHJpbWVJbmZvLkNMQVNTX05BTUUgPSBcIk90aGVyUHJpbWVJbmZvXCI7XG5cbmNvbnN0IFZFUlNJT04kayA9IFwidmVyc2lvblwiO1xuY29uc3QgTU9EVUxVUyA9IFwibW9kdWx1c1wiO1xuY29uc3QgUFVCTElDX0VYUE9ORU5UID0gXCJwdWJsaWNFeHBvbmVudFwiO1xuY29uc3QgUFJJVkFURV9FWFBPTkVOVCA9IFwicHJpdmF0ZUV4cG9uZW50XCI7XG5jb25zdCBQUklNRTEgPSBcInByaW1lMVwiO1xuY29uc3QgUFJJTUUyID0gXCJwcmltZTJcIjtcbmNvbnN0IEVYUE9ORU5UMSA9IFwiZXhwb25lbnQxXCI7XG5jb25zdCBFWFBPTkVOVDIgPSBcImV4cG9uZW50MlwiO1xuY29uc3QgQ09FRkZJQ0lFTlQgPSBcImNvZWZmaWNpZW50XCI7XG5jb25zdCBPVEhFUl9QUklNRV9JTkZPUyA9IFwib3RoZXJQcmltZUluZm9zXCI7XG5jb25zdCBDTEVBUl9QUk9QUyQxNyA9IFtcbiAgICBWRVJTSU9OJGssXG4gICAgTU9EVUxVUyxcbiAgICBQVUJMSUNfRVhQT05FTlQsXG4gICAgUFJJVkFURV9FWFBPTkVOVCxcbiAgICBQUklNRTEsXG4gICAgUFJJTUUyLFxuICAgIEVYUE9ORU5UMSxcbiAgICBFWFBPTkVOVDIsXG4gICAgQ09FRkZJQ0lFTlQsXG4gICAgT1RIRVJfUFJJTUVfSU5GT1Ncbl07XG5jbGFzcyBSU0FQcml2YXRlS2V5IGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVkVSU0lPTiRrLCBSU0FQcml2YXRlS2V5LmRlZmF1bHRWYWx1ZXMoVkVSU0lPTiRrKSk7XG4gICAgICAgIHRoaXMubW9kdWx1cyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE1PRFVMVVMsIFJTQVByaXZhdGVLZXkuZGVmYXVsdFZhbHVlcyhNT0RVTFVTKSk7XG4gICAgICAgIHRoaXMucHVibGljRXhwb25lbnQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBQVUJMSUNfRVhQT05FTlQsIFJTQVByaXZhdGVLZXkuZGVmYXVsdFZhbHVlcyhQVUJMSUNfRVhQT05FTlQpKTtcbiAgICAgICAgdGhpcy5wcml2YXRlRXhwb25lbnQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBQUklWQVRFX0VYUE9ORU5ULCBSU0FQcml2YXRlS2V5LmRlZmF1bHRWYWx1ZXMoUFJJVkFURV9FWFBPTkVOVCkpO1xuICAgICAgICB0aGlzLnByaW1lMSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFBSSU1FMSwgUlNBUHJpdmF0ZUtleS5kZWZhdWx0VmFsdWVzKFBSSU1FMSkpO1xuICAgICAgICB0aGlzLnByaW1lMiA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFBSSU1FMiwgUlNBUHJpdmF0ZUtleS5kZWZhdWx0VmFsdWVzKFBSSU1FMikpO1xuICAgICAgICB0aGlzLmV4cG9uZW50MSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEVYUE9ORU5UMSwgUlNBUHJpdmF0ZUtleS5kZWZhdWx0VmFsdWVzKEVYUE9ORU5UMSkpO1xuICAgICAgICB0aGlzLmV4cG9uZW50MiA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEVYUE9ORU5UMiwgUlNBUHJpdmF0ZUtleS5kZWZhdWx0VmFsdWVzKEVYUE9ORU5UMikpO1xuICAgICAgICB0aGlzLmNvZWZmaWNpZW50ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQ09FRkZJQ0lFTlQsIFJTQVByaXZhdGVLZXkuZGVmYXVsdFZhbHVlcyhDT0VGRklDSUVOVCkpO1xuICAgICAgICBpZiAoT1RIRVJfUFJJTUVfSU5GT1MgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5vdGhlclByaW1lSW5mb3MgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBPVEhFUl9QUklNRV9JTkZPUywgUlNBUHJpdmF0ZUtleS5kZWZhdWx0VmFsdWVzKE9USEVSX1BSSU1FX0lORk9TKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuanNvbikge1xuICAgICAgICAgICAgdGhpcy5mcm9tSlNPTihwYXJhbWV0ZXJzLmpzb24pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJGs6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICBjYXNlIE1PRFVMVVM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuSW50ZWdlcigpO1xuICAgICAgICAgICAgY2FzZSBQVUJMSUNfRVhQT05FTlQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuSW50ZWdlcigpO1xuICAgICAgICAgICAgY2FzZSBQUklWQVRFX0VYUE9ORU5UOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkludGVnZXIoKTtcbiAgICAgICAgICAgIGNhc2UgUFJJTUUxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkludGVnZXIoKTtcbiAgICAgICAgICAgIGNhc2UgUFJJTUUyOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkludGVnZXIoKTtcbiAgICAgICAgICAgIGNhc2UgRVhQT05FTlQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkludGVnZXIoKTtcbiAgICAgICAgICAgIGNhc2UgRVhQT05FTlQyOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkludGVnZXIoKTtcbiAgICAgICAgICAgIGNhc2UgQ09FRkZJQ0lFTlQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuSW50ZWdlcigpO1xuICAgICAgICAgICAgY2FzZSBPVEhFUl9QUklNRV9JTkZPUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy52ZXJzaW9uIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLm1vZHVsdXMgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMucHVibGljRXhwb25lbnQgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMucHJpdmF0ZUV4cG9uZW50IHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLnByaW1lMSB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy5wcmltZTIgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMuZXhwb25lbnQxIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLmV4cG9uZW50MiB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy5jb2VmZmljaWVudCB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUmVwZWF0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5vdGhlclByaW1lSW5mb3NOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IE90aGVyUHJpbWVJbmZvLnNjaGVtYShuYW1lcy5vdGhlclByaW1lSW5mbyB8fCB7fSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDE3KTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBSU0FQcml2YXRlS2V5LnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIHZlcnNpb246IFZFUlNJT04kayxcbiAgICAgICAgICAgICAgICBtb2R1bHVzOiBNT0RVTFVTLFxuICAgICAgICAgICAgICAgIHB1YmxpY0V4cG9uZW50OiBQVUJMSUNfRVhQT05FTlQsXG4gICAgICAgICAgICAgICAgcHJpdmF0ZUV4cG9uZW50OiBQUklWQVRFX0VYUE9ORU5ULFxuICAgICAgICAgICAgICAgIHByaW1lMTogUFJJTUUxLFxuICAgICAgICAgICAgICAgIHByaW1lMjogUFJJTUUyLFxuICAgICAgICAgICAgICAgIGV4cG9uZW50MTogRVhQT05FTlQxLFxuICAgICAgICAgICAgICAgIGV4cG9uZW50MjogRVhQT05FTlQyLFxuICAgICAgICAgICAgICAgIGNvZWZmaWNpZW50OiBDT0VGRklDSUVOVCxcbiAgICAgICAgICAgICAgICBvdGhlclByaW1lSW5mbzoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBPVEhFUl9QUklNRV9JTkZPU1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IGFzbjEucmVzdWx0LnZlcnNpb24udmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgdGhpcy5tb2R1bHVzID0gYXNuMS5yZXN1bHQubW9kdWx1cy5jb252ZXJ0RnJvbURFUigyNTYpO1xuICAgICAgICB0aGlzLnB1YmxpY0V4cG9uZW50ID0gYXNuMS5yZXN1bHQucHVibGljRXhwb25lbnQ7XG4gICAgICAgIHRoaXMucHJpdmF0ZUV4cG9uZW50ID0gYXNuMS5yZXN1bHQucHJpdmF0ZUV4cG9uZW50LmNvbnZlcnRGcm9tREVSKDI1Nik7XG4gICAgICAgIHRoaXMucHJpbWUxID0gYXNuMS5yZXN1bHQucHJpbWUxLmNvbnZlcnRGcm9tREVSKDEyOCk7XG4gICAgICAgIHRoaXMucHJpbWUyID0gYXNuMS5yZXN1bHQucHJpbWUyLmNvbnZlcnRGcm9tREVSKDEyOCk7XG4gICAgICAgIHRoaXMuZXhwb25lbnQxID0gYXNuMS5yZXN1bHQuZXhwb25lbnQxLmNvbnZlcnRGcm9tREVSKDEyOCk7XG4gICAgICAgIHRoaXMuZXhwb25lbnQyID0gYXNuMS5yZXN1bHQuZXhwb25lbnQyLmNvbnZlcnRGcm9tREVSKDEyOCk7XG4gICAgICAgIHRoaXMuY29lZmZpY2llbnQgPSBhc24xLnJlc3VsdC5jb2VmZmljaWVudC5jb252ZXJ0RnJvbURFUigxMjgpO1xuICAgICAgICBpZiAoT1RIRVJfUFJJTUVfSU5GT1MgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLm90aGVyUHJpbWVJbmZvcyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHQub3RoZXJQcmltZUluZm9zLCBlbGVtZW50ID0+IG5ldyBPdGhlclByaW1lSW5mbyh7IHNjaGVtYTogZWxlbWVudCB9KSk7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlOiB0aGlzLnZlcnNpb24gfSkpO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMubW9kdWx1cy5jb252ZXJ0VG9ERVIoKSk7XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5wdWJsaWNFeHBvbmVudCk7XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5wcml2YXRlRXhwb25lbnQuY29udmVydFRvREVSKCkpO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMucHJpbWUxLmNvbnZlcnRUb0RFUigpKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnByaW1lMi5jb252ZXJ0VG9ERVIoKSk7XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5leHBvbmVudDEuY29udmVydFRvREVSKCkpO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMuZXhwb25lbnQyLmNvbnZlcnRUb0RFUigpKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLmNvZWZmaWNpZW50LmNvbnZlcnRUb0RFUigpKTtcbiAgICAgICAgaWYgKHRoaXMub3RoZXJQcmltZUluZm9zKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMub3RoZXJQcmltZUluZm9zLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCBqd2sgPSB7XG4gICAgICAgICAgICBuOiBwdnRzdXRpbHMuQ29udmVydC5Ub0Jhc2U2NFVybCh0aGlzLm1vZHVsdXMudmFsdWVCbG9jay52YWx1ZUhleFZpZXcpLFxuICAgICAgICAgICAgZTogcHZ0c3V0aWxzLkNvbnZlcnQuVG9CYXNlNjRVcmwodGhpcy5wdWJsaWNFeHBvbmVudC52YWx1ZUJsb2NrLnZhbHVlSGV4VmlldyksXG4gICAgICAgICAgICBkOiBwdnRzdXRpbHMuQ29udmVydC5Ub0Jhc2U2NFVybCh0aGlzLnByaXZhdGVFeHBvbmVudC52YWx1ZUJsb2NrLnZhbHVlSGV4VmlldyksXG4gICAgICAgICAgICBwOiBwdnRzdXRpbHMuQ29udmVydC5Ub0Jhc2U2NFVybCh0aGlzLnByaW1lMS52YWx1ZUJsb2NrLnZhbHVlSGV4VmlldyksXG4gICAgICAgICAgICBxOiBwdnRzdXRpbHMuQ29udmVydC5Ub0Jhc2U2NFVybCh0aGlzLnByaW1lMi52YWx1ZUJsb2NrLnZhbHVlSGV4VmlldyksXG4gICAgICAgICAgICBkcDogcHZ0c3V0aWxzLkNvbnZlcnQuVG9CYXNlNjRVcmwodGhpcy5leHBvbmVudDEudmFsdWVCbG9jay52YWx1ZUhleFZpZXcpLFxuICAgICAgICAgICAgZHE6IHB2dHN1dGlscy5Db252ZXJ0LlRvQmFzZTY0VXJsKHRoaXMuZXhwb25lbnQyLnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3KSxcbiAgICAgICAgICAgIHFpOiBwdnRzdXRpbHMuQ29udmVydC5Ub0Jhc2U2NFVybCh0aGlzLmNvZWZmaWNpZW50LnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3KSxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMub3RoZXJQcmltZUluZm9zKSB7XG4gICAgICAgICAgICBqd2sub3RoID0gQXJyYXkuZnJvbSh0aGlzLm90aGVyUHJpbWVJbmZvcywgbyA9PiBvLnRvSlNPTigpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gandrO1xuICAgIH1cbiAgICBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIFBhcmFtZXRlckVycm9yLmFzc2VydChcImpzb25cIiwganNvbiwgXCJuXCIsIFwiZVwiLCBcImRcIiwgXCJwXCIsIFwicVwiLCBcImRwXCIsIFwiZHFcIiwgXCJxaVwiKTtcbiAgICAgICAgdGhpcy5tb2R1bHVzID0gbmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWVIZXg6IHB2dHN1dGlscy5Db252ZXJ0LkZyb21CYXNlNjRVcmwoanNvbi5uKSB9KTtcbiAgICAgICAgdGhpcy5wdWJsaWNFeHBvbmVudCA9IG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlSGV4OiBwdnRzdXRpbHMuQ29udmVydC5Gcm9tQmFzZTY0VXJsKGpzb24uZSkgfSk7XG4gICAgICAgIHRoaXMucHJpdmF0ZUV4cG9uZW50ID0gbmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWVIZXg6IHB2dHN1dGlscy5Db252ZXJ0LkZyb21CYXNlNjRVcmwoanNvbi5kKSB9KTtcbiAgICAgICAgdGhpcy5wcmltZTEgPSBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZUhleDogcHZ0c3V0aWxzLkNvbnZlcnQuRnJvbUJhc2U2NFVybChqc29uLnApIH0pO1xuICAgICAgICB0aGlzLnByaW1lMiA9IG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlSGV4OiBwdnRzdXRpbHMuQ29udmVydC5Gcm9tQmFzZTY0VXJsKGpzb24ucSkgfSk7XG4gICAgICAgIHRoaXMuZXhwb25lbnQxID0gbmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWVIZXg6IHB2dHN1dGlscy5Db252ZXJ0LkZyb21CYXNlNjRVcmwoanNvbi5kcCkgfSk7XG4gICAgICAgIHRoaXMuZXhwb25lbnQyID0gbmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWVIZXg6IHB2dHN1dGlscy5Db252ZXJ0LkZyb21CYXNlNjRVcmwoanNvbi5kcSkgfSk7XG4gICAgICAgIHRoaXMuY29lZmZpY2llbnQgPSBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZUhleDogcHZ0c3V0aWxzLkNvbnZlcnQuRnJvbUJhc2U2NFVybChqc29uLnFpKSB9KTtcbiAgICAgICAgaWYgKGpzb24ub3RoKSB7XG4gICAgICAgICAgICB0aGlzLm90aGVyUHJpbWVJbmZvcyA9IEFycmF5LmZyb20oanNvbi5vdGgsIChlbGVtZW50KSA9PiBuZXcgT3RoZXJQcmltZUluZm8oeyBqc29uOiBlbGVtZW50IH0pKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblJTQVByaXZhdGVLZXkuQ0xBU1NfTkFNRSA9IFwiUlNBUHJpdmF0ZUtleVwiO1xuXG5jb25zdCBWRVJTSU9OJGogPSBcInZlcnNpb25cIjtcbmNvbnN0IFBSSVZBVEVfS0VZX0FMR09SSVRITSA9IFwicHJpdmF0ZUtleUFsZ29yaXRobVwiO1xuY29uc3QgUFJJVkFURV9LRVkgPSBcInByaXZhdGVLZXlcIjtcbmNvbnN0IEFUVFJJQlVURVMkNSA9IFwiYXR0cmlidXRlc1wiO1xuY29uc3QgUEFSU0VEX0tFWSA9IFwicGFyc2VkS2V5XCI7XG5jb25zdCBDTEVBUl9QUk9QUyQxNiA9IFtcbiAgICBWRVJTSU9OJGosXG4gICAgUFJJVkFURV9LRVlfQUxHT1JJVEhNLFxuICAgIFBSSVZBVEVfS0VZLFxuICAgIEFUVFJJQlVURVMkNVxuXTtcbmNsYXNzIFByaXZhdGVLZXlJbmZvIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVkVSU0lPTiRqLCBQcml2YXRlS2V5SW5mby5kZWZhdWx0VmFsdWVzKFZFUlNJT04kaikpO1xuICAgICAgICB0aGlzLnByaXZhdGVLZXlBbGdvcml0aG0gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBQUklWQVRFX0tFWV9BTEdPUklUSE0sIFByaXZhdGVLZXlJbmZvLmRlZmF1bHRWYWx1ZXMoUFJJVkFURV9LRVlfQUxHT1JJVEhNKSk7XG4gICAgICAgIHRoaXMucHJpdmF0ZUtleSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFBSSVZBVEVfS0VZLCBQcml2YXRlS2V5SW5mby5kZWZhdWx0VmFsdWVzKFBSSVZBVEVfS0VZKSk7XG4gICAgICAgIGlmIChBVFRSSUJVVEVTJDUgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQVRUUklCVVRFUyQ1LCBQcml2YXRlS2V5SW5mby5kZWZhdWx0VmFsdWVzKEFUVFJJQlVURVMkNSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChQQVJTRURfS0VZIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMucGFyc2VkS2V5ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUEFSU0VEX0tFWSwgUHJpdmF0ZUtleUluZm8uZGVmYXVsdFZhbHVlcyhQQVJTRURfS0VZKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuanNvbikge1xuICAgICAgICAgICAgdGhpcy5mcm9tSlNPTihwYXJhbWV0ZXJzLmpzb24pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJGo6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICBjYXNlIFBSSVZBVEVfS0VZX0FMR09SSVRITTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgUFJJVkFURV9LRVk6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoKTtcbiAgICAgICAgICAgIGNhc2UgQVRUUklCVVRFUyQ1OlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGNhc2UgUEFSU0VEX0tFWTpcbiAgICAgICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy52ZXJzaW9uIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMucHJpdmF0ZUtleUFsZ29yaXRobSB8fCB7fSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IG5hbWU6IChuYW1lcy5wcml2YXRlS2V5IHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmF0dHJpYnV0ZXMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQXR0cmlidXRlLnNjaGVtYSgpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQxNik7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgUHJpdmF0ZUtleUluZm8uc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgdmVyc2lvbjogVkVSU0lPTiRqLFxuICAgICAgICAgICAgICAgIHByaXZhdGVLZXlBbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogUFJJVkFURV9LRVlfQUxHT1JJVEhNXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHByaXZhdGVLZXk6IFBSSVZBVEVfS0VZLFxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IEFUVFJJQlVURVMkNVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IGFzbjEucmVzdWx0LnZlcnNpb24udmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgdGhpcy5wcml2YXRlS2V5QWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0LnByaXZhdGVLZXlBbGdvcml0aG0gfSk7XG4gICAgICAgIHRoaXMucHJpdmF0ZUtleSA9IGFzbjEucmVzdWx0LnByaXZhdGVLZXk7XG4gICAgICAgIGlmIChBVFRSSUJVVEVTJDUgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMgPSBBcnJheS5mcm9tKGFzbjEucmVzdWx0LmF0dHJpYnV0ZXMsIGVsZW1lbnQgPT4gbmV3IEF0dHJpYnV0ZSh7IHNjaGVtYTogZWxlbWVudCB9KSk7XG4gICAgICAgIHN3aXRjaCAodGhpcy5wcml2YXRlS2V5QWxnb3JpdGhtLmFsZ29yaXRobUlkKSB7XG4gICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMTM1NDkuMS4xLjFcIjpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHByaXZhdGVLZXlBU04xID0gYXNuMWpzLmZyb21CRVIodGhpcy5wcml2YXRlS2V5LnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByaXZhdGVLZXlBU04xLm9mZnNldCAhPT0gLTEpXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcnNlZEtleSA9IG5ldyBSU0FQcml2YXRlS2V5KHsgc2NoZW1hOiBwcml2YXRlS2V5QVNOMS5yZXN1bHQgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIjEuMi44NDAuMTAwNDUuMi4xXCI6XG4gICAgICAgICAgICAgICAgaWYgKFwiYWxnb3JpdGhtUGFyYW1zXCIgaW4gdGhpcy5wcml2YXRlS2V5QWxnb3JpdGhtKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnByaXZhdGVLZXlBbGdvcml0aG0uYWxnb3JpdGhtUGFyYW1zIGluc3RhbmNlb2YgYXNuMWpzLk9iamVjdElkZW50aWZpZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByaXZhdGVLZXlBU04xID0gYXNuMWpzLmZyb21CRVIodGhpcy5wcml2YXRlS2V5LnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcml2YXRlS2V5QVNOMS5vZmZzZXQgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJzZWRLZXkgPSBuZXcgRUNQcml2YXRlS2V5KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZWRDdXJ2ZTogdGhpcy5wcml2YXRlS2V5QWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcy52YWx1ZUJsb2NrLnRvU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYTogcHJpdmF0ZUtleUFTTjEucmVzdWx0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW1xuICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWU6IHRoaXMudmVyc2lvbiB9KSxcbiAgICAgICAgICAgIHRoaXMucHJpdmF0ZUtleUFsZ29yaXRobS50b1NjaGVtYSgpLFxuICAgICAgICAgICAgdGhpcy5wcml2YXRlS2V5XG4gICAgICAgIF07XG4gICAgICAgIGlmICh0aGlzLmF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLmF0dHJpYnV0ZXMsIG8gPT4gby50b1NjaGVtYSgpKVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGlmICghdGhpcy5wYXJzZWRLZXkpIHtcbiAgICAgICAgICAgIGNvbnN0IG9iamVjdCA9IHtcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiB0aGlzLnZlcnNpb24sXG4gICAgICAgICAgICAgICAgcHJpdmF0ZUtleUFsZ29yaXRobTogdGhpcy5wcml2YXRlS2V5QWxnb3JpdGhtLnRvSlNPTigpLFxuICAgICAgICAgICAgICAgIHByaXZhdGVLZXk6IHRoaXMucHJpdmF0ZUtleS50b0pTT04oKSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAodGhpcy5hdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgb2JqZWN0LmF0dHJpYnV0ZXMgPSBBcnJheS5mcm9tKHRoaXMuYXR0cmlidXRlcywgbyA9PiBvLnRvSlNPTigpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBvYmplY3Q7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgandrID0ge307XG4gICAgICAgIHN3aXRjaCAodGhpcy5wcml2YXRlS2V5QWxnb3JpdGhtLmFsZ29yaXRobUlkKSB7XG4gICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMDA0NS4yLjFcIjpcbiAgICAgICAgICAgICAgICBqd2sua3R5ID0gXCJFQ1wiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIjEuMi44NDAuMTEzNTQ5LjEuMS4xXCI6XG4gICAgICAgICAgICAgICAgandrLmt0eSA9IFwiUlNBXCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcHVibGljS2V5SldLID0gdGhpcy5wYXJzZWRLZXkudG9KU09OKCk7XG4gICAgICAgIE9iamVjdC5hc3NpZ24oandrLCBwdWJsaWNLZXlKV0spO1xuICAgICAgICByZXR1cm4gandrO1xuICAgIH1cbiAgICBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIGlmIChcImt0eVwiIGluIGpzb24pIHtcbiAgICAgICAgICAgIHN3aXRjaCAoanNvbi5rdHkudG9VcHBlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgIGNhc2UgXCJFQ1wiOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcnNlZEtleSA9IG5ldyBFQ1ByaXZhdGVLZXkoeyBqc29uIH0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZhdGVLZXlBbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1JZDogXCIxLjIuODQwLjEwMDQ1LjIuMVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtUGFyYW1zOiBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyB2YWx1ZTogdGhpcy5wYXJzZWRLZXkubmFtZWRDdXJ2ZSB9KVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcIlJTQVwiOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcnNlZEtleSA9IG5ldyBSU0FQcml2YXRlS2V5KHsganNvbiB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2YXRlS2V5QWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoe1xuICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtSWQ6IFwiMS4yLjg0MC4xMTM1NDkuMS4xLjFcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogbmV3IGFzbjFqcy5OdWxsKClcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCB2YWx1ZSBmb3IgXCJrdHlcIiBwYXJhbWV0ZXI6ICR7anNvbi5rdHl9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnByaXZhdGVLZXkgPSBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgdmFsdWVIZXg6IHRoaXMucGFyc2VkS2V5LnRvU2NoZW1hKCkudG9CRVIoZmFsc2UpIH0pO1xuICAgICAgICB9XG4gICAgfVxufVxuUHJpdmF0ZUtleUluZm8uQ0xBU1NfTkFNRSA9IFwiUHJpdmF0ZUtleUluZm9cIjtcblxuY29uc3QgQ09OVEVOVF9UWVBFJDEgPSBcImNvbnRlbnRUeXBlXCI7XG5jb25zdCBDT05URU5UX0VOQ1JZUFRJT05fQUxHT1JJVEhNID0gXCJjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobVwiO1xuY29uc3QgRU5DUllQVEVEX0NPTlRFTlQgPSBcImVuY3J5cHRlZENvbnRlbnRcIjtcbmNvbnN0IENMRUFSX1BST1BTJDE1ID0gW1xuICAgIENPTlRFTlRfVFlQRSQxLFxuICAgIENPTlRFTlRfRU5DUllQVElPTl9BTEdPUklUSE0sXG4gICAgRU5DUllQVEVEX0NPTlRFTlQsXG5dO1xuY29uc3QgUElFQ0VfU0laRSA9IDEwMjQ7XG5jbGFzcyBFbmNyeXB0ZWRDb250ZW50SW5mbyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuY29udGVudFR5cGUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBDT05URU5UX1RZUEUkMSwgRW5jcnlwdGVkQ29udGVudEluZm8uZGVmYXVsdFZhbHVlcyhDT05URU5UX1RZUEUkMSkpO1xuICAgICAgICB0aGlzLmNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQ09OVEVOVF9FTkNSWVBUSU9OX0FMR09SSVRITSwgRW5jcnlwdGVkQ29udGVudEluZm8uZGVmYXVsdFZhbHVlcyhDT05URU5UX0VOQ1JZUFRJT05fQUxHT1JJVEhNKSk7XG4gICAgICAgIGlmIChFTkNSWVBURURfQ09OVEVOVCBpbiBwYXJhbWV0ZXJzICYmIHBhcmFtZXRlcnMuZW5jcnlwdGVkQ29udGVudCkge1xuICAgICAgICAgICAgdGhpcy5lbmNyeXB0ZWRDb250ZW50ID0gcGFyYW1ldGVycy5lbmNyeXB0ZWRDb250ZW50O1xuICAgICAgICAgICAgaWYgKCh0aGlzLmVuY3J5cHRlZENvbnRlbnQuaWRCbG9jay50YWdDbGFzcyA9PT0gMSkgJiZcbiAgICAgICAgICAgICAgICAodGhpcy5lbmNyeXB0ZWRDb250ZW50LmlkQmxvY2sudGFnTnVtYmVyID09PSA0KSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmVuY3J5cHRlZENvbnRlbnQuaWRCbG9jay5pc0NvbnN0cnVjdGVkID09PSBmYWxzZSAmJiAhcGFyYW1ldGVycy5kaXNhYmxlU3BsaXQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29uc3RyU3RyaW5nID0gbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7IGlzQ29uc3RydWN0ZWQ6IHRydWUgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzQ29uc3RydWN0ZWQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBvZmZzZXQgPSAwO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZUhleCA9IHRoaXMuZW5jcnlwdGVkQ29udGVudC52YWx1ZUJsb2NrLnZhbHVlSGV4Vmlldy5zbGljZSgpLmJ1ZmZlcjtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGxlbmd0aCA9IHZhbHVlSGV4LmJ5dGVMZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHdoaWxlIChsZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwaWVjZVZpZXcgPSBuZXcgVWludDhBcnJheSh2YWx1ZUhleCwgb2Zmc2V0LCAoKG9mZnNldCArIFBJRUNFX1NJWkUpID4gdmFsdWVIZXguYnl0ZUxlbmd0aCkgPyAodmFsdWVIZXguYnl0ZUxlbmd0aCAtIG9mZnNldCkgOiBQSUVDRV9TSVpFKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IF9hcnJheSA9IG5ldyBBcnJheUJ1ZmZlcihwaWVjZVZpZXcubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IF92aWV3ID0gbmV3IFVpbnQ4QXJyYXkoX2FycmF5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgX3ZpZXcubGVuZ3RoOyBpKyspXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZpZXdbaV0gPSBwaWVjZVZpZXdbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdHJTdHJpbmcudmFsdWVCbG9jay52YWx1ZS5wdXNoKG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyB2YWx1ZUhleDogX2FycmF5IH0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxlbmd0aCAtPSBwaWVjZVZpZXcubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ICs9IHBpZWNlVmlldy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmNyeXB0ZWRDb250ZW50ID0gY29uc3RyU3RyaW5nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgQ09OVEVOVF9UWVBFJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX1NUUklORztcbiAgICAgICAgICAgIGNhc2UgQ09OVEVOVF9FTkNSWVBUSU9OX0FMR09SSVRITTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgRU5DUllQVEVEX0NPTlRFTlQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgQ09OVEVOVF9UWVBFJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gRU1QVFlfU1RSSU5HKTtcbiAgICAgICAgICAgIGNhc2UgQ09OVEVOVF9FTkNSWVBUSU9OX0FMR09SSVRITTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKChtZW1iZXJWYWx1ZS5hbGdvcml0aG1JZCA9PT0gRU1QVFlfU1RSSU5HKSAmJiAoKFwiYWxnb3JpdGhtUGFyYW1zXCIgaW4gbWVtYmVyVmFsdWUpID09PSBmYWxzZSkpO1xuICAgICAgICAgICAgY2FzZSBFTkNSWVBURURfQ09OVEVOVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmlzRXF1YWwoRW5jcnlwdGVkQ29udGVudEluZm8uZGVmYXVsdFZhbHVlcyhFTkNSWVBURURfQ09OVEVOVCkpKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgbmFtZTogKG5hbWVzLmNvbnRlbnRUeXBlIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMuY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0gfHwge30pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ2hvaWNlKHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5lbmNyeXB0ZWRDb250ZW50IHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuZW5jcnlwdGVkQ29udGVudCB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDE1KTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBFbmNyeXB0ZWRDb250ZW50SW5mby5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogQ09OVEVOVF9UWVBFJDEsXG4gICAgICAgICAgICAgICAgY29udGVudEVuY3J5cHRpb25BbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogQ09OVEVOVF9FTkNSWVBUSU9OX0FMR09SSVRITVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlbmNyeXB0ZWRDb250ZW50OiBFTkNSWVBURURfQ09OVEVOVFxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuY29udGVudFR5cGUgPSBhc24xLnJlc3VsdC5jb250ZW50VHlwZS52YWx1ZUJsb2NrLnRvU3RyaW5nKCk7XG4gICAgICAgIHRoaXMuY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHQuY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0gfSk7XG4gICAgICAgIGlmIChFTkNSWVBURURfQ09OVEVOVCBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5lbmNyeXB0ZWRDb250ZW50ID0gYXNuMS5yZXN1bHQuZW5jcnlwdGVkQ29udGVudDtcbiAgICAgICAgICAgIHRoaXMuZW5jcnlwdGVkQ29udGVudC5pZEJsb2NrLnRhZ0NsYXNzID0gMTtcbiAgICAgICAgICAgIHRoaXMuZW5jcnlwdGVkQ29udGVudC5pZEJsb2NrLnRhZ051bWJlciA9IDQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IHNlcXVlbmNlTGVuZ3RoQmxvY2sgPSB7XG4gICAgICAgICAgICBpc0luZGVmaW5pdGVGb3JtOiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLmNvbnRlbnRUeXBlIH0pKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLmNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtLnRvU2NoZW1hKCkpO1xuICAgICAgICBpZiAodGhpcy5lbmNyeXB0ZWRDb250ZW50KSB7XG4gICAgICAgICAgICBzZXF1ZW5jZUxlbmd0aEJsb2NrLmlzSW5kZWZpbml0ZUZvcm0gPSB0aGlzLmVuY3J5cHRlZENvbnRlbnQuaWRCbG9jay5pc0NvbnN0cnVjdGVkO1xuICAgICAgICAgICAgY29uc3QgZW5jcnlwdGVkVmFsdWUgPSB0aGlzLmVuY3J5cHRlZENvbnRlbnQ7XG4gICAgICAgICAgICBlbmNyeXB0ZWRWYWx1ZS5pZEJsb2NrLnRhZ0NsYXNzID0gMztcbiAgICAgICAgICAgIGVuY3J5cHRlZFZhbHVlLmlkQmxvY2sudGFnTnVtYmVyID0gMDtcbiAgICAgICAgICAgIGVuY3J5cHRlZFZhbHVlLmxlbkJsb2NrLmlzSW5kZWZpbml0ZUZvcm0gPSB0aGlzLmVuY3J5cHRlZENvbnRlbnQuaWRCbG9jay5pc0NvbnN0cnVjdGVkO1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChlbmNyeXB0ZWRWYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIGxlbkJsb2NrOiBzZXF1ZW5jZUxlbmd0aEJsb2NrLFxuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICBjb250ZW50VHlwZTogdGhpcy5jb250ZW50VHlwZSxcbiAgICAgICAgICAgIGNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtOiB0aGlzLmNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtLnRvSlNPTigpXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLmVuY3J5cHRlZENvbnRlbnQpIHtcbiAgICAgICAgICAgIHJlcy5lbmNyeXB0ZWRDb250ZW50ID0gdGhpcy5lbmNyeXB0ZWRDb250ZW50LnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxuICAgIGdldEVuY3J5cHRlZENvbnRlbnQoKSB7XG4gICAgICAgIGlmICghdGhpcy5lbmNyeXB0ZWRDb250ZW50KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQYXJhbWV0ZXIgJ2VuY3J5cHRlZENvbnRlbnQnIGlzIHVuZGVmaW5lZFwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXNuMWpzLk9jdGV0U3RyaW5nLnByb3RvdHlwZS5nZXRWYWx1ZS5jYWxsKHRoaXMuZW5jcnlwdGVkQ29udGVudCk7XG4gICAgfVxufVxuRW5jcnlwdGVkQ29udGVudEluZm8uQ0xBU1NfTkFNRSA9IFwiRW5jcnlwdGVkQ29udGVudEluZm9cIjtcblxuY29uc3QgSEFTSF9BTEdPUklUSE0kNCA9IFwiaGFzaEFsZ29yaXRobVwiO1xuY29uc3QgTUFTS19HRU5fQUxHT1JJVEhNJDEgPSBcIm1hc2tHZW5BbGdvcml0aG1cIjtcbmNvbnN0IFNBTFRfTEVOR1RIID0gXCJzYWx0TGVuZ3RoXCI7XG5jb25zdCBUUkFJTEVSX0ZJRUxEID0gXCJ0cmFpbGVyRmllbGRcIjtcbmNvbnN0IENMRUFSX1BST1BTJDE0ID0gW1xuICAgIEhBU0hfQUxHT1JJVEhNJDQsXG4gICAgTUFTS19HRU5fQUxHT1JJVEhNJDEsXG4gICAgU0FMVF9MRU5HVEgsXG4gICAgVFJBSUxFUl9GSUVMRFxuXTtcbmNsYXNzIFJTQVNTQVBTU1BhcmFtcyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuaGFzaEFsZ29yaXRobSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEhBU0hfQUxHT1JJVEhNJDQsIFJTQVNTQVBTU1BhcmFtcy5kZWZhdWx0VmFsdWVzKEhBU0hfQUxHT1JJVEhNJDQpKTtcbiAgICAgICAgdGhpcy5tYXNrR2VuQWxnb3JpdGhtID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgTUFTS19HRU5fQUxHT1JJVEhNJDEsIFJTQVNTQVBTU1BhcmFtcy5kZWZhdWx0VmFsdWVzKE1BU0tfR0VOX0FMR09SSVRITSQxKSk7XG4gICAgICAgIHRoaXMuc2FsdExlbmd0aCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNBTFRfTEVOR1RILCBSU0FTU0FQU1NQYXJhbXMuZGVmYXVsdFZhbHVlcyhTQUxUX0xFTkdUSCkpO1xuICAgICAgICB0aGlzLnRyYWlsZXJGaWVsZCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFRSQUlMRVJfRklFTEQsIFJTQVNTQVBTU1BhcmFtcy5kZWZhdWx0VmFsdWVzKFRSQUlMRVJfRklFTEQpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIEhBU0hfQUxHT1JJVEhNJDQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHtcbiAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtSWQ6IFwiMS4zLjE0LjMuMi4yNlwiLFxuICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1QYXJhbXM6IG5ldyBhc24xanMuTnVsbCgpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjYXNlIE1BU0tfR0VOX0FMR09SSVRITSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobUlkOiBcIjEuMi44NDAuMTEzNTQ5LjEuMS44XCIsXG4gICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogKG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobUlkOiBcIjEuMy4xNC4zLjIuMjZcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogbmV3IGFzbjFqcy5OdWxsKClcbiAgICAgICAgICAgICAgICAgICAgfSkpLnRvU2NoZW1hKClcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNhc2UgU0FMVF9MRU5HVEg6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDIwO1xuICAgICAgICAgICAgY2FzZSBUUkFJTEVSX0ZJRUxEOlxuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMuaGFzaEFsZ29yaXRobSB8fCB7fSldXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW0FsZ29yaXRobUlkZW50aWZpZXIuc2NoZW1hKG5hbWVzLm1hc2tHZW5BbGdvcml0aG0gfHwge30pXVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMuc2FsdExlbmd0aCB8fCBFTVBUWV9TVFJJTkcpIH0pXVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogM1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMudHJhaWxlckZpZWxkIHx8IEVNUFRZX1NUUklORykgfSldXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQxNCk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgUlNBU1NBUFNTUGFyYW1zLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGhhc2hBbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogSEFTSF9BTEdPUklUSE0kNFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBtYXNrR2VuQWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IE1BU0tfR0VOX0FMR09SSVRITSQxXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHNhbHRMZW5ndGg6IFNBTFRfTEVOR1RILFxuICAgICAgICAgICAgICAgIHRyYWlsZXJGaWVsZDogVFJBSUxFUl9GSUVMRFxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIGlmIChIQVNIX0FMR09SSVRITSQ0IGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5oYXNoQWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0Lmhhc2hBbGdvcml0aG0gfSk7XG4gICAgICAgIGlmIChNQVNLX0dFTl9BTEdPUklUSE0kMSBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMubWFza0dlbkFsZ29yaXRobSA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5tYXNrR2VuQWxnb3JpdGhtIH0pO1xuICAgICAgICBpZiAoU0FMVF9MRU5HVEggaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLnNhbHRMZW5ndGggPSBhc24xLnJlc3VsdC5zYWx0TGVuZ3RoLnZhbHVlQmxvY2sudmFsdWVEZWM7XG4gICAgICAgIGlmIChUUkFJTEVSX0ZJRUxEIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy50cmFpbGVyRmllbGQgPSBhc24xLnJlc3VsdC50cmFpbGVyRmllbGQudmFsdWVCbG9jay52YWx1ZURlYztcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgIGlmICghdGhpcy5oYXNoQWxnb3JpdGhtLmlzRXF1YWwoUlNBU1NBUFNTUGFyYW1zLmRlZmF1bHRWYWx1ZXMoSEFTSF9BTEdPUklUSE0kNCkpKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFt0aGlzLmhhc2hBbGdvcml0aG0udG9TY2hlbWEoKV1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMubWFza0dlbkFsZ29yaXRobS5pc0VxdWFsKFJTQVNTQVBTU1BhcmFtcy5kZWZhdWx0VmFsdWVzKE1BU0tfR0VOX0FMR09SSVRITSQxKSkpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW3RoaXMubWFza0dlbkFsZ29yaXRobS50b1NjaGVtYSgpXVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNhbHRMZW5ndGggIT09IFJTQVNTQVBTU1BhcmFtcy5kZWZhdWx0VmFsdWVzKFNBTFRfTEVOR1RIKSkge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBbbmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWU6IHRoaXMuc2FsdExlbmd0aCB9KV1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy50cmFpbGVyRmllbGQgIT09IFJTQVNTQVBTU1BhcmFtcy5kZWZhdWx0VmFsdWVzKFRSQUlMRVJfRklFTEQpKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogM1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFtuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy50cmFpbGVyRmllbGQgfSldXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge307XG4gICAgICAgIGlmICghdGhpcy5oYXNoQWxnb3JpdGhtLmlzRXF1YWwoUlNBU1NBUFNTUGFyYW1zLmRlZmF1bHRWYWx1ZXMoSEFTSF9BTEdPUklUSE0kNCkpKSB7XG4gICAgICAgICAgICByZXMuaGFzaEFsZ29yaXRobSA9IHRoaXMuaGFzaEFsZ29yaXRobS50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMubWFza0dlbkFsZ29yaXRobS5pc0VxdWFsKFJTQVNTQVBTU1BhcmFtcy5kZWZhdWx0VmFsdWVzKE1BU0tfR0VOX0FMR09SSVRITSQxKSkpIHtcbiAgICAgICAgICAgIHJlcy5tYXNrR2VuQWxnb3JpdGhtID0gdGhpcy5tYXNrR2VuQWxnb3JpdGhtLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNhbHRMZW5ndGggIT09IFJTQVNTQVBTU1BhcmFtcy5kZWZhdWx0VmFsdWVzKFNBTFRfTEVOR1RIKSkge1xuICAgICAgICAgICAgcmVzLnNhbHRMZW5ndGggPSB0aGlzLnNhbHRMZW5ndGg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudHJhaWxlckZpZWxkICE9PSBSU0FTU0FQU1NQYXJhbXMuZGVmYXVsdFZhbHVlcyhUUkFJTEVSX0ZJRUxEKSkge1xuICAgICAgICAgICAgcmVzLnRyYWlsZXJGaWVsZCA9IHRoaXMudHJhaWxlckZpZWxkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxufVxuUlNBU1NBUFNTUGFyYW1zLkNMQVNTX05BTUUgPSBcIlJTQVNTQVBTU1BhcmFtc1wiO1xuXG5jb25zdCBTQUxUID0gXCJzYWx0XCI7XG5jb25zdCBJVEVSQVRJT05fQ09VTlQgPSBcIml0ZXJhdGlvbkNvdW50XCI7XG5jb25zdCBLRVlfTEVOR1RIID0gXCJrZXlMZW5ndGhcIjtcbmNvbnN0IFBSRiA9IFwicHJmXCI7XG5jb25zdCBDTEVBUl9QUk9QUyQxMyA9IFtcbiAgICBTQUxULFxuICAgIElURVJBVElPTl9DT1VOVCxcbiAgICBLRVlfTEVOR1RILFxuICAgIFBSRlxuXTtcbmNsYXNzIFBCS0RGMlBhcmFtcyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuc2FsdCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNBTFQsIFBCS0RGMlBhcmFtcy5kZWZhdWx0VmFsdWVzKFNBTFQpKTtcbiAgICAgICAgdGhpcy5pdGVyYXRpb25Db3VudCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIElURVJBVElPTl9DT1VOVCwgUEJLREYyUGFyYW1zLmRlZmF1bHRWYWx1ZXMoSVRFUkFUSU9OX0NPVU5UKSk7XG4gICAgICAgIGlmIChLRVlfTEVOR1RIIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMua2V5TGVuZ3RoID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgS0VZX0xFTkdUSCwgUEJLREYyUGFyYW1zLmRlZmF1bHRWYWx1ZXMoS0VZX0xFTkdUSCkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChQUkYgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5wcmYgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBQUkYsIFBCS0RGMlBhcmFtcy5kZWZhdWx0VmFsdWVzKFBSRikpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBTQUxUOlxuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIGNhc2UgSVRFUkFUSU9OX0NPVU5UOlxuICAgICAgICAgICAgICAgIHJldHVybiAoLTEpO1xuICAgICAgICAgICAgY2FzZSBLRVlfTEVOR1RIOlxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgY2FzZSBQUkY6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHtcbiAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtSWQ6IFwiMS4zLjE0LjMuMi4yNlwiLFxuICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1QYXJhbXM6IG5ldyBhc24xanMuTnVsbCgpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ2hvaWNlKHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyBuYW1lOiAobmFtZXMuc2FsdFByaW1pdGl2ZSB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMuc2FsdENvbnN0cnVjdGVkIHx8IHt9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLml0ZXJhdGlvbkNvdW50IHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmtleUxlbmd0aCB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIEFsZ29yaXRobUlkZW50aWZpZXIuc2NoZW1hKG5hbWVzLnByZiB8fCB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQxMyk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgUEJLREYyUGFyYW1zLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIHNhbHRQcmltaXRpdmU6IFNBTFQsXG4gICAgICAgICAgICAgICAgc2FsdENvbnN0cnVjdGVkOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFNBTFRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgaXRlcmF0aW9uQ291bnQ6IElURVJBVElPTl9DT1VOVCxcbiAgICAgICAgICAgICAgICBrZXlMZW5ndGg6IEtFWV9MRU5HVEgsXG4gICAgICAgICAgICAgICAgcHJmOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFBSRixcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5zYWx0ID0gYXNuMS5yZXN1bHQuc2FsdDtcbiAgICAgICAgdGhpcy5pdGVyYXRpb25Db3VudCA9IGFzbjEucmVzdWx0Lml0ZXJhdGlvbkNvdW50LnZhbHVlQmxvY2sudmFsdWVEZWM7XG4gICAgICAgIGlmIChLRVlfTEVOR1RIIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5rZXlMZW5ndGggPSBhc24xLnJlc3VsdC5rZXlMZW5ndGgudmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgaWYgKFBSRiBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMucHJmID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0LnByZiB9KTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5zYWx0KTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy5pdGVyYXRpb25Db3VudCB9KSk7XG4gICAgICAgIGlmIChLRVlfTEVOR1RIIGluIHRoaXMpIHtcbiAgICAgICAgICAgIGlmIChQQktERjJQYXJhbXMuZGVmYXVsdFZhbHVlcyhLRVlfTEVOR1RIKSAhPT0gdGhpcy5rZXlMZW5ndGgpXG4gICAgICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy5rZXlMZW5ndGggfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnByZikge1xuICAgICAgICAgICAgaWYgKFBCS0RGMlBhcmFtcy5kZWZhdWx0VmFsdWVzKFBSRikuaXNFcXVhbCh0aGlzLnByZikgPT09IGZhbHNlKVxuICAgICAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5wcmYudG9TY2hlbWEoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgICAgc2FsdDogdGhpcy5zYWx0LnRvSlNPTigpLFxuICAgICAgICAgICAgaXRlcmF0aW9uQ291bnQ6IHRoaXMuaXRlcmF0aW9uQ291bnRcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKEtFWV9MRU5HVEggaW4gdGhpcykge1xuICAgICAgICAgICAgaWYgKFBCS0RGMlBhcmFtcy5kZWZhdWx0VmFsdWVzKEtFWV9MRU5HVEgpICE9PSB0aGlzLmtleUxlbmd0aClcbiAgICAgICAgICAgICAgICByZXMua2V5TGVuZ3RoID0gdGhpcy5rZXlMZW5ndGg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucHJmKSB7XG4gICAgICAgICAgICBpZiAoUEJLREYyUGFyYW1zLmRlZmF1bHRWYWx1ZXMoUFJGKS5pc0VxdWFsKHRoaXMucHJmKSA9PT0gZmFsc2UpXG4gICAgICAgICAgICAgICAgcmVzLnByZiA9IHRoaXMucHJmLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxufVxuUEJLREYyUGFyYW1zLkNMQVNTX05BTUUgPSBcIlBCS0RGMlBhcmFtc1wiO1xuXG5jb25zdCBLRVlfREVSSVZBVElPTl9GVU5DID0gXCJrZXlEZXJpdmF0aW9uRnVuY1wiO1xuY29uc3QgRU5DUllQVElPTl9TQ0hFTUUgPSBcImVuY3J5cHRpb25TY2hlbWVcIjtcbmNvbnN0IENMRUFSX1BST1BTJDEyID0gW1xuICAgIEtFWV9ERVJJVkFUSU9OX0ZVTkMsXG4gICAgRU5DUllQVElPTl9TQ0hFTUVcbl07XG5jbGFzcyBQQkVTMlBhcmFtcyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMua2V5RGVyaXZhdGlvbkZ1bmMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBLRVlfREVSSVZBVElPTl9GVU5DLCBQQkVTMlBhcmFtcy5kZWZhdWx0VmFsdWVzKEtFWV9ERVJJVkFUSU9OX0ZVTkMpKTtcbiAgICAgICAgdGhpcy5lbmNyeXB0aW9uU2NoZW1lID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgRU5DUllQVElPTl9TQ0hFTUUsIFBCRVMyUGFyYW1zLmRlZmF1bHRWYWx1ZXMoRU5DUllQVElPTl9TQ0hFTUUpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIEtFWV9ERVJJVkFUSU9OX0ZVTkM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKCk7XG4gICAgICAgICAgICBjYXNlIEVOQ1JZUFRJT05fU0NIRU1FOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcigpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBBbGdvcml0aG1JZGVudGlmaWVyLnNjaGVtYShuYW1lcy5rZXlEZXJpdmF0aW9uRnVuYyB8fCB7fSksXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMuZW5jcnlwdGlvblNjaGVtZSB8fCB7fSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQxMik7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgUEJFUzJQYXJhbXMuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAga2V5RGVyaXZhdGlvbkZ1bmM6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogS0VZX0RFUklWQVRJT05fRlVOQ1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlbmNyeXB0aW9uU2NoZW1lOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IEVOQ1JZUFRJT05fU0NIRU1FXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5rZXlEZXJpdmF0aW9uRnVuYyA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5rZXlEZXJpdmF0aW9uRnVuYyB9KTtcbiAgICAgICAgdGhpcy5lbmNyeXB0aW9uU2NoZW1lID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0LmVuY3J5cHRpb25TY2hlbWUgfSk7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICB0aGlzLmtleURlcml2YXRpb25GdW5jLnRvU2NoZW1hKCksXG4gICAgICAgICAgICAgICAgdGhpcy5lbmNyeXB0aW9uU2NoZW1lLnRvU2NoZW1hKClcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBrZXlEZXJpdmF0aW9uRnVuYzogdGhpcy5rZXlEZXJpdmF0aW9uRnVuYy50b0pTT04oKSxcbiAgICAgICAgICAgIGVuY3J5cHRpb25TY2hlbWU6IHRoaXMuZW5jcnlwdGlvblNjaGVtZS50b0pTT04oKVxuICAgICAgICB9O1xuICAgIH1cbn1cblBCRVMyUGFyYW1zLkNMQVNTX05BTUUgPSBcIlBCRVMyUGFyYW1zXCI7XG5cbmNsYXNzIEFic3RyYWN0Q3J5cHRvRW5naW5lIHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzKSB7XG4gICAgICAgIHRoaXMuY3J5cHRvID0gcGFyYW1ldGVycy5jcnlwdG87XG4gICAgICAgIHRoaXMuc3VidGxlID0gXCJ3ZWJraXRTdWJ0bGVcIiBpbiBwYXJhbWV0ZXJzLmNyeXB0b1xuICAgICAgICAgICAgPyBwYXJhbWV0ZXJzLmNyeXB0by53ZWJraXRTdWJ0bGVcbiAgICAgICAgICAgIDogcGFyYW1ldGVycy5jcnlwdG8uc3VidGxlO1xuICAgICAgICB0aGlzLm5hbWUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVcIiwgRU1QVFlfU1RSSU5HKTtcbiAgICB9XG4gICAgYXN5bmMgZW5jcnlwdCguLi5hcmdzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN1YnRsZS5lbmNyeXB0KC4uLmFyZ3MpO1xuICAgIH1cbiAgICBhc3luYyBkZWNyeXB0KC4uLmFyZ3MpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3VidGxlLmRlY3J5cHQoLi4uYXJncyk7XG4gICAgfVxuICAgIHNpZ24oLi4uYXJncykge1xuICAgICAgICByZXR1cm4gdGhpcy5zdWJ0bGUuc2lnbiguLi5hcmdzKTtcbiAgICB9XG4gICAgYXN5bmMgdmVyaWZ5KC4uLmFyZ3MpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3VidGxlLnZlcmlmeSguLi5hcmdzKTtcbiAgICB9XG4gICAgYXN5bmMgZGlnZXN0KC4uLmFyZ3MpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3VidGxlLmRpZ2VzdCguLi5hcmdzKTtcbiAgICB9XG4gICAgYXN5bmMgZ2VuZXJhdGVLZXkoLi4uYXJncykge1xuICAgICAgICByZXR1cm4gdGhpcy5zdWJ0bGUuZ2VuZXJhdGVLZXkoLi4uYXJncyk7XG4gICAgfVxuICAgIGFzeW5jIGRlcml2ZUtleSguLi5hcmdzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN1YnRsZS5kZXJpdmVLZXkoLi4uYXJncyk7XG4gICAgfVxuICAgIGFzeW5jIGRlcml2ZUJpdHMoLi4uYXJncykge1xuICAgICAgICByZXR1cm4gdGhpcy5zdWJ0bGUuZGVyaXZlQml0cyguLi5hcmdzKTtcbiAgICB9XG4gICAgYXN5bmMgd3JhcEtleSguLi5hcmdzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN1YnRsZS53cmFwS2V5KC4uLmFyZ3MpO1xuICAgIH1cbiAgICBhc3luYyB1bndyYXBLZXkoLi4uYXJncykge1xuICAgICAgICByZXR1cm4gdGhpcy5zdWJ0bGUudW53cmFwS2V5KC4uLmFyZ3MpO1xuICAgIH1cbiAgICBleHBvcnRLZXkoLi4uYXJncykge1xuICAgICAgICByZXR1cm4gdGhpcy5zdWJ0bGUuZXhwb3J0S2V5KC4uLmFyZ3MpO1xuICAgIH1cbiAgICBpbXBvcnRLZXkoLi4uYXJncykge1xuICAgICAgICByZXR1cm4gdGhpcy5zdWJ0bGUuaW1wb3J0S2V5KC4uLmFyZ3MpO1xuICAgIH1cbiAgICBnZXRSYW5kb21WYWx1ZXMoYXJyYXkpIHtcbiAgICAgICAgaWYgKGFycmF5ID09PSBudWxsKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBcmd1bWVudCBcXFwiYXJyYXlcXFwiIG11c3Qgbm90IGJlIG51bGxcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhhcnJheSk7XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBtYWtlUEtDUzEyQjJLZXkoaGFzaEFsZ29yaXRobSwga2V5TGVuZ3RoLCBwYXNzd29yZCwgc2FsdCwgaXRlcmF0aW9uQ291bnQpIHtcbiAgICBsZXQgdTtcbiAgICBsZXQgdjtcbiAgICBsZXQgbWQ7XG4gICAgc3dpdGNoIChoYXNoQWxnb3JpdGhtLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgICAgY2FzZSBcIlNIQS0xXCI6XG4gICAgICAgICAgICB1ID0gMjA7XG4gICAgICAgICAgICB2ID0gNjQ7XG4gICAgICAgICAgICBtZCA9IHNoYTE7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcIlNIQS0yNTZcIjpcbiAgICAgICAgICAgIHUgPSAzMjtcbiAgICAgICAgICAgIHYgPSA2NDtcbiAgICAgICAgICAgIG1kID0gc2hhMjU2O1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJTSEEtMzg0XCI6XG4gICAgICAgICAgICB1ID0gNDg7XG4gICAgICAgICAgICB2ID0gMTI4O1xuICAgICAgICAgICAgbWQgPSBzaGEzODQ7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcIlNIQS01MTJcIjpcbiAgICAgICAgICAgIHUgPSA2NDtcbiAgICAgICAgICAgIHYgPSAxMjg7XG4gICAgICAgICAgICBtZCA9IHNoYTUxMjtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5zdXBwb3J0ZWQgaGFzaGluZyBhbGdvcml0aG1cIik7XG4gICAgfVxuICAgIGNvbnN0IG9yaWdpbmFsUGFzc3dvcmQgPSBuZXcgVWludDhBcnJheShwYXNzd29yZCk7XG4gICAgbGV0IGRlY29kZWRQYXNzd29yZCA9IG5ldyBUZXh0RGVjb2RlcigpLmRlY29kZShwYXNzd29yZCk7XG4gICAgY29uc3QgZW5jb2RlZFBhc3N3b3JkID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKGRlY29kZWRQYXNzd29yZCk7XG4gICAgaWYgKGVuY29kZWRQYXNzd29yZC5zb21lKChieXRlLCBpKSA9PiBieXRlICE9PSBvcmlnaW5hbFBhc3N3b3JkW2ldKSkge1xuICAgICAgICBkZWNvZGVkUGFzc3dvcmQgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKC4uLm9yaWdpbmFsUGFzc3dvcmQpO1xuICAgIH1cbiAgICBjb25zdCBwYXNzd29yZFRyYW5zZm9ybWVkID0gbmV3IFVpbnQ4QXJyYXkoZGVjb2RlZFBhc3N3b3JkLmxlbmd0aCAqIDIgKyAyKTtcbiAgICBjb25zdCBwYXNzd29yZFZpZXcgPSBuZXcgRGF0YVZpZXcocGFzc3dvcmRUcmFuc2Zvcm1lZC5idWZmZXIpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGVjb2RlZFBhc3N3b3JkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHBhc3N3b3JkVmlldy5zZXRVaW50MTYoaSAqIDIsIGRlY29kZWRQYXNzd29yZC5jaGFyQ29kZUF0KGkpLCBmYWxzZSk7XG4gICAgfVxuICAgIHBhc3N3b3JkVmlldy5zZXRVaW50MTYoZGVjb2RlZFBhc3N3b3JkLmxlbmd0aCAqIDIsIDAsIGZhbHNlKTtcbiAgICBjb25zdCBEID0gbmV3IFVpbnQ4QXJyYXkodikuZmlsbCgzKTtcbiAgICBjb25zdCBzYWx0VmlldyA9IG5ldyBVaW50OEFycmF5KHNhbHQpO1xuICAgIGNvbnN0IFMgPSBuZXcgVWludDhBcnJheSh2ICogTWF0aC5jZWlsKHNhbHRWaWV3Lmxlbmd0aCAvIHYpKS5tYXAoKF8sIGkpID0+IHNhbHRWaWV3W2kgJSBzYWx0Vmlldy5sZW5ndGhdKTtcbiAgICBjb25zdCBQID0gbmV3IFVpbnQ4QXJyYXkodiAqIE1hdGguY2VpbChwYXNzd29yZFRyYW5zZm9ybWVkLmxlbmd0aCAvIHYpKS5tYXAoKF8sIGkpID0+IHBhc3N3b3JkVHJhbnNmb3JtZWRbaSAlIHBhc3N3b3JkVHJhbnNmb3JtZWQubGVuZ3RoXSk7XG4gICAgbGV0IEkgPSBuZXcgVWludDhBcnJheShTLmxlbmd0aCArIFAubGVuZ3RoKTtcbiAgICBJLnNldChTKTtcbiAgICBJLnNldChQLCBTLmxlbmd0aCk7XG4gICAgY29uc3QgYyA9IE1hdGguY2VpbCgoa2V5TGVuZ3RoID4+IDMpIC8gdSk7XG4gICAgY29uc3QgcmVzdWx0ID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjOyBpKyspIHtcbiAgICAgICAgbGV0IEEgPSBuZXcgVWludDhBcnJheShELmxlbmd0aCArIEkubGVuZ3RoKTtcbiAgICAgICAgQS5zZXQoRCk7XG4gICAgICAgIEEuc2V0KEksIEQubGVuZ3RoKTtcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBpdGVyYXRpb25Db3VudDsgaisrKSB7XG4gICAgICAgICAgICBBID0gbWQoQSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgQiA9IG5ldyBVaW50OEFycmF5KHYpLm1hcCgoXywgaSkgPT4gQVtpICUgQS5sZW5ndGhdKTtcbiAgICAgICAgY29uc3QgayA9IE1hdGguY2VpbChzYWx0Vmlldy5sZW5ndGggLyB2KSArIE1hdGguY2VpbChwYXNzd29yZFRyYW5zZm9ybWVkLmxlbmd0aCAvIHYpO1xuICAgICAgICBjb25zdCBpUm91bmQgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBrOyBqKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGNodW5rID0gQXJyYXkuZnJvbShJLnNsaWNlKGogKiB2LCAoaiArIDEpICogdikpO1xuICAgICAgICAgICAgbGV0IHggPSAweDFmZjtcbiAgICAgICAgICAgIGZvciAobGV0IGwgPSBCLmxlbmd0aCAtIDE7IGwgPj0gMDsgbC0tKSB7XG4gICAgICAgICAgICAgICAgeCA+Pj0gODtcbiAgICAgICAgICAgICAgICB4ICs9IEJbbF0gKyAoY2h1bmtbbF0gfHwgMCk7XG4gICAgICAgICAgICAgICAgY2h1bmtbbF0gPSB4ICYgMHhmZjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlSb3VuZC5wdXNoKC4uLmNodW5rKTtcbiAgICAgICAgfVxuICAgICAgICBJID0gbmV3IFVpbnQ4QXJyYXkoaVJvdW5kKTtcbiAgICAgICAgcmVzdWx0LnB1c2goLi4uQSk7XG4gICAgfVxuICAgIHJldHVybiBuZXcgVWludDhBcnJheShyZXN1bHQuc2xpY2UoMCwga2V5TGVuZ3RoID4+IDMpKS5idWZmZXI7XG59XG5mdW5jdGlvbiBwcmVwYXJlQWxnb3JpdGhtKGRhdGEpIHtcbiAgICBjb25zdCByZXMgPSB0eXBlb2YgZGF0YSA9PT0gXCJzdHJpbmdcIlxuICAgICAgICA/IHsgbmFtZTogZGF0YSB9XG4gICAgICAgIDogZGF0YTtcbiAgICBpZiAoXCJoYXNoXCIgaW4gcmVzKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5yZXMsXG4gICAgICAgICAgICBoYXNoOiBwcmVwYXJlQWxnb3JpdGhtKHJlcy5oYXNoKVxuICAgICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gcmVzO1xufVxuY2xhc3MgQ3J5cHRvRW5naW5lIGV4dGVuZHMgQWJzdHJhY3RDcnlwdG9FbmdpbmUge1xuICAgIGFzeW5jIGltcG9ydEtleShmb3JtYXQsIGtleURhdGEsIGFsZ29yaXRobSwgZXh0cmFjdGFibGUsIGtleVVzYWdlcykge1xuICAgICAgICB2YXIgX2EsIF9iLCBfYywgX2QsIF9lLCBfZjtcbiAgICAgICAgbGV0IGp3ayA9IHt9O1xuICAgICAgICBjb25zdCBhbGcgPSBwcmVwYXJlQWxnb3JpdGhtKGFsZ29yaXRobSk7XG4gICAgICAgIHN3aXRjaCAoZm9ybWF0LnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgIGNhc2UgXCJyYXdcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zdWJ0bGUuaW1wb3J0S2V5KFwicmF3XCIsIGtleURhdGEsIGFsZ29yaXRobSwgZXh0cmFjdGFibGUsIGtleVVzYWdlcyk7XG4gICAgICAgICAgICBjYXNlIFwic3BraVwiOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5mcm9tQkVSKHB2dHN1dGlscy5CdWZmZXJTb3VyY2VDb252ZXJ0ZXIudG9BcnJheUJ1ZmZlcihrZXlEYXRhKSk7XG4gICAgICAgICAgICAgICAgICAgIEFzbkVycm9yLmFzc2VydChhc24xLCBcImtleURhdGFcIik7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHB1YmxpY0tleUluZm8gPSBuZXcgUHVibGljS2V5SW5mbygpO1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHVibGljS2V5SW5mby5mcm9tU2NoZW1hKGFzbjEucmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnRFcnJvcihcIkluY29ycmVjdCBrZXlEYXRhXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoYWxnLm5hbWUudG9VcHBlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlJTQS1QU1NcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYWxnLmhhc2gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBQYXJhbWV0ZXJFcnJvcihcImhhc2hcIiwgXCJhbGdvcml0aG0uaGFzaFwiLCBcIkluY29ycmVjdCBoYXNoIGFsZ29yaXRobTogSGFzaCBhbGdvcml0aG0gaXMgbWlzc2VkXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoYWxnLmhhc2gubmFtZS50b1VwcGVyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTFcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2suYWxnID0gXCJQUzFcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtMjU2XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmFsZyA9IFwiUFMyNTZcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtMzg0XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmFsZyA9IFwiUFMzODRcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtNTEyXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmFsZyA9IFwiUFM1MTJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbmNvcnJlY3QgaGFzaCBhbGdvcml0aG06ICR7YWxnLmhhc2gubmFtZS50b1VwcGVyQ2FzZSgpfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlJTQVNTQS1QS0NTMS1WMV81XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlVc2FnZXMgPSBbXCJ2ZXJpZnlcIl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5rdHkgPSBcIlJTQVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2suZXh0ID0gZXh0cmFjdGFibGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5rZXlfb3BzID0ga2V5VXNhZ2VzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocHVibGljS2V5SW5mby5hbGdvcml0aG0uYWxnb3JpdGhtSWQgIT09IFwiMS4yLjg0MC4xMTM1NDkuMS4xLjFcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5jb3JyZWN0IHB1YmxpYyBrZXkgYWxnb3JpdGhtOiAke3B1YmxpY0tleUluZm8uYWxnb3JpdGhtLmFsZ29yaXRobUlkfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWp3ay5hbGcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYWxnLmhhc2gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUGFyYW1ldGVyRXJyb3IoXCJoYXNoXCIsIFwiYWxnb3JpdGhtLmhhc2hcIiwgXCJJbmNvcnJlY3QgaGFzaCBhbGdvcml0aG06IEhhc2ggYWxnb3JpdGhtIGlzIG1pc3NlZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoYWxnLmhhc2gubmFtZS50b1VwcGVyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlNIQS0xXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5hbGcgPSBcIlJTMVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTI1NlwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2suYWxnID0gXCJSUzI1NlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTM4NFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2suYWxnID0gXCJSUzM4NFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTUxMlwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2suYWxnID0gXCJSUzUxMlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBoYXNoIGFsZ29yaXRobTogJHthbGcuaGFzaC5uYW1lLnRvVXBwZXJDYXNlKCl9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHVibGljS2V5SlNPTiA9IHB1YmxpY0tleUluZm8udG9KU09OKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oandrLCBwdWJsaWNLZXlKU09OKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiRUNEU0FcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlVc2FnZXMgPSBbXCJ2ZXJpZnlcIl07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiRUNESFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga3R5OiBcIkVDXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHQ6IGV4dHJhY3RhYmxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5X29wczoga2V5VXNhZ2VzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwdWJsaWNLZXlJbmZvLmFsZ29yaXRobS5hbGdvcml0aG1JZCAhPT0gXCIxLjIuODQwLjEwMDQ1LjIuMVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBwdWJsaWMga2V5IGFsZ29yaXRobTogJHtwdWJsaWNLZXlJbmZvLmFsZ29yaXRobS5hbGdvcml0aG1JZH1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwdWJsaWNLZXlKU09OID0gcHVibGljS2V5SW5mby50b0pTT04oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihqd2ssIHB1YmxpY0tleUpTT04pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJSU0EtT0FFUFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmt0eSA9IFwiUlNBXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5leHQgPSBleHRyYWN0YWJsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmtleV9vcHMgPSBrZXlVc2FnZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm5hbWUudG9Mb3dlckNhc2UoKSA9PT0gXCJzYWZhcmlcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5hbGcgPSBcIlJTQS1PQUVQXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhbGcuaGFzaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBQYXJhbWV0ZXJFcnJvcihcImhhc2hcIiwgXCJhbGdvcml0aG0uaGFzaFwiLCBcIkluY29ycmVjdCBoYXNoIGFsZ29yaXRobTogSGFzaCBhbGdvcml0aG0gaXMgbWlzc2VkXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChhbGcuaGFzaC5uYW1lLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTFcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmFsZyA9IFwiUlNBLU9BRVBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlNIQS0yNTZcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmFsZyA9IFwiUlNBLU9BRVAtMjU2XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtMzg0XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5hbGcgPSBcIlJTQS1PQUVQLTM4NFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTUxMlwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2suYWxnID0gXCJSU0EtT0FFUC01MTJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbmNvcnJlY3QgaGFzaCBhbGdvcml0aG06ICR7YWxnLmhhc2gubmFtZS50b1VwcGVyQ2FzZSgpfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHB1YmxpY0tleUpTT04gPSBwdWJsaWNLZXlJbmZvLnRvSlNPTigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKGp3aywgcHVibGljS2V5SlNPTik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlJTQUVTLVBLQ1MxLVYxXzVcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5rdHkgPSBcIlJTQVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2suZXh0ID0gZXh0cmFjdGFibGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5rZXlfb3BzID0ga2V5VXNhZ2VzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2suYWxnID0gXCJQUzFcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHVibGljS2V5SlNPTiA9IHB1YmxpY0tleUluZm8udG9KU09OKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oandrLCBwdWJsaWNLZXlKU09OKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5jb3JyZWN0IGFsZ29yaXRobSBuYW1lOiAke2FsZy5uYW1lLnRvVXBwZXJDYXNlKCl9YCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwicGtjczhcIjpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHByaXZhdGVLZXlJbmZvID0gbmV3IFByaXZhdGVLZXlJbmZvKCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuZnJvbUJFUihwdnRzdXRpbHMuQnVmZmVyU291cmNlQ29udmVydGVyLnRvQXJyYXlCdWZmZXIoa2V5RGF0YSkpO1xuICAgICAgICAgICAgICAgICAgICBBc25FcnJvci5hc3NlcnQoYXNuMSwgXCJrZXlEYXRhXCIpO1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJpdmF0ZUtleUluZm8uZnJvbVNjaGVtYShhc24xLnJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2gge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW5jb3JyZWN0IGtleURhdGFcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFwcml2YXRlS2V5SW5mby5wYXJzZWRLZXkpXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbmNvcnJlY3Qga2V5RGF0YVwiKTtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChhbGcubmFtZS50b1VwcGVyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiUlNBLVBTU1wiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICgoX2EgPSBhbGcuaGFzaCkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLm5hbWUudG9VcHBlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlNIQS0xXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmFsZyA9IFwiUFMxXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTI1NlwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5hbGcgPSBcIlBTMjU2XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTM4NFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5hbGcgPSBcIlBTMzg0XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTUxMlwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5hbGcgPSBcIlBTNTEyXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5jb3JyZWN0IGhhc2ggYWxnb3JpdGhtOiAkeyhfYiA9IGFsZy5oYXNoKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IubmFtZS50b1VwcGVyQ2FzZSgpfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlJTQVNTQS1QS0NTMS1WMV81XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlVc2FnZXMgPSBbXCJzaWduXCJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2sua3R5ID0gXCJSU0FcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmV4dCA9IGV4dHJhY3RhYmxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2sua2V5X29wcyA9IGtleVVzYWdlcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByaXZhdGVLZXlJbmZvLnByaXZhdGVLZXlBbGdvcml0aG0uYWxnb3JpdGhtSWQgIT09IFwiMS4yLjg0MC4xMTM1NDkuMS4xLjFcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5jb3JyZWN0IHByaXZhdGUga2V5IGFsZ29yaXRobTogJHtwcml2YXRlS2V5SW5mby5wcml2YXRlS2V5QWxnb3JpdGhtLmFsZ29yaXRobUlkfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKFwiYWxnXCIgaW4gandrKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoKF9jID0gYWxnLmhhc2gpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy5uYW1lLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTFcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmFsZyA9IFwiUlMxXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtMjU2XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5hbGcgPSBcIlJTMjU2XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtMzg0XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5hbGcgPSBcIlJTMzg0XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtNTEyXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5hbGcgPSBcIlJTNTEyXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5jb3JyZWN0IGhhc2ggYWxnb3JpdGhtOiAkeyhfZCA9IGFsZy5oYXNoKSA9PT0gbnVsbCB8fCBfZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2QubmFtZS50b1VwcGVyQ2FzZSgpfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByaXZhdGVLZXlKU09OID0gcHJpdmF0ZUtleUluZm8udG9KU09OKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oandrLCBwcml2YXRlS2V5SlNPTik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIkVDRFNBXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5VXNhZ2VzID0gW1wic2lnblwiXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJFQ0RIXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2sgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrdHk6IFwiRUNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dDogZXh0cmFjdGFibGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlfb3BzOiBrZXlVc2FnZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByaXZhdGVLZXlJbmZvLnByaXZhdGVLZXlBbGdvcml0aG0uYWxnb3JpdGhtSWQgIT09IFwiMS4yLjg0MC4xMDA0NS4yLjFcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5jb3JyZWN0IGFsZ29yaXRobTogJHtwcml2YXRlS2V5SW5mby5wcml2YXRlS2V5QWxnb3JpdGhtLmFsZ29yaXRobUlkfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcml2YXRlS2V5SlNPTiA9IHByaXZhdGVLZXlJbmZvLnRvSlNPTigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKGp3aywgcHJpdmF0ZUtleUpTT04pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJSU0EtT0FFUFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmt0eSA9IFwiUlNBXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5leHQgPSBleHRyYWN0YWJsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmtleV9vcHMgPSBrZXlVc2FnZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm5hbWUudG9Mb3dlckNhc2UoKSA9PT0gXCJzYWZhcmlcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5hbGcgPSBcIlJTQS1PQUVQXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICgoX2UgPSBhbGcuaGFzaCkgPT09IG51bGwgfHwgX2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9lLm5hbWUudG9VcHBlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtMVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2suYWxnID0gXCJSU0EtT0FFUFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTI1NlwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2suYWxnID0gXCJSU0EtT0FFUC0yNTZcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlNIQS0zODRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmFsZyA9IFwiUlNBLU9BRVAtMzg0XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtNTEyXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5hbGcgPSBcIlJTQS1PQUVQLTUxMlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBoYXNoIGFsZ29yaXRobTogJHsoX2YgPSBhbGcuaGFzaCkgPT09IG51bGwgfHwgX2YgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9mLm5hbWUudG9VcHBlckNhc2UoKX1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcml2YXRlS2V5SlNPTiA9IHByaXZhdGVLZXlJbmZvLnRvSlNPTigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKGp3aywgcHJpdmF0ZUtleUpTT04pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJSU0FFUy1QS0NTMS1WMV81XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlVc2FnZXMgPSBbXCJkZWNyeXB0XCJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2sua3R5ID0gXCJSU0FcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmV4dCA9IGV4dHJhY3RhYmxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2sua2V5X29wcyA9IGtleVVzYWdlcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmFsZyA9IFwiUFMxXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByaXZhdGVLZXlKU09OID0gcHJpdmF0ZUtleUluZm8udG9KU09OKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oandrLCBwcml2YXRlS2V5SlNPTik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBhbGdvcml0aG0gbmFtZTogJHthbGcubmFtZS50b1VwcGVyQ2FzZSgpfWApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImp3a1wiOlxuICAgICAgICAgICAgICAgIGp3ayA9IGtleURhdGE7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5jb3JyZWN0IGZvcm1hdDogJHtmb3JtYXR9YCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubmFtZS50b0xvd2VyQ2FzZSgpID09PSBcInNhZmFyaVwiKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnN1YnRsZS5pbXBvcnRLZXkoXCJqd2tcIiwgcHZ1dGlscy5zdHJpbmdUb0FycmF5QnVmZmVyKEpTT04uc3RyaW5naWZ5KGp3aykpLCBhbGdvcml0aG0sIGV4dHJhY3RhYmxlLCBrZXlVc2FnZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2gge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnN1YnRsZS5pbXBvcnRLZXkoXCJqd2tcIiwgandrLCBhbGdvcml0aG0sIGV4dHJhY3RhYmxlLCBrZXlVc2FnZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnN1YnRsZS5pbXBvcnRLZXkoXCJqd2tcIiwgandrLCBhbGdvcml0aG0sIGV4dHJhY3RhYmxlLCBrZXlVc2FnZXMpO1xuICAgIH1cbiAgICBhc3luYyBleHBvcnRLZXkoZm9ybWF0LCBrZXkpIHtcbiAgICAgICAgbGV0IGp3ayA9IGF3YWl0IHRoaXMuc3VidGxlLmV4cG9ydEtleShcImp3a1wiLCBrZXkpO1xuICAgICAgICBpZiAodGhpcy5uYW1lLnRvTG93ZXJDYXNlKCkgPT09IFwic2FmYXJpXCIpIHtcbiAgICAgICAgICAgIGlmIChqd2sgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikge1xuICAgICAgICAgICAgICAgIGp3ayA9IEpTT04ucGFyc2UocHZ1dGlscy5hcnJheUJ1ZmZlclRvU3RyaW5nKGp3aykpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHN3aXRjaCAoZm9ybWF0LnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgIGNhc2UgXCJyYXdcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zdWJ0bGUuZXhwb3J0S2V5KFwicmF3XCIsIGtleSk7XG4gICAgICAgICAgICBjYXNlIFwic3BraVwiOiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcHVibGljS2V5SW5mbyA9IG5ldyBQdWJsaWNLZXlJbmZvKCk7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgcHVibGljS2V5SW5mby5mcm9tSlNPTihqd2spO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkluY29ycmVjdCBrZXkgZGF0YVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHB1YmxpY0tleUluZm8udG9TY2hlbWEoKS50b0JFUihmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFwicGtjczhcIjoge1xuICAgICAgICAgICAgICAgIGNvbnN0IHByaXZhdGVLZXlJbmZvID0gbmV3IFByaXZhdGVLZXlJbmZvKCk7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgcHJpdmF0ZUtleUluZm8uZnJvbUpTT04oandrKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2gge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbmNvcnJlY3Qga2V5IGRhdGFcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBwcml2YXRlS2V5SW5mby50b1NjaGVtYSgpLnRvQkVSKGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgXCJqd2tcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gandrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBmb3JtYXQ6ICR7Zm9ybWF0fWApO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFzeW5jIGNvbnZlcnQoaW5wdXRGb3JtYXQsIG91dHB1dEZvcm1hdCwga2V5RGF0YSwgYWxnb3JpdGhtLCBleHRyYWN0YWJsZSwga2V5VXNhZ2VzKSB7XG4gICAgICAgIGlmIChpbnB1dEZvcm1hdC50b0xvd2VyQ2FzZSgpID09PSBvdXRwdXRGb3JtYXQudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgcmV0dXJuIGtleURhdGE7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qga2V5ID0gYXdhaXQgdGhpcy5pbXBvcnRLZXkoaW5wdXRGb3JtYXQsIGtleURhdGEsIGFsZ29yaXRobSwgZXh0cmFjdGFibGUsIGtleVVzYWdlcyk7XG4gICAgICAgIHJldHVybiB0aGlzLmV4cG9ydEtleShvdXRwdXRGb3JtYXQsIGtleSk7XG4gICAgfVxuICAgIGdldEFsZ29yaXRobUJ5T0lEKG9pZCwgc2FmZXR5ID0gZmFsc2UsIHRhcmdldCkge1xuICAgICAgICBzd2l0Y2ggKG9pZCkge1xuICAgICAgICAgICAgY2FzZSBcIjEuMi44NDAuMTEzNTQ5LjEuMS4xXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJSU0FFUy1QS0NTMS12MV81XCJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjEuMi44NDAuMTEzNTQ5LjEuMS41XCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJSU0FTU0EtUEtDUzEtdjFfNVwiLFxuICAgICAgICAgICAgICAgICAgICBoYXNoOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlNIQS0xXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMTM1NDkuMS4xLjExXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJSU0FTU0EtUEtDUzEtdjFfNVwiLFxuICAgICAgICAgICAgICAgICAgICBoYXNoOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlNIQS0yNTZcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIxLjIuODQwLjExMzU0OS4xLjEuMTJcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlJTQVNTQS1QS0NTMS12MV81XCIsXG4gICAgICAgICAgICAgICAgICAgIGhhc2g6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiU0hBLTM4NFwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjEuMi44NDAuMTEzNTQ5LjEuMS4xM1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiUlNBU1NBLVBLQ1MxLXYxXzVcIixcbiAgICAgICAgICAgICAgICAgICAgaGFzaDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJTSEEtNTEyXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMTM1NDkuMS4xLjEwXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJSU0EtUFNTXCJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjEuMi44NDAuMTEzNTQ5LjEuMS43XCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJSU0EtT0FFUFwiXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIxLjIuODQwLjEwMDQ1LjIuMVwiOlxuICAgICAgICAgICAgY2FzZSBcIjEuMi44NDAuMTAwNDUuNC4xXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJFQ0RTQVwiLFxuICAgICAgICAgICAgICAgICAgICBoYXNoOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlNIQS0xXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMDA0NS40LjMuMlwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiRUNEU0FcIixcbiAgICAgICAgICAgICAgICAgICAgaGFzaDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJTSEEtMjU2XCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMDA0NS40LjMuM1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiRUNEU0FcIixcbiAgICAgICAgICAgICAgICAgICAgaGFzaDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJTSEEtMzg0XCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMDA0NS40LjMuNFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiRUNEU0FcIixcbiAgICAgICAgICAgICAgICAgICAgaGFzaDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJTSEEtNTEyXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFwiMS4zLjEzMy4xNi44NDAuNjMuMC4yXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJFQ0RIXCIsXG4gICAgICAgICAgICAgICAgICAgIGtkZjogXCJTSEEtMVwiXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIxLjMuMTMyLjEuMTEuMVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiRUNESFwiLFxuICAgICAgICAgICAgICAgICAgICBrZGY6IFwiU0hBLTI1NlwiXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIxLjMuMTMyLjEuMTEuMlwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiRUNESFwiLFxuICAgICAgICAgICAgICAgICAgICBrZGY6IFwiU0hBLTM4NFwiXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIxLjMuMTMyLjEuMTEuM1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiRUNESFwiLFxuICAgICAgICAgICAgICAgICAgICBrZGY6IFwiU0hBLTUxMlwiXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIyLjE2Ljg0MC4xLjEwMS4zLjQuMS4yXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJBRVMtQ0JDXCIsXG4gICAgICAgICAgICAgICAgICAgIGxlbmd0aDogMTI4XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIyLjE2Ljg0MC4xLjEwMS4zLjQuMS4yMlwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiQUVTLUNCQ1wiLFxuICAgICAgICAgICAgICAgICAgICBsZW5ndGg6IDE5MlxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFwiMi4xNi44NDAuMS4xMDEuMy40LjEuNDJcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkFFUy1DQkNcIixcbiAgICAgICAgICAgICAgICAgICAgbGVuZ3RoOiAyNTZcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjIuMTYuODQwLjEuMTAxLjMuNC4xLjZcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkFFUy1HQ01cIixcbiAgICAgICAgICAgICAgICAgICAgbGVuZ3RoOiAxMjhcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjIuMTYuODQwLjEuMTAxLjMuNC4xLjI2XCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJBRVMtR0NNXCIsXG4gICAgICAgICAgICAgICAgICAgIGxlbmd0aDogMTkyXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIyLjE2Ljg0MC4xLjEwMS4zLjQuMS40NlwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiQUVTLUdDTVwiLFxuICAgICAgICAgICAgICAgICAgICBsZW5ndGg6IDI1NlxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFwiMi4xNi44NDAuMS4xMDEuMy40LjEuNFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiQUVTLUNGQlwiLFxuICAgICAgICAgICAgICAgICAgICBsZW5ndGg6IDEyOFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFwiMi4xNi44NDAuMS4xMDEuMy40LjEuMjRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkFFUy1DRkJcIixcbiAgICAgICAgICAgICAgICAgICAgbGVuZ3RoOiAxOTJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjIuMTYuODQwLjEuMTAxLjMuNC4xLjQ0XCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJBRVMtQ0ZCXCIsXG4gICAgICAgICAgICAgICAgICAgIGxlbmd0aDogMjU2XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIyLjE2Ljg0MC4xLjEwMS4zLjQuMS41XCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJBRVMtS1dcIixcbiAgICAgICAgICAgICAgICAgICAgbGVuZ3RoOiAxMjhcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjIuMTYuODQwLjEuMTAxLjMuNC4xLjI1XCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJBRVMtS1dcIixcbiAgICAgICAgICAgICAgICAgICAgbGVuZ3RoOiAxOTJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjIuMTYuODQwLjEuMTAxLjMuNC4xLjQ1XCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJBRVMtS1dcIixcbiAgICAgICAgICAgICAgICAgICAgbGVuZ3RoOiAyNTZcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjEuMi44NDAuMTEzNTQ5LjIuN1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiSE1BQ1wiLFxuICAgICAgICAgICAgICAgICAgICBoYXNoOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlNIQS0xXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMTM1NDkuMi45XCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJITUFDXCIsXG4gICAgICAgICAgICAgICAgICAgIGhhc2g6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiU0hBLTI1NlwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjEuMi44NDAuMTEzNTQ5LjIuMTBcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkhNQUNcIixcbiAgICAgICAgICAgICAgICAgICAgaGFzaDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJTSEEtMzg0XCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMTM1NDkuMi4xMVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiSE1BQ1wiLFxuICAgICAgICAgICAgICAgICAgICBoYXNoOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlNIQS01MTJcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIxLjIuODQwLjExMzU0OS4xLjkuMTYuMy41XCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJESFwiXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIxLjMuMTQuMy4yLjI2XCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJTSEEtMVwiXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIyLjE2Ljg0MC4xLjEwMS4zLjQuMi4xXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJTSEEtMjU2XCJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjIuMTYuODQwLjEuMTAxLjMuNC4yLjJcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlNIQS0zODRcIlxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFwiMi4xNi44NDAuMS4xMDEuMy40LjIuM1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiU0hBLTUxMlwiXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIxLjIuODQwLjExMzU0OS4xLjUuMTJcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlBCS0RGMlwiXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIxLjIuODQwLjEwMDQ1LjMuMS43XCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJQLTI1NlwiXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIxLjMuMTMyLjAuMzRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlAtMzg0XCJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjEuMy4xMzIuMC4zNVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiUC01MjFcIlxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNhZmV0eSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbnN1cHBvcnRlZCBhbGdvcml0aG0gaWRlbnRpZmllciAke3RhcmdldCA/IGBmb3IgJHt0YXJnZXR9IGAgOiBFTVBUWV9TVFJJTkd9OiAke29pZH1gKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge307XG4gICAgfVxuICAgIGdldE9JREJ5QWxnb3JpdGhtKGFsZ29yaXRobSwgc2FmZXR5ID0gZmFsc2UsIHRhcmdldCkge1xuICAgICAgICBsZXQgcmVzdWx0ID0gRU1QVFlfU1RSSU5HO1xuICAgICAgICBzd2l0Y2ggKGFsZ29yaXRobS5uYW1lLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgICAgICAgIGNhc2UgXCJSU0FFUy1QS0NTMS1WMV81XCI6XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIxLjIuODQwLjExMzU0OS4xLjEuMVwiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIlJTQVNTQS1QS0NTMS1WMV81XCI6XG4gICAgICAgICAgICAgICAgc3dpdGNoIChhbGdvcml0aG0uaGFzaC5uYW1lLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlNIQS0xXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBcIjEuMi44NDAuMTEzNTQ5LjEuMS41XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlNIQS0yNTZcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMS4yLjg0MC4xMTM1NDkuMS4xLjExXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlNIQS0zODRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMS4yLjg0MC4xMTM1NDkuMS4xLjEyXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlNIQS01MTJcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMS4yLjg0MC4xMTM1NDkuMS4xLjEzXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiUlNBLVBTU1wiOlxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMS4yLjg0MC4xMTM1NDkuMS4xLjEwXCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiUlNBLU9BRVBcIjpcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBcIjEuMi44NDAuMTEzNTQ5LjEuMS43XCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiRUNEU0FcIjpcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGFsZ29yaXRobS5oYXNoLm5hbWUudG9VcHBlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTFcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMS4yLjg0MC4xMDA0NS40LjFcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTI1NlwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIxLjIuODQwLjEwMDQ1LjQuMy4yXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlNIQS0zODRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMS4yLjg0MC4xMDA0NS40LjMuM1wiO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtNTEyXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBcIjEuMi44NDAuMTAwNDUuNC4zLjRcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJFQ0RIXCI6XG4gICAgICAgICAgICAgICAgc3dpdGNoIChhbGdvcml0aG0ua2RmLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlNIQS0xXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBcIjEuMy4xMzMuMTYuODQwLjYzLjAuMlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtMjU2XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBcIjEuMy4xMzIuMS4xMS4xXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlNIQS0zODRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMS4zLjEzMi4xLjExLjJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTUxMlwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIxLjMuMTMyLjEuMTEuM1wiO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIkFFUy1DVFJcIjpcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJBRVMtQ0JDXCI6XG4gICAgICAgICAgICAgICAgc3dpdGNoIChhbGdvcml0aG0ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTI4OlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIyLjE2Ljg0MC4xLjEwMS4zLjQuMS4yXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOTI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBcIjIuMTYuODQwLjEuMTAxLjMuNC4xLjIyXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyNTY6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBcIjIuMTYuODQwLjEuMTAxLjMuNC4xLjQyXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiQUVTLUNNQUNcIjpcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJBRVMtR0NNXCI6XG4gICAgICAgICAgICAgICAgc3dpdGNoIChhbGdvcml0aG0ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTI4OlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIyLjE2Ljg0MC4xLjEwMS4zLjQuMS42XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOTI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBcIjIuMTYuODQwLjEuMTAxLjMuNC4xLjI2XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyNTY6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBcIjIuMTYuODQwLjEuMTAxLjMuNC4xLjQ2XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiQUVTLUNGQlwiOlxuICAgICAgICAgICAgICAgIHN3aXRjaCAoYWxnb3JpdGhtLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDEyODpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMi4xNi44NDAuMS4xMDEuMy40LjEuNFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTkyOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIyLjE2Ljg0MC4xLjEwMS4zLjQuMS4yNFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjU2OlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIyLjE2Ljg0MC4xLjEwMS4zLjQuMS40NFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIkFFUy1LV1wiOlxuICAgICAgICAgICAgICAgIHN3aXRjaCAoYWxnb3JpdGhtLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDEyODpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMi4xNi44NDAuMS4xMDEuMy40LjEuNVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTkyOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIyLjE2Ljg0MC4xLjEwMS4zLjQuMS4yNVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjU2OlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIyLjE2Ljg0MC4xLjEwMS4zLjQuMS40NVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIkhNQUNcIjpcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGFsZ29yaXRobS5oYXNoLm5hbWUudG9VcHBlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTFcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMS4yLjg0MC4xMTM1NDkuMi43XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlNIQS0yNTZcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMS4yLjg0MC4xMTM1NDkuMi45XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlNIQS0zODRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMS4yLjg0MC4xMTM1NDkuMi4xMFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtNTEyXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBcIjEuMi44NDAuMTEzNTQ5LjIuMTFcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJESFwiOlxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMS4yLjg0MC4xMTM1NDkuMS45LjE2LjMuNVwiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIlNIQS0xXCI6XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIxLjMuMTQuMy4yLjI2XCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiU0hBLTI1NlwiOlxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMi4xNi44NDAuMS4xMDEuMy40LjIuMVwiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIlNIQS0zODRcIjpcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBcIjIuMTYuODQwLjEuMTAxLjMuNC4yLjJcIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJTSEEtNTEyXCI6XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIyLjE2Ljg0MC4xLjEwMS4zLjQuMi4zXCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiQ09OQ0FUXCI6XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiSEtERlwiOlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIlBCS0RGMlwiOlxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMS4yLjg0MC4xMTM1NDkuMS41LjEyXCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiUC0yNTZcIjpcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBcIjEuMi44NDAuMTAwNDUuMy4xLjdcIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJQLTM4NFwiOlxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMS4zLjEzMi4wLjM0XCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiUC01MjFcIjpcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBcIjEuMy4xMzIuMC4zNVwiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcmVzdWx0ICYmIHNhZmV0eSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbnN1cHBvcnRlZCBhbGdvcml0aG0gJHt0YXJnZXQgPyBgZm9yICR7dGFyZ2V0fSBgIDogRU1QVFlfU1RSSU5HfTogJHthbGdvcml0aG0ubmFtZX1gKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBnZXRBbGdvcml0aG1QYXJhbWV0ZXJzKGFsZ29yaXRobU5hbWUsIG9wZXJhdGlvbikge1xuICAgICAgICBsZXQgcmVzdWx0ID0ge1xuICAgICAgICAgICAgYWxnb3JpdGhtOiB7fSxcbiAgICAgICAgICAgIHVzYWdlczogW11cbiAgICAgICAgfTtcbiAgICAgICAgc3dpdGNoIChhbGdvcml0aG1OYW1lLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgICAgICAgIGNhc2UgXCJSU0FFUy1QS0NTMS1WMV81XCI6XG4gICAgICAgICAgICBjYXNlIFwiUlNBU1NBLVBLQ1MxLVYxXzVcIjpcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG9wZXJhdGlvbi50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJnZW5lcmF0ZWtleVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlJTQVNTQS1QS0NTMS12MV81XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsdXNMZW5ndGg6IDIwNDgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB1YmxpY0V4cG9uZW50OiBuZXcgVWludDhBcnJheShbMHgwMSwgMHgwMCwgMHgwMV0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNoOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlNIQS0yNTZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtcInNpZ25cIiwgXCJ2ZXJpZnlcIl1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInZlcmlmeVwiOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwic2lnblwiOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiaW1wb3J0a2V5XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiUlNBU1NBLVBLQ1MxLXYxXzVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzaDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJTSEEtMjU2XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXCJ2ZXJpZnlcIl1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImV4cG9ydGtleVwiOlxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJSU0FTU0EtUEtDUzEtdjFfNVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJSU0EtUFNTXCI6XG4gICAgICAgICAgICAgICAgc3dpdGNoIChvcGVyYXRpb24udG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwic2lnblwiOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwidmVyaWZ5XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiUlNBLVBTU1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNoOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlNIQS0xXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FsdExlbmd0aDogMjBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYWdlczogW1wic2lnblwiLCBcInZlcmlmeVwiXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZ2VuZXJhdGVrZXlcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJSU0EtUFNTXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsdXNMZW5ndGg6IDIwNDgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB1YmxpY0V4cG9uZW50OiBuZXcgVWludDhBcnJheShbMHgwMSwgMHgwMCwgMHgwMV0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNoOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlNIQS0xXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXCJzaWduXCIsIFwidmVyaWZ5XCJdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJpbXBvcnRrZXlcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJSU0EtUFNTXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc2g6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiU0hBLTFcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtcInZlcmlmeVwiXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZXhwb3J0a2V5XCI6XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlJTQS1QU1NcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiUlNBLU9BRVBcIjpcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG9wZXJhdGlvbi50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJlbmNyeXB0XCI6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJkZWNyeXB0XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiUlNBLU9BRVBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXCJlbmNyeXB0XCIsIFwiZGVjcnlwdFwiXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZ2VuZXJhdGVrZXlcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJSU0EtT0FFUFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2R1bHVzTGVuZ3RoOiAyMDQ4LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdWJsaWNFeHBvbmVudDogbmV3IFVpbnQ4QXJyYXkoWzB4MDEsIDB4MDAsIDB4MDFdKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzaDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJTSEEtMjU2XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXCJlbmNyeXB0XCIsIFwiZGVjcnlwdFwiLCBcIndyYXBLZXlcIiwgXCJ1bndyYXBLZXlcIl1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImltcG9ydGtleVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlJTQS1PQUVQXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc2g6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiU0hBLTI1NlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYWdlczogW1wiZW5jcnlwdFwiXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZXhwb3J0a2V5XCI6XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlJTQS1PQUVQXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYWdlczogW11cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIkVDRFNBXCI6XG4gICAgICAgICAgICAgICAgc3dpdGNoIChvcGVyYXRpb24udG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZ2VuZXJhdGVrZXlcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJFQ0RTQVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lZEN1cnZlOiBcIlAtMjU2XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYWdlczogW1wic2lnblwiLCBcInZlcmlmeVwiXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiaW1wb3J0a2V5XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiRUNEU0FcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZWRDdXJ2ZTogXCJQLTI1NlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtcInZlcmlmeVwiXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwidmVyaWZ5XCI6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJzaWduXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiRUNEU0FcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzaDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJTSEEtMjU2XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXCJzaWduXCJdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkVDRFNBXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYWdlczogW11cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIkVDREhcIjpcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG9wZXJhdGlvbi50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJleHBvcnRrZXlcIjpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImltcG9ydGtleVwiOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZ2VuZXJhdGVrZXlcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJFQ0RIXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVkQ3VydmU6IFwiUC0yNTZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXCJkZXJpdmVLZXlcIiwgXCJkZXJpdmVCaXRzXCJdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJkZXJpdmVrZXlcIjpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImRlcml2ZWJpdHNcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJFQ0RIXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVkQ3VydmU6IFwiUC0yNTZcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHVibGljOiBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXCJlbmNyeXB0XCIsIFwiZGVjcnlwdFwiXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJFQ0RIXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYWdlczogW11cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIkFFUy1DVFJcIjpcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG9wZXJhdGlvbi50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJpbXBvcnRrZXlcIjpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImV4cG9ydGtleVwiOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZ2VuZXJhdGVrZXlcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJBRVMtQ1RSXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlbmd0aDogMjU2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtcImVuY3J5cHRcIiwgXCJkZWNyeXB0XCIsIFwid3JhcEtleVwiLCBcInVud3JhcEtleVwiXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZGVjcnlwdFwiOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZW5jcnlwdFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkFFUy1DVFJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRlcjogbmV3IFVpbnQ4QXJyYXkoMTYpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZW5ndGg6IDEwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtcImVuY3J5cHRcIiwgXCJkZWNyeXB0XCIsIFwid3JhcEtleVwiLCBcInVud3JhcEtleVwiXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJBRVMtQ1RSXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYWdlczogW11cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIkFFUy1DQkNcIjpcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG9wZXJhdGlvbi50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJpbXBvcnRrZXlcIjpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImV4cG9ydGtleVwiOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZ2VuZXJhdGVrZXlcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJBRVMtQ0JDXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlbmd0aDogMjU2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtcImVuY3J5cHRcIiwgXCJkZWNyeXB0XCIsIFwid3JhcEtleVwiLCBcInVud3JhcEtleVwiXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZGVjcnlwdFwiOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZW5jcnlwdFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkFFUy1DQkNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXY6IHRoaXMuZ2V0UmFuZG9tVmFsdWVzKG5ldyBVaW50OEFycmF5KDE2KSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYWdlczogW1wiZW5jcnlwdFwiLCBcImRlY3J5cHRcIiwgXCJ3cmFwS2V5XCIsIFwidW53cmFwS2V5XCJdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkFFUy1DQkNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiQUVTLUdDTVwiOlxuICAgICAgICAgICAgICAgIHN3aXRjaCAob3BlcmF0aW9uLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImltcG9ydGtleVwiOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZXhwb3J0a2V5XCI6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJnZW5lcmF0ZWtleVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkFFUy1HQ01cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVuZ3RoOiAyNTZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYWdlczogW1wiZW5jcnlwdFwiLCBcImRlY3J5cHRcIiwgXCJ3cmFwS2V5XCIsIFwidW53cmFwS2V5XCJdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJkZWNyeXB0XCI6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJlbmNyeXB0XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiQUVTLUdDTVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdjogdGhpcy5nZXRSYW5kb21WYWx1ZXMobmV3IFVpbnQ4QXJyYXkoMTYpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXCJlbmNyeXB0XCIsIFwiZGVjcnlwdFwiLCBcIndyYXBLZXlcIiwgXCJ1bndyYXBLZXlcIl1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiQUVTLUdDTVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJBRVMtS1dcIjpcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG9wZXJhdGlvbi50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJpbXBvcnRrZXlcIjpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImV4cG9ydGtleVwiOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZ2VuZXJhdGVrZXlcIjpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIndyYXBrZXlcIjpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInVud3JhcGtleVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkFFUy1LV1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZW5ndGg6IDI1NlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXCJ3cmFwS2V5XCIsIFwidW53cmFwS2V5XCJdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkFFUy1LV1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJITUFDXCI6XG4gICAgICAgICAgICAgICAgc3dpdGNoIChvcGVyYXRpb24udG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwic2lnblwiOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwidmVyaWZ5XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiSE1BQ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtcInNpZ25cIiwgXCJ2ZXJpZnlcIl1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImltcG9ydGtleVwiOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZXhwb3J0a2V5XCI6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJnZW5lcmF0ZWtleVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkhNQUNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVuZ3RoOiAzMixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzaDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJTSEEtMjU2XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXCJzaWduXCIsIFwidmVyaWZ5XCJdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkhNQUNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiSEtERlwiOlxuICAgICAgICAgICAgICAgIHN3aXRjaCAob3BlcmF0aW9uLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImRlcml2ZWtleVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkhLREZcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzaDogXCJTSEEtMjU2XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhbHQ6IG5ldyBVaW50OEFycmF5KFtdKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mbzogbmV3IFVpbnQ4QXJyYXkoW10pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtcImVuY3J5cHRcIiwgXCJkZWNyeXB0XCJdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkhLREZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiUEJLREYyXCI6XG4gICAgICAgICAgICAgICAgc3dpdGNoIChvcGVyYXRpb24udG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZGVyaXZla2V5XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiUEJLREYyXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc2g6IHsgbmFtZTogXCJTSEEtMjU2XCIgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FsdDogbmV3IFVpbnQ4QXJyYXkoW10pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVyYXRpb25zOiAxMDAwMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXCJlbmNyeXB0XCIsIFwiZGVjcnlwdFwiXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJQQktERjJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgZ2V0SGFzaEFsZ29yaXRobShzaWduYXR1cmVBbGdvcml0aG0pIHtcbiAgICAgICAgbGV0IHJlc3VsdCA9IEVNUFRZX1NUUklORztcbiAgICAgICAgc3dpdGNoIChzaWduYXR1cmVBbGdvcml0aG0uYWxnb3JpdGhtSWQpIHtcbiAgICAgICAgICAgIGNhc2UgXCIxLjIuODQwLjEwMDQ1LjQuMVwiOlxuICAgICAgICAgICAgY2FzZSBcIjEuMi44NDAuMTEzNTQ5LjEuMS41XCI6XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gXCJTSEEtMVwiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIjEuMi44NDAuMTAwNDUuNC4zLjJcIjpcbiAgICAgICAgICAgIGNhc2UgXCIxLjIuODQwLjExMzU0OS4xLjEuMTFcIjpcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBcIlNIQS0yNTZcIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCIxLjIuODQwLjEwMDQ1LjQuMy4zXCI6XG4gICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMTM1NDkuMS4xLjEyXCI6XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gXCJTSEEtMzg0XCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMDA0NS40LjMuNFwiOlxuICAgICAgICAgICAgY2FzZSBcIjEuMi44NDAuMTEzNTQ5LjEuMS4xM1wiOlxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiU0hBLTUxMlwiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIjEuMi44NDAuMTEzNTQ5LjEuMS4xMFwiOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcmFtcyA9IG5ldyBSU0FTU0FQU1NQYXJhbXMoeyBzY2hlbWE6IHNpZ25hdHVyZUFsZ29yaXRobS5hbGdvcml0aG1QYXJhbXMgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyYW1zLmhhc2hBbGdvcml0aG0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhbGdvcml0aG0gPSB0aGlzLmdldEFsZ29yaXRobUJ5T0lEKHBhcmFtcy5oYXNoQWxnb3JpdGhtLmFsZ29yaXRobUlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoXCJuYW1lXCIgaW4gYWxnb3JpdGhtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFsZ29yaXRobS5uYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX1NUUklORztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gXCJTSEEtMVwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIHtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBhc3luYyBlbmNyeXB0RW5jcnlwdGVkQ29udGVudEluZm8ocGFyYW1ldGVycykge1xuICAgICAgICBQYXJhbWV0ZXJFcnJvci5hc3NlcnQocGFyYW1ldGVycywgXCJwYXNzd29yZFwiLCBcImNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtXCIsIFwiaG1hY0hhc2hBbGdvcml0aG1cIiwgXCJpdGVyYXRpb25Db3VudFwiLCBcImNvbnRlbnRUb0VuY3J5cHRcIiwgXCJjb250ZW50VG9FbmNyeXB0XCIsIFwiY29udGVudFR5cGVcIik7XG4gICAgICAgIGNvbnN0IGNvbnRlbnRFbmNyeXB0aW9uT0lEID0gdGhpcy5nZXRPSURCeUFsZ29yaXRobShwYXJhbWV0ZXJzLmNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtLCB0cnVlLCBcImNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtXCIpO1xuICAgICAgICBjb25zdCBwYmtkZjJPSUQgPSB0aGlzLmdldE9JREJ5QWxnb3JpdGhtKHtcbiAgICAgICAgICAgIG5hbWU6IFwiUEJLREYyXCJcbiAgICAgICAgfSwgdHJ1ZSwgXCJQQktERjJcIik7XG4gICAgICAgIGNvbnN0IGhtYWNPSUQgPSB0aGlzLmdldE9JREJ5QWxnb3JpdGhtKHtcbiAgICAgICAgICAgIG5hbWU6IFwiSE1BQ1wiLFxuICAgICAgICAgICAgaGFzaDoge1xuICAgICAgICAgICAgICAgIG5hbWU6IHBhcmFtZXRlcnMuaG1hY0hhc2hBbGdvcml0aG1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgdHJ1ZSwgXCJobWFjSGFzaEFsZ29yaXRobVwiKTtcbiAgICAgICAgY29uc3QgaXZCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoMTYpO1xuICAgICAgICBjb25zdCBpdlZpZXcgPSBuZXcgVWludDhBcnJheShpdkJ1ZmZlcik7XG4gICAgICAgIHRoaXMuZ2V0UmFuZG9tVmFsdWVzKGl2Vmlldyk7XG4gICAgICAgIGNvbnN0IHNhbHRCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoNjQpO1xuICAgICAgICBjb25zdCBzYWx0VmlldyA9IG5ldyBVaW50OEFycmF5KHNhbHRCdWZmZXIpO1xuICAgICAgICB0aGlzLmdldFJhbmRvbVZhbHVlcyhzYWx0Vmlldyk7XG4gICAgICAgIGNvbnN0IGNvbnRlbnRWaWV3ID0gbmV3IFVpbnQ4QXJyYXkocGFyYW1ldGVycy5jb250ZW50VG9FbmNyeXB0KTtcbiAgICAgICAgY29uc3QgcGJrZGYyUGFyYW1zID0gbmV3IFBCS0RGMlBhcmFtcyh7XG4gICAgICAgICAgICBzYWx0OiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgdmFsdWVIZXg6IHNhbHRCdWZmZXIgfSksXG4gICAgICAgICAgICBpdGVyYXRpb25Db3VudDogcGFyYW1ldGVycy5pdGVyYXRpb25Db3VudCxcbiAgICAgICAgICAgIHByZjogbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoe1xuICAgICAgICAgICAgICAgIGFsZ29yaXRobUlkOiBobWFjT0lELFxuICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogbmV3IGFzbjFqcy5OdWxsKClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBwYXNzd29yZFZpZXcgPSBuZXcgVWludDhBcnJheShwYXJhbWV0ZXJzLnBhc3N3b3JkKTtcbiAgICAgICAgY29uc3QgcGJrZGZLZXkgPSBhd2FpdCB0aGlzLmltcG9ydEtleShcInJhd1wiLCBwYXNzd29yZFZpZXcsIFwiUEJLREYyXCIsIGZhbHNlLCBbXCJkZXJpdmVLZXlcIl0pO1xuICAgICAgICBjb25zdCBkZXJpdmVkS2V5ID0gYXdhaXQgdGhpcy5kZXJpdmVLZXkoe1xuICAgICAgICAgICAgbmFtZTogXCJQQktERjJcIixcbiAgICAgICAgICAgIGhhc2g6IHtcbiAgICAgICAgICAgICAgICBuYW1lOiBwYXJhbWV0ZXJzLmhtYWNIYXNoQWxnb3JpdGhtXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2FsdDogc2FsdFZpZXcsXG4gICAgICAgICAgICBpdGVyYXRpb25zOiBwYXJhbWV0ZXJzLml0ZXJhdGlvbkNvdW50XG4gICAgICAgIH0sIHBia2RmS2V5LCBwYXJhbWV0ZXJzLmNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtLCBmYWxzZSwgW1wiZW5jcnlwdFwiXSk7XG4gICAgICAgIGNvbnN0IGVuY3J5cHRlZERhdGEgPSBhd2FpdCB0aGlzLmVuY3J5cHQoe1xuICAgICAgICAgICAgbmFtZTogcGFyYW1ldGVycy5jb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobS5uYW1lLFxuICAgICAgICAgICAgaXY6IGl2Vmlld1xuICAgICAgICB9LCBkZXJpdmVkS2V5LCBjb250ZW50Vmlldyk7XG4gICAgICAgIGNvbnN0IHBiZXMyUGFyYW1ldGVycyA9IG5ldyBQQkVTMlBhcmFtcyh7XG4gICAgICAgICAgICBrZXlEZXJpdmF0aW9uRnVuYzogbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoe1xuICAgICAgICAgICAgICAgIGFsZ29yaXRobUlkOiBwYmtkZjJPSUQsXG4gICAgICAgICAgICAgICAgYWxnb3JpdGhtUGFyYW1zOiBwYmtkZjJQYXJhbXMudG9TY2hlbWEoKVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBlbmNyeXB0aW9uU2NoZW1lOiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgYWxnb3JpdGhtSWQ6IGNvbnRlbnRFbmNyeXB0aW9uT0lELFxuICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiBpdkJ1ZmZlciB9KVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBuZXcgRW5jcnlwdGVkQ29udGVudEluZm8oe1xuICAgICAgICAgICAgY29udGVudFR5cGU6IHBhcmFtZXRlcnMuY29udGVudFR5cGUsXG4gICAgICAgICAgICBjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobTogbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoe1xuICAgICAgICAgICAgICAgIGFsZ29yaXRobUlkOiBcIjEuMi44NDAuMTEzNTQ5LjEuNS4xM1wiLFxuICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogcGJlczJQYXJhbWV0ZXJzLnRvU2NoZW1hKClcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgZW5jcnlwdGVkQ29udGVudDogbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiBlbmNyeXB0ZWREYXRhIH0pXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBhc3luYyBkZWNyeXB0RW5jcnlwdGVkQ29udGVudEluZm8ocGFyYW1ldGVycykge1xuICAgICAgICBQYXJhbWV0ZXJFcnJvci5hc3NlcnQocGFyYW1ldGVycywgXCJwYXNzd29yZFwiLCBcImVuY3J5cHRlZENvbnRlbnRJbmZvXCIpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5lbmNyeXB0ZWRDb250ZW50SW5mby5jb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobS5hbGdvcml0aG1JZCAhPT0gXCIxLjIuODQwLjExMzU0OS4xLjUuMTNcIilcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBcImNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtXCI6ICR7cGFyYW1ldGVycy5lbmNyeXB0ZWRDb250ZW50SW5mby5jb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobS5hbGdvcml0aG1JZH1gKTtcbiAgICAgICAgbGV0IHBiZXMyUGFyYW1ldGVycztcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHBiZXMyUGFyYW1ldGVycyA9IG5ldyBQQkVTMlBhcmFtcyh7IHNjaGVtYTogcGFyYW1ldGVycy5lbmNyeXB0ZWRDb250ZW50SW5mby5jb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobS5hbGdvcml0aG1QYXJhbXMgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2gge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW5jb3JyZWN0bHkgZW5jb2RlZCBcXFwicGJlczJQYXJhbWV0ZXJzXFxcIlwiKTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgcGJrZGYyUGFyYW1zO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcGJrZGYyUGFyYW1zID0gbmV3IFBCS0RGMlBhcmFtcyh7IHNjaGVtYTogcGJlczJQYXJhbWV0ZXJzLmtleURlcml2YXRpb25GdW5jLmFsZ29yaXRobVBhcmFtcyB9KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbmNvcnJlY3RseSBlbmNvZGVkIFxcXCJwYmtkZjJQYXJhbXNcXFwiXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtID0gdGhpcy5nZXRBbGdvcml0aG1CeU9JRChwYmVzMlBhcmFtZXRlcnMuZW5jcnlwdGlvblNjaGVtZS5hbGdvcml0aG1JZCwgdHJ1ZSk7XG4gICAgICAgIGNvbnN0IGl2QnVmZmVyID0gcGJlczJQYXJhbWV0ZXJzLmVuY3J5cHRpb25TY2hlbWUuYWxnb3JpdGhtUGFyYW1zLnZhbHVlQmxvY2sudmFsdWVIZXg7XG4gICAgICAgIGNvbnN0IGl2VmlldyA9IG5ldyBVaW50OEFycmF5KGl2QnVmZmVyKTtcbiAgICAgICAgY29uc3Qgc2FsdEJ1ZmZlciA9IHBia2RmMlBhcmFtcy5zYWx0LnZhbHVlQmxvY2sudmFsdWVIZXg7XG4gICAgICAgIGNvbnN0IHNhbHRWaWV3ID0gbmV3IFVpbnQ4QXJyYXkoc2FsdEJ1ZmZlcik7XG4gICAgICAgIGNvbnN0IGl0ZXJhdGlvbkNvdW50ID0gcGJrZGYyUGFyYW1zLml0ZXJhdGlvbkNvdW50O1xuICAgICAgICBsZXQgaG1hY0hhc2hBbGdvcml0aG0gPSBcIlNIQS0xXCI7XG4gICAgICAgIGlmIChwYmtkZjJQYXJhbXMucHJmKSB7XG4gICAgICAgICAgICBjb25zdCBhbGdvcml0aG0gPSB0aGlzLmdldEFsZ29yaXRobUJ5T0lEKHBia2RmMlBhcmFtcy5wcmYuYWxnb3JpdGhtSWQsIHRydWUpO1xuICAgICAgICAgICAgaG1hY0hhc2hBbGdvcml0aG0gPSBhbGdvcml0aG0uaGFzaC5uYW1lO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHBia2RmS2V5ID0gYXdhaXQgdGhpcy5pbXBvcnRLZXkoXCJyYXdcIiwgcGFyYW1ldGVycy5wYXNzd29yZCwgXCJQQktERjJcIiwgZmFsc2UsIFtcImRlcml2ZUtleVwiXSk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZGVyaXZlS2V5KHtcbiAgICAgICAgICAgIG5hbWU6IFwiUEJLREYyXCIsXG4gICAgICAgICAgICBoYXNoOiB7XG4gICAgICAgICAgICAgICAgbmFtZTogaG1hY0hhc2hBbGdvcml0aG1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzYWx0OiBzYWx0VmlldyxcbiAgICAgICAgICAgIGl0ZXJhdGlvbnM6IGl0ZXJhdGlvbkNvdW50XG4gICAgICAgIH0sIHBia2RmS2V5LCBjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobSwgZmFsc2UsIFtcImRlY3J5cHRcIl0pO1xuICAgICAgICBjb25zdCBkYXRhQnVmZmVyID0gcGFyYW1ldGVycy5lbmNyeXB0ZWRDb250ZW50SW5mby5nZXRFbmNyeXB0ZWRDb250ZW50KCk7XG4gICAgICAgIHJldHVybiB0aGlzLmRlY3J5cHQoe1xuICAgICAgICAgICAgbmFtZTogY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0ubmFtZSxcbiAgICAgICAgICAgIGl2OiBpdlZpZXdcbiAgICAgICAgfSwgcmVzdWx0LCBkYXRhQnVmZmVyKTtcbiAgICB9XG4gICAgYXN5bmMgc3RhbXBEYXRhV2l0aFBhc3N3b3JkKHBhcmFtZXRlcnMpIHtcbiAgICAgICAgaWYgKChwYXJhbWV0ZXJzIGluc3RhbmNlb2YgT2JqZWN0KSA9PT0gZmFsc2UpXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQYXJhbWV0ZXJzIG11c3QgaGF2ZSB0eXBlIFxcXCJPYmplY3RcXFwiXCIpO1xuICAgICAgICBQYXJhbWV0ZXJFcnJvci5hc3NlcnQocGFyYW1ldGVycywgXCJwYXNzd29yZFwiLCBcImhhc2hBbGdvcml0aG1cIiwgXCJpdGVyYXRpb25Db3VudFwiLCBcInNhbHRcIiwgXCJjb250ZW50VG9TdGFtcFwiKTtcbiAgICAgICAgbGV0IGxlbmd0aDtcbiAgICAgICAgc3dpdGNoIChwYXJhbWV0ZXJzLmhhc2hBbGdvcml0aG0udG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgY2FzZSBcInNoYS0xXCI6XG4gICAgICAgICAgICAgICAgbGVuZ3RoID0gMTYwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInNoYS0yNTZcIjpcbiAgICAgICAgICAgICAgICBsZW5ndGggPSAyNTY7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwic2hhLTM4NFwiOlxuICAgICAgICAgICAgICAgIGxlbmd0aCA9IDM4NDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJzaGEtNTEyXCI6XG4gICAgICAgICAgICAgICAgbGVuZ3RoID0gNTEyO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBcInBhcmFtZXRlcnMuaGFzaEFsZ29yaXRobVwiIHBhcmFtZXRlcjogJHtwYXJhbWV0ZXJzLmhhc2hBbGdvcml0aG19YCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaG1hY0FsZ29yaXRobSA9IHtcbiAgICAgICAgICAgIG5hbWU6IFwiSE1BQ1wiLFxuICAgICAgICAgICAgbGVuZ3RoLFxuICAgICAgICAgICAgaGFzaDoge1xuICAgICAgICAgICAgICAgIG5hbWU6IHBhcmFtZXRlcnMuaGFzaEFsZ29yaXRobVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBwa2NzS2V5ID0gYXdhaXQgbWFrZVBLQ1MxMkIyS2V5KHBhcmFtZXRlcnMuaGFzaEFsZ29yaXRobSwgbGVuZ3RoLCBwYXJhbWV0ZXJzLnBhc3N3b3JkLCBwYXJhbWV0ZXJzLnNhbHQsIHBhcmFtZXRlcnMuaXRlcmF0aW9uQ291bnQpO1xuICAgICAgICBjb25zdCBobWFjS2V5ID0gYXdhaXQgdGhpcy5pbXBvcnRLZXkoXCJyYXdcIiwgbmV3IFVpbnQ4QXJyYXkocGtjc0tleSksIGhtYWNBbGdvcml0aG0sIGZhbHNlLCBbXCJzaWduXCJdKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2lnbihobWFjQWxnb3JpdGhtLCBobWFjS2V5LCBuZXcgVWludDhBcnJheShwYXJhbWV0ZXJzLmNvbnRlbnRUb1N0YW1wKSk7XG4gICAgfVxuICAgIGFzeW5jIHZlcmlmeURhdGFTdGFtcGVkV2l0aFBhc3N3b3JkKHBhcmFtZXRlcnMpIHtcbiAgICAgICAgUGFyYW1ldGVyRXJyb3IuYXNzZXJ0KHBhcmFtZXRlcnMsIFwicGFzc3dvcmRcIiwgXCJoYXNoQWxnb3JpdGhtXCIsIFwic2FsdFwiLCBcIml0ZXJhdGlvbkNvdW50XCIsIFwiY29udGVudFRvVmVyaWZ5XCIsIFwic2lnbmF0dXJlVG9WZXJpZnlcIik7XG4gICAgICAgIGxldCBsZW5ndGggPSAwO1xuICAgICAgICBzd2l0Y2ggKHBhcmFtZXRlcnMuaGFzaEFsZ29yaXRobS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICBjYXNlIFwic2hhLTFcIjpcbiAgICAgICAgICAgICAgICBsZW5ndGggPSAxNjA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwic2hhLTI1NlwiOlxuICAgICAgICAgICAgICAgIGxlbmd0aCA9IDI1NjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJzaGEtMzg0XCI6XG4gICAgICAgICAgICAgICAgbGVuZ3RoID0gMzg0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInNoYS01MTJcIjpcbiAgICAgICAgICAgICAgICBsZW5ndGggPSA1MTI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5jb3JyZWN0IFwicGFyYW1ldGVycy5oYXNoQWxnb3JpdGhtXCIgcGFyYW1ldGVyOiAke3BhcmFtZXRlcnMuaGFzaEFsZ29yaXRobX1gKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBobWFjQWxnb3JpdGhtID0ge1xuICAgICAgICAgICAgbmFtZTogXCJITUFDXCIsXG4gICAgICAgICAgICBsZW5ndGgsXG4gICAgICAgICAgICBoYXNoOiB7XG4gICAgICAgICAgICAgICAgbmFtZTogcGFyYW1ldGVycy5oYXNoQWxnb3JpdGhtXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHBrY3NLZXkgPSBhd2FpdCBtYWtlUEtDUzEyQjJLZXkocGFyYW1ldGVycy5oYXNoQWxnb3JpdGhtLCBsZW5ndGgsIHBhcmFtZXRlcnMucGFzc3dvcmQsIHBhcmFtZXRlcnMuc2FsdCwgcGFyYW1ldGVycy5pdGVyYXRpb25Db3VudCk7XG4gICAgICAgIGNvbnN0IGhtYWNLZXkgPSBhd2FpdCB0aGlzLmltcG9ydEtleShcInJhd1wiLCBuZXcgVWludDhBcnJheShwa2NzS2V5KSwgaG1hY0FsZ29yaXRobSwgZmFsc2UsIFtcInZlcmlmeVwiXSk7XG4gICAgICAgIHJldHVybiB0aGlzLnZlcmlmeShobWFjQWxnb3JpdGhtLCBobWFjS2V5LCBuZXcgVWludDhBcnJheShwYXJhbWV0ZXJzLnNpZ25hdHVyZVRvVmVyaWZ5KSwgbmV3IFVpbnQ4QXJyYXkocGFyYW1ldGVycy5jb250ZW50VG9WZXJpZnkpKTtcbiAgICB9XG4gICAgYXN5bmMgZ2V0U2lnbmF0dXJlUGFyYW1ldGVycyhwcml2YXRlS2V5LCBoYXNoQWxnb3JpdGhtID0gXCJTSEEtMVwiKSB7XG4gICAgICAgIHRoaXMuZ2V0T0lEQnlBbGdvcml0aG0oeyBuYW1lOiBoYXNoQWxnb3JpdGhtIH0sIHRydWUsIFwiaGFzaEFsZ29yaXRobVwiKTtcbiAgICAgICAgY29uc3Qgc2lnbmF0dXJlQWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgY29uc3QgcGFyYW1ldGVycyA9IHRoaXMuZ2V0QWxnb3JpdGhtUGFyYW1ldGVycyhwcml2YXRlS2V5LmFsZ29yaXRobS5uYW1lLCBcInNpZ25cIik7XG4gICAgICAgIGlmICghT2JqZWN0LmtleXMocGFyYW1ldGVycy5hbGdvcml0aG0pLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUGFyYW1ldGVyICdhbGdvcml0aG0nIGlzIGVtcHR5XCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGFsZ29yaXRobSA9IHBhcmFtZXRlcnMuYWxnb3JpdGhtO1xuICAgICAgICBpZiAoXCJoYXNoXCIgaW4gcHJpdmF0ZUtleS5hbGdvcml0aG0gJiYgcHJpdmF0ZUtleS5hbGdvcml0aG0uaGFzaCAmJiBwcml2YXRlS2V5LmFsZ29yaXRobS5oYXNoLm5hbWUpIHtcbiAgICAgICAgICAgIGFsZ29yaXRobS5oYXNoLm5hbWUgPSBwcml2YXRlS2V5LmFsZ29yaXRobS5oYXNoLm5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBhbGdvcml0aG0uaGFzaC5uYW1lID0gaGFzaEFsZ29yaXRobTtcbiAgICAgICAgfVxuICAgICAgICBzd2l0Y2ggKHByaXZhdGVLZXkuYWxnb3JpdGhtLm5hbWUudG9VcHBlckNhc2UoKSkge1xuICAgICAgICAgICAgY2FzZSBcIlJTQVNTQS1QS0NTMS1WMV81XCI6XG4gICAgICAgICAgICBjYXNlIFwiRUNEU0FcIjpcbiAgICAgICAgICAgICAgICBzaWduYXR1cmVBbGdvcml0aG0uYWxnb3JpdGhtSWQgPSB0aGlzLmdldE9JREJ5QWxnb3JpdGhtKGFsZ29yaXRobSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiUlNBLVBTU1wiOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChhbGdvcml0aG0uaGFzaC5uYW1lLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtMjU2XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtLnNhbHRMZW5ndGggPSAzMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtMzg0XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtLnNhbHRMZW5ndGggPSA0ODtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtNTEyXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtLnNhbHRMZW5ndGggPSA2NDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJhbXNPYmplY3QgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFsZ29yaXRobS5oYXNoLm5hbWUudG9VcHBlckNhc2UoKSAhPT0gXCJTSEEtMVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBoYXNoQWxnb3JpdGhtT0lEID0gdGhpcy5nZXRPSURCeUFsZ29yaXRobSh7IG5hbWU6IGFsZ29yaXRobS5oYXNoLm5hbWUgfSwgdHJ1ZSwgXCJoYXNoQWxnb3JpdGhtXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zT2JqZWN0Lmhhc2hBbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtSWQ6IGhhc2hBbGdvcml0aG1PSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtUGFyYW1zOiBuZXcgYXNuMWpzLk51bGwoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXNPYmplY3QubWFza0dlbkFsZ29yaXRobSA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1JZDogXCIxLjIuODQwLjExMzU0OS4xLjEuOFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogcGFyYW1zT2JqZWN0Lmhhc2hBbGdvcml0aG0udG9TY2hlbWEoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGFsZ29yaXRobS5zYWx0TGVuZ3RoICE9PSAyMClcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtc09iamVjdC5zYWx0TGVuZ3RoID0gYWxnb3JpdGhtLnNhbHRMZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBzc1BhcmFtZXRlcnMgPSBuZXcgUlNBU1NBUFNTUGFyYW1zKHBhcmFtc09iamVjdCk7XG4gICAgICAgICAgICAgICAgICAgIHNpZ25hdHVyZUFsZ29yaXRobS5hbGdvcml0aG1JZCA9IFwiMS4yLjg0MC4xMTM1NDkuMS4xLjEwXCI7XG4gICAgICAgICAgICAgICAgICAgIHNpZ25hdHVyZUFsZ29yaXRobS5hbGdvcml0aG1QYXJhbXMgPSBwc3NQYXJhbWV0ZXJzLnRvU2NoZW1hKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIHNpZ25hdHVyZSBhbGdvcml0aG06ICR7cHJpdmF0ZUtleS5hbGdvcml0aG0ubmFtZX1gKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc2lnbmF0dXJlQWxnb3JpdGhtLFxuICAgICAgICAgICAgcGFyYW1ldGVyc1xuICAgICAgICB9O1xuICAgIH1cbiAgICBhc3luYyBzaWduV2l0aFByaXZhdGVLZXkoZGF0YSwgcHJpdmF0ZUtleSwgcGFyYW1ldGVycykge1xuICAgICAgICBjb25zdCBzaWduYXR1cmUgPSBhd2FpdCB0aGlzLnNpZ24ocGFyYW1ldGVycy5hbGdvcml0aG0sIHByaXZhdGVLZXksIGRhdGEpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5hbGdvcml0aG0ubmFtZSA9PT0gXCJFQ0RTQVwiKSB7XG4gICAgICAgICAgICByZXR1cm4gY3JlYXRlQ01TRUNEU0FTaWduYXR1cmUoc2lnbmF0dXJlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2lnbmF0dXJlO1xuICAgIH1cbiAgICBmaWxsUHVibGljS2V5UGFyYW1ldGVycyhwdWJsaWNLZXlJbmZvLCBzaWduYXR1cmVBbGdvcml0aG0pIHtcbiAgICAgICAgY29uc3QgcGFyYW1ldGVycyA9IHt9O1xuICAgICAgICBjb25zdCBzaGFBbGdvcml0aG0gPSB0aGlzLmdldEhhc2hBbGdvcml0aG0oc2lnbmF0dXJlQWxnb3JpdGhtKTtcbiAgICAgICAgaWYgKHNoYUFsZ29yaXRobSA9PT0gRU1QVFlfU1RSSU5HKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbnN1cHBvcnRlZCBzaWduYXR1cmUgYWxnb3JpdGhtOiAke3NpZ25hdHVyZUFsZ29yaXRobS5hbGdvcml0aG1JZH1gKTtcbiAgICAgICAgbGV0IGFsZ29yaXRobUlkO1xuICAgICAgICBpZiAoc2lnbmF0dXJlQWxnb3JpdGhtLmFsZ29yaXRobUlkID09PSBcIjEuMi44NDAuMTEzNTQ5LjEuMS4xMFwiKVxuICAgICAgICAgICAgYWxnb3JpdGhtSWQgPSBzaWduYXR1cmVBbGdvcml0aG0uYWxnb3JpdGhtSWQ7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGFsZ29yaXRobUlkID0gcHVibGljS2V5SW5mby5hbGdvcml0aG0uYWxnb3JpdGhtSWQ7XG4gICAgICAgIGNvbnN0IGFsZ29yaXRobU9iamVjdCA9IHRoaXMuZ2V0QWxnb3JpdGhtQnlPSUQoYWxnb3JpdGhtSWQsIHRydWUpO1xuICAgICAgICBwYXJhbWV0ZXJzLmFsZ29yaXRobSA9IHRoaXMuZ2V0QWxnb3JpdGhtUGFyYW1ldGVycyhhbGdvcml0aG1PYmplY3QubmFtZSwgXCJpbXBvcnRLZXlcIik7XG4gICAgICAgIGlmIChcImhhc2hcIiBpbiBwYXJhbWV0ZXJzLmFsZ29yaXRobS5hbGdvcml0aG0pXG4gICAgICAgICAgICBwYXJhbWV0ZXJzLmFsZ29yaXRobS5hbGdvcml0aG0uaGFzaC5uYW1lID0gc2hhQWxnb3JpdGhtO1xuICAgICAgICBpZiAoYWxnb3JpdGhtT2JqZWN0Lm5hbWUgPT09IFwiRUNEU0FcIikge1xuICAgICAgICAgICAgY29uc3QgcHVibGljS2V5QWxnb3JpdGhtID0gcHVibGljS2V5SW5mby5hbGdvcml0aG07XG4gICAgICAgICAgICBpZiAoIXB1YmxpY0tleUFsZ29yaXRobS5hbGdvcml0aG1QYXJhbXMpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBbGdvcml0aG0gcGFyYW1ldGVycyBmb3IgRUNEU0EgcHVibGljIGtleSBhcmUgbWlzc2VkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgcHVibGljS2V5QWxnb3JpdGhtUGFyYW1zID0gcHVibGljS2V5QWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcztcbiAgICAgICAgICAgIGlmIChcImlkQmxvY2tcIiBpbiBwdWJsaWNLZXlBbGdvcml0aG0uYWxnb3JpdGhtUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoKHB1YmxpY0tleUFsZ29yaXRobVBhcmFtcy5pZEJsb2NrLnRhZ0NsYXNzID09PSAxKSAmJiAocHVibGljS2V5QWxnb3JpdGhtUGFyYW1zLmlkQmxvY2sudGFnTnVtYmVyID09PSA2KSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW5jb3JyZWN0IHR5cGUgZm9yIEVDRFNBIHB1YmxpYyBrZXkgcGFyYW1ldGVyc1wiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBjdXJ2ZU9iamVjdCA9IHRoaXMuZ2V0QWxnb3JpdGhtQnlPSUQocHVibGljS2V5QWxnb3JpdGhtUGFyYW1zLnZhbHVlQmxvY2sudG9TdHJpbmcoKSwgdHJ1ZSk7XG4gICAgICAgICAgICBwYXJhbWV0ZXJzLmFsZ29yaXRobS5hbGdvcml0aG0ubmFtZWRDdXJ2ZSA9IGN1cnZlT2JqZWN0Lm5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBhcmFtZXRlcnM7XG4gICAgfVxuICAgIGFzeW5jIGdldFB1YmxpY0tleShwdWJsaWNLZXlJbmZvLCBzaWduYXR1cmVBbGdvcml0aG0sIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgaWYgKCFwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICBwYXJhbWV0ZXJzID0gdGhpcy5maWxsUHVibGljS2V5UGFyYW1ldGVycyhwdWJsaWNLZXlJbmZvLCBzaWduYXR1cmVBbGdvcml0aG0pO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHB1YmxpY0tleUluZm9CdWZmZXIgPSBwdWJsaWNLZXlJbmZvLnRvU2NoZW1hKCkudG9CRVIoZmFsc2UpO1xuICAgICAgICByZXR1cm4gdGhpcy5pbXBvcnRLZXkoXCJzcGtpXCIsIHB1YmxpY0tleUluZm9CdWZmZXIsIHBhcmFtZXRlcnMuYWxnb3JpdGhtLmFsZ29yaXRobSwgdHJ1ZSwgcGFyYW1ldGVycy5hbGdvcml0aG0udXNhZ2VzKTtcbiAgICB9XG4gICAgYXN5bmMgdmVyaWZ5V2l0aFB1YmxpY0tleShkYXRhLCBzaWduYXR1cmUsIHB1YmxpY0tleUluZm8sIHNpZ25hdHVyZUFsZ29yaXRobSwgc2hhQWxnb3JpdGhtKSB7XG4gICAgICAgIGxldCBwdWJsaWNLZXk7XG4gICAgICAgIGlmICghc2hhQWxnb3JpdGhtKSB7XG4gICAgICAgICAgICBzaGFBbGdvcml0aG0gPSB0aGlzLmdldEhhc2hBbGdvcml0aG0oc2lnbmF0dXJlQWxnb3JpdGhtKTtcbiAgICAgICAgICAgIGlmICghc2hhQWxnb3JpdGhtKVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5zdXBwb3J0ZWQgc2lnbmF0dXJlIGFsZ29yaXRobTogJHtzaWduYXR1cmVBbGdvcml0aG0uYWxnb3JpdGhtSWR9YCk7XG4gICAgICAgICAgICBwdWJsaWNLZXkgPSBhd2FpdCB0aGlzLmdldFB1YmxpY0tleShwdWJsaWNLZXlJbmZvLCBzaWduYXR1cmVBbGdvcml0aG0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgcGFyYW1ldGVycyA9IHt9O1xuICAgICAgICAgICAgbGV0IGFsZ29yaXRobUlkO1xuICAgICAgICAgICAgaWYgKHNpZ25hdHVyZUFsZ29yaXRobS5hbGdvcml0aG1JZCA9PT0gXCIxLjIuODQwLjExMzU0OS4xLjEuMTBcIilcbiAgICAgICAgICAgICAgICBhbGdvcml0aG1JZCA9IHNpZ25hdHVyZUFsZ29yaXRobS5hbGdvcml0aG1JZDtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBhbGdvcml0aG1JZCA9IHB1YmxpY0tleUluZm8uYWxnb3JpdGhtLmFsZ29yaXRobUlkO1xuICAgICAgICAgICAgY29uc3QgYWxnb3JpdGhtT2JqZWN0ID0gdGhpcy5nZXRBbGdvcml0aG1CeU9JRChhbGdvcml0aG1JZCwgdHJ1ZSk7XG4gICAgICAgICAgICBwYXJhbWV0ZXJzLmFsZ29yaXRobSA9IHRoaXMuZ2V0QWxnb3JpdGhtUGFyYW1ldGVycyhhbGdvcml0aG1PYmplY3QubmFtZSwgXCJpbXBvcnRLZXlcIik7XG4gICAgICAgICAgICBpZiAoXCJoYXNoXCIgaW4gcGFyYW1ldGVycy5hbGdvcml0aG0uYWxnb3JpdGhtKVxuICAgICAgICAgICAgICAgIHBhcmFtZXRlcnMuYWxnb3JpdGhtLmFsZ29yaXRobS5oYXNoLm5hbWUgPSBzaGFBbGdvcml0aG07XG4gICAgICAgICAgICBpZiAoYWxnb3JpdGhtT2JqZWN0Lm5hbWUgPT09IFwiRUNEU0FcIikge1xuICAgICAgICAgICAgICAgIGxldCBhbGdvcml0aG1QYXJhbXNDaGVja2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKChcImFsZ29yaXRobVBhcmFtc1wiIGluIHB1YmxpY0tleUluZm8uYWxnb3JpdGhtKSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoXCJpZEJsb2NrXCIgaW4gcHVibGljS2V5SW5mby5hbGdvcml0aG0uYWxnb3JpdGhtUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHB1YmxpY0tleUluZm8uYWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcy5pZEJsb2NrLnRhZ0NsYXNzID09PSAxKSAmJiAocHVibGljS2V5SW5mby5hbGdvcml0aG0uYWxnb3JpdGhtUGFyYW1zLmlkQmxvY2sudGFnTnVtYmVyID09PSA2KSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1QYXJhbXNDaGVja2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYWxnb3JpdGhtUGFyYW1zQ2hlY2tlZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW5jb3JyZWN0IHR5cGUgZm9yIEVDRFNBIHB1YmxpYyBrZXkgcGFyYW1ldGVyc1wiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgY3VydmVPYmplY3QgPSB0aGlzLmdldEFsZ29yaXRobUJ5T0lEKHB1YmxpY0tleUluZm8uYWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcy52YWx1ZUJsb2NrLnRvU3RyaW5nKCksIHRydWUpO1xuICAgICAgICAgICAgICAgIHBhcmFtZXRlcnMuYWxnb3JpdGhtLmFsZ29yaXRobS5uYW1lZEN1cnZlID0gY3VydmVPYmplY3QubmFtZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHB1YmxpY0tleSA9IGF3YWl0IHRoaXMuZ2V0UHVibGljS2V5KHB1YmxpY0tleUluZm8sIG51bGwsIHBhcmFtZXRlcnMpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGFsZ29yaXRobSA9IHRoaXMuZ2V0QWxnb3JpdGhtUGFyYW1ldGVycyhwdWJsaWNLZXkuYWxnb3JpdGhtLm5hbWUsIFwidmVyaWZ5XCIpO1xuICAgICAgICBpZiAoXCJoYXNoXCIgaW4gYWxnb3JpdGhtLmFsZ29yaXRobSlcbiAgICAgICAgICAgIGFsZ29yaXRobS5hbGdvcml0aG0uaGFzaC5uYW1lID0gc2hhQWxnb3JpdGhtO1xuICAgICAgICBsZXQgc2lnbmF0dXJlVmFsdWUgPSBzaWduYXR1cmUudmFsdWVCbG9jay52YWx1ZUhleFZpZXc7XG4gICAgICAgIGlmIChwdWJsaWNLZXkuYWxnb3JpdGhtLm5hbWUgPT09IFwiRUNEU0FcIikge1xuICAgICAgICAgICAgY29uc3QgbmFtZWRDdXJ2ZSA9IEVDTmFtZWRDdXJ2ZXMuZmluZChwdWJsaWNLZXkuYWxnb3JpdGhtLm5hbWVkQ3VydmUpO1xuICAgICAgICAgICAgaWYgKCFuYW1lZEN1cnZlKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5zdXBwb3J0ZWQgbmFtZWQgY3VydmUgaW4gdXNlXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5mcm9tQkVSKHNpZ25hdHVyZVZhbHVlKTtcbiAgICAgICAgICAgIEFzbkVycm9yLmFzc2VydChhc24xLCBcIlNpZ25hdHVyZSB2YWx1ZVwiKTtcbiAgICAgICAgICAgIHNpZ25hdHVyZVZhbHVlID0gY3JlYXRlRUNEU0FTaWduYXR1cmVGcm9tQ01TKGFzbjEucmVzdWx0LCBuYW1lZEN1cnZlLnNpemUpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwdWJsaWNLZXkuYWxnb3JpdGhtLm5hbWUgPT09IFwiUlNBLVBTU1wiKSB7XG4gICAgICAgICAgICBjb25zdCBwc3NQYXJhbWV0ZXJzID0gbmV3IFJTQVNTQVBTU1BhcmFtcyh7IHNjaGVtYTogc2lnbmF0dXJlQWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcyB9KTtcbiAgICAgICAgICAgIGlmIChcInNhbHRMZW5ndGhcIiBpbiBwc3NQYXJhbWV0ZXJzKVxuICAgICAgICAgICAgICAgIGFsZ29yaXRobS5hbGdvcml0aG0uc2FsdExlbmd0aCA9IHBzc1BhcmFtZXRlcnMuc2FsdExlbmd0aDtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBhbGdvcml0aG0uYWxnb3JpdGhtLnNhbHRMZW5ndGggPSAyMDtcbiAgICAgICAgICAgIGxldCBoYXNoQWxnbyA9IFwiU0hBLTFcIjtcbiAgICAgICAgICAgIGlmIChcImhhc2hBbGdvcml0aG1cIiBpbiBwc3NQYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaGFzaEFsZ29yaXRobSA9IHRoaXMuZ2V0QWxnb3JpdGhtQnlPSUQocHNzUGFyYW1ldGVycy5oYXNoQWxnb3JpdGhtLmFsZ29yaXRobUlkLCB0cnVlKTtcbiAgICAgICAgICAgICAgICBoYXNoQWxnbyA9IGhhc2hBbGdvcml0aG0ubmFtZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFsZ29yaXRobS5hbGdvcml0aG0uaGFzaC5uYW1lID0gaGFzaEFsZ287XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMudmVyaWZ5KGFsZ29yaXRobS5hbGdvcml0aG0sIHB1YmxpY0tleSwgc2lnbmF0dXJlVmFsdWUsIGRhdGEpO1xuICAgIH1cbn1cblxubGV0IGVuZ2luZSA9IHtcbiAgICBuYW1lOiBcIm5vbmVcIixcbiAgICBjcnlwdG86IG51bGwsXG59O1xuZnVuY3Rpb24gaXNDcnlwdG9FbmdpbmUoZW5naW5lKSB7XG4gICAgcmV0dXJuIGVuZ2luZVxuICAgICAgICAmJiB0eXBlb2YgZW5naW5lID09PSBcIm9iamVjdFwiXG4gICAgICAgICYmIFwiY3J5cHRvXCIgaW4gZW5naW5lXG4gICAgICAgID8gdHJ1ZVxuICAgICAgICA6IGZhbHNlO1xufVxuZnVuY3Rpb24gc2V0RW5naW5lKG5hbWUsIC4uLmFyZ3MpIHtcbiAgICBsZXQgY3J5cHRvID0gbnVsbDtcbiAgICBpZiAoYXJncy5sZW5ndGggPCAyKSB7XG4gICAgICAgIGlmIChhcmdzLmxlbmd0aCkge1xuICAgICAgICAgICAgY3J5cHRvID0gYXJnc1swXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNyeXB0byA9IHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiICYmIHNlbGYuY3J5cHRvID8gbmV3IENyeXB0b0VuZ2luZSh7IG5hbWU6IFwiYnJvd3NlclwiLCBjcnlwdG86IHNlbGYuY3J5cHRvIH0pIDogbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgY29uc3QgY3J5cHRvQXJnID0gYXJnc1swXTtcbiAgICAgICAgY29uc3Qgc3VidGxlQXJnID0gYXJnc1sxXTtcbiAgICAgICAgaWYgKGlzQ3J5cHRvRW5naW5lKHN1YnRsZUFyZykpIHtcbiAgICAgICAgICAgIGNyeXB0byA9IHN1YnRsZUFyZztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpc0NyeXB0b0VuZ2luZShjcnlwdG9BcmcpKSB7XG4gICAgICAgICAgICBjcnlwdG8gPSBjcnlwdG9Bcmc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoXCJzdWJ0bGVcIiBpbiBjcnlwdG9BcmcgJiYgXCJnZXRSYW5kb21WYWx1ZXNcIiBpbiBjcnlwdG9BcmcpIHtcbiAgICAgICAgICAgIGNyeXB0byA9IG5ldyBDcnlwdG9FbmdpbmUoe1xuICAgICAgICAgICAgICAgIGNyeXB0bzogY3J5cHRvQXJnLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKCh0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIikgJiYgKFwicGlkXCIgaW4gcHJvY2VzcykgJiYgKHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIpICYmICh0eXBlb2Ygd2luZG93ID09PSBcInVuZGVmaW5lZFwiKSkge1xuICAgICAgICBpZiAodHlwZW9mIGdsb2JhbFtwcm9jZXNzLnBpZF0gPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgIGdsb2JhbFtwcm9jZXNzLnBpZF0gPSB7fTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZ2xvYmFsW3Byb2Nlc3MucGlkXSAhPT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTmFtZSBnbG9iYWwuJHtwcm9jZXNzLnBpZH0gYWxyZWFkeSBleGlzdHMgYW5kIGl0IGlzIG5vdCBhbiBvYmplY3RgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGdsb2JhbFtwcm9jZXNzLnBpZF0ucGtpanMgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgIGdsb2JhbFtwcm9jZXNzLnBpZF0ucGtpanMgPSB7fTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZ2xvYmFsW3Byb2Nlc3MucGlkXS5wa2lqcyAhPT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTmFtZSBnbG9iYWwuJHtwcm9jZXNzLnBpZH0ucGtpanMgYWxyZWFkeSBleGlzdHMgYW5kIGl0IGlzIG5vdCBhbiBvYmplY3RgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBnbG9iYWxbcHJvY2Vzcy5waWRdLnBraWpzLmVuZ2luZSA9IHtcbiAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICBjcnlwdG8sXG4gICAgICAgIH07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBlbmdpbmUgPSB7XG4gICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgY3J5cHRvLFxuICAgICAgICB9O1xuICAgIH1cbn1cbmZ1bmN0aW9uIGdldEVuZ2luZSgpIHtcbiAgICBpZiAoKHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiKSAmJiAoXCJwaWRcIiBpbiBwcm9jZXNzKSAmJiAodHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIikgJiYgKHR5cGVvZiB3aW5kb3cgPT09IFwidW5kZWZpbmVkXCIpKSB7XG4gICAgICAgIGxldCBfZW5naW5lO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgX2VuZ2luZSA9IGdsb2JhbFtwcm9jZXNzLnBpZF0ucGtpanMuZW5naW5lO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlBsZWFzZSBjYWxsICdzZXRFbmdpbmUnIGJlZm9yZSBjYWxsIHRvICdnZXRFbmdpbmUnXCIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfZW5naW5lO1xuICAgIH1cbiAgICByZXR1cm4gZW5naW5lO1xufVxuZnVuY3Rpb24gZ2V0Q3J5cHRvKHNhZmV0eSA9IGZhbHNlKSB7XG4gICAgY29uc3QgX2VuZ2luZSA9IGdldEVuZ2luZSgpO1xuICAgIGlmICghX2VuZ2luZS5jcnlwdG8gJiYgc2FmZXR5KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVuYWJsZSB0byBjcmVhdGUgV2ViQ3J5cHRvIG9iamVjdFwiKTtcbiAgICB9XG4gICAgcmV0dXJuIF9lbmdpbmUuY3J5cHRvO1xufVxuZnVuY3Rpb24gZ2V0UmFuZG9tVmFsdWVzKHZpZXcpIHtcbiAgICByZXR1cm4gZ2V0Q3J5cHRvKHRydWUpLmdldFJhbmRvbVZhbHVlcyh2aWV3KTtcbn1cbmZ1bmN0aW9uIGdldE9JREJ5QWxnb3JpdGhtKGFsZ29yaXRobSwgc2FmZXR5LCB0YXJnZXQpIHtcbiAgICByZXR1cm4gZ2V0Q3J5cHRvKHRydWUpLmdldE9JREJ5QWxnb3JpdGhtKGFsZ29yaXRobSwgc2FmZXR5LCB0YXJnZXQpO1xufVxuZnVuY3Rpb24gZ2V0QWxnb3JpdGhtUGFyYW1ldGVycyhhbGdvcml0aG1OYW1lLCBvcGVyYXRpb24pIHtcbiAgICByZXR1cm4gZ2V0Q3J5cHRvKHRydWUpLmdldEFsZ29yaXRobVBhcmFtZXRlcnMoYWxnb3JpdGhtTmFtZSwgb3BlcmF0aW9uKTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZUNNU0VDRFNBU2lnbmF0dXJlKHNpZ25hdHVyZUJ1ZmZlcikge1xuICAgIGlmICgoc2lnbmF0dXJlQnVmZmVyLmJ5dGVMZW5ndGggJSAyKSAhPT0gMClcbiAgICAgICAgcmV0dXJuIEVNUFRZX0JVRkZFUjtcbiAgICBjb25zdCBsZW5ndGggPSBzaWduYXR1cmVCdWZmZXIuYnl0ZUxlbmd0aCAvIDI7XG4gICAgY29uc3QgckJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcihsZW5ndGgpO1xuICAgIGNvbnN0IHJWaWV3ID0gbmV3IFVpbnQ4QXJyYXkockJ1ZmZlcik7XG4gICAgclZpZXcuc2V0KG5ldyBVaW50OEFycmF5KHNpZ25hdHVyZUJ1ZmZlciwgMCwgbGVuZ3RoKSk7XG4gICAgY29uc3QgckludGVnZXIgPSBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZUhleDogckJ1ZmZlciB9KTtcbiAgICBjb25zdCBzQnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKGxlbmd0aCk7XG4gICAgY29uc3Qgc1ZpZXcgPSBuZXcgVWludDhBcnJheShzQnVmZmVyKTtcbiAgICBzVmlldy5zZXQobmV3IFVpbnQ4QXJyYXkoc2lnbmF0dXJlQnVmZmVyLCBsZW5ndGgsIGxlbmd0aCkpO1xuICAgIGNvbnN0IHNJbnRlZ2VyID0gbmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWVIZXg6IHNCdWZmZXIgfSk7XG4gICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgIHJJbnRlZ2VyLmNvbnZlcnRUb0RFUigpLFxuICAgICAgICAgICAgc0ludGVnZXIuY29udmVydFRvREVSKClcbiAgICAgICAgXVxuICAgIH0pKS50b0JFUihmYWxzZSk7XG59XG5mdW5jdGlvbiBjcmVhdGVFQ0RTQVNpZ25hdHVyZUZyb21DTVMoY21zU2lnbmF0dXJlLCBwb2ludFNpemUpIHtcbiAgICBpZiAoIShjbXNTaWduYXR1cmUgaW5zdGFuY2VvZiBhc24xanMuU2VxdWVuY2VcbiAgICAgICAgJiYgY21zU2lnbmF0dXJlLnZhbHVlQmxvY2sudmFsdWUubGVuZ3RoID09PSAyXG4gICAgICAgICYmIGNtc1NpZ25hdHVyZS52YWx1ZUJsb2NrLnZhbHVlWzBdIGluc3RhbmNlb2YgYXNuMWpzLkludGVnZXJcbiAgICAgICAgJiYgY21zU2lnbmF0dXJlLnZhbHVlQmxvY2sudmFsdWVbMV0gaW5zdGFuY2VvZiBhc24xanMuSW50ZWdlcikpXG4gICAgICAgIHJldHVybiBFTVBUWV9CVUZGRVI7XG4gICAgY29uc3QgclZhbHVlVmlldyA9IGNtc1NpZ25hdHVyZS52YWx1ZUJsb2NrLnZhbHVlWzBdLmNvbnZlcnRGcm9tREVSKCkudmFsdWVCbG9jay52YWx1ZUhleFZpZXc7XG4gICAgY29uc3Qgc1ZhbHVlVmlldyA9IGNtc1NpZ25hdHVyZS52YWx1ZUJsb2NrLnZhbHVlWzFdLmNvbnZlcnRGcm9tREVSKCkudmFsdWVCbG9jay52YWx1ZUhleFZpZXc7XG4gICAgY29uc3QgcmVzID0gbmV3IFVpbnQ4QXJyYXkocG9pbnRTaXplICogMik7XG4gICAgcmVzLnNldChyVmFsdWVWaWV3LCBwb2ludFNpemUgLSByVmFsdWVWaWV3LmJ5dGVMZW5ndGgpO1xuICAgIHJlcy5zZXQoc1ZhbHVlVmlldywgKDIgKiBwb2ludFNpemUpIC0gc1ZhbHVlVmlldy5ieXRlTGVuZ3RoKTtcbiAgICByZXR1cm4gcmVzLmJ1ZmZlcjtcbn1cbmZ1bmN0aW9uIGdldEFsZ29yaXRobUJ5T0lEKG9pZCwgc2FmZXR5ID0gZmFsc2UsIHRhcmdldCkge1xuICAgIHJldHVybiBnZXRDcnlwdG8odHJ1ZSkuZ2V0QWxnb3JpdGhtQnlPSUQob2lkLCBzYWZldHksIHRhcmdldCk7XG59XG5mdW5jdGlvbiBnZXRIYXNoQWxnb3JpdGhtKHNpZ25hdHVyZUFsZ29yaXRobSkge1xuICAgIHJldHVybiBnZXRDcnlwdG8odHJ1ZSkuZ2V0SGFzaEFsZ29yaXRobShzaWduYXR1cmVBbGdvcml0aG0pO1xufVxuYXN5bmMgZnVuY3Rpb24ga2RmV2l0aENvdW50ZXIoaGFzaEZ1bmN0aW9uLCB6QnVmZmVyLCBDb3VudGVyLCBTaGFyZWRJbmZvLCBjcnlwdG8pIHtcbiAgICBzd2l0Y2ggKGhhc2hGdW5jdGlvbi50b1VwcGVyQ2FzZSgpKSB7XG4gICAgICAgIGNhc2UgXCJTSEEtMVwiOlxuICAgICAgICBjYXNlIFwiU0hBLTI1NlwiOlxuICAgICAgICBjYXNlIFwiU0hBLTM4NFwiOlxuICAgICAgICBjYXNlIFwiU0hBLTUxMlwiOlxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnRFcnJvcihgVW5rbm93biBoYXNoIGZ1bmN0aW9uOiAke2hhc2hGdW5jdGlvbn1gKTtcbiAgICB9XG4gICAgQXJndW1lbnRFcnJvci5hc3NlcnQoekJ1ZmZlciwgXCJ6QnVmZmVyXCIsIFwiQXJyYXlCdWZmZXJcIik7XG4gICAgaWYgKHpCdWZmZXIuYnl0ZUxlbmd0aCA9PT0gMClcbiAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50RXJyb3IoXCInekJ1ZmZlcicgaGFzIHplcm8gbGVuZ3RoLCBlcnJvclwiKTtcbiAgICBBcmd1bWVudEVycm9yLmFzc2VydChTaGFyZWRJbmZvLCBcIlNoYXJlZEluZm9cIiwgXCJBcnJheUJ1ZmZlclwiKTtcbiAgICBpZiAoQ291bnRlciA+IDI1NSlcbiAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50RXJyb3IoXCJQbGVhc2Ugc2V0ICdDb3VudGVyJyBhcmd1bWVudCB0byB2YWx1ZSBsZXNzIG9yIGVxdWFsIHRvIDI1NVwiKTtcbiAgICBjb25zdCBjb3VudGVyQnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKDQpO1xuICAgIGNvbnN0IGNvdW50ZXJWaWV3ID0gbmV3IFVpbnQ4QXJyYXkoY291bnRlckJ1ZmZlcik7XG4gICAgY291bnRlclZpZXdbMF0gPSAweDAwO1xuICAgIGNvdW50ZXJWaWV3WzFdID0gMHgwMDtcbiAgICBjb3VudGVyVmlld1syXSA9IDB4MDA7XG4gICAgY291bnRlclZpZXdbM10gPSBDb3VudGVyO1xuICAgIGxldCBjb21iaW5lZEJ1ZmZlciA9IEVNUFRZX0JVRkZFUjtcbiAgICBjb21iaW5lZEJ1ZmZlciA9IHB2dXRpbHMudXRpbENvbmNhdEJ1Zihjb21iaW5lZEJ1ZmZlciwgekJ1ZmZlcik7XG4gICAgY29tYmluZWRCdWZmZXIgPSBwdnV0aWxzLnV0aWxDb25jYXRCdWYoY29tYmluZWRCdWZmZXIsIGNvdW50ZXJCdWZmZXIpO1xuICAgIGNvbWJpbmVkQnVmZmVyID0gcHZ1dGlscy51dGlsQ29uY2F0QnVmKGNvbWJpbmVkQnVmZmVyLCBTaGFyZWRJbmZvKTtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjcnlwdG8uZGlnZXN0KHsgbmFtZTogaGFzaEZ1bmN0aW9uIH0sIGNvbWJpbmVkQnVmZmVyKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb3VudGVyOiBDb3VudGVyLFxuICAgICAgICByZXN1bHRcbiAgICB9O1xufVxuYXN5bmMgZnVuY3Rpb24ga2RmKGhhc2hGdW5jdGlvbiwgWmJ1ZmZlciwga2V5ZGF0YWxlbiwgU2hhcmVkSW5mbywgY3J5cHRvID0gZ2V0Q3J5cHRvKHRydWUpKSB7XG4gICAgbGV0IGhhc2hMZW5ndGggPSAwO1xuICAgIGxldCBtYXhDb3VudGVyID0gMTtcbiAgICBzd2l0Y2ggKGhhc2hGdW5jdGlvbi50b1VwcGVyQ2FzZSgpKSB7XG4gICAgICAgIGNhc2UgXCJTSEEtMVwiOlxuICAgICAgICAgICAgaGFzaExlbmd0aCA9IDE2MDtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiU0hBLTI1NlwiOlxuICAgICAgICAgICAgaGFzaExlbmd0aCA9IDI1NjtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiU0hBLTM4NFwiOlxuICAgICAgICAgICAgaGFzaExlbmd0aCA9IDM4NDtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiU0hBLTUxMlwiOlxuICAgICAgICAgICAgaGFzaExlbmd0aCA9IDUxMjtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50RXJyb3IoYFVua25vd24gaGFzaCBmdW5jdGlvbjogJHtoYXNoRnVuY3Rpb259YCk7XG4gICAgfVxuICAgIEFyZ3VtZW50RXJyb3IuYXNzZXJ0KFpidWZmZXIsIFwiWmJ1ZmZlclwiLCBcIkFycmF5QnVmZmVyXCIpO1xuICAgIGlmIChaYnVmZmVyLmJ5dGVMZW5ndGggPT09IDApXG4gICAgICAgIHRocm93IG5ldyBBcmd1bWVudEVycm9yKFwiJ1pidWZmZXInIGhhcyB6ZXJvIGxlbmd0aCwgZXJyb3JcIik7XG4gICAgQXJndW1lbnRFcnJvci5hc3NlcnQoU2hhcmVkSW5mbywgXCJTaGFyZWRJbmZvXCIsIFwiQXJyYXlCdWZmZXJcIik7XG4gICAgY29uc3QgcXVvdGllbnQgPSBrZXlkYXRhbGVuIC8gaGFzaExlbmd0aDtcbiAgICBpZiAoTWF0aC5mbG9vcihxdW90aWVudCkgPiAwKSB7XG4gICAgICAgIG1heENvdW50ZXIgPSBNYXRoLmZsb29yKHF1b3RpZW50KTtcbiAgICAgICAgaWYgKChxdW90aWVudCAtIG1heENvdW50ZXIpID4gMClcbiAgICAgICAgICAgIG1heENvdW50ZXIrKztcbiAgICB9XG4gICAgY29uc3QgaW5jb21pbmdSZXN1bHQgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMTsgaSA8PSBtYXhDb3VudGVyOyBpKyspXG4gICAgICAgIGluY29taW5nUmVzdWx0LnB1c2goYXdhaXQga2RmV2l0aENvdW50ZXIoaGFzaEZ1bmN0aW9uLCBaYnVmZmVyLCBpLCBTaGFyZWRJbmZvLCBjcnlwdG8pKTtcbiAgICBsZXQgY29tYmluZWRCdWZmZXIgPSBFTVBUWV9CVUZGRVI7XG4gICAgbGV0IGN1cnJlbnRDb3VudGVyID0gMTtcbiAgICBsZXQgZm91bmQgPSB0cnVlO1xuICAgIHdoaWxlIChmb3VuZCkge1xuICAgICAgICBmb3VuZCA9IGZhbHNlO1xuICAgICAgICBmb3IgKGNvbnN0IHJlc3VsdCBvZiBpbmNvbWluZ1Jlc3VsdCkge1xuICAgICAgICAgICAgaWYgKHJlc3VsdC5jb3VudGVyID09PSBjdXJyZW50Q291bnRlcikge1xuICAgICAgICAgICAgICAgIGNvbWJpbmVkQnVmZmVyID0gcHZ1dGlscy51dGlsQ29uY2F0QnVmKGNvbWJpbmVkQnVmZmVyLCByZXN1bHQucmVzdWx0KTtcbiAgICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY3VycmVudENvdW50ZXIrKztcbiAgICB9XG4gICAga2V5ZGF0YWxlbiA+Pj0gMztcbiAgICBpZiAoY29tYmluZWRCdWZmZXIuYnl0ZUxlbmd0aCA+IGtleWRhdGFsZW4pIHtcbiAgICAgICAgY29uc3QgbmV3QnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKGtleWRhdGFsZW4pO1xuICAgICAgICBjb25zdCBuZXdWaWV3ID0gbmV3IFVpbnQ4QXJyYXkobmV3QnVmZmVyKTtcbiAgICAgICAgY29uc3QgY29tYmluZWRWaWV3ID0gbmV3IFVpbnQ4QXJyYXkoY29tYmluZWRCdWZmZXIpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGtleWRhdGFsZW47IGkrKylcbiAgICAgICAgICAgIG5ld1ZpZXdbaV0gPSBjb21iaW5lZFZpZXdbaV07XG4gICAgICAgIHJldHVybiBuZXdCdWZmZXI7XG4gICAgfVxuICAgIHJldHVybiBjb21iaW5lZEJ1ZmZlcjtcbn1cblxuY29uc3QgVkVSU0lPTiRpID0gXCJ2ZXJzaW9uXCI7XG5jb25zdCBMT0dfSUQgPSBcImxvZ0lEXCI7XG5jb25zdCBFWFRFTlNJT05TJDYgPSBcImV4dGVuc2lvbnNcIjtcbmNvbnN0IFRJTUVTVEFNUCA9IFwidGltZXN0YW1wXCI7XG5jb25zdCBIQVNIX0FMR09SSVRITSQzID0gXCJoYXNoQWxnb3JpdGhtXCI7XG5jb25zdCBTSUdOQVRVUkVfQUxHT1JJVEhNJDggPSBcInNpZ25hdHVyZUFsZ29yaXRobVwiO1xuY29uc3QgU0lHTkFUVVJFJDcgPSBcInNpZ25hdHVyZVwiO1xuY29uc3QgTk9ORSA9IFwibm9uZVwiO1xuY29uc3QgTUQ1ID0gXCJtZDVcIjtcbmNvbnN0IFNIQTEgPSBcInNoYTFcIjtcbmNvbnN0IFNIQTIyNCA9IFwic2hhMjI0XCI7XG5jb25zdCBTSEEyNTYgPSBcInNoYTI1NlwiO1xuY29uc3QgU0hBMzg0ID0gXCJzaGEzODRcIjtcbmNvbnN0IFNIQTUxMiA9IFwic2hhNTEyXCI7XG5jb25zdCBBTk9OWU1PVVMgPSBcImFub255bW91c1wiO1xuY29uc3QgUlNBID0gXCJyc2FcIjtcbmNvbnN0IERTQSA9IFwiZHNhXCI7XG5jb25zdCBFQ0RTQSA9IFwiZWNkc2FcIjtcbmNsYXNzIFNpZ25lZENlcnRpZmljYXRlVGltZXN0YW1wIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVkVSU0lPTiRpLCBTaWduZWRDZXJ0aWZpY2F0ZVRpbWVzdGFtcC5kZWZhdWx0VmFsdWVzKFZFUlNJT04kaSkpO1xuICAgICAgICB0aGlzLmxvZ0lEID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgTE9HX0lELCBTaWduZWRDZXJ0aWZpY2F0ZVRpbWVzdGFtcC5kZWZhdWx0VmFsdWVzKExPR19JRCkpO1xuICAgICAgICB0aGlzLnRpbWVzdGFtcCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFRJTUVTVEFNUCwgU2lnbmVkQ2VydGlmaWNhdGVUaW1lc3RhbXAuZGVmYXVsdFZhbHVlcyhUSU1FU1RBTVApKTtcbiAgICAgICAgdGhpcy5leHRlbnNpb25zID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgRVhURU5TSU9OUyQ2LCBTaWduZWRDZXJ0aWZpY2F0ZVRpbWVzdGFtcC5kZWZhdWx0VmFsdWVzKEVYVEVOU0lPTlMkNikpO1xuICAgICAgICB0aGlzLmhhc2hBbGdvcml0aG0gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBIQVNIX0FMR09SSVRITSQzLCBTaWduZWRDZXJ0aWZpY2F0ZVRpbWVzdGFtcC5kZWZhdWx0VmFsdWVzKEhBU0hfQUxHT1JJVEhNJDMpKTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmVBbGdvcml0aG0gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTSUdOQVRVUkVfQUxHT1JJVEhNJDgsIFNpZ25lZENlcnRpZmljYXRlVGltZXN0YW1wLmRlZmF1bHRWYWx1ZXMoU0lHTkFUVVJFX0FMR09SSVRITSQ4KSk7XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU0lHTkFUVVJFJDcsIFNpZ25lZENlcnRpZmljYXRlVGltZXN0YW1wLmRlZmF1bHRWYWx1ZXMoU0lHTkFUVVJFJDcpKTtcbiAgICAgICAgaWYgKFwic3RyZWFtXCIgaW4gcGFyYW1ldGVycyAmJiBwYXJhbWV0ZXJzLnN0cmVhbSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU3RyZWFtKHBhcmFtZXRlcnMuc3RyZWFtKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkVSU0lPTiRpOlxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgY2FzZSBMT0dfSUQ6XG4gICAgICAgICAgICBjYXNlIEVYVEVOU0lPTlMkNjpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfQlVGRkVSO1xuICAgICAgICAgICAgY2FzZSBUSU1FU1RBTVA6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKDApO1xuICAgICAgICAgICAgY2FzZSBIQVNIX0FMR09SSVRITSQzOlxuICAgICAgICAgICAgY2FzZSBTSUdOQVRVUkVfQUxHT1JJVEhNJDg6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX1NUUklORztcbiAgICAgICAgICAgIGNhc2UgU0lHTkFUVVJFJDc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX0JVRkZFUjtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgaWYgKChzY2hlbWEgaW5zdGFuY2VvZiBhc24xanMuUmF3RGF0YSkgPT09IGZhbHNlKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiT2JqZWN0J3Mgc2NoZW1hIHdhcyBub3QgdmVyaWZpZWQgYWdhaW5zdCBpbnB1dCBkYXRhIGZvciBTaWduZWRDZXJ0aWZpY2F0ZVRpbWVzdGFtcFwiKTtcbiAgICAgICAgY29uc3Qgc2VxU3RyZWFtID0gbmV3IGJzLlNlcVN0cmVhbSh7XG4gICAgICAgICAgICBzdHJlYW06IG5ldyBicy5CeXRlU3RyZWFtKHtcbiAgICAgICAgICAgICAgICBidWZmZXI6IHNjaGVtYS5kYXRhXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5mcm9tU3RyZWFtKHNlcVN0cmVhbSk7XG4gICAgfVxuICAgIGZyb21TdHJlYW0oc3RyZWFtKSB7XG4gICAgICAgIGNvbnN0IGJsb2NrTGVuZ3RoID0gc3RyZWFtLmdldFVpbnQxNigpO1xuICAgICAgICB0aGlzLnZlcnNpb24gPSAoc3RyZWFtLmdldEJsb2NrKDEpKVswXTtcbiAgICAgICAgaWYgKHRoaXMudmVyc2lvbiA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5sb2dJRCA9IChuZXcgVWludDhBcnJheShzdHJlYW0uZ2V0QmxvY2soMzIpKSkuYnVmZmVyLnNsaWNlKDApO1xuICAgICAgICAgICAgdGhpcy50aW1lc3RhbXAgPSBuZXcgRGF0ZShwdnV0aWxzLnV0aWxGcm9tQmFzZShuZXcgVWludDhBcnJheShzdHJlYW0uZ2V0QmxvY2soOCkpLCA4KSk7XG4gICAgICAgICAgICBjb25zdCBleHRlbnNpb25zTGVuZ3RoID0gc3RyZWFtLmdldFVpbnQxNigpO1xuICAgICAgICAgICAgdGhpcy5leHRlbnNpb25zID0gKG5ldyBVaW50OEFycmF5KHN0cmVhbS5nZXRCbG9jayhleHRlbnNpb25zTGVuZ3RoKSkpLmJ1ZmZlci5zbGljZSgwKTtcbiAgICAgICAgICAgIHN3aXRjaCAoKHN0cmVhbS5nZXRCbG9jaygxKSlbMF0pIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzaEFsZ29yaXRobSA9IE5PTkU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYXNoQWxnb3JpdGhtID0gTUQ1O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzaEFsZ29yaXRobSA9IFNIQTE7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYXNoQWxnb3JpdGhtID0gU0hBMjI0O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzaEFsZ29yaXRobSA9IFNIQTI1NjtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhc2hBbGdvcml0aG0gPSBTSEEzODQ7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYXNoQWxnb3JpdGhtID0gU0hBNTEyO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJPYmplY3QncyBzdHJlYW0gd2FzIG5vdCBjb3JyZWN0IGZvciBTaWduZWRDZXJ0aWZpY2F0ZVRpbWVzdGFtcFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN3aXRjaCAoKHN0cmVhbS5nZXRCbG9jaygxKSlbMF0pIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtID0gQU5PTllNT1VTO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtID0gUlNBO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtID0gRFNBO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtID0gRUNEU0E7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk9iamVjdCdzIHN0cmVhbSB3YXMgbm90IGNvcnJlY3QgZm9yIFNpZ25lZENlcnRpZmljYXRlVGltZXN0YW1wXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3Qgc2lnbmF0dXJlTGVuZ3RoID0gc3RyZWFtLmdldFVpbnQxNigpO1xuICAgICAgICAgICAgdGhpcy5zaWduYXR1cmUgPSBuZXcgVWludDhBcnJheShzdHJlYW0uZ2V0QmxvY2soc2lnbmF0dXJlTGVuZ3RoKSkuYnVmZmVyLnNsaWNlKDApO1xuICAgICAgICAgICAgaWYgKGJsb2NrTGVuZ3RoICE9PSAoNDcgKyBleHRlbnNpb25zTGVuZ3RoICsgc2lnbmF0dXJlTGVuZ3RoKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk9iamVjdCdzIHN0cmVhbSB3YXMgbm90IGNvcnJlY3QgZm9yIFNpZ25lZENlcnRpZmljYXRlVGltZXN0YW1wXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBzdHJlYW0gPSB0aGlzLnRvU3RyZWFtKCk7XG4gICAgICAgIHJldHVybiBuZXcgYXNuMWpzLlJhd0RhdGEoeyBkYXRhOiBzdHJlYW0uc3RyZWFtLmJ1ZmZlciB9KTtcbiAgICB9XG4gICAgdG9TdHJlYW0oKSB7XG4gICAgICAgIGNvbnN0IHN0cmVhbSA9IG5ldyBicy5TZXFTdHJlYW0oKTtcbiAgICAgICAgc3RyZWFtLmFwcGVuZFVpbnQxNig0NyArIHRoaXMuZXh0ZW5zaW9ucy5ieXRlTGVuZ3RoICsgdGhpcy5zaWduYXR1cmUuYnl0ZUxlbmd0aCk7XG4gICAgICAgIHN0cmVhbS5hcHBlbmRDaGFyKHRoaXMudmVyc2lvbik7XG4gICAgICAgIHN0cmVhbS5hcHBlbmRWaWV3KG5ldyBVaW50OEFycmF5KHRoaXMubG9nSUQpKTtcbiAgICAgICAgY29uc3QgdGltZUJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcig4KTtcbiAgICAgICAgY29uc3QgdGltZVZpZXcgPSBuZXcgVWludDhBcnJheSh0aW1lQnVmZmVyKTtcbiAgICAgICAgY29uc3QgYmFzZUFycmF5ID0gcHZ1dGlscy51dGlsVG9CYXNlKHRoaXMudGltZXN0YW1wLnZhbHVlT2YoKSwgOCk7XG4gICAgICAgIHRpbWVWaWV3LnNldChuZXcgVWludDhBcnJheShiYXNlQXJyYXkpLCA4IC0gYmFzZUFycmF5LmJ5dGVMZW5ndGgpO1xuICAgICAgICBzdHJlYW0uYXBwZW5kVmlldyh0aW1lVmlldyk7XG4gICAgICAgIHN0cmVhbS5hcHBlbmRVaW50MTYodGhpcy5leHRlbnNpb25zLmJ5dGVMZW5ndGgpO1xuICAgICAgICBpZiAodGhpcy5leHRlbnNpb25zLmJ5dGVMZW5ndGgpXG4gICAgICAgICAgICBzdHJlYW0uYXBwZW5kVmlldyhuZXcgVWludDhBcnJheSh0aGlzLmV4dGVuc2lvbnMpKTtcbiAgICAgICAgbGV0IF9oYXNoQWxnb3JpdGhtO1xuICAgICAgICBzd2l0Y2ggKHRoaXMuaGFzaEFsZ29yaXRobS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICBjYXNlIE5PTkU6XG4gICAgICAgICAgICAgICAgX2hhc2hBbGdvcml0aG0gPSAwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBNRDU6XG4gICAgICAgICAgICAgICAgX2hhc2hBbGdvcml0aG0gPSAxO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBTSEExOlxuICAgICAgICAgICAgICAgIF9oYXNoQWxnb3JpdGhtID0gMjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgU0hBMjI0OlxuICAgICAgICAgICAgICAgIF9oYXNoQWxnb3JpdGhtID0gMztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgU0hBMjU2OlxuICAgICAgICAgICAgICAgIF9oYXNoQWxnb3JpdGhtID0gNDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgU0hBMzg0OlxuICAgICAgICAgICAgICAgIF9oYXNoQWxnb3JpdGhtID0gNTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgU0hBNTEyOlxuICAgICAgICAgICAgICAgIF9oYXNoQWxnb3JpdGhtID0gNjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbmNvcnJlY3QgZGF0YSBmb3IgaGFzaEFsZ29yaXRobTogJHt0aGlzLmhhc2hBbGdvcml0aG19YCk7XG4gICAgICAgIH1cbiAgICAgICAgc3RyZWFtLmFwcGVuZENoYXIoX2hhc2hBbGdvcml0aG0pO1xuICAgICAgICBsZXQgX3NpZ25hdHVyZUFsZ29yaXRobTtcbiAgICAgICAgc3dpdGNoICh0aGlzLnNpZ25hdHVyZUFsZ29yaXRobS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICBjYXNlIEFOT05ZTU9VUzpcbiAgICAgICAgICAgICAgICBfc2lnbmF0dXJlQWxnb3JpdGhtID0gMDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgUlNBOlxuICAgICAgICAgICAgICAgIF9zaWduYXR1cmVBbGdvcml0aG0gPSAxO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBEU0E6XG4gICAgICAgICAgICAgICAgX3NpZ25hdHVyZUFsZ29yaXRobSA9IDI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIEVDRFNBOlxuICAgICAgICAgICAgICAgIF9zaWduYXR1cmVBbGdvcml0aG0gPSAzO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBkYXRhIGZvciBzaWduYXR1cmVBbGdvcml0aG06ICR7dGhpcy5zaWduYXR1cmVBbGdvcml0aG19YCk7XG4gICAgICAgIH1cbiAgICAgICAgc3RyZWFtLmFwcGVuZENoYXIoX3NpZ25hdHVyZUFsZ29yaXRobSk7XG4gICAgICAgIHN0cmVhbS5hcHBlbmRVaW50MTYodGhpcy5zaWduYXR1cmUuYnl0ZUxlbmd0aCk7XG4gICAgICAgIHN0cmVhbS5hcHBlbmRWaWV3KG5ldyBVaW50OEFycmF5KHRoaXMuc2lnbmF0dXJlKSk7XG4gICAgICAgIHJldHVybiBzdHJlYW07XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZlcnNpb246IHRoaXMudmVyc2lvbixcbiAgICAgICAgICAgIGxvZ0lEOiBwdnV0aWxzLmJ1ZmZlclRvSGV4Q29kZXModGhpcy5sb2dJRCksXG4gICAgICAgICAgICB0aW1lc3RhbXA6IHRoaXMudGltZXN0YW1wLFxuICAgICAgICAgICAgZXh0ZW5zaW9uczogcHZ1dGlscy5idWZmZXJUb0hleENvZGVzKHRoaXMuZXh0ZW5zaW9ucyksXG4gICAgICAgICAgICBoYXNoQWxnb3JpdGhtOiB0aGlzLmhhc2hBbGdvcml0aG0sXG4gICAgICAgICAgICBzaWduYXR1cmVBbGdvcml0aG06IHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtLFxuICAgICAgICAgICAgc2lnbmF0dXJlOiBwdnV0aWxzLmJ1ZmZlclRvSGV4Q29kZXModGhpcy5zaWduYXR1cmUpLFxuICAgICAgICB9O1xuICAgIH1cbiAgICBhc3luYyB2ZXJpZnkobG9ncywgZGF0YSwgZGF0YVR5cGUgPSAwLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgY29uc3QgbG9nSWQgPSBwdnV0aWxzLnRvQmFzZTY0KHB2dXRpbHMuYXJyYXlCdWZmZXJUb1N0cmluZyh0aGlzLmxvZ0lEKSk7XG4gICAgICAgIGxldCBwdWJsaWNLZXlCYXNlNjQgPSBudWxsO1xuICAgICAgICBjb25zdCBzdHJlYW0gPSBuZXcgYnMuU2VxU3RyZWFtKCk7XG4gICAgICAgIGZvciAoY29uc3QgbG9nIG9mIGxvZ3MpIHtcbiAgICAgICAgICAgIGlmIChsb2cubG9nX2lkID09PSBsb2dJZCkge1xuICAgICAgICAgICAgICAgIHB1YmxpY0tleUJhc2U2NCA9IGxvZy5rZXk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFwdWJsaWNLZXlCYXNlNjQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgUHVibGljIGtleSBub3QgZm91bmQgZm9yIENUIHdpdGggbG9nSWQ6ICR7bG9nSWR9YCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcGtpID0gcHZ1dGlscy5zdHJpbmdUb0FycmF5QnVmZmVyKHB2dXRpbHMuZnJvbUJhc2U2NChwdWJsaWNLZXlCYXNlNjQpKTtcbiAgICAgICAgY29uc3QgcHVibGljS2V5SW5mbyA9IFB1YmxpY0tleUluZm8uZnJvbUJFUihwa2kpO1xuICAgICAgICBzdHJlYW0uYXBwZW5kQ2hhcigweDAwKTtcbiAgICAgICAgc3RyZWFtLmFwcGVuZENoYXIoMHgwMCk7XG4gICAgICAgIGNvbnN0IHRpbWVCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoOCk7XG4gICAgICAgIGNvbnN0IHRpbWVWaWV3ID0gbmV3IFVpbnQ4QXJyYXkodGltZUJ1ZmZlcik7XG4gICAgICAgIGNvbnN0IGJhc2VBcnJheSA9IHB2dXRpbHMudXRpbFRvQmFzZSh0aGlzLnRpbWVzdGFtcC52YWx1ZU9mKCksIDgpO1xuICAgICAgICB0aW1lVmlldy5zZXQobmV3IFVpbnQ4QXJyYXkoYmFzZUFycmF5KSwgOCAtIGJhc2VBcnJheS5ieXRlTGVuZ3RoKTtcbiAgICAgICAgc3RyZWFtLmFwcGVuZFZpZXcodGltZVZpZXcpO1xuICAgICAgICBzdHJlYW0uYXBwZW5kVWludDE2KGRhdGFUeXBlKTtcbiAgICAgICAgaWYgKGRhdGFUeXBlID09PSAwKVxuICAgICAgICAgICAgc3RyZWFtLmFwcGVuZFVpbnQyNChkYXRhLmJ5dGVMZW5ndGgpO1xuICAgICAgICBzdHJlYW0uYXBwZW5kVmlldyhuZXcgVWludDhBcnJheShkYXRhKSk7XG4gICAgICAgIHN0cmVhbS5hcHBlbmRVaW50MTYodGhpcy5leHRlbnNpb25zLmJ5dGVMZW5ndGgpO1xuICAgICAgICBpZiAodGhpcy5leHRlbnNpb25zLmJ5dGVMZW5ndGggIT09IDApXG4gICAgICAgICAgICBzdHJlYW0uYXBwZW5kVmlldyhuZXcgVWludDhBcnJheSh0aGlzLmV4dGVuc2lvbnMpKTtcbiAgICAgICAgcmV0dXJuIGNyeXB0by52ZXJpZnlXaXRoUHVibGljS2V5KHN0cmVhbS5idWZmZXIuc2xpY2UoMCwgc3RyZWFtLmxlbmd0aCksIG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyB2YWx1ZUhleDogdGhpcy5zaWduYXR1cmUgfSksIHB1YmxpY0tleUluZm8sIHsgYWxnb3JpdGhtSWQ6IEVNUFRZX1NUUklORyB9LCBcIlNIQS0yNTZcIik7XG4gICAgfVxufVxuU2lnbmVkQ2VydGlmaWNhdGVUaW1lc3RhbXAuQ0xBU1NfTkFNRSA9IFwiU2lnbmVkQ2VydGlmaWNhdGVUaW1lc3RhbXBcIjtcbmFzeW5jIGZ1bmN0aW9uIHZlcmlmeVNDVHNGb3JDZXJ0aWZpY2F0ZShjZXJ0aWZpY2F0ZSwgaXNzdWVyQ2VydGlmaWNhdGUsIGxvZ3MsIGluZGV4ID0gKC0xKSwgY3J5cHRvID0gZ2V0Q3J5cHRvKHRydWUpKSB7XG4gICAgbGV0IHBhcnNlZFZhbHVlID0gbnVsbDtcbiAgICBjb25zdCBzdHJlYW0gPSBuZXcgYnMuU2VxU3RyZWFtKCk7XG4gICAgaWYgKGNlcnRpZmljYXRlLmV4dGVuc2lvbnMpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IGNlcnRpZmljYXRlLmV4dGVuc2lvbnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIHN3aXRjaCAoY2VydGlmaWNhdGUuZXh0ZW5zaW9uc1tpXS5leHRuSUQpIHtcbiAgICAgICAgICAgICAgICBjYXNlIGlkX1NpZ25lZENlcnRpZmljYXRlVGltZXN0YW1wTGlzdDpcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VkVmFsdWUgPSBjZXJ0aWZpY2F0ZS5leHRlbnNpb25zW2ldLnBhcnNlZFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwYXJzZWRWYWx1ZSB8fCBwYXJzZWRWYWx1ZS50aW1lc3RhbXBzLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJOb3RoaW5nIHRvIHZlcmlmeSBpbiB0aGUgY2VydGlmaWNhdGVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBjZXJ0aWZpY2F0ZS5leHRlbnNpb25zLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAocGFyc2VkVmFsdWUgPT09IG51bGwpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIFNpZ25lZENlcnRpZmljYXRlVGltZXN0YW1wTGlzdCBleHRlbnNpb24gaW4gdGhlIHNwZWNpZmllZCBjZXJ0aWZpY2F0ZVwiKTtcbiAgICBjb25zdCB0YnMgPSBjZXJ0aWZpY2F0ZS5lbmNvZGVUQlMoKS50b0JFUigpO1xuICAgIGNvbnN0IGlzc3VlcklkID0gYXdhaXQgY3J5cHRvLmRpZ2VzdCh7IG5hbWU6IFwiU0hBLTI1NlwiIH0sIG5ldyBVaW50OEFycmF5KGlzc3VlckNlcnRpZmljYXRlLnN1YmplY3RQdWJsaWNLZXlJbmZvLnRvU2NoZW1hKCkudG9CRVIoZmFsc2UpKSk7XG4gICAgc3RyZWFtLmFwcGVuZFZpZXcobmV3IFVpbnQ4QXJyYXkoaXNzdWVySWQpKTtcbiAgICBzdHJlYW0uYXBwZW5kVWludDI0KHRicy5ieXRlTGVuZ3RoKTtcbiAgICBzdHJlYW0uYXBwZW5kVmlldyhuZXcgVWludDhBcnJheSh0YnMpKTtcbiAgICBjb25zdCBwcmVDZXJ0ID0gc3RyZWFtLnN0cmVhbS5zbGljZSgwLCBzdHJlYW0ubGVuZ3RoKTtcbiAgICBpZiAoaW5kZXggPT09ICgtMSkpIHtcbiAgICAgICAgY29uc3QgdmVyaWZ5QXJyYXkgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCB0aW1lc3RhbXAgb2YgcGFyc2VkVmFsdWUudGltZXN0YW1wcykge1xuICAgICAgICAgICAgY29uc3QgdmVyaWZ5UmVzdWx0ID0gYXdhaXQgdGltZXN0YW1wLnZlcmlmeShsb2dzLCBwcmVDZXJ0LmJ1ZmZlciwgMSwgY3J5cHRvKTtcbiAgICAgICAgICAgIHZlcmlmeUFycmF5LnB1c2godmVyaWZ5UmVzdWx0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmVyaWZ5QXJyYXk7XG4gICAgfVxuICAgIGlmIChpbmRleCA+PSBwYXJzZWRWYWx1ZS50aW1lc3RhbXBzLmxlbmd0aClcbiAgICAgICAgaW5kZXggPSAocGFyc2VkVmFsdWUudGltZXN0YW1wcy5sZW5ndGggLSAxKTtcbiAgICByZXR1cm4gW2F3YWl0IHBhcnNlZFZhbHVlLnRpbWVzdGFtcHNbaW5kZXhdLnZlcmlmeShsb2dzLCBwcmVDZXJ0LmJ1ZmZlciwgMSwgY3J5cHRvKV07XG59XG5cbmNvbnN0IFRJTUVTVEFNUFMgPSBcInRpbWVzdGFtcHNcIjtcbmNsYXNzIFNpZ25lZENlcnRpZmljYXRlVGltZXN0YW1wTGlzdCBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudGltZXN0YW1wcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFRJTUVTVEFNUFMsIFNpZ25lZENlcnRpZmljYXRlVGltZXN0YW1wTGlzdC5kZWZhdWx0VmFsdWVzKFRJTUVTVEFNUFMpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFRJTUVTVEFNUFM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBUSU1FU1RBTVBTOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUubGVuZ3RoID09PSAwKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICAoX2EgPSBuYW1lcy5vcHRpb25hbCkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogKG5hbWVzLm9wdGlvbmFsID0gZmFsc2UpO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBcIlNpZ25lZENlcnRpZmljYXRlVGltZXN0YW1wTGlzdFwiKSxcbiAgICAgICAgICAgIG9wdGlvbmFsOiBuYW1lcy5vcHRpb25hbFxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIGlmICgoc2NoZW1hIGluc3RhbmNlb2YgYXNuMWpzLk9jdGV0U3RyaW5nKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk9iamVjdCdzIHNjaGVtYSB3YXMgbm90IHZlcmlmaWVkIGFnYWluc3QgaW5wdXQgZGF0YSBmb3IgU2lnbmVkQ2VydGlmaWNhdGVUaW1lc3RhbXBMaXN0XCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHNlcVN0cmVhbSA9IG5ldyBicy5TZXFTdHJlYW0oe1xuICAgICAgICAgICAgc3RyZWFtOiBuZXcgYnMuQnl0ZVN0cmVhbSh7XG4gICAgICAgICAgICAgICAgYnVmZmVyOiBzY2hlbWEudmFsdWVCbG9jay52YWx1ZUhleFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGRhdGFMZW5ndGggPSBzZXFTdHJlYW0uZ2V0VWludDE2KCk7XG4gICAgICAgIGlmIChkYXRhTGVuZ3RoICE9PSBzZXFTdHJlYW0ubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJPYmplY3QncyBzY2hlbWEgd2FzIG5vdCB2ZXJpZmllZCBhZ2FpbnN0IGlucHV0IGRhdGEgZm9yIFNpZ25lZENlcnRpZmljYXRlVGltZXN0YW1wTGlzdFwiKTtcbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAoc2VxU3RyZWFtLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy50aW1lc3RhbXBzLnB1c2gobmV3IFNpZ25lZENlcnRpZmljYXRlVGltZXN0YW1wKHsgc3RyZWFtOiBzZXFTdHJlYW0gfSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBzdHJlYW0gPSBuZXcgYnMuU2VxU3RyZWFtKCk7XG4gICAgICAgIGxldCBvdmVyYWxsTGVuZ3RoID0gMDtcbiAgICAgICAgY29uc3QgdGltZXN0YW1wc0RhdGEgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCB0aW1lc3RhbXAgb2YgdGhpcy50aW1lc3RhbXBzKSB7XG4gICAgICAgICAgICBjb25zdCB0aW1lc3RhbXBTdHJlYW0gPSB0aW1lc3RhbXAudG9TdHJlYW0oKTtcbiAgICAgICAgICAgIHRpbWVzdGFtcHNEYXRhLnB1c2godGltZXN0YW1wU3RyZWFtKTtcbiAgICAgICAgICAgIG92ZXJhbGxMZW5ndGggKz0gdGltZXN0YW1wU3RyZWFtLnN0cmVhbS5idWZmZXIuYnl0ZUxlbmd0aDtcbiAgICAgICAgfVxuICAgICAgICBzdHJlYW0uYXBwZW5kVWludDE2KG92ZXJhbGxMZW5ndGgpO1xuICAgICAgICBmb3IgKGNvbnN0IHRpbWVzdGFtcCBvZiB0aW1lc3RhbXBzRGF0YSkge1xuICAgICAgICAgICAgc3RyZWFtLmFwcGVuZFZpZXcodGltZXN0YW1wLnN0cmVhbS52aWV3KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiBzdHJlYW0uc3RyZWFtLmJ1ZmZlci5zbGljZSgwKSB9KTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdGltZXN0YW1wczogQXJyYXkuZnJvbSh0aGlzLnRpbWVzdGFtcHMsIG8gPT4gby50b0pTT04oKSlcbiAgICAgICAgfTtcbiAgICB9XG59XG5TaWduZWRDZXJ0aWZpY2F0ZVRpbWVzdGFtcExpc3QuQ0xBU1NfTkFNRSA9IFwiU2lnbmVkQ2VydGlmaWNhdGVUaW1lc3RhbXBMaXN0XCI7XG5cbmNvbnN0IEFUVFJJQlVURVMkNCA9IFwiYXR0cmlidXRlc1wiO1xuY29uc3QgQ0xFQVJfUFJPUFMkMTEgPSBbXG4gICAgQVRUUklCVVRFUyQ0XG5dO1xuY2xhc3MgU3ViamVjdERpcmVjdG9yeUF0dHJpYnV0ZXMgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmF0dHJpYnV0ZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBBVFRSSUJVVEVTJDQsIFN1YmplY3REaXJlY3RvcnlBdHRyaWJ1dGVzLmRlZmF1bHRWYWx1ZXMoQVRUUklCVVRFUyQ0KSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBBVFRSSUJVVEVTJDQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmF0dHJpYnV0ZXMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IEF0dHJpYnV0ZS5zY2hlbWEoKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkMTEpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFN1YmplY3REaXJlY3RvcnlBdHRyaWJ1dGVzLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IEFUVFJJQlVURVMkNFxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHQuYXR0cmlidXRlcywgZWxlbWVudCA9PiBuZXcgQXR0cmlidXRlKHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLmF0dHJpYnV0ZXMsIG8gPT4gby50b1NjaGVtYSgpKVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZXM6IEFycmF5LmZyb20odGhpcy5hdHRyaWJ1dGVzLCBvID0+IG8udG9KU09OKCkpXG4gICAgICAgIH07XG4gICAgfVxufVxuU3ViamVjdERpcmVjdG9yeUF0dHJpYnV0ZXMuQ0xBU1NfTkFNRSA9IFwiU3ViamVjdERpcmVjdG9yeUF0dHJpYnV0ZXNcIjtcblxuY2xhc3MgRXh0ZW5zaW9uVmFsdWVGYWN0b3J5IHtcbiAgICBzdGF0aWMgZ2V0SXRlbXMoKSB7XG4gICAgICAgIGlmICghdGhpcy50eXBlcykge1xuICAgICAgICAgICAgdGhpcy50eXBlcyA9IHt9O1xuICAgICAgICAgICAgRXh0ZW5zaW9uVmFsdWVGYWN0b3J5LnJlZ2lzdGVyKGlkX1N1YmplY3RBbHROYW1lLCBcIlN1YmplY3RBbHROYW1lXCIsIEFsdE5hbWUpO1xuICAgICAgICAgICAgRXh0ZW5zaW9uVmFsdWVGYWN0b3J5LnJlZ2lzdGVyKGlkX0lzc3VlckFsdE5hbWUsIFwiSXNzdWVyQWx0TmFtZVwiLCBBbHROYW1lKTtcbiAgICAgICAgICAgIEV4dGVuc2lvblZhbHVlRmFjdG9yeS5yZWdpc3RlcihpZF9BdXRob3JpdHlLZXlJZGVudGlmaWVyLCBcIkF1dGhvcml0eUtleUlkZW50aWZpZXJcIiwgQXV0aG9yaXR5S2V5SWRlbnRpZmllcik7XG4gICAgICAgICAgICBFeHRlbnNpb25WYWx1ZUZhY3RvcnkucmVnaXN0ZXIoaWRfQmFzaWNDb25zdHJhaW50cywgXCJCYXNpY0NvbnN0cmFpbnRzXCIsIEJhc2ljQ29uc3RyYWludHMpO1xuICAgICAgICAgICAgRXh0ZW5zaW9uVmFsdWVGYWN0b3J5LnJlZ2lzdGVyKGlkX01pY3Jvc29mdENhVmVyc2lvbiwgXCJNaWNyb3NvZnRDYVZlcnNpb25cIiwgQ0FWZXJzaW9uKTtcbiAgICAgICAgICAgIEV4dGVuc2lvblZhbHVlRmFjdG9yeS5yZWdpc3RlcihpZF9DZXJ0aWZpY2F0ZVBvbGljaWVzLCBcIkNlcnRpZmljYXRlUG9saWNpZXNcIiwgQ2VydGlmaWNhdGVQb2xpY2llcyk7XG4gICAgICAgICAgICBFeHRlbnNpb25WYWx1ZUZhY3RvcnkucmVnaXN0ZXIoaWRfTWljcm9zb2Z0QXBwUG9saWNpZXMsIFwiQ2VydGlmaWNhdGVQb2xpY2llc01pY3Jvc29mdFwiLCBDZXJ0aWZpY2F0ZVBvbGljaWVzKTtcbiAgICAgICAgICAgIEV4dGVuc2lvblZhbHVlRmFjdG9yeS5yZWdpc3RlcihpZF9NaWNyb3NvZnRDZXJ0VGVtcGxhdGVWMiwgXCJNaWNyb3NvZnRDZXJ0VGVtcGxhdGVWMlwiLCBDZXJ0aWZpY2F0ZVRlbXBsYXRlKTtcbiAgICAgICAgICAgIEV4dGVuc2lvblZhbHVlRmFjdG9yeS5yZWdpc3RlcihpZF9DUkxEaXN0cmlidXRpb25Qb2ludHMsIFwiQ1JMRGlzdHJpYnV0aW9uUG9pbnRzXCIsIENSTERpc3RyaWJ1dGlvblBvaW50cyk7XG4gICAgICAgICAgICBFeHRlbnNpb25WYWx1ZUZhY3RvcnkucmVnaXN0ZXIoaWRfRnJlc2hlc3RDUkwsIFwiRnJlc2hlc3RDUkxcIiwgQ1JMRGlzdHJpYnV0aW9uUG9pbnRzKTtcbiAgICAgICAgICAgIEV4dGVuc2lvblZhbHVlRmFjdG9yeS5yZWdpc3RlcihpZF9FeHRLZXlVc2FnZSwgXCJFeHRLZXlVc2FnZVwiLCBFeHRLZXlVc2FnZSk7XG4gICAgICAgICAgICBFeHRlbnNpb25WYWx1ZUZhY3RvcnkucmVnaXN0ZXIoaWRfQ2VydGlmaWNhdGVJc3N1ZXIsIFwiQ2VydGlmaWNhdGVJc3N1ZXJcIiwgR2VuZXJhbE5hbWVzKTtcbiAgICAgICAgICAgIEV4dGVuc2lvblZhbHVlRmFjdG9yeS5yZWdpc3RlcihpZF9BdXRob3JpdHlJbmZvQWNjZXNzLCBcIkF1dGhvcml0eUluZm9BY2Nlc3NcIiwgSW5mb0FjY2Vzcyk7XG4gICAgICAgICAgICBFeHRlbnNpb25WYWx1ZUZhY3RvcnkucmVnaXN0ZXIoaWRfU3ViamVjdEluZm9BY2Nlc3MsIFwiU3ViamVjdEluZm9BY2Nlc3NcIiwgSW5mb0FjY2Vzcyk7XG4gICAgICAgICAgICBFeHRlbnNpb25WYWx1ZUZhY3RvcnkucmVnaXN0ZXIoaWRfSXNzdWluZ0Rpc3RyaWJ1dGlvblBvaW50LCBcIklzc3VpbmdEaXN0cmlidXRpb25Qb2ludFwiLCBJc3N1aW5nRGlzdHJpYnV0aW9uUG9pbnQpO1xuICAgICAgICAgICAgRXh0ZW5zaW9uVmFsdWVGYWN0b3J5LnJlZ2lzdGVyKGlkX05hbWVDb25zdHJhaW50cywgXCJOYW1lQ29uc3RyYWludHNcIiwgTmFtZUNvbnN0cmFpbnRzKTtcbiAgICAgICAgICAgIEV4dGVuc2lvblZhbHVlRmFjdG9yeS5yZWdpc3RlcihpZF9Qb2xpY3lDb25zdHJhaW50cywgXCJQb2xpY3lDb25zdHJhaW50c1wiLCBQb2xpY3lDb25zdHJhaW50cyk7XG4gICAgICAgICAgICBFeHRlbnNpb25WYWx1ZUZhY3RvcnkucmVnaXN0ZXIoaWRfUG9saWN5TWFwcGluZ3MsIFwiUG9saWN5TWFwcGluZ3NcIiwgUG9saWN5TWFwcGluZ3MpO1xuICAgICAgICAgICAgRXh0ZW5zaW9uVmFsdWVGYWN0b3J5LnJlZ2lzdGVyKGlkX1ByaXZhdGVLZXlVc2FnZVBlcmlvZCwgXCJQcml2YXRlS2V5VXNhZ2VQZXJpb2RcIiwgUHJpdmF0ZUtleVVzYWdlUGVyaW9kKTtcbiAgICAgICAgICAgIEV4dGVuc2lvblZhbHVlRmFjdG9yeS5yZWdpc3RlcihpZF9RQ1N0YXRlbWVudHMsIFwiUUNTdGF0ZW1lbnRzXCIsIFFDU3RhdGVtZW50cyk7XG4gICAgICAgICAgICBFeHRlbnNpb25WYWx1ZUZhY3RvcnkucmVnaXN0ZXIoaWRfU2lnbmVkQ2VydGlmaWNhdGVUaW1lc3RhbXBMaXN0LCBcIlNpZ25lZENlcnRpZmljYXRlVGltZXN0YW1wTGlzdFwiLCBTaWduZWRDZXJ0aWZpY2F0ZVRpbWVzdGFtcExpc3QpO1xuICAgICAgICAgICAgRXh0ZW5zaW9uVmFsdWVGYWN0b3J5LnJlZ2lzdGVyKGlkX1N1YmplY3REaXJlY3RvcnlBdHRyaWJ1dGVzLCBcIlN1YmplY3REaXJlY3RvcnlBdHRyaWJ1dGVzXCIsIFN1YmplY3REaXJlY3RvcnlBdHRyaWJ1dGVzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy50eXBlcztcbiAgICB9XG4gICAgc3RhdGljIGZyb21CRVIoaWQsIHJhdykge1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmZyb21CRVIocmF3KTtcbiAgICAgICAgaWYgKGFzbjEub2Zmc2V0ID09PSAtMSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaXRlbSA9IHRoaXMuZmluZChpZCk7XG4gICAgICAgIGlmIChpdGVtKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgaXRlbS50eXBlKHsgc2NoZW1hOiBhc24xLnJlc3VsdCB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXMgPSBuZXcgaXRlbS50eXBlKCk7XG4gICAgICAgICAgICAgICAgcmVzLnBhcnNpbmdFcnJvciA9IGBJbmNvcnJlY3RseSBmb3JtYXR0ZWQgdmFsdWUgb2YgZXh0ZW5zaW9uICR7aXRlbS5uYW1lfSAoJHtpZH0pYDtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhc24xLnJlc3VsdDtcbiAgICB9XG4gICAgc3RhdGljIGZpbmQoaWQpIHtcbiAgICAgICAgY29uc3QgdHlwZXMgPSB0aGlzLmdldEl0ZW1zKCk7XG4gICAgICAgIHJldHVybiB0eXBlc1tpZF0gfHwgbnVsbDtcbiAgICB9XG4gICAgc3RhdGljIHJlZ2lzdGVyKGlkLCBuYW1lLCB0eXBlKSB7XG4gICAgICAgIHRoaXMuZ2V0SXRlbXMoKVtpZF0gPSB7IG5hbWUsIHR5cGUgfTtcbiAgICB9XG59XG5cbmNvbnN0IEVYVE5fSUQgPSBcImV4dG5JRFwiO1xuY29uc3QgQ1JJVElDQUwgPSBcImNyaXRpY2FsXCI7XG5jb25zdCBFWFROX1ZBTFVFID0gXCJleHRuVmFsdWVcIjtcbmNvbnN0IFBBUlNFRF9WQUxVRSQ1ID0gXCJwYXJzZWRWYWx1ZVwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkMTAgPSBbXG4gICAgRVhUTl9JRCxcbiAgICBDUklUSUNBTCxcbiAgICBFWFROX1ZBTFVFXG5dO1xuY2xhc3MgRXh0ZW5zaW9uIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBnZXQgcGFyc2VkVmFsdWUoKSB7XG4gICAgICAgIGlmICh0aGlzLl9wYXJzZWRWYWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBjb25zdCBwYXJzZWRWYWx1ZSA9IEV4dGVuc2lvblZhbHVlRmFjdG9yeS5mcm9tQkVSKHRoaXMuZXh0bklELCB0aGlzLmV4dG5WYWx1ZS52YWx1ZUJsb2NrLnZhbHVlSGV4Vmlldyk7XG4gICAgICAgICAgICB0aGlzLl9wYXJzZWRWYWx1ZSA9IHBhcnNlZFZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9wYXJzZWRWYWx1ZSB8fCB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHNldCBwYXJzZWRWYWx1ZSh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9wYXJzZWRWYWx1ZSA9IHZhbHVlO1xuICAgIH1cbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5leHRuSUQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBFWFROX0lELCBFeHRlbnNpb24uZGVmYXVsdFZhbHVlcyhFWFROX0lEKSk7XG4gICAgICAgIHRoaXMuY3JpdGljYWwgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBDUklUSUNBTCwgRXh0ZW5zaW9uLmRlZmF1bHRWYWx1ZXMoQ1JJVElDQUwpKTtcbiAgICAgICAgaWYgKEVYVE5fVkFMVUUgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5leHRuVmFsdWUgPSBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgdmFsdWVIZXg6IHBhcmFtZXRlcnMuZXh0blZhbHVlIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5leHRuVmFsdWUgPSBFeHRlbnNpb24uZGVmYXVsdFZhbHVlcyhFWFROX1ZBTFVFKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoUEFSU0VEX1ZBTFVFJDUgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5wYXJzZWRWYWx1ZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFBBUlNFRF9WQUxVRSQ1LCBFeHRlbnNpb24uZGVmYXVsdFZhbHVlcyhQQVJTRURfVkFMVUUkNSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBFWFROX0lEOlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9TVFJJTkc7XG4gICAgICAgICAgICBjYXNlIENSSVRJQ0FMOlxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIGNhc2UgRVhUTl9WQUxVRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5PY3RldFN0cmluZygpO1xuICAgICAgICAgICAgY2FzZSBQQVJTRURfVkFMVUUkNTpcbiAgICAgICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IG5hbWU6IChuYW1lcy5leHRuSUQgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkJvb2xlYW4oe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuY3JpdGljYWwgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWVcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgbmFtZTogKG5hbWVzLmV4dG5WYWx1ZSB8fCBFTVBUWV9TVFJJTkcpIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkMTApO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIEV4dGVuc2lvbi5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBleHRuSUQ6IEVYVE5fSUQsXG4gICAgICAgICAgICAgICAgY3JpdGljYWw6IENSSVRJQ0FMLFxuICAgICAgICAgICAgICAgIGV4dG5WYWx1ZTogRVhUTl9WQUxVRVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuZXh0bklEID0gYXNuMS5yZXN1bHQuZXh0bklELnZhbHVlQmxvY2sudG9TdHJpbmcoKTtcbiAgICAgICAgaWYgKENSSVRJQ0FMIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLmNyaXRpY2FsID0gYXNuMS5yZXN1bHQuY3JpdGljYWwudmFsdWVCbG9jay52YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmV4dG5WYWx1ZSA9IGFzbjEucmVzdWx0LmV4dG5WYWx1ZTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgdmFsdWU6IHRoaXMuZXh0bklEIH0pKTtcbiAgICAgICAgaWYgKHRoaXMuY3JpdGljYWwgIT09IEV4dGVuc2lvbi5kZWZhdWx0VmFsdWVzKENSSVRJQ0FMKSkge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkJvb2xlYW4oeyB2YWx1ZTogdGhpcy5jcml0aWNhbCB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLmV4dG5WYWx1ZSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IG9iamVjdCA9IHtcbiAgICAgICAgICAgIGV4dG5JRDogdGhpcy5leHRuSUQsXG4gICAgICAgICAgICBleHRuVmFsdWU6IHRoaXMuZXh0blZhbHVlLnRvSlNPTigpLFxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5jcml0aWNhbCAhPT0gRXh0ZW5zaW9uLmRlZmF1bHRWYWx1ZXMoQ1JJVElDQUwpKSB7XG4gICAgICAgICAgICBvYmplY3QuY3JpdGljYWwgPSB0aGlzLmNyaXRpY2FsO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcnNlZFZhbHVlICYmIHRoaXMucGFyc2VkVmFsdWUudG9KU09OKSB7XG4gICAgICAgICAgICBvYmplY3QucGFyc2VkVmFsdWUgPSB0aGlzLnBhcnNlZFZhbHVlLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvYmplY3Q7XG4gICAgfVxufVxuRXh0ZW5zaW9uLkNMQVNTX05BTUUgPSBcIkV4dGVuc2lvblwiO1xuXG5jb25zdCBFWFRFTlNJT05TJDUgPSBcImV4dGVuc2lvbnNcIjtcbmNvbnN0IENMRUFSX1BST1BTJCQgPSBbXG4gICAgRVhURU5TSU9OUyQ1LFxuXTtcbmNsYXNzIEV4dGVuc2lvbnMgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmV4dGVuc2lvbnMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBFWFRFTlNJT05TJDUsIEV4dGVuc2lvbnMuZGVmYXVsdFZhbHVlcyhFWFRFTlNJT05TJDUpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIEVYVEVOU0lPTlMkNTpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9LCBvcHRpb25hbCA9IGZhbHNlKSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBvcHRpb25hbCxcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5leHRlbnNpb25zIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBFeHRlbnNpb24uc2NoZW1hKG5hbWVzLmV4dGVuc2lvbiB8fCB7fSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJCQpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIEV4dGVuc2lvbnMuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgZXh0ZW5zaW9uczogRVhURU5TSU9OUyQ1XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5leHRlbnNpb25zID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdC5leHRlbnNpb25zLCBlbGVtZW50ID0+IG5ldyBFeHRlbnNpb24oeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMuZXh0ZW5zaW9ucywgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZXh0ZW5zaW9uczogdGhpcy5leHRlbnNpb25zLm1hcChvID0+IG8udG9KU09OKCkpXG4gICAgICAgIH07XG4gICAgfVxufVxuRXh0ZW5zaW9ucy5DTEFTU19OQU1FID0gXCJFeHRlbnNpb25zXCI7XG5cbmNvbnN0IElTU1VFUiQ1ID0gXCJpc3N1ZXJcIjtcbmNvbnN0IFNFUklBTF9OVU1CRVIkNiA9IFwic2VyaWFsTnVtYmVyXCI7XG5jb25zdCBJU1NVRVJfVUlEID0gXCJpc3N1ZXJVSURcIjtcbmNvbnN0IENMRUFSX1BST1BTJF8gPSBbXG4gICAgSVNTVUVSJDUsXG4gICAgU0VSSUFMX05VTUJFUiQ2LFxuICAgIElTU1VFUl9VSUQsXG5dO1xuY2xhc3MgSXNzdWVyU2VyaWFsIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5pc3N1ZXIgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBJU1NVRVIkNSwgSXNzdWVyU2VyaWFsLmRlZmF1bHRWYWx1ZXMoSVNTVUVSJDUpKTtcbiAgICAgICAgdGhpcy5zZXJpYWxOdW1iZXIgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTRVJJQUxfTlVNQkVSJDYsIElzc3VlclNlcmlhbC5kZWZhdWx0VmFsdWVzKFNFUklBTF9OVU1CRVIkNikpO1xuICAgICAgICBpZiAoSVNTVUVSX1VJRCBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLmlzc3VlclVJRCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIElTU1VFUl9VSUQsIElzc3VlclNlcmlhbC5kZWZhdWx0VmFsdWVzKElTU1VFUl9VSUQpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgSVNTVUVSJDU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmFsTmFtZXMoKTtcbiAgICAgICAgICAgIGNhc2UgU0VSSUFMX05VTUJFUiQ2OlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkludGVnZXIoKTtcbiAgICAgICAgICAgIGNhc2UgSVNTVUVSX1VJRDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5CaXRTdHJpbmcoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgR2VuZXJhbE5hbWVzLnNjaGVtYShuYW1lcy5pc3N1ZXIgfHwge30pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy5zZXJpYWxOdW1iZXIgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkJpdFN0cmluZyh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuaXNzdWVyVUlEIHx8IEVNUFRZX1NUUklORylcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJF8pO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIElzc3VlclNlcmlhbC5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBpc3N1ZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogSVNTVUVSJDVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc2VyaWFsTnVtYmVyOiBTRVJJQUxfTlVNQkVSJDYsXG4gICAgICAgICAgICAgICAgaXNzdWVyVUlEOiBJU1NVRVJfVUlEXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5pc3N1ZXIgPSBuZXcgR2VuZXJhbE5hbWVzKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5pc3N1ZXIgfSk7XG4gICAgICAgIHRoaXMuc2VyaWFsTnVtYmVyID0gYXNuMS5yZXN1bHQuc2VyaWFsTnVtYmVyO1xuICAgICAgICBpZiAoSVNTVUVSX1VJRCBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMuaXNzdWVyVUlEID0gYXNuMS5yZXN1bHQuaXNzdWVyVUlEO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIHRoaXMuaXNzdWVyLnRvU2NoZW1hKCksXG4gICAgICAgICAgICAgICAgdGhpcy5zZXJpYWxOdW1iZXJcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh0aGlzLmlzc3VlclVJRCkge1xuICAgICAgICAgICAgcmVzdWx0LnZhbHVlQmxvY2sudmFsdWUucHVzaCh0aGlzLmlzc3VlclVJRCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgICAgICBpc3N1ZXI6IHRoaXMuaXNzdWVyLnRvSlNPTigpLFxuICAgICAgICAgICAgc2VyaWFsTnVtYmVyOiB0aGlzLnNlcmlhbE51bWJlci50b0pTT04oKVxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5pc3N1ZXJVSUQpIHtcbiAgICAgICAgICAgIHJlc3VsdC5pc3N1ZXJVSUQgPSB0aGlzLmlzc3VlclVJRC50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbn1cbklzc3VlclNlcmlhbC5DTEFTU19OQU1FID0gXCJJc3N1ZXJTZXJpYWxcIjtcblxuY29uc3QgVkVSU0lPTiRoID0gXCJ2ZXJzaW9uXCI7XG5jb25zdCBCQVNFX0NFUlRJRklDQVRFX0lEJDIgPSBcImJhc2VDZXJ0aWZpY2F0ZUlEXCI7XG5jb25zdCBTVUJKRUNUX05BTUUgPSBcInN1YmplY3ROYW1lXCI7XG5jb25zdCBJU1NVRVIkNCA9IFwiaXNzdWVyXCI7XG5jb25zdCBTSUdOQVRVUkUkNiA9IFwic2lnbmF0dXJlXCI7XG5jb25zdCBTRVJJQUxfTlVNQkVSJDUgPSBcInNlcmlhbE51bWJlclwiO1xuY29uc3QgQVRUUl9DRVJUX1ZBTElESVRZX1BFUklPRCQxID0gXCJhdHRyQ2VydFZhbGlkaXR5UGVyaW9kXCI7XG5jb25zdCBBVFRSSUJVVEVTJDMgPSBcImF0dHJpYnV0ZXNcIjtcbmNvbnN0IElTU1VFUl9VTklRVUVfSUQkMiA9IFwiaXNzdWVyVW5pcXVlSURcIjtcbmNvbnN0IEVYVEVOU0lPTlMkNCA9IFwiZXh0ZW5zaW9uc1wiO1xuY29uc3QgQ0xFQVJfUFJPUFMkWiA9IFtcbiAgICBWRVJTSU9OJGgsXG4gICAgQkFTRV9DRVJUSUZJQ0FURV9JRCQyLFxuICAgIFNVQkpFQ1RfTkFNRSxcbiAgICBJU1NVRVIkNCxcbiAgICBTSUdOQVRVUkUkNixcbiAgICBTRVJJQUxfTlVNQkVSJDUsXG4gICAgQVRUUl9DRVJUX1ZBTElESVRZX1BFUklPRCQxLFxuICAgIEFUVFJJQlVURVMkMyxcbiAgICBJU1NVRVJfVU5JUVVFX0lEJDIsXG4gICAgRVhURU5TSU9OUyQ0LFxuXTtcbmNsYXNzIEF0dHJpYnV0ZUNlcnRpZmljYXRlSW5mb1YxIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVkVSU0lPTiRoLCBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMS5kZWZhdWx0VmFsdWVzKFZFUlNJT04kaCkpO1xuICAgICAgICBpZiAoQkFTRV9DRVJUSUZJQ0FURV9JRCQyIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuYmFzZUNlcnRpZmljYXRlSUQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBCQVNFX0NFUlRJRklDQVRFX0lEJDIsIEF0dHJpYnV0ZUNlcnRpZmljYXRlSW5mb1YxLmRlZmF1bHRWYWx1ZXMoQkFTRV9DRVJUSUZJQ0FURV9JRCQyKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFNVQkpFQ1RfTkFNRSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnN1YmplY3ROYW1lID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU1VCSkVDVF9OQU1FLCBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMS5kZWZhdWx0VmFsdWVzKFNVQkpFQ1RfTkFNRSkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXNzdWVyID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgSVNTVUVSJDQsIEF0dHJpYnV0ZUNlcnRpZmljYXRlSW5mb1YxLmRlZmF1bHRWYWx1ZXMoSVNTVUVSJDQpKTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTSUdOQVRVUkUkNiwgQXR0cmlidXRlQ2VydGlmaWNhdGVJbmZvVjEuZGVmYXVsdFZhbHVlcyhTSUdOQVRVUkUkNikpO1xuICAgICAgICB0aGlzLnNlcmlhbE51bWJlciA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNFUklBTF9OVU1CRVIkNSwgQXR0cmlidXRlQ2VydGlmaWNhdGVJbmZvVjEuZGVmYXVsdFZhbHVlcyhTRVJJQUxfTlVNQkVSJDUpKTtcbiAgICAgICAgdGhpcy5hdHRyQ2VydFZhbGlkaXR5UGVyaW9kID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQVRUUl9DRVJUX1ZBTElESVRZX1BFUklPRCQxLCBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMS5kZWZhdWx0VmFsdWVzKEFUVFJfQ0VSVF9WQUxJRElUWV9QRVJJT0QkMSkpO1xuICAgICAgICB0aGlzLmF0dHJpYnV0ZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBBVFRSSUJVVEVTJDMsIEF0dHJpYnV0ZUNlcnRpZmljYXRlSW5mb1YxLmRlZmF1bHRWYWx1ZXMoQVRUUklCVVRFUyQzKSk7XG4gICAgICAgIGlmIChJU1NVRVJfVU5JUVVFX0lEJDIgaW4gcGFyYW1ldGVycylcbiAgICAgICAgICAgIHRoaXMuaXNzdWVyVW5pcXVlSUQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBJU1NVRVJfVU5JUVVFX0lEJDIsIEF0dHJpYnV0ZUNlcnRpZmljYXRlSW5mb1YxLmRlZmF1bHRWYWx1ZXMoSVNTVUVSX1VOSVFVRV9JRCQyKSk7XG4gICAgICAgIGlmIChFWFRFTlNJT05TJDQgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5leHRlbnNpb25zID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgRVhURU5TSU9OUyQ0LCBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMS5kZWZhdWx0VmFsdWVzKEVYVEVOU0lPTlMkNCkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJGg6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICBjYXNlIEJBU0VfQ0VSVElGSUNBVEVfSUQkMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IElzc3VlclNlcmlhbCgpO1xuICAgICAgICAgICAgY2FzZSBTVUJKRUNUX05BTUU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmFsTmFtZXMoKTtcbiAgICAgICAgICAgIGNhc2UgSVNTVUVSJDQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmFsTmFtZXMoKTtcbiAgICAgICAgICAgIGNhc2UgU0lHTkFUVVJFJDY6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKCk7XG4gICAgICAgICAgICBjYXNlIFNFUklBTF9OVU1CRVIkNTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5JbnRlZ2VyKCk7XG4gICAgICAgICAgICBjYXNlIEFUVFJfQ0VSVF9WQUxJRElUWV9QRVJJT0QkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF0dENlcnRWYWxpZGl0eVBlcmlvZCgpO1xuICAgICAgICAgICAgY2FzZSBBVFRSSUJVVEVTJDM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgY2FzZSBJU1NVRVJfVU5JUVVFX0lEJDI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuQml0U3RyaW5nKCk7XG4gICAgICAgICAgICBjYXNlIEVYVEVOU0lPTlMkNDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEV4dGVuc2lvbnMoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLnZlcnNpb24gfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNob2ljZSh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuYmFzZUNlcnRpZmljYXRlSUQgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBJc3N1ZXJTZXJpYWwuc2NoZW1hKCkudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuc3ViamVjdE5hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBHZW5lcmFsTmFtZXMuc2NoZW1hKCkudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBHZW5lcmFsTmFtZXMuc2NoZW1hKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogKG5hbWVzLmlzc3VlciB8fCBFTVBUWV9TVFJJTkcpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBBbGdvcml0aG1JZGVudGlmaWVyLnNjaGVtYShuYW1lcy5zaWduYXR1cmUgfHwge30pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy5zZXJpYWxOdW1iZXIgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBBdHRDZXJ0VmFsaWRpdHlQZXJpb2Quc2NoZW1hKG5hbWVzLmF0dHJDZXJ0VmFsaWRpdHlQZXJpb2QgfHwge30pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuYXR0cmlidXRlcyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IEF0dHJpYnV0ZS5zY2hlbWEoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQml0U3RyaW5nKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5pc3N1ZXJVbmlxdWVJRCB8fCBFTVBUWV9TVFJJTkcpXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgRXh0ZW5zaW9ucy5zY2hlbWEobmFtZXMuZXh0ZW5zaW9ucyB8fCB7fSwgdHJ1ZSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRaKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMS5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBWRVJTSU9OJGgsXG4gICAgICAgICAgICAgICAgYmFzZUNlcnRpZmljYXRlSUQ6IEJBU0VfQ0VSVElGSUNBVEVfSUQkMixcbiAgICAgICAgICAgICAgICBzdWJqZWN0TmFtZTogU1VCSkVDVF9OQU1FLFxuICAgICAgICAgICAgICAgIGlzc3VlcjogSVNTVUVSJDQsXG4gICAgICAgICAgICAgICAgc2lnbmF0dXJlOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFNJR05BVFVSRSQ2XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHNlcmlhbE51bWJlcjogU0VSSUFMX05VTUJFUiQ1LFxuICAgICAgICAgICAgICAgIGF0dHJDZXJ0VmFsaWRpdHlQZXJpb2Q6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogQVRUUl9DRVJUX1ZBTElESVRZX1BFUklPRCQxXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IEFUVFJJQlVURVMkMyxcbiAgICAgICAgICAgICAgICBpc3N1ZXJVbmlxdWVJRDogSVNTVUVSX1VOSVFVRV9JRCQyLFxuICAgICAgICAgICAgICAgIGV4dGVuc2lvbnM6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogRVhURU5TSU9OUyQ0XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gYXNuMS5yZXN1bHQudmVyc2lvbi52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgICAgICBpZiAoQkFTRV9DRVJUSUZJQ0FURV9JRCQyIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLmJhc2VDZXJ0aWZpY2F0ZUlEID0gbmV3IElzc3VlclNlcmlhbCh7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGFzbjEucmVzdWx0LmJhc2VDZXJ0aWZpY2F0ZUlELnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFNVQkpFQ1RfTkFNRSBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5zdWJqZWN0TmFtZSA9IG5ldyBHZW5lcmFsTmFtZXMoe1xuICAgICAgICAgICAgICAgIHNjaGVtYTogbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBhc24xLnJlc3VsdC5zdWJqZWN0TmFtZS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXNzdWVyID0gYXNuMS5yZXN1bHQuaXNzdWVyO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZSA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5zaWduYXR1cmUgfSk7XG4gICAgICAgIHRoaXMuc2VyaWFsTnVtYmVyID0gYXNuMS5yZXN1bHQuc2VyaWFsTnVtYmVyO1xuICAgICAgICB0aGlzLmF0dHJDZXJ0VmFsaWRpdHlQZXJpb2QgPSBuZXcgQXR0Q2VydFZhbGlkaXR5UGVyaW9kKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5hdHRyQ2VydFZhbGlkaXR5UGVyaW9kIH0pO1xuICAgICAgICB0aGlzLmF0dHJpYnV0ZXMgPSBBcnJheS5mcm9tKGFzbjEucmVzdWx0LmF0dHJpYnV0ZXMudmFsdWVCbG9jay52YWx1ZSwgZWxlbWVudCA9PiBuZXcgQXR0cmlidXRlKHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICAgICAgaWYgKElTU1VFUl9VTklRVUVfSUQkMiBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5pc3N1ZXJVbmlxdWVJRCA9IGFzbjEucmVzdWx0Lmlzc3VlclVuaXF1ZUlEO1xuICAgICAgICB9XG4gICAgICAgIGlmIChFWFRFTlNJT05TJDQgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHRoaXMuZXh0ZW5zaW9ucyA9IG5ldyBFeHRlbnNpb25zKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5leHRlbnNpb25zIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBbbmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWU6IHRoaXMudmVyc2lvbiB9KV1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh0aGlzLmJhc2VDZXJ0aWZpY2F0ZUlEKSB7XG4gICAgICAgICAgICByZXN1bHQudmFsdWVCbG9jay52YWx1ZS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuYmFzZUNlcnRpZmljYXRlSUQudG9TY2hlbWEoKS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuc3ViamVjdE5hbWUpIHtcbiAgICAgICAgICAgIHJlc3VsdC52YWx1ZUJsb2NrLnZhbHVlLnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5zdWJqZWN0TmFtZS50b1NjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXN1bHQudmFsdWVCbG9jay52YWx1ZS5wdXNoKHRoaXMuaXNzdWVyLnRvU2NoZW1hKCkpO1xuICAgICAgICByZXN1bHQudmFsdWVCbG9jay52YWx1ZS5wdXNoKHRoaXMuc2lnbmF0dXJlLnRvU2NoZW1hKCkpO1xuICAgICAgICByZXN1bHQudmFsdWVCbG9jay52YWx1ZS5wdXNoKHRoaXMuc2VyaWFsTnVtYmVyKTtcbiAgICAgICAgcmVzdWx0LnZhbHVlQmxvY2sudmFsdWUucHVzaCh0aGlzLmF0dHJDZXJ0VmFsaWRpdHlQZXJpb2QudG9TY2hlbWEoKSk7XG4gICAgICAgIHJlc3VsdC52YWx1ZUJsb2NrLnZhbHVlLnB1c2gobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLmF0dHJpYnV0ZXMsIG8gPT4gby50b1NjaGVtYSgpKVxuICAgICAgICB9KSk7XG4gICAgICAgIGlmICh0aGlzLmlzc3VlclVuaXF1ZUlEKSB7XG4gICAgICAgICAgICByZXN1bHQudmFsdWVCbG9jay52YWx1ZS5wdXNoKHRoaXMuaXNzdWVyVW5pcXVlSUQpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmV4dGVuc2lvbnMpIHtcbiAgICAgICAgICAgIHJlc3VsdC52YWx1ZUJsb2NrLnZhbHVlLnB1c2godGhpcy5leHRlbnNpb25zLnRvU2NoZW1hKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgdmVyc2lvbjogdGhpcy52ZXJzaW9uXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLmJhc2VDZXJ0aWZpY2F0ZUlEKSB7XG4gICAgICAgICAgICByZXN1bHQuYmFzZUNlcnRpZmljYXRlSUQgPSB0aGlzLmJhc2VDZXJ0aWZpY2F0ZUlELnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnN1YmplY3ROYW1lKSB7XG4gICAgICAgICAgICByZXN1bHQuc3ViamVjdE5hbWUgPSB0aGlzLnN1YmplY3ROYW1lLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdC5pc3N1ZXIgPSB0aGlzLmlzc3Vlci50b0pTT04oKTtcbiAgICAgICAgcmVzdWx0LnNpZ25hdHVyZSA9IHRoaXMuc2lnbmF0dXJlLnRvSlNPTigpO1xuICAgICAgICByZXN1bHQuc2VyaWFsTnVtYmVyID0gdGhpcy5zZXJpYWxOdW1iZXIudG9KU09OKCk7XG4gICAgICAgIHJlc3VsdC5hdHRyQ2VydFZhbGlkaXR5UGVyaW9kID0gdGhpcy5hdHRyQ2VydFZhbGlkaXR5UGVyaW9kLnRvSlNPTigpO1xuICAgICAgICByZXN1bHQuYXR0cmlidXRlcyA9IEFycmF5LmZyb20odGhpcy5hdHRyaWJ1dGVzLCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICBpZiAodGhpcy5pc3N1ZXJVbmlxdWVJRCkge1xuICAgICAgICAgICAgcmVzdWx0Lmlzc3VlclVuaXF1ZUlEID0gdGhpcy5pc3N1ZXJVbmlxdWVJRC50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5leHRlbnNpb25zKSB7XG4gICAgICAgICAgICByZXN1bHQuZXh0ZW5zaW9ucyA9IHRoaXMuZXh0ZW5zaW9ucy50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbn1cbkF0dHJpYnV0ZUNlcnRpZmljYXRlSW5mb1YxLkNMQVNTX05BTUUgPSBcIkF0dHJpYnV0ZUNlcnRpZmljYXRlSW5mb1YxXCI7XG5cbmNvbnN0IEFDSU5GTyQxID0gXCJhY2luZm9cIjtcbmNvbnN0IFNJR05BVFVSRV9BTEdPUklUSE0kNyA9IFwic2lnbmF0dXJlQWxnb3JpdGhtXCI7XG5jb25zdCBTSUdOQVRVUkVfVkFMVUUkNCA9IFwic2lnbmF0dXJlVmFsdWVcIjtcbmNvbnN0IENMRUFSX1BST1BTJFkgPSBbXG4gICAgQUNJTkZPJDEsXG4gICAgU0lHTkFUVVJFX1ZBTFVFJDQsXG4gICAgU0lHTkFUVVJFX0FMR09SSVRITSQ3XG5dO1xuY2xhc3MgQXR0cmlidXRlQ2VydGlmaWNhdGVWMSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuYWNpbmZvID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQUNJTkZPJDEsIEF0dHJpYnV0ZUNlcnRpZmljYXRlVjEuZGVmYXVsdFZhbHVlcyhBQ0lORk8kMSkpO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNJR05BVFVSRV9BTEdPUklUSE0kNywgQXR0cmlidXRlQ2VydGlmaWNhdGVWMS5kZWZhdWx0VmFsdWVzKFNJR05BVFVSRV9BTEdPUklUSE0kNykpO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZVZhbHVlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU0lHTkFUVVJFX1ZBTFVFJDQsIEF0dHJpYnV0ZUNlcnRpZmljYXRlVjEuZGVmYXVsdFZhbHVlcyhTSUdOQVRVUkVfVkFMVUUkNCkpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgQUNJTkZPJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMSgpO1xuICAgICAgICAgICAgY2FzZSBTSUdOQVRVUkVfQUxHT1JJVEhNJDc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKCk7XG4gICAgICAgICAgICBjYXNlIFNJR05BVFVSRV9WQUxVRSQ0OlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkJpdFN0cmluZygpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMS5zY2hlbWEobmFtZXMuYWNpbmZvIHx8IHt9KSxcbiAgICAgICAgICAgICAgICBBbGdvcml0aG1JZGVudGlmaWVyLnNjaGVtYShuYW1lcy5zaWduYXR1cmVBbGdvcml0aG0gfHwge30pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQml0U3RyaW5nKHsgbmFtZTogKG5hbWVzLnNpZ25hdHVyZVZhbHVlIHx8IEVNUFRZX1NUUklORykgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRZKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZVYxLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGFjaW5mbzoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBBQ0lORk8kMVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBzaWduYXR1cmVBbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogU0lHTkFUVVJFX0FMR09SSVRITSQ3XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHNpZ25hdHVyZVZhbHVlOiBTSUdOQVRVUkVfVkFMVUUkNFxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuYWNpbmZvID0gbmV3IEF0dHJpYnV0ZUNlcnRpZmljYXRlSW5mb1YxKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5hY2luZm8gfSk7XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0LnNpZ25hdHVyZUFsZ29yaXRobSB9KTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmVWYWx1ZSA9IGFzbjEucmVzdWx0LnNpZ25hdHVyZVZhbHVlO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgdGhpcy5hY2luZm8udG9TY2hlbWEoKSxcbiAgICAgICAgICAgICAgICB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobS50b1NjaGVtYSgpLFxuICAgICAgICAgICAgICAgIHRoaXMuc2lnbmF0dXJlVmFsdWVcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhY2luZm86IHRoaXMuYWNpbmZvLnRvSlNPTigpLFxuICAgICAgICAgICAgc2lnbmF0dXJlQWxnb3JpdGhtOiB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobS50b0pTT04oKSxcbiAgICAgICAgICAgIHNpZ25hdHVyZVZhbHVlOiB0aGlzLnNpZ25hdHVyZVZhbHVlLnRvSlNPTigpLFxuICAgICAgICB9O1xuICAgIH1cbn1cbkF0dHJpYnV0ZUNlcnRpZmljYXRlVjEuQ0xBU1NfTkFNRSA9IFwiQXR0cmlidXRlQ2VydGlmaWNhdGVWMVwiO1xuXG5jb25zdCBESUdFU1RFRF9PQkpFQ1RfVFlQRSA9IFwiZGlnZXN0ZWRPYmplY3RUeXBlXCI7XG5jb25zdCBPVEhFUl9PQkpFQ1RfVFlQRV9JRCA9IFwib3RoZXJPYmplY3RUeXBlSURcIjtcbmNvbnN0IERJR0VTVF9BTEdPUklUSE0kMiA9IFwiZGlnZXN0QWxnb3JpdGhtXCI7XG5jb25zdCBPQkpFQ1RfRElHRVNUID0gXCJvYmplY3REaWdlc3RcIjtcbmNvbnN0IENMRUFSX1BST1BTJFggPSBbXG4gICAgRElHRVNURURfT0JKRUNUX1RZUEUsXG4gICAgT1RIRVJfT0JKRUNUX1RZUEVfSUQsXG4gICAgRElHRVNUX0FMR09SSVRITSQyLFxuICAgIE9CSkVDVF9ESUdFU1QsXG5dO1xuY2xhc3MgT2JqZWN0RGlnZXN0SW5mbyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuZGlnZXN0ZWRPYmplY3RUeXBlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgRElHRVNURURfT0JKRUNUX1RZUEUsIE9iamVjdERpZ2VzdEluZm8uZGVmYXVsdFZhbHVlcyhESUdFU1RFRF9PQkpFQ1RfVFlQRSkpO1xuICAgICAgICBpZiAoT1RIRVJfT0JKRUNUX1RZUEVfSUQgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5vdGhlck9iamVjdFR5cGVJRCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE9USEVSX09CSkVDVF9UWVBFX0lELCBPYmplY3REaWdlc3RJbmZvLmRlZmF1bHRWYWx1ZXMoT1RIRVJfT0JKRUNUX1RZUEVfSUQpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRpZ2VzdEFsZ29yaXRobSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIERJR0VTVF9BTEdPUklUSE0kMiwgT2JqZWN0RGlnZXN0SW5mby5kZWZhdWx0VmFsdWVzKERJR0VTVF9BTEdPUklUSE0kMikpO1xuICAgICAgICB0aGlzLm9iamVjdERpZ2VzdCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE9CSkVDVF9ESUdFU1QsIE9iamVjdERpZ2VzdEluZm8uZGVmYXVsdFZhbHVlcyhPQkpFQ1RfRElHRVNUKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBESUdFU1RFRF9PQkpFQ1RfVFlQRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5FbnVtZXJhdGVkKCk7XG4gICAgICAgICAgICBjYXNlIE9USEVSX09CSkVDVF9UWVBFX0lEOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgRElHRVNUX0FMR09SSVRITSQyOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcigpO1xuICAgICAgICAgICAgY2FzZSBPQkpFQ1RfRElHRVNUOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkJpdFN0cmluZygpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkVudW1lcmF0ZWQoeyBuYW1lOiAobmFtZXMuZGlnZXN0ZWRPYmplY3RUeXBlIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5vdGhlck9iamVjdFR5cGVJRCB8fCBFTVBUWV9TVFJJTkcpXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMuZGlnZXN0QWxnb3JpdGhtIHx8IHt9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkJpdFN0cmluZyh7IG5hbWU6IChuYW1lcy5vYmplY3REaWdlc3QgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRYKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBPYmplY3REaWdlc3RJbmZvLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGRpZ2VzdGVkT2JqZWN0VHlwZTogRElHRVNURURfT0JKRUNUX1RZUEUsXG4gICAgICAgICAgICAgICAgb3RoZXJPYmplY3RUeXBlSUQ6IE9USEVSX09CSkVDVF9UWVBFX0lELFxuICAgICAgICAgICAgICAgIGRpZ2VzdEFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBESUdFU1RfQUxHT1JJVEhNJDJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgb2JqZWN0RGlnZXN0OiBPQkpFQ1RfRElHRVNUXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5kaWdlc3RlZE9iamVjdFR5cGUgPSBhc24xLnJlc3VsdC5kaWdlc3RlZE9iamVjdFR5cGU7XG4gICAgICAgIGlmIChPVEhFUl9PQkpFQ1RfVFlQRV9JRCBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5vdGhlck9iamVjdFR5cGVJRCA9IGFzbjEucmVzdWx0Lm90aGVyT2JqZWN0VHlwZUlEO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGlnZXN0QWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0LmRpZ2VzdEFsZ29yaXRobSB9KTtcbiAgICAgICAgdGhpcy5vYmplY3REaWdlc3QgPSBhc24xLnJlc3VsdC5vYmplY3REaWdlc3Q7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBbdGhpcy5kaWdlc3RlZE9iamVjdFR5cGVdXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodGhpcy5vdGhlck9iamVjdFR5cGVJRCkge1xuICAgICAgICAgICAgcmVzdWx0LnZhbHVlQmxvY2sudmFsdWUucHVzaCh0aGlzLm90aGVyT2JqZWN0VHlwZUlEKTtcbiAgICAgICAgfVxuICAgICAgICByZXN1bHQudmFsdWVCbG9jay52YWx1ZS5wdXNoKHRoaXMuZGlnZXN0QWxnb3JpdGhtLnRvU2NoZW1hKCkpO1xuICAgICAgICByZXN1bHQudmFsdWVCbG9jay52YWx1ZS5wdXNoKHRoaXMub2JqZWN0RGlnZXN0KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgICAgICBkaWdlc3RlZE9iamVjdFR5cGU6IHRoaXMuZGlnZXN0ZWRPYmplY3RUeXBlLnRvSlNPTigpLFxuICAgICAgICAgICAgZGlnZXN0QWxnb3JpdGhtOiB0aGlzLmRpZ2VzdEFsZ29yaXRobS50b0pTT04oKSxcbiAgICAgICAgICAgIG9iamVjdERpZ2VzdDogdGhpcy5vYmplY3REaWdlc3QudG9KU09OKCksXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLm90aGVyT2JqZWN0VHlwZUlEKSB7XG4gICAgICAgICAgICByZXN1bHQub3RoZXJPYmplY3RUeXBlSUQgPSB0aGlzLm90aGVyT2JqZWN0VHlwZUlELnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxufVxuT2JqZWN0RGlnZXN0SW5mby5DTEFTU19OQU1FID0gXCJPYmplY3REaWdlc3RJbmZvXCI7XG5cbmNvbnN0IElTU1VFUl9OQU1FID0gXCJpc3N1ZXJOYW1lXCI7XG5jb25zdCBCQVNFX0NFUlRJRklDQVRFX0lEJDEgPSBcImJhc2VDZXJ0aWZpY2F0ZUlEXCI7XG5jb25zdCBPQkpFQ1RfRElHRVNUX0lORk8kMSA9IFwib2JqZWN0RGlnZXN0SW5mb1wiO1xuY29uc3QgQ0xFQVJfUFJPUFMkVyA9IFtcbiAgICBJU1NVRVJfTkFNRSxcbiAgICBCQVNFX0NFUlRJRklDQVRFX0lEJDEsXG4gICAgT0JKRUNUX0RJR0VTVF9JTkZPJDFcbl07XG5jbGFzcyBWMkZvcm0gZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICBpZiAoSVNTVUVSX05BTUUgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5pc3N1ZXJOYW1lID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgSVNTVUVSX05BTUUsIFYyRm9ybS5kZWZhdWx0VmFsdWVzKElTU1VFUl9OQU1FKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKEJBU0VfQ0VSVElGSUNBVEVfSUQkMSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLmJhc2VDZXJ0aWZpY2F0ZUlEID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQkFTRV9DRVJUSUZJQ0FURV9JRCQxLCBWMkZvcm0uZGVmYXVsdFZhbHVlcyhCQVNFX0NFUlRJRklDQVRFX0lEJDEpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoT0JKRUNUX0RJR0VTVF9JTkZPJDEgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5vYmplY3REaWdlc3RJbmZvID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgT0JKRUNUX0RJR0VTVF9JTkZPJDEsIFYyRm9ybS5kZWZhdWx0VmFsdWVzKE9CSkVDVF9ESUdFU1RfSU5GTyQxKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIElTU1VFUl9OQU1FOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgR2VuZXJhbE5hbWVzKCk7XG4gICAgICAgICAgICBjYXNlIEJBU0VfQ0VSVElGSUNBVEVfSUQkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IElzc3VlclNlcmlhbCgpO1xuICAgICAgICAgICAgY2FzZSBPQkpFQ1RfRElHRVNUX0lORk8kMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IE9iamVjdERpZ2VzdEluZm8oKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgR2VuZXJhbE5hbWVzLnNjaGVtYSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IG5hbWVzLmlzc3Vlck5hbWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIHRydWUpLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJhc2VDZXJ0aWZpY2F0ZUlEIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBJc3N1ZXJTZXJpYWwuc2NoZW1hKCkudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLm9iamVjdERpZ2VzdEluZm8gfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IE9iamVjdERpZ2VzdEluZm8uc2NoZW1hKCkudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkVyk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgVjJGb3JtLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGlzc3Vlck5hbWU6IElTU1VFUl9OQU1FLFxuICAgICAgICAgICAgICAgIGJhc2VDZXJ0aWZpY2F0ZUlEOiBCQVNFX0NFUlRJRklDQVRFX0lEJDEsXG4gICAgICAgICAgICAgICAgb2JqZWN0RGlnZXN0SW5mbzogT0JKRUNUX0RJR0VTVF9JTkZPJDFcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICBpZiAoSVNTVUVSX05BTUUgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLmlzc3Vlck5hbWUgPSBuZXcgR2VuZXJhbE5hbWVzKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5pc3N1ZXJOYW1lIH0pO1xuICAgICAgICBpZiAoQkFTRV9DRVJUSUZJQ0FURV9JRCQxIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLmJhc2VDZXJ0aWZpY2F0ZUlEID0gbmV3IElzc3VlclNlcmlhbCh7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGFzbjEucmVzdWx0LmJhc2VDZXJ0aWZpY2F0ZUlELnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE9CSkVDVF9ESUdFU1RfSU5GTyQxIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLm9iamVjdERpZ2VzdEluZm8gPSBuZXcgT2JqZWN0RGlnZXN0SW5mbyh7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGFzbjEucmVzdWx0Lm9iamVjdERpZ2VzdEluZm8udmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IGFzbjFqcy5TZXF1ZW5jZSgpO1xuICAgICAgICBpZiAodGhpcy5pc3N1ZXJOYW1lKVxuICAgICAgICAgICAgcmVzdWx0LnZhbHVlQmxvY2sudmFsdWUucHVzaCh0aGlzLmlzc3Vlck5hbWUudG9TY2hlbWEoKSk7XG4gICAgICAgIGlmICh0aGlzLmJhc2VDZXJ0aWZpY2F0ZUlEKSB7XG4gICAgICAgICAgICByZXN1bHQudmFsdWVCbG9jay52YWx1ZS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuYmFzZUNlcnRpZmljYXRlSUQudG9TY2hlbWEoKS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMub2JqZWN0RGlnZXN0SW5mbykge1xuICAgICAgICAgICAgcmVzdWx0LnZhbHVlQmxvY2sudmFsdWUucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLm9iamVjdERpZ2VzdEluZm8udG9TY2hlbWEoKS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICAgICAgaWYgKHRoaXMuaXNzdWVyTmFtZSkge1xuICAgICAgICAgICAgcmVzdWx0Lmlzc3Vlck5hbWUgPSB0aGlzLmlzc3Vlck5hbWUudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYmFzZUNlcnRpZmljYXRlSUQpIHtcbiAgICAgICAgICAgIHJlc3VsdC5iYXNlQ2VydGlmaWNhdGVJRCA9IHRoaXMuYmFzZUNlcnRpZmljYXRlSUQudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMub2JqZWN0RGlnZXN0SW5mbykge1xuICAgICAgICAgICAgcmVzdWx0Lm9iamVjdERpZ2VzdEluZm8gPSB0aGlzLm9iamVjdERpZ2VzdEluZm8udG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG59XG5WMkZvcm0uQ0xBU1NfTkFNRSA9IFwiVjJGb3JtXCI7XG5cbmNvbnN0IEJBU0VfQ0VSVElGSUNBVEVfSUQgPSBcImJhc2VDZXJ0aWZpY2F0ZUlEXCI7XG5jb25zdCBFTlRJVFlfTkFNRSA9IFwiZW50aXR5TmFtZVwiO1xuY29uc3QgT0JKRUNUX0RJR0VTVF9JTkZPID0gXCJvYmplY3REaWdlc3RJbmZvXCI7XG5jb25zdCBDTEVBUl9QUk9QUyRWID0gW1xuICAgIEJBU0VfQ0VSVElGSUNBVEVfSUQsXG4gICAgRU5USVRZX05BTUUsXG4gICAgT0JKRUNUX0RJR0VTVF9JTkZPXG5dO1xuY2xhc3MgSG9sZGVyIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgaWYgKEJBU0VfQ0VSVElGSUNBVEVfSUQgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5iYXNlQ2VydGlmaWNhdGVJRCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEJBU0VfQ0VSVElGSUNBVEVfSUQsIEhvbGRlci5kZWZhdWx0VmFsdWVzKEJBU0VfQ0VSVElGSUNBVEVfSUQpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoRU5USVRZX05BTUUgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5lbnRpdHlOYW1lID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgRU5USVRZX05BTUUsIEhvbGRlci5kZWZhdWx0VmFsdWVzKEVOVElUWV9OQU1FKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE9CSkVDVF9ESUdFU1RfSU5GTyBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLm9iamVjdERpZ2VzdEluZm8gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBPQkpFQ1RfRElHRVNUX0lORk8sIEhvbGRlci5kZWZhdWx0VmFsdWVzKE9CSkVDVF9ESUdFU1RfSU5GTykpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBCQVNFX0NFUlRJRklDQVRFX0lEOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgSXNzdWVyU2VyaWFsKCk7XG4gICAgICAgICAgICBjYXNlIEVOVElUWV9OQU1FOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgR2VuZXJhbE5hbWVzKCk7XG4gICAgICAgICAgICBjYXNlIE9CSkVDVF9ESUdFU1RfSU5GTzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IE9iamVjdERpZ2VzdEluZm8oKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuYmFzZUNlcnRpZmljYXRlSUQgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IElzc3VlclNlcmlhbC5zY2hlbWEoKS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuZW50aXR5TmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogR2VuZXJhbE5hbWVzLnNjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5vYmplY3REaWdlc3RJbmZvIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAyXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBPYmplY3REaWdlc3RJbmZvLnNjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJFYpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIEhvbGRlci5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBiYXNlQ2VydGlmaWNhdGVJRDogQkFTRV9DRVJUSUZJQ0FURV9JRCxcbiAgICAgICAgICAgICAgICBlbnRpdHlOYW1lOiBFTlRJVFlfTkFNRSxcbiAgICAgICAgICAgICAgICBvYmplY3REaWdlc3RJbmZvOiBPQkpFQ1RfRElHRVNUX0lORk9cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICBpZiAoQkFTRV9DRVJUSUZJQ0FURV9JRCBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5iYXNlQ2VydGlmaWNhdGVJRCA9IG5ldyBJc3N1ZXJTZXJpYWwoe1xuICAgICAgICAgICAgICAgIHNjaGVtYTogbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBhc24xLnJlc3VsdC5iYXNlQ2VydGlmaWNhdGVJRC52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChFTlRJVFlfTkFNRSBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5lbnRpdHlOYW1lID0gbmV3IEdlbmVyYWxOYW1lcyh7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGFzbjEucmVzdWx0LmVudGl0eU5hbWUudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoT0JKRUNUX0RJR0VTVF9JTkZPIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLm9iamVjdERpZ2VzdEluZm8gPSBuZXcgT2JqZWN0RGlnZXN0SW5mbyh7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGFzbjEucmVzdWx0Lm9iamVjdERpZ2VzdEluZm8udmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IGFzbjFqcy5TZXF1ZW5jZSgpO1xuICAgICAgICBpZiAodGhpcy5iYXNlQ2VydGlmaWNhdGVJRCkge1xuICAgICAgICAgICAgcmVzdWx0LnZhbHVlQmxvY2sudmFsdWUucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLmJhc2VDZXJ0aWZpY2F0ZUlELnRvU2NoZW1hKCkudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmVudGl0eU5hbWUpIHtcbiAgICAgICAgICAgIHJlc3VsdC52YWx1ZUJsb2NrLnZhbHVlLnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5lbnRpdHlOYW1lLnRvU2NoZW1hKCkudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm9iamVjdERpZ2VzdEluZm8pIHtcbiAgICAgICAgICAgIHJlc3VsdC52YWx1ZUJsb2NrLnZhbHVlLnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAyXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5vYmplY3REaWdlc3RJbmZvLnRvU2NoZW1hKCkudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0ge307XG4gICAgICAgIGlmICh0aGlzLmJhc2VDZXJ0aWZpY2F0ZUlEKSB7XG4gICAgICAgICAgICByZXN1bHQuYmFzZUNlcnRpZmljYXRlSUQgPSB0aGlzLmJhc2VDZXJ0aWZpY2F0ZUlELnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmVudGl0eU5hbWUpIHtcbiAgICAgICAgICAgIHJlc3VsdC5lbnRpdHlOYW1lID0gdGhpcy5lbnRpdHlOYW1lLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm9iamVjdERpZ2VzdEluZm8pIHtcbiAgICAgICAgICAgIHJlc3VsdC5vYmplY3REaWdlc3RJbmZvID0gdGhpcy5vYmplY3REaWdlc3RJbmZvLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxufVxuSG9sZGVyLkNMQVNTX05BTUUgPSBcIkhvbGRlclwiO1xuXG5jb25zdCBWRVJTSU9OJGcgPSBcInZlcnNpb25cIjtcbmNvbnN0IEhPTERFUiA9IFwiaG9sZGVyXCI7XG5jb25zdCBJU1NVRVIkMyA9IFwiaXNzdWVyXCI7XG5jb25zdCBTSUdOQVRVUkUkNSA9IFwic2lnbmF0dXJlXCI7XG5jb25zdCBTRVJJQUxfTlVNQkVSJDQgPSBcInNlcmlhbE51bWJlclwiO1xuY29uc3QgQVRUUl9DRVJUX1ZBTElESVRZX1BFUklPRCA9IFwiYXR0ckNlcnRWYWxpZGl0eVBlcmlvZFwiO1xuY29uc3QgQVRUUklCVVRFUyQyID0gXCJhdHRyaWJ1dGVzXCI7XG5jb25zdCBJU1NVRVJfVU5JUVVFX0lEJDEgPSBcImlzc3VlclVuaXF1ZUlEXCI7XG5jb25zdCBFWFRFTlNJT05TJDMgPSBcImV4dGVuc2lvbnNcIjtcbmNvbnN0IENMRUFSX1BST1BTJFUgPSBbXG4gICAgVkVSU0lPTiRnLFxuICAgIEhPTERFUixcbiAgICBJU1NVRVIkMyxcbiAgICBTSUdOQVRVUkUkNSxcbiAgICBTRVJJQUxfTlVNQkVSJDQsXG4gICAgQVRUUl9DRVJUX1ZBTElESVRZX1BFUklPRCxcbiAgICBBVFRSSUJVVEVTJDIsXG4gICAgSVNTVUVSX1VOSVFVRV9JRCQxLFxuICAgIEVYVEVOU0lPTlMkM1xuXTtcbmNsYXNzIEF0dHJpYnV0ZUNlcnRpZmljYXRlSW5mb1YyIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVkVSU0lPTiRnLCBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMi5kZWZhdWx0VmFsdWVzKFZFUlNJT04kZykpO1xuICAgICAgICB0aGlzLmhvbGRlciA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEhPTERFUiwgQXR0cmlidXRlQ2VydGlmaWNhdGVJbmZvVjIuZGVmYXVsdFZhbHVlcyhIT0xERVIpKTtcbiAgICAgICAgdGhpcy5pc3N1ZXIgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBJU1NVRVIkMywgQXR0cmlidXRlQ2VydGlmaWNhdGVJbmZvVjIuZGVmYXVsdFZhbHVlcyhJU1NVRVIkMykpO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNJR05BVFVSRSQ1LCBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMi5kZWZhdWx0VmFsdWVzKFNJR05BVFVSRSQ1KSk7XG4gICAgICAgIHRoaXMuc2VyaWFsTnVtYmVyID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU0VSSUFMX05VTUJFUiQ0LCBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMi5kZWZhdWx0VmFsdWVzKFNFUklBTF9OVU1CRVIkNCkpO1xuICAgICAgICB0aGlzLmF0dHJDZXJ0VmFsaWRpdHlQZXJpb2QgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBBVFRSX0NFUlRfVkFMSURJVFlfUEVSSU9ELCBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMi5kZWZhdWx0VmFsdWVzKEFUVFJfQ0VSVF9WQUxJRElUWV9QRVJJT0QpKTtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQVRUUklCVVRFUyQyLCBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMi5kZWZhdWx0VmFsdWVzKEFUVFJJQlVURVMkMikpO1xuICAgICAgICBpZiAoSVNTVUVSX1VOSVFVRV9JRCQxIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuaXNzdWVyVW5pcXVlSUQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBJU1NVRVJfVU5JUVVFX0lEJDEsIEF0dHJpYnV0ZUNlcnRpZmljYXRlSW5mb1YyLmRlZmF1bHRWYWx1ZXMoSVNTVUVSX1VOSVFVRV9JRCQxKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKEVYVEVOU0lPTlMkMyBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLmV4dGVuc2lvbnMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBFWFRFTlNJT05TJDMsIEF0dHJpYnV0ZUNlcnRpZmljYXRlSW5mb1YyLmRlZmF1bHRWYWx1ZXMoRVhURU5TSU9OUyQzKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFZFUlNJT04kZzpcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgIGNhc2UgSE9MREVSOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgSG9sZGVyKCk7XG4gICAgICAgICAgICBjYXNlIElTU1VFUiQzOlxuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIGNhc2UgU0lHTkFUVVJFJDU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKCk7XG4gICAgICAgICAgICBjYXNlIFNFUklBTF9OVU1CRVIkNDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5JbnRlZ2VyKCk7XG4gICAgICAgICAgICBjYXNlIEFUVFJfQ0VSVF9WQUxJRElUWV9QRVJJT0Q6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdHRDZXJ0VmFsaWRpdHlQZXJpb2QoKTtcbiAgICAgICAgICAgIGNhc2UgQVRUUklCVVRFUyQyOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGNhc2UgSVNTVUVSX1VOSVFVRV9JRCQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkJpdFN0cmluZygpO1xuICAgICAgICAgICAgY2FzZSBFWFRFTlNJT05TJDM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBFeHRlbnNpb25zKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy52ZXJzaW9uIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgSG9sZGVyLnNjaGVtYShuYW1lcy5ob2xkZXIgfHwge30pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ2hvaWNlKHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIEdlbmVyYWxOYW1lcy5zY2hlbWEoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogKG5hbWVzLmlzc3VlciB8fCBFTVBUWV9TVFJJTkcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuaXNzdWVyIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogVjJGb3JtLnNjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBBbGdvcml0aG1JZGVudGlmaWVyLnNjaGVtYShuYW1lcy5zaWduYXR1cmUgfHwge30pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy5zZXJpYWxOdW1iZXIgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBBdHRDZXJ0VmFsaWRpdHlQZXJpb2Quc2NoZW1hKG5hbWVzLmF0dHJDZXJ0VmFsaWRpdHlQZXJpb2QgfHwge30pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuYXR0cmlidXRlcyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IEF0dHJpYnV0ZS5zY2hlbWEoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQml0U3RyaW5nKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5pc3N1ZXJVbmlxdWVJRCB8fCBFTVBUWV9TVFJJTkcpXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgRXh0ZW5zaW9ucy5zY2hlbWEobmFtZXMuZXh0ZW5zaW9ucyB8fCB7fSwgdHJ1ZSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRVKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMi5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBWRVJTSU9OJGcsXG4gICAgICAgICAgICAgICAgaG9sZGVyOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IEhPTERFUlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBpc3N1ZXI6IElTU1VFUiQzLFxuICAgICAgICAgICAgICAgIHNpZ25hdHVyZToge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBTSUdOQVRVUkUkNVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBzZXJpYWxOdW1iZXI6IFNFUklBTF9OVU1CRVIkNCxcbiAgICAgICAgICAgICAgICBhdHRyQ2VydFZhbGlkaXR5UGVyaW9kOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IEFUVFJfQ0VSVF9WQUxJRElUWV9QRVJJT0RcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlczogQVRUUklCVVRFUyQyLFxuICAgICAgICAgICAgICAgIGlzc3VlclVuaXF1ZUlEOiBJU1NVRVJfVU5JUVVFX0lEJDEsXG4gICAgICAgICAgICAgICAgZXh0ZW5zaW9uczoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBFWFRFTlNJT05TJDNcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLnZlcnNpb24gPSBhc24xLnJlc3VsdC52ZXJzaW9uLnZhbHVlQmxvY2sudmFsdWVEZWM7XG4gICAgICAgIHRoaXMuaG9sZGVyID0gbmV3IEhvbGRlcih7IHNjaGVtYTogYXNuMS5yZXN1bHQuaG9sZGVyIH0pO1xuICAgICAgICBzd2l0Y2ggKGFzbjEucmVzdWx0Lmlzc3Vlci5pZEJsb2NrLnRhZ0NsYXNzKSB7XG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgdGhpcy5pc3N1ZXIgPSBuZXcgVjJGb3JtKHtcbiAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBhc24xLnJlc3VsdC5pc3N1ZXIudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbmNvcnJlY3QgdmFsdWUgZm9yICdpc3N1ZXInIGluIEF0dHJpYnV0ZUNlcnRpZmljYXRlSW5mb1YyXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0LnNpZ25hdHVyZSB9KTtcbiAgICAgICAgdGhpcy5zZXJpYWxOdW1iZXIgPSBhc24xLnJlc3VsdC5zZXJpYWxOdW1iZXI7XG4gICAgICAgIHRoaXMuYXR0ckNlcnRWYWxpZGl0eVBlcmlvZCA9IG5ldyBBdHRDZXJ0VmFsaWRpdHlQZXJpb2QoeyBzY2hlbWE6IGFzbjEucmVzdWx0LmF0dHJDZXJ0VmFsaWRpdHlQZXJpb2QgfSk7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHQuYXR0cmlidXRlcy52YWx1ZUJsb2NrLnZhbHVlLCBlbGVtZW50ID0+IG5ldyBBdHRyaWJ1dGUoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgICAgICBpZiAoSVNTVUVSX1VOSVFVRV9JRCQxIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLmlzc3VlclVuaXF1ZUlEID0gYXNuMS5yZXN1bHQuaXNzdWVyVW5pcXVlSUQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKEVYVEVOU0lPTlMkMyBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5leHRlbnNpb25zID0gbmV3IEV4dGVuc2lvbnMoeyBzY2hlbWE6IGFzbjEucmVzdWx0LmV4dGVuc2lvbnMgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy52ZXJzaW9uIH0pLFxuICAgICAgICAgICAgICAgIHRoaXMuaG9sZGVyLnRvU2NoZW1hKCksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLmlzc3Vlci50b1NjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICB0aGlzLnNpZ25hdHVyZS50b1NjaGVtYSgpLFxuICAgICAgICAgICAgICAgIHRoaXMuc2VyaWFsTnVtYmVyLFxuICAgICAgICAgICAgICAgIHRoaXMuYXR0ckNlcnRWYWxpZGl0eVBlcmlvZC50b1NjaGVtYSgpLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLmF0dHJpYnV0ZXMsIG8gPT4gby50b1NjaGVtYSgpKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodGhpcy5pc3N1ZXJVbmlxdWVJRCkge1xuICAgICAgICAgICAgcmVzdWx0LnZhbHVlQmxvY2sudmFsdWUucHVzaCh0aGlzLmlzc3VlclVuaXF1ZUlEKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5leHRlbnNpb25zKSB7XG4gICAgICAgICAgICByZXN1bHQudmFsdWVCbG9jay52YWx1ZS5wdXNoKHRoaXMuZXh0ZW5zaW9ucy50b1NjaGVtYSgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgICAgIHZlcnNpb246IHRoaXMudmVyc2lvbixcbiAgICAgICAgICAgIGhvbGRlcjogdGhpcy5ob2xkZXIudG9KU09OKCksXG4gICAgICAgICAgICBpc3N1ZXI6IHRoaXMuaXNzdWVyLnRvSlNPTigpLFxuICAgICAgICAgICAgc2lnbmF0dXJlOiB0aGlzLnNpZ25hdHVyZS50b0pTT04oKSxcbiAgICAgICAgICAgIHNlcmlhbE51bWJlcjogdGhpcy5zZXJpYWxOdW1iZXIudG9KU09OKCksXG4gICAgICAgICAgICBhdHRyQ2VydFZhbGlkaXR5UGVyaW9kOiB0aGlzLmF0dHJDZXJ0VmFsaWRpdHlQZXJpb2QudG9KU09OKCksXG4gICAgICAgICAgICBhdHRyaWJ1dGVzOiBBcnJheS5mcm9tKHRoaXMuYXR0cmlidXRlcywgbyA9PiBvLnRvSlNPTigpKVxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5pc3N1ZXJVbmlxdWVJRCkge1xuICAgICAgICAgICAgcmVzdWx0Lmlzc3VlclVuaXF1ZUlEID0gdGhpcy5pc3N1ZXJVbmlxdWVJRC50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5leHRlbnNpb25zKSB7XG4gICAgICAgICAgICByZXN1bHQuZXh0ZW5zaW9ucyA9IHRoaXMuZXh0ZW5zaW9ucy50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbn1cbkF0dHJpYnV0ZUNlcnRpZmljYXRlSW5mb1YyLkNMQVNTX05BTUUgPSBcIkF0dHJpYnV0ZUNlcnRpZmljYXRlSW5mb1YyXCI7XG5cbmNvbnN0IEFDSU5GTyA9IFwiYWNpbmZvXCI7XG5jb25zdCBTSUdOQVRVUkVfQUxHT1JJVEhNJDYgPSBcInNpZ25hdHVyZUFsZ29yaXRobVwiO1xuY29uc3QgU0lHTkFUVVJFX1ZBTFVFJDMgPSBcInNpZ25hdHVyZVZhbHVlXCI7XG5jb25zdCBDTEVBUl9QUk9QUyRUID0gW1xuICAgIEFDSU5GTyxcbiAgICBTSUdOQVRVUkVfQUxHT1JJVEhNJDYsXG4gICAgU0lHTkFUVVJFX1ZBTFVFJDMsXG5dO1xuY2xhc3MgQXR0cmlidXRlQ2VydGlmaWNhdGVWMiBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuYWNpbmZvID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQUNJTkZPLCBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZVYyLmRlZmF1bHRWYWx1ZXMoQUNJTkZPKSk7XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU0lHTkFUVVJFX0FMR09SSVRITSQ2LCBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZVYyLmRlZmF1bHRWYWx1ZXMoU0lHTkFUVVJFX0FMR09SSVRITSQ2KSk7XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlVmFsdWUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTSUdOQVRVUkVfVkFMVUUkMywgQXR0cmlidXRlQ2VydGlmaWNhdGVWMi5kZWZhdWx0VmFsdWVzKFNJR05BVFVSRV9WQUxVRSQzKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBBQ0lORk86XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMigpO1xuICAgICAgICAgICAgY2FzZSBTSUdOQVRVUkVfQUxHT1JJVEhNJDY6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKCk7XG4gICAgICAgICAgICBjYXNlIFNJR05BVFVSRV9WQUxVRSQzOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkJpdFN0cmluZygpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMi5zY2hlbWEobmFtZXMuYWNpbmZvIHx8IHt9KSxcbiAgICAgICAgICAgICAgICBBbGdvcml0aG1JZGVudGlmaWVyLnNjaGVtYShuYW1lcy5zaWduYXR1cmVBbGdvcml0aG0gfHwge30pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQml0U3RyaW5nKHsgbmFtZTogKG5hbWVzLnNpZ25hdHVyZVZhbHVlIHx8IEVNUFRZX1NUUklORykgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRUKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZVYyLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGFjaW5mbzoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBBQ0lORk9cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc2lnbmF0dXJlQWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFNJR05BVFVSRV9BTEdPUklUSE0kNlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBzaWduYXR1cmVWYWx1ZTogU0lHTkFUVVJFX1ZBTFVFJDNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmFjaW5mbyA9IG5ldyBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMih7IHNjaGVtYTogYXNuMS5yZXN1bHQuYWNpbmZvIH0pO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobSA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5zaWduYXR1cmVBbGdvcml0aG0gfSk7XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlVmFsdWUgPSBhc24xLnJlc3VsdC5zaWduYXR1cmVWYWx1ZTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIHRoaXMuYWNpbmZvLnRvU2NoZW1hKCksXG4gICAgICAgICAgICAgICAgdGhpcy5zaWduYXR1cmVBbGdvcml0aG0udG9TY2hlbWEoKSxcbiAgICAgICAgICAgICAgICB0aGlzLnNpZ25hdHVyZVZhbHVlXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYWNpbmZvOiB0aGlzLmFjaW5mby50b0pTT04oKSxcbiAgICAgICAgICAgIHNpZ25hdHVyZUFsZ29yaXRobTogdGhpcy5zaWduYXR1cmVBbGdvcml0aG0udG9KU09OKCksXG4gICAgICAgICAgICBzaWduYXR1cmVWYWx1ZTogdGhpcy5zaWduYXR1cmVWYWx1ZS50b0pTT04oKSxcbiAgICAgICAgfTtcbiAgICB9XG59XG5BdHRyaWJ1dGVDZXJ0aWZpY2F0ZVYyLkNMQVNTX05BTUUgPSBcIkF0dHJpYnV0ZUNlcnRpZmljYXRlVjJcIjtcblxuY29uc3QgQ09OVEVOVF9UWVBFID0gXCJjb250ZW50VHlwZVwiO1xuY29uc3QgQ09OVEVOVCA9IFwiY29udGVudFwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkUyA9IFtDT05URU5UX1RZUEUsIENPTlRFTlRdO1xuY2xhc3MgQ29udGVudEluZm8gZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmNvbnRlbnRUeXBlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQ09OVEVOVF9UWVBFLCBDb250ZW50SW5mby5kZWZhdWx0VmFsdWVzKENPTlRFTlRfVFlQRSkpO1xuICAgICAgICB0aGlzLmNvbnRlbnQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBDT05URU5ULCBDb250ZW50SW5mby5kZWZhdWx0VmFsdWVzKENPTlRFTlQpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIENPTlRFTlRfVFlQRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfU1RSSU5HO1xuICAgICAgICAgICAgY2FzZSBDT05URU5UOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkFueSgpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBDT05URU5UX1RZUEU6XG4gICAgICAgICAgICAgICAgcmV0dXJuICh0eXBlb2YgbWVtYmVyVmFsdWUgPT09IFwic3RyaW5nXCIgJiZcbiAgICAgICAgICAgICAgICAgICAgbWVtYmVyVmFsdWUgPT09IHRoaXMuZGVmYXVsdFZhbHVlcyhDT05URU5UX1RZUEUpKTtcbiAgICAgICAgICAgIGNhc2UgQ09OVEVOVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlIGluc3RhbmNlb2YgYXNuMWpzLkFueSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIGlmICgoXCJvcHRpb25hbFwiIGluIG5hbWVzKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIG5hbWVzLm9wdGlvbmFsID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgXCJDb250ZW50SW5mb1wiKSxcbiAgICAgICAgICAgIG9wdGlvbmFsOiBuYW1lcy5vcHRpb25hbCxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgbmFtZTogKG5hbWVzLmNvbnRlbnRUeXBlIHx8IENPTlRFTlRfVFlQRSkgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbbmV3IGFzbjFqcy5BbnkoeyBuYW1lOiAobmFtZXMuY29udGVudCB8fCBDT05URU5UKSB9KV1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJFMpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIENvbnRlbnRJbmZvLnNjaGVtYSgpKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5jb250ZW50VHlwZSA9IGFzbjEucmVzdWx0LmNvbnRlbnRUeXBlLnZhbHVlQmxvY2sudG9TdHJpbmcoKTtcbiAgICAgICAgdGhpcy5jb250ZW50ID0gYXNuMS5yZXN1bHQuY29udGVudDtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLmNvbnRlbnRUeXBlIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW3RoaXMuY29udGVudF1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3Qgb2JqZWN0ID0ge1xuICAgICAgICAgICAgY29udGVudFR5cGU6IHRoaXMuY29udGVudFR5cGVcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKCEodGhpcy5jb250ZW50IGluc3RhbmNlb2YgYXNuMWpzLkFueSkpIHtcbiAgICAgICAgICAgIG9iamVjdC5jb250ZW50ID0gdGhpcy5jb250ZW50LnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvYmplY3Q7XG4gICAgfVxufVxuQ29udGVudEluZm8uQ0xBU1NfTkFNRSA9IFwiQ29udGVudEluZm9cIjtcbkNvbnRlbnRJbmZvLkRBVEEgPSBpZF9Db250ZW50VHlwZV9EYXRhO1xuQ29udGVudEluZm8uU0lHTkVEX0RBVEEgPSBpZF9Db250ZW50VHlwZV9TaWduZWREYXRhO1xuQ29udGVudEluZm8uRU5WRUxPUEVEX0RBVEEgPSBpZF9Db250ZW50VHlwZV9FbnZlbG9wZWREYXRhO1xuQ29udGVudEluZm8uRU5DUllQVEVEX0RBVEEgPSBpZF9Db250ZW50VHlwZV9FbmNyeXB0ZWREYXRhO1xuXG5jb25zdCBUWVBFJDEgPSBcInR5cGVcIjtcbmNvbnN0IFZBTFVFJDQgPSBcInZhbHVlXCI7XG5jb25zdCBVVENfVElNRV9OQU1FID0gXCJ1dGNUaW1lTmFtZVwiO1xuY29uc3QgR0VORVJBTF9USU1FX05BTUUgPSBcImdlbmVyYWxUaW1lTmFtZVwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkUiA9IFtVVENfVElNRV9OQU1FLCBHRU5FUkFMX1RJTUVfTkFNRV07XG52YXIgVGltZVR5cGU7XG4oZnVuY3Rpb24gKFRpbWVUeXBlKSB7XG4gICAgVGltZVR5cGVbVGltZVR5cGVbXCJVVENUaW1lXCJdID0gMF0gPSBcIlVUQ1RpbWVcIjtcbiAgICBUaW1lVHlwZVtUaW1lVHlwZVtcIkdlbmVyYWxpemVkVGltZVwiXSA9IDFdID0gXCJHZW5lcmFsaXplZFRpbWVcIjtcbiAgICBUaW1lVHlwZVtUaW1lVHlwZVtcImVtcHR5XCJdID0gMl0gPSBcImVtcHR5XCI7XG59KShUaW1lVHlwZSB8fCAoVGltZVR5cGUgPSB7fSkpO1xuY2xhc3MgVGltZSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudHlwZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFRZUEUkMSwgVGltZS5kZWZhdWx0VmFsdWVzKFRZUEUkMSkpO1xuICAgICAgICB0aGlzLnZhbHVlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVkFMVUUkNCwgVGltZS5kZWZhdWx0VmFsdWVzKFZBTFVFJDQpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFRZUEUkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGNhc2UgVkFMVUUkNDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoMCwgMCwgMCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9LCBvcHRpb25hbCA9IGZhbHNlKSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5DaG9pY2Uoe1xuICAgICAgICAgICAgb3B0aW9uYWwsXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuVVRDVGltZSh7IG5hbWU6IChuYW1lcy51dGNUaW1lTmFtZSB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuR2VuZXJhbGl6ZWRUaW1lKHsgbmFtZTogKG5hbWVzLmdlbmVyYWxUaW1lTmFtZSB8fCBFTVBUWV9TVFJJTkcpIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkUik7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgVGltZS5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICB1dGNUaW1lTmFtZTogVVRDX1RJTUVfTkFNRSxcbiAgICAgICAgICAgICAgICBnZW5lcmFsVGltZU5hbWU6IEdFTkVSQUxfVElNRV9OQU1FXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgaWYgKFVUQ19USU1FX05BTUUgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHRoaXMudHlwZSA9IDA7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gYXNuMS5yZXN1bHQudXRjVGltZU5hbWUudG9EYXRlKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKEdFTkVSQUxfVElNRV9OQU1FIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLnR5cGUgPSAxO1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IGFzbjEucmVzdWx0LmdlbmVyYWxUaW1lTmFtZS50b0RhdGUoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgaWYgKHRoaXMudHlwZSA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuVVRDVGltZSh7IHZhbHVlRGF0ZTogdGhpcy52YWx1ZSB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLnR5cGUgPT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkdlbmVyYWxpemVkVGltZSh7IHZhbHVlRGF0ZTogdGhpcy52YWx1ZSB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge307XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6IHRoaXMudHlwZSxcbiAgICAgICAgICAgIHZhbHVlOiB0aGlzLnZhbHVlXG4gICAgICAgIH07XG4gICAgfVxufVxuVGltZS5DTEFTU19OQU1FID0gXCJUaW1lXCI7XG5cbmNvbnN0IFRCUyQ0ID0gXCJ0YnNcIjtcbmNvbnN0IFZFUlNJT04kZiA9IFwidmVyc2lvblwiO1xuY29uc3QgU0VSSUFMX05VTUJFUiQzID0gXCJzZXJpYWxOdW1iZXJcIjtcbmNvbnN0IFNJR05BVFVSRSQ0ID0gXCJzaWduYXR1cmVcIjtcbmNvbnN0IElTU1VFUiQyID0gXCJpc3N1ZXJcIjtcbmNvbnN0IE5PVF9CRUZPUkUgPSBcIm5vdEJlZm9yZVwiO1xuY29uc3QgTk9UX0FGVEVSID0gXCJub3RBZnRlclwiO1xuY29uc3QgU1VCSkVDVCQxID0gXCJzdWJqZWN0XCI7XG5jb25zdCBTVUJKRUNUX1BVQkxJQ19LRVlfSU5GTyA9IFwic3ViamVjdFB1YmxpY0tleUluZm9cIjtcbmNvbnN0IElTU1VFUl9VTklRVUVfSUQgPSBcImlzc3VlclVuaXF1ZUlEXCI7XG5jb25zdCBTVUJKRUNUX1VOSVFVRV9JRCA9IFwic3ViamVjdFVuaXF1ZUlEXCI7XG5jb25zdCBFWFRFTlNJT05TJDIgPSBcImV4dGVuc2lvbnNcIjtcbmNvbnN0IFNJR05BVFVSRV9BTEdPUklUSE0kNSA9IFwic2lnbmF0dXJlQWxnb3JpdGhtXCI7XG5jb25zdCBTSUdOQVRVUkVfVkFMVUUkMiA9IFwic2lnbmF0dXJlVmFsdWVcIjtcbmNvbnN0IFRCU19DRVJUSUZJQ0FURSA9IFwidGJzQ2VydGlmaWNhdGVcIjtcbmNvbnN0IFRCU19DRVJUSUZJQ0FURV9WRVJTSU9OID0gYCR7VEJTX0NFUlRJRklDQVRFfS4ke1ZFUlNJT04kZn1gO1xuY29uc3QgVEJTX0NFUlRJRklDQVRFX1NFUklBTF9OVU1CRVIgPSBgJHtUQlNfQ0VSVElGSUNBVEV9LiR7U0VSSUFMX05VTUJFUiQzfWA7XG5jb25zdCBUQlNfQ0VSVElGSUNBVEVfU0lHTkFUVVJFID0gYCR7VEJTX0NFUlRJRklDQVRFfS4ke1NJR05BVFVSRSQ0fWA7XG5jb25zdCBUQlNfQ0VSVElGSUNBVEVfSVNTVUVSID0gYCR7VEJTX0NFUlRJRklDQVRFfS4ke0lTU1VFUiQyfWA7XG5jb25zdCBUQlNfQ0VSVElGSUNBVEVfTk9UX0JFRk9SRSA9IGAke1RCU19DRVJUSUZJQ0FURX0uJHtOT1RfQkVGT1JFfWA7XG5jb25zdCBUQlNfQ0VSVElGSUNBVEVfTk9UX0FGVEVSID0gYCR7VEJTX0NFUlRJRklDQVRFfS4ke05PVF9BRlRFUn1gO1xuY29uc3QgVEJTX0NFUlRJRklDQVRFX1NVQkpFQ1QgPSBgJHtUQlNfQ0VSVElGSUNBVEV9LiR7U1VCSkVDVCQxfWA7XG5jb25zdCBUQlNfQ0VSVElGSUNBVEVfU1VCSkVDVF9QVUJMSUNfS0VZID0gYCR7VEJTX0NFUlRJRklDQVRFfS4ke1NVQkpFQ1RfUFVCTElDX0tFWV9JTkZPfWA7XG5jb25zdCBUQlNfQ0VSVElGSUNBVEVfSVNTVUVSX1VOSVFVRV9JRCA9IGAke1RCU19DRVJUSUZJQ0FURX0uJHtJU1NVRVJfVU5JUVVFX0lEfWA7XG5jb25zdCBUQlNfQ0VSVElGSUNBVEVfU1VCSkVDVF9VTklRVUVfSUQgPSBgJHtUQlNfQ0VSVElGSUNBVEV9LiR7U1VCSkVDVF9VTklRVUVfSUR9YDtcbmNvbnN0IFRCU19DRVJUSUZJQ0FURV9FWFRFTlNJT05TID0gYCR7VEJTX0NFUlRJRklDQVRFfS4ke0VYVEVOU0lPTlMkMn1gO1xuY29uc3QgQ0xFQVJfUFJPUFMkUSA9IFtcbiAgICBUQlNfQ0VSVElGSUNBVEUsXG4gICAgVEJTX0NFUlRJRklDQVRFX1ZFUlNJT04sXG4gICAgVEJTX0NFUlRJRklDQVRFX1NFUklBTF9OVU1CRVIsXG4gICAgVEJTX0NFUlRJRklDQVRFX1NJR05BVFVSRSxcbiAgICBUQlNfQ0VSVElGSUNBVEVfSVNTVUVSLFxuICAgIFRCU19DRVJUSUZJQ0FURV9OT1RfQkVGT1JFLFxuICAgIFRCU19DRVJUSUZJQ0FURV9OT1RfQUZURVIsXG4gICAgVEJTX0NFUlRJRklDQVRFX1NVQkpFQ1QsXG4gICAgVEJTX0NFUlRJRklDQVRFX1NVQkpFQ1RfUFVCTElDX0tFWSxcbiAgICBUQlNfQ0VSVElGSUNBVEVfSVNTVUVSX1VOSVFVRV9JRCxcbiAgICBUQlNfQ0VSVElGSUNBVEVfU1VCSkVDVF9VTklRVUVfSUQsXG4gICAgVEJTX0NFUlRJRklDQVRFX0VYVEVOU0lPTlMsXG4gICAgU0lHTkFUVVJFX0FMR09SSVRITSQ1LFxuICAgIFNJR05BVFVSRV9WQUxVRSQyXG5dO1xuZnVuY3Rpb24gdGJzQ2VydGlmaWNhdGUocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IFRCU19DRVJUSUZJQ0FURSksXG4gICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy50YnNDZXJ0aWZpY2F0ZVZlcnNpb24gfHwgVEJTX0NFUlRJRklDQVRFX1ZFUlNJT04pIH0pXG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMudGJzQ2VydGlmaWNhdGVTZXJpYWxOdW1iZXIgfHwgVEJTX0NFUlRJRklDQVRFX1NFUklBTF9OVU1CRVIpIH0pLFxuICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMuc2lnbmF0dXJlIHx8IHtcbiAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFRCU19DRVJUSUZJQ0FURV9TSUdOQVRVUkVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIFJlbGF0aXZlRGlzdGluZ3Vpc2hlZE5hbWVzLnNjaGVtYShuYW1lcy5pc3N1ZXIgfHwge1xuICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogVEJTX0NFUlRJRklDQVRFX0lTU1VFUlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnRic0NlcnRpZmljYXRlVmFsaWRpdHkgfHwgXCJ0YnNDZXJ0aWZpY2F0ZS52YWxpZGl0eVwiKSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICBUaW1lLnNjaGVtYShuYW1lcy5ub3RCZWZvcmUgfHwge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGNUaW1lTmFtZTogVEJTX0NFUlRJRklDQVRFX05PVF9CRUZPUkUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2VuZXJhbFRpbWVOYW1lOiBUQlNfQ0VSVElGSUNBVEVfTk9UX0JFRk9SRVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgVGltZS5zY2hlbWEobmFtZXMubm90QWZ0ZXIgfHwge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGNUaW1lTmFtZTogVEJTX0NFUlRJRklDQVRFX05PVF9BRlRFUixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZW5lcmFsVGltZU5hbWU6IFRCU19DRVJUSUZJQ0FURV9OT1RfQUZURVJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIFJlbGF0aXZlRGlzdGluZ3Vpc2hlZE5hbWVzLnNjaGVtYShuYW1lcy5zdWJqZWN0IHx8IHtcbiAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFRCU19DRVJUSUZJQ0FURV9TVUJKRUNUXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBQdWJsaWNLZXlJbmZvLnNjaGVtYShuYW1lcy5zdWJqZWN0UHVibGljS2V5SW5mbyB8fCB7XG4gICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBUQlNfQ0VSVElGSUNBVEVfU1VCSkVDVF9QVUJMSUNfS0VZXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnRic0NlcnRpZmljYXRlSXNzdWVyVW5pcXVlSUQgfHwgVEJTX0NFUlRJRklDQVRFX0lTU1VFUl9VTklRVUVfSUQpLFxuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy50YnNDZXJ0aWZpY2F0ZVN1YmplY3RVbmlxdWVJRCB8fCBUQlNfQ0VSVElGSUNBVEVfU1VCSkVDVF9VTklRVUVfSUQpLFxuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAzXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW0V4dGVuc2lvbnMuc2NoZW1hKG5hbWVzLmV4dGVuc2lvbnMgfHwge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFRCU19DRVJUSUZJQ0FURV9FWFRFTlNJT05TXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXVxuICAgICAgICAgICAgfSlcbiAgICAgICAgXVxuICAgIH0pKTtcbn1cbmNsYXNzIENlcnRpZmljYXRlIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBnZXQgdGJzKCkge1xuICAgICAgICByZXR1cm4gcHZ0c3V0aWxzLkJ1ZmZlclNvdXJjZUNvbnZlcnRlci50b0FycmF5QnVmZmVyKHRoaXMudGJzVmlldyk7XG4gICAgfVxuICAgIHNldCB0YnModmFsdWUpIHtcbiAgICAgICAgdGhpcy50YnNWaWV3ID0gbmV3IFVpbnQ4QXJyYXkodmFsdWUpO1xuICAgIH1cbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy50YnNWaWV3ID0gbmV3IFVpbnQ4QXJyYXkocHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVEJTJDQsIENlcnRpZmljYXRlLmRlZmF1bHRWYWx1ZXMoVEJTJDQpKSk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZFUlNJT04kZiwgQ2VydGlmaWNhdGUuZGVmYXVsdFZhbHVlcyhWRVJTSU9OJGYpKTtcbiAgICAgICAgdGhpcy5zZXJpYWxOdW1iZXIgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTRVJJQUxfTlVNQkVSJDMsIENlcnRpZmljYXRlLmRlZmF1bHRWYWx1ZXMoU0VSSUFMX05VTUJFUiQzKSk7XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU0lHTkFUVVJFJDQsIENlcnRpZmljYXRlLmRlZmF1bHRWYWx1ZXMoU0lHTkFUVVJFJDQpKTtcbiAgICAgICAgdGhpcy5pc3N1ZXIgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBJU1NVRVIkMiwgQ2VydGlmaWNhdGUuZGVmYXVsdFZhbHVlcyhJU1NVRVIkMikpO1xuICAgICAgICB0aGlzLm5vdEJlZm9yZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE5PVF9CRUZPUkUsIENlcnRpZmljYXRlLmRlZmF1bHRWYWx1ZXMoTk9UX0JFRk9SRSkpO1xuICAgICAgICB0aGlzLm5vdEFmdGVyID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgTk9UX0FGVEVSLCBDZXJ0aWZpY2F0ZS5kZWZhdWx0VmFsdWVzKE5PVF9BRlRFUikpO1xuICAgICAgICB0aGlzLnN1YmplY3QgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTVUJKRUNUJDEsIENlcnRpZmljYXRlLmRlZmF1bHRWYWx1ZXMoU1VCSkVDVCQxKSk7XG4gICAgICAgIHRoaXMuc3ViamVjdFB1YmxpY0tleUluZm8gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTVUJKRUNUX1BVQkxJQ19LRVlfSU5GTywgQ2VydGlmaWNhdGUuZGVmYXVsdFZhbHVlcyhTVUJKRUNUX1BVQkxJQ19LRVlfSU5GTykpO1xuICAgICAgICBpZiAoSVNTVUVSX1VOSVFVRV9JRCBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLmlzc3VlclVuaXF1ZUlEID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgSVNTVUVSX1VOSVFVRV9JRCwgQ2VydGlmaWNhdGUuZGVmYXVsdFZhbHVlcyhJU1NVRVJfVU5JUVVFX0lEKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFNVQkpFQ1RfVU5JUVVFX0lEIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuc3ViamVjdFVuaXF1ZUlEID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU1VCSkVDVF9VTklRVUVfSUQsIENlcnRpZmljYXRlLmRlZmF1bHRWYWx1ZXMoU1VCSkVDVF9VTklRVUVfSUQpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoRVhURU5TSU9OUyQyIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuZXh0ZW5zaW9ucyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEVYVEVOU0lPTlMkMiwgQ2VydGlmaWNhdGUuZGVmYXVsdFZhbHVlcyhFWFRFTlNJT05TJDIpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNJR05BVFVSRV9BTEdPUklUSE0kNSwgQ2VydGlmaWNhdGUuZGVmYXVsdFZhbHVlcyhTSUdOQVRVUkVfQUxHT1JJVEhNJDUpKTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmVWYWx1ZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNJR05BVFVSRV9WQUxVRSQyLCBDZXJ0aWZpY2F0ZS5kZWZhdWx0VmFsdWVzKFNJR05BVFVSRV9WQUxVRSQyKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBUQlMkNDpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfQlVGRkVSO1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJGY6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICBjYXNlIFNFUklBTF9OVU1CRVIkMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5JbnRlZ2VyKCk7XG4gICAgICAgICAgICBjYXNlIFNJR05BVFVSRSQ0OlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcigpO1xuICAgICAgICAgICAgY2FzZSBJU1NVRVIkMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFJlbGF0aXZlRGlzdGluZ3Vpc2hlZE5hbWVzKCk7XG4gICAgICAgICAgICBjYXNlIE5PVF9CRUZPUkU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBUaW1lKCk7XG4gICAgICAgICAgICBjYXNlIE5PVF9BRlRFUjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFRpbWUoKTtcbiAgICAgICAgICAgIGNhc2UgU1VCSkVDVCQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZXMoKTtcbiAgICAgICAgICAgIGNhc2UgU1VCSkVDVF9QVUJMSUNfS0VZX0lORk86XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQdWJsaWNLZXlJbmZvKCk7XG4gICAgICAgICAgICBjYXNlIElTU1VFUl9VTklRVUVfSUQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX0JVRkZFUjtcbiAgICAgICAgICAgIGNhc2UgU1VCSkVDVF9VTklRVUVfSUQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX0JVRkZFUjtcbiAgICAgICAgICAgIGNhc2UgRVhURU5TSU9OUyQyOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGNhc2UgU0lHTkFUVVJFX0FMR09SSVRITSQ1OlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcigpO1xuICAgICAgICAgICAgY2FzZSBTSUdOQVRVUkVfVkFMVUUkMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5CaXRTdHJpbmcoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgdGJzQ2VydGlmaWNhdGUobmFtZXMudGJzQ2VydGlmaWNhdGUpLFxuICAgICAgICAgICAgICAgIEFsZ29yaXRobUlkZW50aWZpZXIuc2NoZW1hKG5hbWVzLnNpZ25hdHVyZUFsZ29yaXRobSB8fCB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFNJR05BVFVSRV9BTEdPUklUSE0kNVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5CaXRTdHJpbmcoeyBuYW1lOiAobmFtZXMuc2lnbmF0dXJlVmFsdWUgfHwgU0lHTkFUVVJFX1ZBTFVFJDIpIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkUSk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgQ2VydGlmaWNhdGUuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgdGJzQ2VydGlmaWNhdGU6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4dGVuc2lvbnM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHRlbnNpb25zOiBUQlNfQ0VSVElGSUNBVEVfRVhURU5TSU9OU1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLnRic1ZpZXcgPSBhc24xLnJlc3VsdC50YnNDZXJ0aWZpY2F0ZS52YWx1ZUJlZm9yZURlY29kZVZpZXc7XG4gICAgICAgIGlmIChUQlNfQ0VSVElGSUNBVEVfVkVSU0lPTiBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMudmVyc2lvbiA9IGFzbjEucmVzdWx0W1RCU19DRVJUSUZJQ0FURV9WRVJTSU9OXS52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgICAgICB0aGlzLnNlcmlhbE51bWJlciA9IGFzbjEucmVzdWx0W1RCU19DRVJUSUZJQ0FURV9TRVJJQUxfTlVNQkVSXTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmUgPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHRbVEJTX0NFUlRJRklDQVRFX1NJR05BVFVSRV0gfSk7XG4gICAgICAgIHRoaXMuaXNzdWVyID0gbmV3IFJlbGF0aXZlRGlzdGluZ3Vpc2hlZE5hbWVzKHsgc2NoZW1hOiBhc24xLnJlc3VsdFtUQlNfQ0VSVElGSUNBVEVfSVNTVUVSXSB9KTtcbiAgICAgICAgdGhpcy5ub3RCZWZvcmUgPSBuZXcgVGltZSh7IHNjaGVtYTogYXNuMS5yZXN1bHRbVEJTX0NFUlRJRklDQVRFX05PVF9CRUZPUkVdIH0pO1xuICAgICAgICB0aGlzLm5vdEFmdGVyID0gbmV3IFRpbWUoeyBzY2hlbWE6IGFzbjEucmVzdWx0W1RCU19DRVJUSUZJQ0FURV9OT1RfQUZURVJdIH0pO1xuICAgICAgICB0aGlzLnN1YmplY3QgPSBuZXcgUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZXMoeyBzY2hlbWE6IGFzbjEucmVzdWx0W1RCU19DRVJUSUZJQ0FURV9TVUJKRUNUXSB9KTtcbiAgICAgICAgdGhpcy5zdWJqZWN0UHVibGljS2V5SW5mbyA9IG5ldyBQdWJsaWNLZXlJbmZvKHsgc2NoZW1hOiBhc24xLnJlc3VsdFtUQlNfQ0VSVElGSUNBVEVfU1VCSkVDVF9QVUJMSUNfS0VZXSB9KTtcbiAgICAgICAgaWYgKFRCU19DRVJUSUZJQ0FURV9JU1NVRVJfVU5JUVVFX0lEIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5pc3N1ZXJVbmlxdWVJRCA9IGFzbjEucmVzdWx0W1RCU19DRVJUSUZJQ0FURV9JU1NVRVJfVU5JUVVFX0lEXS52YWx1ZUJsb2NrLnZhbHVlSGV4O1xuICAgICAgICBpZiAoVEJTX0NFUlRJRklDQVRFX1NVQkpFQ1RfVU5JUVVFX0lEIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5zdWJqZWN0VW5pcXVlSUQgPSBhc24xLnJlc3VsdFtUQlNfQ0VSVElGSUNBVEVfU1VCSkVDVF9VTklRVUVfSURdLnZhbHVlQmxvY2sudmFsdWVIZXg7XG4gICAgICAgIGlmIChUQlNfQ0VSVElGSUNBVEVfRVhURU5TSU9OUyBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMuZXh0ZW5zaW9ucyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHRbVEJTX0NFUlRJRklDQVRFX0VYVEVOU0lPTlNdLCBlbGVtZW50ID0+IG5ldyBFeHRlbnNpb24oeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobSA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5zaWduYXR1cmVBbGdvcml0aG0gfSk7XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlVmFsdWUgPSBhc24xLnJlc3VsdC5zaWduYXR1cmVWYWx1ZTtcbiAgICB9XG4gICAgZW5jb2RlVEJTKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBpZiAoKFZFUlNJT04kZiBpbiB0aGlzKSAmJiAodGhpcy52ZXJzaW9uICE9PSBDZXJ0aWZpY2F0ZS5kZWZhdWx0VmFsdWVzKFZFUlNJT04kZikpKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWU6IHRoaXMudmVyc2lvbiB9KVxuICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMuc2VyaWFsTnVtYmVyKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnNpZ25hdHVyZS50b1NjaGVtYSgpKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLmlzc3Vlci50b1NjaGVtYSgpKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgdGhpcy5ub3RCZWZvcmUudG9TY2hlbWEoKSxcbiAgICAgICAgICAgICAgICB0aGlzLm5vdEFmdGVyLnRvU2NoZW1hKClcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMuc3ViamVjdC50b1NjaGVtYSgpKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnN1YmplY3RQdWJsaWNLZXlJbmZvLnRvU2NoZW1hKCkpO1xuICAgICAgICBpZiAodGhpcy5pc3N1ZXJVbmlxdWVJRCkge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZUhleDogdGhpcy5pc3N1ZXJVbmlxdWVJRFxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnN1YmplY3RVbmlxdWVJRCkge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAyXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZUhleDogdGhpcy5zdWJqZWN0VW5pcXVlSURcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5leHRlbnNpb25zKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogM1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFtuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMuZXh0ZW5zaW9ucywgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgICAgICAgICAgICAgIH0pXVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b1NjaGVtYShlbmNvZGVGbGFnID0gZmFsc2UpIHtcbiAgICAgICAgbGV0IHRic1NjaGVtYTtcbiAgICAgICAgaWYgKGVuY29kZUZsYWcgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMudGJzVmlldy5ieXRlTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIENlcnRpZmljYXRlLnNjaGVtYSgpLnZhbHVlWzBdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5mcm9tQkVSKHRoaXMudGJzVmlldyk7XG4gICAgICAgICAgICBBc25FcnJvci5hc3NlcnQoYXNuMSwgXCJUQlMgQ2VydGlmaWNhdGVcIik7XG4gICAgICAgICAgICB0YnNTY2hlbWEgPSBhc24xLnJlc3VsdDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRic1NjaGVtYSA9IHRoaXMuZW5jb2RlVEJTKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgdGJzU2NoZW1hLFxuICAgICAgICAgICAgICAgIHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtLnRvU2NoZW1hKCksXG4gICAgICAgICAgICAgICAgdGhpcy5zaWduYXR1cmVWYWx1ZVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgICAgdGJzOiBwdnRzdXRpbHMuQ29udmVydC5Ub0hleCh0aGlzLnRic1ZpZXcpLFxuICAgICAgICAgICAgdmVyc2lvbjogdGhpcy52ZXJzaW9uLFxuICAgICAgICAgICAgc2VyaWFsTnVtYmVyOiB0aGlzLnNlcmlhbE51bWJlci50b0pTT04oKSxcbiAgICAgICAgICAgIHNpZ25hdHVyZTogdGhpcy5zaWduYXR1cmUudG9KU09OKCksXG4gICAgICAgICAgICBpc3N1ZXI6IHRoaXMuaXNzdWVyLnRvSlNPTigpLFxuICAgICAgICAgICAgbm90QmVmb3JlOiB0aGlzLm5vdEJlZm9yZS50b0pTT04oKSxcbiAgICAgICAgICAgIG5vdEFmdGVyOiB0aGlzLm5vdEFmdGVyLnRvSlNPTigpLFxuICAgICAgICAgICAgc3ViamVjdDogdGhpcy5zdWJqZWN0LnRvSlNPTigpLFxuICAgICAgICAgICAgc3ViamVjdFB1YmxpY0tleUluZm86IHRoaXMuc3ViamVjdFB1YmxpY0tleUluZm8udG9KU09OKCksXG4gICAgICAgICAgICBzaWduYXR1cmVBbGdvcml0aG06IHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtLnRvSlNPTigpLFxuICAgICAgICAgICAgc2lnbmF0dXJlVmFsdWU6IHRoaXMuc2lnbmF0dXJlVmFsdWUudG9KU09OKCksXG4gICAgICAgIH07XG4gICAgICAgIGlmICgoVkVSU0lPTiRmIGluIHRoaXMpICYmICh0aGlzLnZlcnNpb24gIT09IENlcnRpZmljYXRlLmRlZmF1bHRWYWx1ZXMoVkVSU0lPTiRmKSkpIHtcbiAgICAgICAgICAgIHJlcy52ZXJzaW9uID0gdGhpcy52ZXJzaW9uO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmlzc3VlclVuaXF1ZUlEKSB7XG4gICAgICAgICAgICByZXMuaXNzdWVyVW5pcXVlSUQgPSBwdnRzdXRpbHMuQ29udmVydC5Ub0hleCh0aGlzLmlzc3VlclVuaXF1ZUlEKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zdWJqZWN0VW5pcXVlSUQpIHtcbiAgICAgICAgICAgIHJlcy5zdWJqZWN0VW5pcXVlSUQgPSBwdnRzdXRpbHMuQ29udmVydC5Ub0hleCh0aGlzLnN1YmplY3RVbmlxdWVJRCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZXh0ZW5zaW9ucykge1xuICAgICAgICAgICAgcmVzLmV4dGVuc2lvbnMgPSBBcnJheS5mcm9tKHRoaXMuZXh0ZW5zaW9ucywgbyA9PiBvLnRvSlNPTigpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbiAgICBhc3luYyBnZXRQdWJsaWNLZXkocGFyYW1ldGVycywgY3J5cHRvID0gZ2V0Q3J5cHRvKHRydWUpKSB7XG4gICAgICAgIHJldHVybiBjcnlwdG8uZ2V0UHVibGljS2V5KHRoaXMuc3ViamVjdFB1YmxpY0tleUluZm8sIHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtLCBwYXJhbWV0ZXJzKTtcbiAgICB9XG4gICAgYXN5bmMgZ2V0S2V5SGFzaChoYXNoQWxnb3JpdGhtID0gXCJTSEEtMVwiLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgcmV0dXJuIGNyeXB0by5kaWdlc3QoeyBuYW1lOiBoYXNoQWxnb3JpdGhtIH0sIHRoaXMuc3ViamVjdFB1YmxpY0tleUluZm8uc3ViamVjdFB1YmxpY0tleS52YWx1ZUJsb2NrLnZhbHVlSGV4Vmlldyk7XG4gICAgfVxuICAgIGFzeW5jIHNpZ24ocHJpdmF0ZUtleSwgaGFzaEFsZ29yaXRobSA9IFwiU0hBLTFcIiwgY3J5cHRvID0gZ2V0Q3J5cHRvKHRydWUpKSB7XG4gICAgICAgIGlmICghcHJpdmF0ZUtleSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTmVlZCB0byBwcm92aWRlIGEgcHJpdmF0ZSBrZXkgZm9yIHNpZ25pbmdcIik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc2lnbmF0dXJlUGFyYW1ldGVycyA9IGF3YWl0IGNyeXB0by5nZXRTaWduYXR1cmVQYXJhbWV0ZXJzKHByaXZhdGVLZXksIGhhc2hBbGdvcml0aG0pO1xuICAgICAgICBjb25zdCBwYXJhbWV0ZXJzID0gc2lnbmF0dXJlUGFyYW1ldGVycy5wYXJhbWV0ZXJzO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZSA9IHNpZ25hdHVyZVBhcmFtZXRlcnMuc2lnbmF0dXJlQWxnb3JpdGhtO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobSA9IHNpZ25hdHVyZVBhcmFtZXRlcnMuc2lnbmF0dXJlQWxnb3JpdGhtO1xuICAgICAgICB0aGlzLnRic1ZpZXcgPSBuZXcgVWludDhBcnJheSh0aGlzLmVuY29kZVRCUygpLnRvQkVSKCkpO1xuICAgICAgICBjb25zdCBzaWduYXR1cmUgPSBhd2FpdCBjcnlwdG8uc2lnbldpdGhQcml2YXRlS2V5KHRoaXMudGJzVmlldywgcHJpdmF0ZUtleSwgcGFyYW1ldGVycyk7XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlVmFsdWUgPSBuZXcgYXNuMWpzLkJpdFN0cmluZyh7IHZhbHVlSGV4OiBzaWduYXR1cmUgfSk7XG4gICAgfVxuICAgIGFzeW5jIHZlcmlmeShpc3N1ZXJDZXJ0aWZpY2F0ZSwgY3J5cHRvID0gZ2V0Q3J5cHRvKHRydWUpKSB7XG4gICAgICAgIGxldCBzdWJqZWN0UHVibGljS2V5SW5mbztcbiAgICAgICAgaWYgKGlzc3VlckNlcnRpZmljYXRlKSB7XG4gICAgICAgICAgICBzdWJqZWN0UHVibGljS2V5SW5mbyA9IGlzc3VlckNlcnRpZmljYXRlLnN1YmplY3RQdWJsaWNLZXlJbmZvO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuaXNzdWVyLmlzRXF1YWwodGhpcy5zdWJqZWN0KSkge1xuICAgICAgICAgICAgc3ViamVjdFB1YmxpY0tleUluZm8gPSB0aGlzLnN1YmplY3RQdWJsaWNLZXlJbmZvO1xuICAgICAgICB9XG4gICAgICAgIGlmICghKHN1YmplY3RQdWJsaWNLZXlJbmZvIGluc3RhbmNlb2YgUHVibGljS2V5SW5mbykpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlBsZWFzZSBwcm92aWRlIGlzc3VlciBjZXJ0aWZpY2F0ZSBhcyBhIHBhcmFtZXRlclwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY3J5cHRvLnZlcmlmeVdpdGhQdWJsaWNLZXkodGhpcy50YnNWaWV3LCB0aGlzLnNpZ25hdHVyZVZhbHVlLCBzdWJqZWN0UHVibGljS2V5SW5mbywgdGhpcy5zaWduYXR1cmVBbGdvcml0aG0pO1xuICAgIH1cbn1cbkNlcnRpZmljYXRlLkNMQVNTX05BTUUgPSBcIkNlcnRpZmljYXRlXCI7XG5mdW5jdGlvbiBjaGVja0NBKGNlcnQsIHNpZ25lckNlcnQgPSBudWxsKSB7XG4gICAgaWYgKHNpZ25lckNlcnQgJiYgY2VydC5pc3N1ZXIuaXNFcXVhbChzaWduZXJDZXJ0Lmlzc3VlcikgJiYgY2VydC5zZXJpYWxOdW1iZXIuaXNFcXVhbChzaWduZXJDZXJ0LnNlcmlhbE51bWJlcikpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGxldCBpc0NBID0gZmFsc2U7XG4gICAgaWYgKGNlcnQuZXh0ZW5zaW9ucykge1xuICAgICAgICBmb3IgKGNvbnN0IGV4dGVuc2lvbiBvZiBjZXJ0LmV4dGVuc2lvbnMpIHtcbiAgICAgICAgICAgIGlmIChleHRlbnNpb24uZXh0bklEID09PSBpZF9CYXNpY0NvbnN0cmFpbnRzICYmIGV4dGVuc2lvbi5wYXJzZWRWYWx1ZSBpbnN0YW5jZW9mIEJhc2ljQ29uc3RyYWludHMpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXh0ZW5zaW9uLnBhcnNlZFZhbHVlLmNBKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzQ0EgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKGlzQ0EpIHtcbiAgICAgICAgcmV0dXJuIGNlcnQ7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xufVxuXG5jb25zdCBDRVJUX0lEJDEgPSBcImNlcnRJZFwiO1xuY29uc3QgQ0VSVF9WQUxVRSA9IFwiY2VydFZhbHVlXCI7XG5jb25zdCBQQVJTRURfVkFMVUUkNCA9IFwicGFyc2VkVmFsdWVcIjtcbmNvbnN0IENMRUFSX1BST1BTJFAgPSBbXG4gICAgQ0VSVF9JRCQxLFxuICAgIENFUlRfVkFMVUVcbl07XG5jbGFzcyBDZXJ0QmFnIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5jZXJ0SWQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBDRVJUX0lEJDEsIENlcnRCYWcuZGVmYXVsdFZhbHVlcyhDRVJUX0lEJDEpKTtcbiAgICAgICAgdGhpcy5jZXJ0VmFsdWUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBDRVJUX1ZBTFVFLCBDZXJ0QmFnLmRlZmF1bHRWYWx1ZXMoQ0VSVF9WQUxVRSkpO1xuICAgICAgICBpZiAoUEFSU0VEX1ZBTFVFJDQgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5wYXJzZWRWYWx1ZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFBBUlNFRF9WQUxVRSQ0LCBDZXJ0QmFnLmRlZmF1bHRWYWx1ZXMoUEFSU0VEX1ZBTFVFJDQpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgQ0VSVF9JRCQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9TVFJJTkc7XG4gICAgICAgICAgICBjYXNlIENFUlRfVkFMVUU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLkFueSgpKTtcbiAgICAgICAgICAgIGNhc2UgUEFSU0VEX1ZBTFVFJDQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBDRVJUX0lEJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gRU1QVFlfU1RSSU5HKTtcbiAgICAgICAgICAgIGNhc2UgQ0VSVF9WQUxVRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlIGluc3RhbmNlb2YgYXNuMWpzLkFueSk7XG4gICAgICAgICAgICBjYXNlIFBBUlNFRF9WQUxVRSQ0OlxuICAgICAgICAgICAgICAgIHJldHVybiAoKG1lbWJlclZhbHVlIGluc3RhbmNlb2YgT2JqZWN0KSAmJiAoT2JqZWN0LmtleXMobWVtYmVyVmFsdWUpLmxlbmd0aCA9PT0gMCkpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyBuYW1lOiAobmFtZXMuaWQgfHwgXCJpZFwiKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtuZXcgYXNuMWpzLkFueSh7IG5hbWU6IChuYW1lcy52YWx1ZSB8fCBcInZhbHVlXCIpIH0pXVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkUCk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgQ2VydEJhZy5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBpZDogQ0VSVF9JRCQxLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBDRVJUX1ZBTFVFXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5jZXJ0SWQgPSBhc24xLnJlc3VsdC5jZXJ0SWQudmFsdWVCbG9jay50b1N0cmluZygpO1xuICAgICAgICB0aGlzLmNlcnRWYWx1ZSA9IGFzbjEucmVzdWx0LmNlcnRWYWx1ZTtcbiAgICAgICAgY29uc3QgY2VydFZhbHVlSGV4ID0gdGhpcy5jZXJ0VmFsdWUudmFsdWVCbG9jay52YWx1ZUhleFZpZXc7XG4gICAgICAgIHN3aXRjaCAodGhpcy5jZXJ0SWQpIHtcbiAgICAgICAgICAgIGNhc2UgaWRfQ2VydEJhZ19YNTA5Q2VydGlmaWNhdGU6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJzZWRWYWx1ZSA9IENlcnRpZmljYXRlLmZyb21CRVIoY2VydFZhbHVlSGV4KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZVYyLmZyb21CRVIoY2VydFZhbHVlSGV4KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgaWRfQ2VydEJhZ19BdHRyaWJ1dGVDZXJ0aWZpY2F0ZTpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyc2VkVmFsdWUgPSBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZVYyLmZyb21CRVIoY2VydFZhbHVlSGV4KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGlkX0NlcnRCYWdfU0RTSUNlcnRpZmljYXRlOlxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBDRVJUX0lEIHZhbHVlIGluIENlcnRCYWc6ICR7dGhpcy5jZXJ0SWR9YCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGlmIChQQVJTRURfVkFMVUUkNCBpbiB0aGlzKSB7XG4gICAgICAgICAgICBpZiAoXCJhY2luZm9cIiBpbiB0aGlzLnBhcnNlZFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jZXJ0SWQgPSBpZF9DZXJ0QmFnX0F0dHJpYnV0ZUNlcnRpZmljYXRlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jZXJ0SWQgPSBpZF9DZXJ0QmFnX1g1MDlDZXJ0aWZpY2F0ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuY2VydFZhbHVlID0gbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiB0aGlzLnBhcnNlZFZhbHVlLnRvU2NoZW1hKCkudG9CRVIoZmFsc2UpIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLmNlcnRJZCB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFsoKFwidG9TY2hlbWFcIiBpbiB0aGlzLmNlcnRWYWx1ZSkgPyB0aGlzLmNlcnRWYWx1ZS50b1NjaGVtYSgpIDogdGhpcy5jZXJ0VmFsdWUpXVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY2VydElkOiB0aGlzLmNlcnRJZCxcbiAgICAgICAgICAgIGNlcnRWYWx1ZTogdGhpcy5jZXJ0VmFsdWUudG9KU09OKClcbiAgICAgICAgfTtcbiAgICB9XG59XG5DZXJ0QmFnLkNMQVNTX05BTUUgPSBcIkNlcnRCYWdcIjtcblxuY29uc3QgVVNFUl9DRVJUSUZJQ0FURSA9IFwidXNlckNlcnRpZmljYXRlXCI7XG5jb25zdCBSRVZPQ0FUSU9OX0RBVEUgPSBcInJldm9jYXRpb25EYXRlXCI7XG5jb25zdCBDUkxfRU5UUllfRVhURU5TSU9OUyA9IFwiY3JsRW50cnlFeHRlbnNpb25zXCI7XG5jb25zdCBDTEVBUl9QUk9QUyRPID0gW1xuICAgIFVTRVJfQ0VSVElGSUNBVEUsXG4gICAgUkVWT0NBVElPTl9EQVRFLFxuICAgIENSTF9FTlRSWV9FWFRFTlNJT05TXG5dO1xuY2xhc3MgUmV2b2tlZENlcnRpZmljYXRlIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy51c2VyQ2VydGlmaWNhdGUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBVU0VSX0NFUlRJRklDQVRFLCBSZXZva2VkQ2VydGlmaWNhdGUuZGVmYXVsdFZhbHVlcyhVU0VSX0NFUlRJRklDQVRFKSk7XG4gICAgICAgIHRoaXMucmV2b2NhdGlvbkRhdGUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBSRVZPQ0FUSU9OX0RBVEUsIFJldm9rZWRDZXJ0aWZpY2F0ZS5kZWZhdWx0VmFsdWVzKFJFVk9DQVRJT05fREFURSkpO1xuICAgICAgICBpZiAoQ1JMX0VOVFJZX0VYVEVOU0lPTlMgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5jcmxFbnRyeUV4dGVuc2lvbnMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBDUkxfRU5UUllfRVhURU5TSU9OUywgUmV2b2tlZENlcnRpZmljYXRlLmRlZmF1bHRWYWx1ZXMoQ1JMX0VOVFJZX0VYVEVOU0lPTlMpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVVNFUl9DRVJUSUZJQ0FURTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5JbnRlZ2VyKCk7XG4gICAgICAgICAgICBjYXNlIFJFVk9DQVRJT05fREFURTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFRpbWUoKTtcbiAgICAgICAgICAgIGNhc2UgQ1JMX0VOVFJZX0VYVEVOU0lPTlM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBFeHRlbnNpb25zKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLnVzZXJDZXJ0aWZpY2F0ZSB8fCBVU0VSX0NFUlRJRklDQVRFKSB9KSxcbiAgICAgICAgICAgICAgICBUaW1lLnNjaGVtYSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1dGNUaW1lTmFtZTogKG5hbWVzLnJldm9jYXRpb25EYXRlIHx8IFJFVk9DQVRJT05fREFURSksXG4gICAgICAgICAgICAgICAgICAgICAgICBnZW5lcmFsVGltZU5hbWU6IChuYW1lcy5yZXZvY2F0aW9uRGF0ZSB8fCBSRVZPQ0FUSU9OX0RBVEUpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBFeHRlbnNpb25zLnNjaGVtYSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IChuYW1lcy5jcmxFbnRyeUV4dGVuc2lvbnMgfHwgQ1JMX0VOVFJZX0VYVEVOU0lPTlMpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCB0cnVlKVxuICAgICAgICAgICAgXVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkTyk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgUmV2b2tlZENlcnRpZmljYXRlLnNjaGVtYSgpKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy51c2VyQ2VydGlmaWNhdGUgPSBhc24xLnJlc3VsdC51c2VyQ2VydGlmaWNhdGU7XG4gICAgICAgIHRoaXMucmV2b2NhdGlvbkRhdGUgPSBuZXcgVGltZSh7IHNjaGVtYTogYXNuMS5yZXN1bHQucmV2b2NhdGlvbkRhdGUgfSk7XG4gICAgICAgIGlmIChDUkxfRU5UUllfRVhURU5TSU9OUyBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5jcmxFbnRyeUV4dGVuc2lvbnMgPSBuZXcgRXh0ZW5zaW9ucyh7IHNjaGVtYTogYXNuMS5yZXN1bHQuY3JsRW50cnlFeHRlbnNpb25zIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtcbiAgICAgICAgICAgIHRoaXMudXNlckNlcnRpZmljYXRlLFxuICAgICAgICAgICAgdGhpcy5yZXZvY2F0aW9uRGF0ZS50b1NjaGVtYSgpXG4gICAgICAgIF07XG4gICAgICAgIGlmICh0aGlzLmNybEVudHJ5RXh0ZW5zaW9ucykge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLmNybEVudHJ5RXh0ZW5zaW9ucy50b1NjaGVtYSgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICB1c2VyQ2VydGlmaWNhdGU6IHRoaXMudXNlckNlcnRpZmljYXRlLnRvSlNPTigpLFxuICAgICAgICAgICAgcmV2b2NhdGlvbkRhdGU6IHRoaXMucmV2b2NhdGlvbkRhdGUudG9KU09OKCksXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLmNybEVudHJ5RXh0ZW5zaW9ucykge1xuICAgICAgICAgICAgcmVzLmNybEVudHJ5RXh0ZW5zaW9ucyA9IHRoaXMuY3JsRW50cnlFeHRlbnNpb25zLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxufVxuUmV2b2tlZENlcnRpZmljYXRlLkNMQVNTX05BTUUgPSBcIlJldm9rZWRDZXJ0aWZpY2F0ZVwiO1xuXG5jb25zdCBUQlMkMyA9IFwidGJzXCI7XG5jb25zdCBWRVJTSU9OJGUgPSBcInZlcnNpb25cIjtcbmNvbnN0IFNJR05BVFVSRSQzID0gXCJzaWduYXR1cmVcIjtcbmNvbnN0IElTU1VFUiQxID0gXCJpc3N1ZXJcIjtcbmNvbnN0IFRISVNfVVBEQVRFJDEgPSBcInRoaXNVcGRhdGVcIjtcbmNvbnN0IE5FWFRfVVBEQVRFJDEgPSBcIm5leHRVcGRhdGVcIjtcbmNvbnN0IFJFVk9LRURfQ0VSVElGSUNBVEVTID0gXCJyZXZva2VkQ2VydGlmaWNhdGVzXCI7XG5jb25zdCBDUkxfRVhURU5TSU9OUyA9IFwiY3JsRXh0ZW5zaW9uc1wiO1xuY29uc3QgU0lHTkFUVVJFX0FMR09SSVRITSQ0ID0gXCJzaWduYXR1cmVBbGdvcml0aG1cIjtcbmNvbnN0IFNJR05BVFVSRV9WQUxVRSQxID0gXCJzaWduYXR1cmVWYWx1ZVwiO1xuY29uc3QgVEJTX0NFUlRfTElTVCA9IFwidGJzQ2VydExpc3RcIjtcbmNvbnN0IFRCU19DRVJUX0xJU1RfVkVSU0lPTiA9IGAke1RCU19DRVJUX0xJU1R9LnZlcnNpb25gO1xuY29uc3QgVEJTX0NFUlRfTElTVF9TSUdOQVRVUkUgPSBgJHtUQlNfQ0VSVF9MSVNUfS5zaWduYXR1cmVgO1xuY29uc3QgVEJTX0NFUlRfTElTVF9JU1NVRVIgPSBgJHtUQlNfQ0VSVF9MSVNUfS5pc3N1ZXJgO1xuY29uc3QgVEJTX0NFUlRfTElTVF9USElTX1VQREFURSA9IGAke1RCU19DRVJUX0xJU1R9LnRoaXNVcGRhdGVgO1xuY29uc3QgVEJTX0NFUlRfTElTVF9ORVhUX1VQREFURSA9IGAke1RCU19DRVJUX0xJU1R9Lm5leHRVcGRhdGVgO1xuY29uc3QgVEJTX0NFUlRfTElTVF9SRVZPS0VEX0NFUlRJRklDQVRFUyA9IGAke1RCU19DRVJUX0xJU1R9LnJldm9rZWRDZXJ0aWZpY2F0ZXNgO1xuY29uc3QgVEJTX0NFUlRfTElTVF9FWFRFTlNJT05TID0gYCR7VEJTX0NFUlRfTElTVH0uZXh0ZW5zaW9uc2A7XG5jb25zdCBDTEVBUl9QUk9QUyROID0gW1xuICAgIFRCU19DRVJUX0xJU1QsXG4gICAgVEJTX0NFUlRfTElTVF9WRVJTSU9OLFxuICAgIFRCU19DRVJUX0xJU1RfU0lHTkFUVVJFLFxuICAgIFRCU19DRVJUX0xJU1RfSVNTVUVSLFxuICAgIFRCU19DRVJUX0xJU1RfVEhJU19VUERBVEUsXG4gICAgVEJTX0NFUlRfTElTVF9ORVhUX1VQREFURSxcbiAgICBUQlNfQ0VSVF9MSVNUX1JFVk9LRURfQ0VSVElGSUNBVEVTLFxuICAgIFRCU19DRVJUX0xJU1RfRVhURU5TSU9OUyxcbiAgICBTSUdOQVRVUkVfQUxHT1JJVEhNJDQsXG4gICAgU0lHTkFUVVJFX1ZBTFVFJDFcbl07XG5mdW5jdGlvbiB0YnNDZXJ0TGlzdChwYXJhbWV0ZXJzID0ge30pIHtcbiAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgVEJTX0NFUlRfTElTVCksXG4gICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy50YnNDZXJ0TGlzdFZlcnNpb24gfHwgVEJTX0NFUlRfTElTVF9WRVJTSU9OKSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogMlxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBBbGdvcml0aG1JZGVudGlmaWVyLnNjaGVtYShuYW1lcy5zaWduYXR1cmUgfHwge1xuICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogVEJTX0NFUlRfTElTVF9TSUdOQVRVUkVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIFJlbGF0aXZlRGlzdGluZ3Vpc2hlZE5hbWVzLnNjaGVtYShuYW1lcy5pc3N1ZXIgfHwge1xuICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogVEJTX0NFUlRfTElTVF9JU1NVRVJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIFRpbWUuc2NoZW1hKG5hbWVzLnRic0NlcnRMaXN0VGhpc1VwZGF0ZSB8fCB7XG4gICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgdXRjVGltZU5hbWU6IFRCU19DRVJUX0xJU1RfVEhJU19VUERBVEUsXG4gICAgICAgICAgICAgICAgICAgIGdlbmVyYWxUaW1lTmFtZTogVEJTX0NFUlRfTElTVF9USElTX1VQREFURVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgVGltZS5zY2hlbWEobmFtZXMudGJzQ2VydExpc3ROZXh0VXBkYXRlIHx8IHtcbiAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICB1dGNUaW1lTmFtZTogVEJTX0NFUlRfTElTVF9ORVhUX1VQREFURSxcbiAgICAgICAgICAgICAgICAgICAgZ2VuZXJhbFRpbWVOYW1lOiBUQlNfQ0VSVF9MSVNUX05FWFRfVVBEQVRFXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgdHJ1ZSksXG4gICAgICAgICAgICBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy50YnNDZXJ0TGlzdFJldm9rZWRDZXJ0aWZpY2F0ZXMgfHwgVEJTX0NFUlRfTElTVF9SRVZPS0VEX0NFUlRJRklDQVRFUyksXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRpbWUuc2NoZW1hKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEV4dGVuc2lvbnMuc2NoZW1hKHt9LCB0cnVlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBbRXh0ZW5zaW9ucy5zY2hlbWEobmFtZXMuY3JsRXh0ZW5zaW9ucyB8fCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogVEJTX0NFUlRfTElTVF9FWFRFTlNJT05TXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXVxuICAgICAgICAgICAgfSlcbiAgICAgICAgXVxuICAgIH0pKTtcbn1cbmNvbnN0IFdFTExfS05PV05fRVhURU5TSU9OUyA9IFtcbiAgICBpZF9BdXRob3JpdHlLZXlJZGVudGlmaWVyLFxuICAgIGlkX0lzc3VlckFsdE5hbWUsXG4gICAgaWRfQ1JMTnVtYmVyLFxuICAgIGlkX0Jhc2VDUkxOdW1iZXIsXG4gICAgaWRfSXNzdWluZ0Rpc3RyaWJ1dGlvblBvaW50LFxuICAgIGlkX0ZyZXNoZXN0Q1JMLFxuICAgIGlkX0F1dGhvcml0eUluZm9BY2Nlc3MsXG4gICAgaWRfQ1JMUmVhc29uLFxuICAgIGlkX0ludmFsaWRpdHlEYXRlLFxuICAgIGlkX0NlcnRpZmljYXRlSXNzdWVyLFxuXTtcbmNsYXNzIENlcnRpZmljYXRlUmV2b2NhdGlvbkxpc3QgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGdldCB0YnMoKSB7XG4gICAgICAgIHJldHVybiBwdnRzdXRpbHMuQnVmZmVyU291cmNlQ29udmVydGVyLnRvQXJyYXlCdWZmZXIodGhpcy50YnNWaWV3KTtcbiAgICB9XG4gICAgc2V0IHRicyh2YWx1ZSkge1xuICAgICAgICB0aGlzLnRic1ZpZXcgPSBuZXcgVWludDhBcnJheSh2YWx1ZSk7XG4gICAgfVxuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnRic1ZpZXcgPSBuZXcgVWludDhBcnJheShwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBUQlMkMywgQ2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdC5kZWZhdWx0VmFsdWVzKFRCUyQzKSkpO1xuICAgICAgICB0aGlzLnZlcnNpb24gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBWRVJTSU9OJGUsIENlcnRpZmljYXRlUmV2b2NhdGlvbkxpc3QuZGVmYXVsdFZhbHVlcyhWRVJTSU9OJGUpKTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTSUdOQVRVUkUkMywgQ2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdC5kZWZhdWx0VmFsdWVzKFNJR05BVFVSRSQzKSk7XG4gICAgICAgIHRoaXMuaXNzdWVyID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgSVNTVUVSJDEsIENlcnRpZmljYXRlUmV2b2NhdGlvbkxpc3QuZGVmYXVsdFZhbHVlcyhJU1NVRVIkMSkpO1xuICAgICAgICB0aGlzLnRoaXNVcGRhdGUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBUSElTX1VQREFURSQxLCBDZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0LmRlZmF1bHRWYWx1ZXMoVEhJU19VUERBVEUkMSkpO1xuICAgICAgICBpZiAoTkVYVF9VUERBVEUkMSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLm5leHRVcGRhdGUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBORVhUX1VQREFURSQxLCBDZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0LmRlZmF1bHRWYWx1ZXMoTkVYVF9VUERBVEUkMSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChSRVZPS0VEX0NFUlRJRklDQVRFUyBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnJldm9rZWRDZXJ0aWZpY2F0ZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBSRVZPS0VEX0NFUlRJRklDQVRFUywgQ2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdC5kZWZhdWx0VmFsdWVzKFJFVk9LRURfQ0VSVElGSUNBVEVTKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKENSTF9FWFRFTlNJT05TIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuY3JsRXh0ZW5zaW9ucyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIENSTF9FWFRFTlNJT05TLCBDZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0LmRlZmF1bHRWYWx1ZXMoQ1JMX0VYVEVOU0lPTlMpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNJR05BVFVSRV9BTEdPUklUSE0kNCwgQ2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdC5kZWZhdWx0VmFsdWVzKFNJR05BVFVSRV9BTEdPUklUSE0kNCkpO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZVZhbHVlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU0lHTkFUVVJFX1ZBTFVFJDEsIENlcnRpZmljYXRlUmV2b2NhdGlvbkxpc3QuZGVmYXVsdFZhbHVlcyhTSUdOQVRVUkVfVkFMVUUkMSkpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVEJTJDM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX0JVRkZFUjtcbiAgICAgICAgICAgIGNhc2UgVkVSU0lPTiRlOlxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgY2FzZSBTSUdOQVRVUkUkMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgSVNTVUVSJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBSZWxhdGl2ZURpc3Rpbmd1aXNoZWROYW1lcygpO1xuICAgICAgICAgICAgY2FzZSBUSElTX1VQREFURSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVGltZSgpO1xuICAgICAgICAgICAgY2FzZSBORVhUX1VQREFURSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVGltZSgpO1xuICAgICAgICAgICAgY2FzZSBSRVZPS0VEX0NFUlRJRklDQVRFUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBjYXNlIENSTF9FWFRFTlNJT05TOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRXh0ZW5zaW9ucygpO1xuICAgICAgICAgICAgY2FzZSBTSUdOQVRVUkVfQUxHT1JJVEhNJDQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKCk7XG4gICAgICAgICAgICBjYXNlIFNJR05BVFVSRV9WQUxVRSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkJpdFN0cmluZygpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBcIkNlcnRpZmljYXRlTGlzdFwiKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgdGJzQ2VydExpc3QocGFyYW1ldGVycyksXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMuc2lnbmF0dXJlQWxnb3JpdGhtIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogU0lHTkFUVVJFX0FMR09SSVRITSQ0XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkJpdFN0cmluZyh7IG5hbWU6IChuYW1lcy5zaWduYXR1cmVWYWx1ZSB8fCBTSUdOQVRVUkVfVkFMVUUkMSkgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyROKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBDZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0LnNjaGVtYSgpKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy50YnNWaWV3ID0gYXNuMS5yZXN1bHQudGJzQ2VydExpc3QudmFsdWVCZWZvcmVEZWNvZGVWaWV3O1xuICAgICAgICBpZiAoVEJTX0NFUlRfTElTVF9WRVJTSU9OIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLnZlcnNpb24gPSBhc24xLnJlc3VsdFtUQlNfQ0VSVF9MSVNUX1ZFUlNJT05dLnZhbHVlQmxvY2sudmFsdWVEZWM7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zaWduYXR1cmUgPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHRbVEJTX0NFUlRfTElTVF9TSUdOQVRVUkVdIH0pO1xuICAgICAgICB0aGlzLmlzc3VlciA9IG5ldyBSZWxhdGl2ZURpc3Rpbmd1aXNoZWROYW1lcyh7IHNjaGVtYTogYXNuMS5yZXN1bHRbVEJTX0NFUlRfTElTVF9JU1NVRVJdIH0pO1xuICAgICAgICB0aGlzLnRoaXNVcGRhdGUgPSBuZXcgVGltZSh7IHNjaGVtYTogYXNuMS5yZXN1bHRbVEJTX0NFUlRfTElTVF9USElTX1VQREFURV0gfSk7XG4gICAgICAgIGlmIChUQlNfQ0VSVF9MSVNUX05FWFRfVVBEQVRFIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLm5leHRVcGRhdGUgPSBuZXcgVGltZSh7IHNjaGVtYTogYXNuMS5yZXN1bHRbVEJTX0NFUlRfTElTVF9ORVhUX1VQREFURV0gfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFRCU19DRVJUX0xJU1RfUkVWT0tFRF9DRVJUSUZJQ0FURVMgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHRoaXMucmV2b2tlZENlcnRpZmljYXRlcyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHRbVEJTX0NFUlRfTElTVF9SRVZPS0VEX0NFUlRJRklDQVRFU10sIGVsZW1lbnQgPT4gbmV3IFJldm9rZWRDZXJ0aWZpY2F0ZSh7IHNjaGVtYTogZWxlbWVudCB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFRCU19DRVJUX0xJU1RfRVhURU5TSU9OUyBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5jcmxFeHRlbnNpb25zID0gbmV3IEV4dGVuc2lvbnMoeyBzY2hlbWE6IGFzbjEucmVzdWx0W1RCU19DRVJUX0xJU1RfRVhURU5TSU9OU10gfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zaWduYXR1cmVBbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHQuc2lnbmF0dXJlQWxnb3JpdGhtIH0pO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZVZhbHVlID0gYXNuMS5yZXN1bHQuc2lnbmF0dXJlVmFsdWU7XG4gICAgfVxuICAgIGVuY29kZVRCUygpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgaWYgKHRoaXMudmVyc2lvbiAhPT0gQ2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdC5kZWZhdWx0VmFsdWVzKFZFUlNJT04kZSkpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWU6IHRoaXMudmVyc2lvbiB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnNpZ25hdHVyZS50b1NjaGVtYSgpKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLmlzc3Vlci50b1NjaGVtYSgpKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnRoaXNVcGRhdGUudG9TY2hlbWEoKSk7XG4gICAgICAgIGlmICh0aGlzLm5leHRVcGRhdGUpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5uZXh0VXBkYXRlLnRvU2NoZW1hKCkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnJldm9rZWRDZXJ0aWZpY2F0ZXMpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy5yZXZva2VkQ2VydGlmaWNhdGVzLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jcmxFeHRlbnNpb25zKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jcmxFeHRlbnNpb25zLnRvU2NoZW1hKClcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvU2NoZW1hKGVuY29kZUZsYWcgPSBmYWxzZSkge1xuICAgICAgICBsZXQgdGJzU2NoZW1hO1xuICAgICAgICBpZiAoIWVuY29kZUZsYWcpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy50YnNWaWV3LmJ5dGVMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQ2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdC5zY2hlbWEoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuZnJvbUJFUih0aGlzLnRic1ZpZXcpO1xuICAgICAgICAgICAgQXNuRXJyb3IuYXNzZXJ0KGFzbjEsIFwiVEJTIENlcnRpZmljYXRlIFJldm9jYXRpb24gTGlzdFwiKTtcbiAgICAgICAgICAgIHRic1NjaGVtYSA9IGFzbjEucmVzdWx0O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGJzU2NoZW1hID0gdGhpcy5lbmNvZGVUQlMoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICB0YnNTY2hlbWEsXG4gICAgICAgICAgICAgICAgdGhpcy5zaWduYXR1cmVBbGdvcml0aG0udG9TY2hlbWEoKSxcbiAgICAgICAgICAgICAgICB0aGlzLnNpZ25hdHVyZVZhbHVlXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICB0YnM6IHB2dHN1dGlscy5Db252ZXJ0LlRvSGV4KHRoaXMudGJzVmlldyksXG4gICAgICAgICAgICB2ZXJzaW9uOiB0aGlzLnZlcnNpb24sXG4gICAgICAgICAgICBzaWduYXR1cmU6IHRoaXMuc2lnbmF0dXJlLnRvSlNPTigpLFxuICAgICAgICAgICAgaXNzdWVyOiB0aGlzLmlzc3Vlci50b0pTT04oKSxcbiAgICAgICAgICAgIHRoaXNVcGRhdGU6IHRoaXMudGhpc1VwZGF0ZS50b0pTT04oKSxcbiAgICAgICAgICAgIHNpZ25hdHVyZUFsZ29yaXRobTogdGhpcy5zaWduYXR1cmVBbGdvcml0aG0udG9KU09OKCksXG4gICAgICAgICAgICBzaWduYXR1cmVWYWx1ZTogdGhpcy5zaWduYXR1cmVWYWx1ZS50b0pTT04oKVxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy52ZXJzaW9uICE9PSBDZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0LmRlZmF1bHRWYWx1ZXMoVkVSU0lPTiRlKSlcbiAgICAgICAgICAgIHJlcy52ZXJzaW9uID0gdGhpcy52ZXJzaW9uO1xuICAgICAgICBpZiAodGhpcy5uZXh0VXBkYXRlKSB7XG4gICAgICAgICAgICByZXMubmV4dFVwZGF0ZSA9IHRoaXMubmV4dFVwZGF0ZS50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5yZXZva2VkQ2VydGlmaWNhdGVzKSB7XG4gICAgICAgICAgICByZXMucmV2b2tlZENlcnRpZmljYXRlcyA9IEFycmF5LmZyb20odGhpcy5yZXZva2VkQ2VydGlmaWNhdGVzLCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmNybEV4dGVuc2lvbnMpIHtcbiAgICAgICAgICAgIHJlcy5jcmxFeHRlbnNpb25zID0gdGhpcy5jcmxFeHRlbnNpb25zLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxuICAgIGlzQ2VydGlmaWNhdGVSZXZva2VkKGNlcnRpZmljYXRlKSB7XG4gICAgICAgIGlmICghdGhpcy5pc3N1ZXIuaXNFcXVhbChjZXJ0aWZpY2F0ZS5pc3N1ZXIpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLnJldm9rZWRDZXJ0aWZpY2F0ZXMpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IHJldm9rZWRDZXJ0aWZpY2F0ZSBvZiB0aGlzLnJldm9rZWRDZXJ0aWZpY2F0ZXMpIHtcbiAgICAgICAgICAgIGlmIChyZXZva2VkQ2VydGlmaWNhdGUudXNlckNlcnRpZmljYXRlLmlzRXF1YWwoY2VydGlmaWNhdGUuc2VyaWFsTnVtYmVyKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgYXN5bmMgc2lnbihwcml2YXRlS2V5LCBoYXNoQWxnb3JpdGhtID0gXCJTSEEtMVwiLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgaWYgKCFwcml2YXRlS2V5KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJOZWVkIHRvIHByb3ZpZGUgYSBwcml2YXRlIGtleSBmb3Igc2lnbmluZ1wiKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzaWduYXR1cmVQYXJhbWV0ZXJzID0gYXdhaXQgY3J5cHRvLmdldFNpZ25hdHVyZVBhcmFtZXRlcnMocHJpdmF0ZUtleSwgaGFzaEFsZ29yaXRobSk7XG4gICAgICAgIGNvbnN0IHsgcGFyYW1ldGVycyB9ID0gc2lnbmF0dXJlUGFyYW1ldGVycztcbiAgICAgICAgdGhpcy5zaWduYXR1cmUgPSBzaWduYXR1cmVQYXJhbWV0ZXJzLnNpZ25hdHVyZUFsZ29yaXRobTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmVBbGdvcml0aG0gPSBzaWduYXR1cmVQYXJhbWV0ZXJzLnNpZ25hdHVyZUFsZ29yaXRobTtcbiAgICAgICAgdGhpcy50YnNWaWV3ID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5lbmNvZGVUQlMoKS50b0JFUigpKTtcbiAgICAgICAgY29uc3Qgc2lnbmF0dXJlID0gYXdhaXQgY3J5cHRvLnNpZ25XaXRoUHJpdmF0ZUtleSh0aGlzLnRic1ZpZXcsIHByaXZhdGVLZXksIHBhcmFtZXRlcnMpO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZVZhbHVlID0gbmV3IGFzbjFqcy5CaXRTdHJpbmcoeyB2YWx1ZUhleDogc2lnbmF0dXJlIH0pO1xuICAgIH1cbiAgICBhc3luYyB2ZXJpZnkocGFyYW1ldGVycyA9IHt9LCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgbGV0IHN1YmplY3RQdWJsaWNLZXlJbmZvO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5pc3N1ZXJDZXJ0aWZpY2F0ZSkge1xuICAgICAgICAgICAgc3ViamVjdFB1YmxpY0tleUluZm8gPSBwYXJhbWV0ZXJzLmlzc3VlckNlcnRpZmljYXRlLnN1YmplY3RQdWJsaWNLZXlJbmZvO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmlzc3Vlci5pc0VxdWFsKHBhcmFtZXRlcnMuaXNzdWVyQ2VydGlmaWNhdGUuc3ViamVjdCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMucHVibGljS2V5SW5mbykge1xuICAgICAgICAgICAgc3ViamVjdFB1YmxpY0tleUluZm8gPSBwYXJhbWV0ZXJzLnB1YmxpY0tleUluZm87XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzdWJqZWN0UHVibGljS2V5SW5mbykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSXNzdWVyJ3MgY2VydGlmaWNhdGUgbXVzdCBiZSBwcm92aWRlZCBhcyBhbiBpbnB1dCBwYXJhbWV0ZXJcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY3JsRXh0ZW5zaW9ucykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBleHRlbnNpb24gb2YgdGhpcy5jcmxFeHRlbnNpb25zLmV4dGVuc2lvbnMpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXh0ZW5zaW9uLmNyaXRpY2FsKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghV0VMTF9LTk9XTl9FWFRFTlNJT05TLmluY2x1ZGVzKGV4dGVuc2lvbi5leHRuSUQpKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY3J5cHRvLnZlcmlmeVdpdGhQdWJsaWNLZXkodGhpcy50YnNWaWV3LCB0aGlzLnNpZ25hdHVyZVZhbHVlLCBzdWJqZWN0UHVibGljS2V5SW5mbywgdGhpcy5zaWduYXR1cmVBbGdvcml0aG0pO1xuICAgIH1cbn1cbkNlcnRpZmljYXRlUmV2b2NhdGlvbkxpc3QuQ0xBU1NfTkFNRSA9IFwiQ2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdFwiO1xuXG5jb25zdCBDUkxfSUQgPSBcImNybElkXCI7XG5jb25zdCBDUkxfVkFMVUUgPSBcImNybFZhbHVlXCI7XG5jb25zdCBQQVJTRURfVkFMVUUkMyA9IFwicGFyc2VkVmFsdWVcIjtcbmNvbnN0IENMRUFSX1BST1BTJE0gPSBbXG4gICAgQ1JMX0lELFxuICAgIENSTF9WQUxVRSxcbl07XG5jbGFzcyBDUkxCYWcgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmNybElkID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQ1JMX0lELCBDUkxCYWcuZGVmYXVsdFZhbHVlcyhDUkxfSUQpKTtcbiAgICAgICAgdGhpcy5jcmxWYWx1ZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIENSTF9WQUxVRSwgQ1JMQmFnLmRlZmF1bHRWYWx1ZXMoQ1JMX1ZBTFVFKSk7XG4gICAgICAgIGlmIChQQVJTRURfVkFMVUUkMyBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnBhcnNlZFZhbHVlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUEFSU0VEX1ZBTFVFJDMsIENSTEJhZy5kZWZhdWx0VmFsdWVzKFBBUlNFRF9WQUxVRSQzKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIENSTF9JRDpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfU1RSSU5HO1xuICAgICAgICAgICAgY2FzZSBDUkxfVkFMVUU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLkFueSgpKTtcbiAgICAgICAgICAgIGNhc2UgUEFSU0VEX1ZBTFVFJDM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBDUkxfSUQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gRU1QVFlfU1RSSU5HKTtcbiAgICAgICAgICAgIGNhc2UgQ1JMX1ZBTFVFOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgaW5zdGFuY2VvZiBhc24xanMuQW55KTtcbiAgICAgICAgICAgIGNhc2UgUEFSU0VEX1ZBTFVFJDM6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgobWVtYmVyVmFsdWUgaW5zdGFuY2VvZiBPYmplY3QpICYmIChPYmplY3Qua2V5cyhtZW1iZXJWYWx1ZSkubGVuZ3RoID09PSAwKSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IG5hbWU6IChuYW1lcy5pZCB8fCBcImlkXCIpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW25ldyBhc24xanMuQW55KHsgbmFtZTogKG5hbWVzLnZhbHVlIHx8IFwidmFsdWVcIikgfSldXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRNKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBDUkxCYWcuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgaWQ6IENSTF9JRCxcbiAgICAgICAgICAgICAgICB2YWx1ZTogQ1JMX1ZBTFVFXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5jcmxJZCA9IGFzbjEucmVzdWx0LmNybElkLnZhbHVlQmxvY2sudG9TdHJpbmcoKTtcbiAgICAgICAgdGhpcy5jcmxWYWx1ZSA9IGFzbjEucmVzdWx0LmNybFZhbHVlO1xuICAgICAgICBzd2l0Y2ggKHRoaXMuY3JsSWQpIHtcbiAgICAgICAgICAgIGNhc2UgaWRfQ1JMQmFnX1g1MDlDUkw6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcnNlZFZhbHVlID0gQ2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdC5mcm9tQkVSKHRoaXMuY2VydFZhbHVlLnZhbHVlQmxvY2sudmFsdWVIZXgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbmNvcnJlY3QgQ1JMX0lEIHZhbHVlIGluIENSTEJhZzogJHt0aGlzLmNybElkfWApO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBpZiAodGhpcy5wYXJzZWRWYWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5jcmxJZCA9IGlkX0NSTEJhZ19YNTA5Q1JMO1xuICAgICAgICAgICAgdGhpcy5jcmxWYWx1ZSA9IG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyB2YWx1ZUhleDogdGhpcy5wYXJzZWRWYWx1ZS50b1NjaGVtYSgpLnRvQkVSKGZhbHNlKSB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyB2YWx1ZTogdGhpcy5jcmxJZCB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFt0aGlzLmNybFZhbHVlLnRvU2NoZW1hKCldXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjcmxJZDogdGhpcy5jcmxJZCxcbiAgICAgICAgICAgIGNybFZhbHVlOiB0aGlzLmNybFZhbHVlLnRvSlNPTigpXG4gICAgICAgIH07XG4gICAgfVxufVxuQ1JMQmFnLkNMQVNTX05BTUUgPSBcIkNSTEJhZ1wiO1xuXG5jb25zdCBWRVJTSU9OJGQgPSBcInZlcnNpb25cIjtcbmNvbnN0IEVOQ1JZUFRFRF9DT05URU5UX0lORk8kMSA9IFwiZW5jcnlwdGVkQ29udGVudEluZm9cIjtcbmNvbnN0IFVOUFJPVEVDVEVEX0FUVFJTJDEgPSBcInVucHJvdGVjdGVkQXR0cnNcIjtcbmNvbnN0IENMRUFSX1BST1BTJEwgPSBbXG4gICAgVkVSU0lPTiRkLFxuICAgIEVOQ1JZUFRFRF9DT05URU5UX0lORk8kMSxcbiAgICBVTlBST1RFQ1RFRF9BVFRSUyQxLFxuXTtcbmNsYXNzIEVuY3J5cHRlZERhdGEgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnZlcnNpb24gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBWRVJTSU9OJGQsIEVuY3J5cHRlZERhdGEuZGVmYXVsdFZhbHVlcyhWRVJTSU9OJGQpKTtcbiAgICAgICAgdGhpcy5lbmNyeXB0ZWRDb250ZW50SW5mbyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEVOQ1JZUFRFRF9DT05URU5UX0lORk8kMSwgRW5jcnlwdGVkRGF0YS5kZWZhdWx0VmFsdWVzKEVOQ1JZUFRFRF9DT05URU5UX0lORk8kMSkpO1xuICAgICAgICBpZiAoVU5QUk9URUNURURfQVRUUlMkMSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnVucHJvdGVjdGVkQXR0cnMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBVTlBST1RFQ1RFRF9BVFRSUyQxLCBFbmNyeXB0ZWREYXRhLmRlZmF1bHRWYWx1ZXMoVU5QUk9URUNURURfQVRUUlMkMSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJGQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICBjYXNlIEVOQ1JZUFRFRF9DT05URU5UX0lORk8kMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEVuY3J5cHRlZENvbnRlbnRJbmZvKCk7XG4gICAgICAgICAgICBjYXNlIFVOUFJPVEVDVEVEX0FUVFJTJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJGQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gMCk7XG4gICAgICAgICAgICBjYXNlIEVOQ1JZUFRFRF9DT05URU5UX0lORk8kMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKChFbmNyeXB0ZWRDb250ZW50SW5mby5jb21wYXJlV2l0aERlZmF1bHQoXCJjb250ZW50VHlwZVwiLCBtZW1iZXJWYWx1ZS5jb250ZW50VHlwZSkpICYmXG4gICAgICAgICAgICAgICAgICAgIChFbmNyeXB0ZWRDb250ZW50SW5mby5jb21wYXJlV2l0aERlZmF1bHQoXCJjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobVwiLCBtZW1iZXJWYWx1ZS5jb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobSkpICYmXG4gICAgICAgICAgICAgICAgICAgIChFbmNyeXB0ZWRDb250ZW50SW5mby5jb21wYXJlV2l0aERlZmF1bHQoXCJlbmNyeXB0ZWRDb250ZW50XCIsIG1lbWJlclZhbHVlLmVuY3J5cHRlZENvbnRlbnQpKSk7XG4gICAgICAgICAgICBjYXNlIFVOUFJPVEVDVEVEX0FUVFJTJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMudmVyc2lvbiB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIEVuY3J5cHRlZENvbnRlbnRJbmZvLnNjaGVtYShuYW1lcy5lbmNyeXB0ZWRDb250ZW50SW5mbyB8fCB7fSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnVucHJvdGVjdGVkQXR0cnMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQXR0cmlidXRlLnNjaGVtYSgpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRMKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBFbmNyeXB0ZWREYXRhLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIHZlcnNpb246IFZFUlNJT04kZCxcbiAgICAgICAgICAgICAgICBlbmNyeXB0ZWRDb250ZW50SW5mbzoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBFTkNSWVBURURfQ09OVEVOVF9JTkZPJDFcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdW5wcm90ZWN0ZWRBdHRyczogVU5QUk9URUNURURfQVRUUlMkMVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IGFzbjEucmVzdWx0LnZlcnNpb24udmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgdGhpcy5lbmNyeXB0ZWRDb250ZW50SW5mbyA9IG5ldyBFbmNyeXB0ZWRDb250ZW50SW5mbyh7IHNjaGVtYTogYXNuMS5yZXN1bHQuZW5jcnlwdGVkQ29udGVudEluZm8gfSk7XG4gICAgICAgIGlmIChVTlBST1RFQ1RFRF9BVFRSUyQxIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy51bnByb3RlY3RlZEF0dHJzID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdC51bnByb3RlY3RlZEF0dHJzLCBlbGVtZW50ID0+IG5ldyBBdHRyaWJ1dGUoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy52ZXJzaW9uIH0pKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLmVuY3J5cHRlZENvbnRlbnRJbmZvLnRvU2NoZW1hKCkpO1xuICAgICAgICBpZiAodGhpcy51bnByb3RlY3RlZEF0dHJzKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy51bnByb3RlY3RlZEF0dHJzLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICB2ZXJzaW9uOiB0aGlzLnZlcnNpb24sXG4gICAgICAgICAgICBlbmNyeXB0ZWRDb250ZW50SW5mbzogdGhpcy5lbmNyeXB0ZWRDb250ZW50SW5mby50b0pTT04oKVxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy51bnByb3RlY3RlZEF0dHJzKVxuICAgICAgICAgICAgcmVzLnVucHJvdGVjdGVkQXR0cnMgPSBBcnJheS5mcm9tKHRoaXMudW5wcm90ZWN0ZWRBdHRycywgbyA9PiBvLnRvSlNPTigpKTtcbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG4gICAgYXN5bmMgZW5jcnlwdChwYXJhbWV0ZXJzLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgQXJndW1lbnRFcnJvci5hc3NlcnQocGFyYW1ldGVycywgXCJwYXJhbWV0ZXJzXCIsIFwib2JqZWN0XCIpO1xuICAgICAgICBjb25zdCBlbmNyeXB0UGFyYW1zID0ge1xuICAgICAgICAgICAgLi4ucGFyYW1ldGVycyxcbiAgICAgICAgICAgIGNvbnRlbnRUeXBlOiBcIjEuMi44NDAuMTEzNTQ5LjEuNy4xXCIsXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZW5jcnlwdGVkQ29udGVudEluZm8gPSBhd2FpdCBjcnlwdG8uZW5jcnlwdEVuY3J5cHRlZENvbnRlbnRJbmZvKGVuY3J5cHRQYXJhbXMpO1xuICAgIH1cbiAgICBhc3luYyBkZWNyeXB0KHBhcmFtZXRlcnMsIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICBBcmd1bWVudEVycm9yLmFzc2VydChwYXJhbWV0ZXJzLCBcInBhcmFtZXRlcnNcIiwgXCJvYmplY3RcIik7XG4gICAgICAgIGNvbnN0IGRlY3J5cHRQYXJhbXMgPSB7XG4gICAgICAgICAgICAuLi5wYXJhbWV0ZXJzLFxuICAgICAgICAgICAgZW5jcnlwdGVkQ29udGVudEluZm86IHRoaXMuZW5jcnlwdGVkQ29udGVudEluZm8sXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBjcnlwdG8uZGVjcnlwdEVuY3J5cHRlZENvbnRlbnRJbmZvKGRlY3J5cHRQYXJhbXMpO1xuICAgIH1cbn1cbkVuY3J5cHRlZERhdGEuQ0xBU1NfTkFNRSA9IFwiRW5jcnlwdGVkRGF0YVwiO1xuXG5jb25zdCBFTkNSWVBUSU9OX0FMR09SSVRITSA9IFwiZW5jcnlwdGlvbkFsZ29yaXRobVwiO1xuY29uc3QgRU5DUllQVEVEX0RBVEEgPSBcImVuY3J5cHRlZERhdGFcIjtcbmNvbnN0IFBBUlNFRF9WQUxVRSQyID0gXCJwYXJzZWRWYWx1ZVwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkSyA9IFtcbiAgICBFTkNSWVBUSU9OX0FMR09SSVRITSxcbiAgICBFTkNSWVBURURfREFUQSxcbl07XG5jbGFzcyBQS0NTOFNocm91ZGVkS2V5QmFnIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5lbmNyeXB0aW9uQWxnb3JpdGhtID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgRU5DUllQVElPTl9BTEdPUklUSE0sIFBLQ1M4U2hyb3VkZWRLZXlCYWcuZGVmYXVsdFZhbHVlcyhFTkNSWVBUSU9OX0FMR09SSVRITSkpO1xuICAgICAgICB0aGlzLmVuY3J5cHRlZERhdGEgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBFTkNSWVBURURfREFUQSwgUEtDUzhTaHJvdWRlZEtleUJhZy5kZWZhdWx0VmFsdWVzKEVOQ1JZUFRFRF9EQVRBKSk7XG4gICAgICAgIGlmIChQQVJTRURfVkFMVUUkMiBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnBhcnNlZFZhbHVlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUEFSU0VEX1ZBTFVFJDIsIFBLQ1M4U2hyb3VkZWRLZXlCYWcuZGVmYXVsdFZhbHVlcyhQQVJTRURfVkFMVUUkMikpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBFTkNSWVBUSU9OX0FMR09SSVRITTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKCkpO1xuICAgICAgICAgICAgY2FzZSBFTkNSWVBURURfREFUQTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoKSk7XG4gICAgICAgICAgICBjYXNlIFBBUlNFRF9WQUxVRSQyOlxuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgRU5DUllQVElPTl9BTEdPUklUSE06XG4gICAgICAgICAgICAgICAgcmV0dXJuICgoQWxnb3JpdGhtSWRlbnRpZmllci5jb21wYXJlV2l0aERlZmF1bHQoXCJhbGdvcml0aG1JZFwiLCBtZW1iZXJWYWx1ZS5hbGdvcml0aG1JZCkpICYmXG4gICAgICAgICAgICAgICAgICAgICgoXCJhbGdvcml0aG1QYXJhbXNcIiBpbiBtZW1iZXJWYWx1ZSkgPT09IGZhbHNlKSk7XG4gICAgICAgICAgICBjYXNlIEVOQ1JZUFRFRF9EQVRBOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUuaXNFcXVhbChQS0NTOFNocm91ZGVkS2V5QmFnLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkpKTtcbiAgICAgICAgICAgIGNhc2UgUEFSU0VEX1ZBTFVFJDI6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgobWVtYmVyVmFsdWUgaW5zdGFuY2VvZiBPYmplY3QpICYmIChPYmplY3Qua2V5cyhtZW1iZXJWYWx1ZSkubGVuZ3RoID09PSAwKSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIEFsZ29yaXRobUlkZW50aWZpZXIuc2NoZW1hKG5hbWVzLmVuY3J5cHRpb25BbGdvcml0aG0gfHwge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBFTkNSWVBUSU9OX0FMR09SSVRITVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5DaG9pY2Uoe1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IG5hbWU6IChuYW1lcy5lbmNyeXB0ZWREYXRhIHx8IEVOQ1JZUFRFRF9EQVRBKSB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNDb25zdHJ1Y3RlZDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmVuY3J5cHRlZERhdGEgfHwgRU5DUllQVEVEX0RBVEEpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRLKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBQS0NTOFNocm91ZGVkS2V5QmFnLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGVuY3J5cHRpb25BbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogRU5DUllQVElPTl9BTEdPUklUSE1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZW5jcnlwdGVkRGF0YTogRU5DUllQVEVEX0RBVEFcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmVuY3J5cHRpb25BbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHQuZW5jcnlwdGlvbkFsZ29yaXRobSB9KTtcbiAgICAgICAgdGhpcy5lbmNyeXB0ZWREYXRhID0gYXNuMS5yZXN1bHQuZW5jcnlwdGVkRGF0YTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIHRoaXMuZW5jcnlwdGlvbkFsZ29yaXRobS50b1NjaGVtYSgpLFxuICAgICAgICAgICAgICAgIHRoaXMuZW5jcnlwdGVkRGF0YVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGVuY3J5cHRpb25BbGdvcml0aG06IHRoaXMuZW5jcnlwdGlvbkFsZ29yaXRobS50b0pTT04oKSxcbiAgICAgICAgICAgIGVuY3J5cHRlZERhdGE6IHRoaXMuZW5jcnlwdGVkRGF0YS50b0pTT04oKSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgYXN5bmMgcGFyc2VJbnRlcm5hbFZhbHVlcyhwYXJhbWV0ZXJzLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgY29uc3QgY21zRW5jcnlwdGVkID0gbmV3IEVuY3J5cHRlZERhdGEoe1xuICAgICAgICAgICAgZW5jcnlwdGVkQ29udGVudEluZm86IG5ldyBFbmNyeXB0ZWRDb250ZW50SW5mbyh7XG4gICAgICAgICAgICAgICAgY29udGVudEVuY3J5cHRpb25BbGdvcml0aG06IHRoaXMuZW5jcnlwdGlvbkFsZ29yaXRobSxcbiAgICAgICAgICAgICAgICBlbmNyeXB0ZWRDb250ZW50OiB0aGlzLmVuY3J5cHRlZERhdGFcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBkZWNyeXB0ZWREYXRhID0gYXdhaXQgY21zRW5jcnlwdGVkLmRlY3J5cHQocGFyYW1ldGVycywgY3J5cHRvKTtcbiAgICAgICAgdGhpcy5wYXJzZWRWYWx1ZSA9IFByaXZhdGVLZXlJbmZvLmZyb21CRVIoZGVjcnlwdGVkRGF0YSk7XG4gICAgfVxuICAgIGFzeW5jIG1ha2VJbnRlcm5hbFZhbHVlcyhwYXJhbWV0ZXJzLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgaWYgKCF0aGlzLnBhcnNlZFZhbHVlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQbGVhc2UgaW5pdGlhbGl6ZSBcXFwicGFyc2VkVmFsdWVcXFwiIGZpcnN0XCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNtc0VuY3J5cHRlZCA9IG5ldyBFbmNyeXB0ZWREYXRhKCk7XG4gICAgICAgIGNvbnN0IGVuY3J5cHRQYXJhbXMgPSB7XG4gICAgICAgICAgICAuLi5wYXJhbWV0ZXJzLFxuICAgICAgICAgICAgY29udGVudFRvRW5jcnlwdDogdGhpcy5wYXJzZWRWYWx1ZS50b1NjaGVtYSgpLnRvQkVSKGZhbHNlKSxcbiAgICAgICAgfTtcbiAgICAgICAgYXdhaXQgY21zRW5jcnlwdGVkLmVuY3J5cHQoZW5jcnlwdFBhcmFtcywgY3J5cHRvKTtcbiAgICAgICAgaWYgKCFjbXNFbmNyeXB0ZWQuZW5jcnlwdGVkQ29udGVudEluZm8uZW5jcnlwdGVkQ29udGVudCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhlIGZpbGVkIGBlbmNyeXB0ZWRDb250ZW50YCBpbiBFbmNyeXB0ZWRDb250ZW50SW5mbyBpcyBlbXB0eVwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmVuY3J5cHRpb25BbGdvcml0aG0gPSBjbXNFbmNyeXB0ZWQuZW5jcnlwdGVkQ29udGVudEluZm8uY29udGVudEVuY3J5cHRpb25BbGdvcml0aG07XG4gICAgICAgIHRoaXMuZW5jcnlwdGVkRGF0YSA9IGNtc0VuY3J5cHRlZC5lbmNyeXB0ZWRDb250ZW50SW5mby5lbmNyeXB0ZWRDb250ZW50O1xuICAgIH1cbn1cblBLQ1M4U2hyb3VkZWRLZXlCYWcuQ0xBU1NfTkFNRSA9IFwiUEtDUzhTaHJvdWRlZEtleUJhZ1wiO1xuXG5jb25zdCBTRUNSRVRfVFlQRV9JRCA9IFwic2VjcmV0VHlwZUlkXCI7XG5jb25zdCBTRUNSRVRfVkFMVUUgPSBcInNlY3JldFZhbHVlXCI7XG5jb25zdCBDTEVBUl9QUk9QUyRKID0gW1xuICAgIFNFQ1JFVF9UWVBFX0lELFxuICAgIFNFQ1JFVF9WQUxVRSxcbl07XG5jbGFzcyBTZWNyZXRCYWcgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnNlY3JldFR5cGVJZCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNFQ1JFVF9UWVBFX0lELCBTZWNyZXRCYWcuZGVmYXVsdFZhbHVlcyhTRUNSRVRfVFlQRV9JRCkpO1xuICAgICAgICB0aGlzLnNlY3JldFZhbHVlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU0VDUkVUX1ZBTFVFLCBTZWNyZXRCYWcuZGVmYXVsdFZhbHVlcyhTRUNSRVRfVkFMVUUpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFNFQ1JFVF9UWVBFX0lEOlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9TVFJJTkc7XG4gICAgICAgICAgICBjYXNlIFNFQ1JFVF9WQUxVRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuQW55KCkpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBTRUNSRVRfVFlQRV9JRDpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlID09PSBFTVBUWV9TVFJJTkcpO1xuICAgICAgICAgICAgY2FzZSBTRUNSRVRfVkFMVUU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSBpbnN0YW5jZW9mIGFzbjFqcy5BbnkpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyBuYW1lOiAobmFtZXMuaWQgfHwgXCJpZFwiKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtuZXcgYXNuMWpzLkFueSh7IG5hbWU6IChuYW1lcy52YWx1ZSB8fCBcInZhbHVlXCIpIH0pXVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkSik7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgU2VjcmV0QmFnLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGlkOiBTRUNSRVRfVFlQRV9JRCxcbiAgICAgICAgICAgICAgICB2YWx1ZTogU0VDUkVUX1ZBTFVFXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5zZWNyZXRUeXBlSWQgPSBhc24xLnJlc3VsdC5zZWNyZXRUeXBlSWQudmFsdWVCbG9jay50b1N0cmluZygpO1xuICAgICAgICB0aGlzLnNlY3JldFZhbHVlID0gYXNuMS5yZXN1bHQuc2VjcmV0VmFsdWU7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyB2YWx1ZTogdGhpcy5zZWNyZXRUeXBlSWQgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbdGhpcy5zZWNyZXRWYWx1ZS50b1NjaGVtYSgpXVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc2VjcmV0VHlwZUlkOiB0aGlzLnNlY3JldFR5cGVJZCxcbiAgICAgICAgICAgIHNlY3JldFZhbHVlOiB0aGlzLnNlY3JldFZhbHVlLnRvSlNPTigpXG4gICAgICAgIH07XG4gICAgfVxufVxuU2VjcmV0QmFnLkNMQVNTX05BTUUgPSBcIlNlY3JldEJhZ1wiO1xuXG5jbGFzcyBTYWZlQmFnVmFsdWVGYWN0b3J5IHtcbiAgICBzdGF0aWMgZ2V0SXRlbXMoKSB7XG4gICAgICAgIGlmICghdGhpcy5pdGVtcykge1xuICAgICAgICAgICAgdGhpcy5pdGVtcyA9IHt9O1xuICAgICAgICAgICAgU2FmZUJhZ1ZhbHVlRmFjdG9yeS5yZWdpc3RlcihcIjEuMi44NDAuMTEzNTQ5LjEuMTIuMTAuMS4xXCIsIFByaXZhdGVLZXlJbmZvKTtcbiAgICAgICAgICAgIFNhZmVCYWdWYWx1ZUZhY3RvcnkucmVnaXN0ZXIoXCIxLjIuODQwLjExMzU0OS4xLjEyLjEwLjEuMlwiLCBQS0NTOFNocm91ZGVkS2V5QmFnKTtcbiAgICAgICAgICAgIFNhZmVCYWdWYWx1ZUZhY3RvcnkucmVnaXN0ZXIoXCIxLjIuODQwLjExMzU0OS4xLjEyLjEwLjEuM1wiLCBDZXJ0QmFnKTtcbiAgICAgICAgICAgIFNhZmVCYWdWYWx1ZUZhY3RvcnkucmVnaXN0ZXIoXCIxLjIuODQwLjExMzU0OS4xLjEyLjEwLjEuNFwiLCBDUkxCYWcpO1xuICAgICAgICAgICAgU2FmZUJhZ1ZhbHVlRmFjdG9yeS5yZWdpc3RlcihcIjEuMi44NDAuMTEzNTQ5LjEuMTIuMTAuMS41XCIsIFNlY3JldEJhZyk7XG4gICAgICAgICAgICBTYWZlQmFnVmFsdWVGYWN0b3J5LnJlZ2lzdGVyKFwiMS4yLjg0MC4xMTM1NDkuMS4xMi4xMC4xLjZcIiwgU2FmZUNvbnRlbnRzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5pdGVtcztcbiAgICB9XG4gICAgc3RhdGljIHJlZ2lzdGVyKGlkLCB0eXBlKSB7XG4gICAgICAgIHRoaXMuZ2V0SXRlbXMoKVtpZF0gPSB0eXBlO1xuICAgIH1cbiAgICBzdGF0aWMgZmluZChpZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRJdGVtcygpW2lkXSB8fCBudWxsO1xuICAgIH1cbn1cblxuY29uc3QgQkFHX0lEID0gXCJiYWdJZFwiO1xuY29uc3QgQkFHX1ZBTFVFID0gXCJiYWdWYWx1ZVwiO1xuY29uc3QgQkFHX0FUVFJJQlVURVMgPSBcImJhZ0F0dHJpYnV0ZXNcIjtcbmNvbnN0IENMRUFSX1BST1BTJEkgPSBbXG4gICAgQkFHX0lELFxuICAgIEJBR19WQUxVRSxcbiAgICBCQUdfQVRUUklCVVRFU1xuXTtcbmNsYXNzIFNhZmVCYWcgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmJhZ0lkID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQkFHX0lELCBTYWZlQmFnLmRlZmF1bHRWYWx1ZXMoQkFHX0lEKSk7XG4gICAgICAgIHRoaXMuYmFnVmFsdWUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBCQUdfVkFMVUUsIFNhZmVCYWcuZGVmYXVsdFZhbHVlcyhCQUdfVkFMVUUpKTtcbiAgICAgICAgaWYgKEJBR19BVFRSSUJVVEVTIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuYmFnQXR0cmlidXRlcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEJBR19BVFRSSUJVVEVTLCBTYWZlQmFnLmRlZmF1bHRWYWx1ZXMoQkFHX0FUVFJJQlVURVMpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgQkFHX0lEOlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9TVFJJTkc7XG4gICAgICAgICAgICBjYXNlIEJBR19WQUxVRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuQW55KCkpO1xuICAgICAgICAgICAgY2FzZSBCQUdfQVRUUklCVVRFUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIEJBR19JRDpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlID09PSBFTVBUWV9TVFJJTkcpO1xuICAgICAgICAgICAgY2FzZSBCQUdfVkFMVUU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSBpbnN0YW5jZW9mIGFzbjFqcy5BbnkpO1xuICAgICAgICAgICAgY2FzZSBCQUdfQVRUUklCVVRFUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IG5hbWU6IChuYW1lcy5iYWdJZCB8fCBCQUdfSUQpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW25ldyBhc24xanMuQW55KHsgbmFtZTogKG5hbWVzLmJhZ1ZhbHVlIHx8IEJBR19WQUxVRSkgfSldXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5TZXQoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUmVwZWF0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5iYWdBdHRyaWJ1dGVzIHx8IEJBR19BVFRSSUJVVEVTKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQXR0cmlidXRlLnNjaGVtYSgpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRJKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBTYWZlQmFnLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGJhZ0lkOiBCQUdfSUQsXG4gICAgICAgICAgICAgICAgYmFnVmFsdWU6IEJBR19WQUxVRSxcbiAgICAgICAgICAgICAgICBiYWdBdHRyaWJ1dGVzOiBCQUdfQVRUUklCVVRFU1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuYmFnSWQgPSBhc24xLnJlc3VsdC5iYWdJZC52YWx1ZUJsb2NrLnRvU3RyaW5nKCk7XG4gICAgICAgIGNvbnN0IGJhZ1R5cGUgPSBTYWZlQmFnVmFsdWVGYWN0b3J5LmZpbmQodGhpcy5iYWdJZCk7XG4gICAgICAgIGlmICghYmFnVHlwZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIEJBR19JRCBmb3IgU2FmZUJhZzogJHt0aGlzLmJhZ0lkfWApO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYmFnVmFsdWUgPSBuZXcgYmFnVHlwZSh7IHNjaGVtYTogYXNuMS5yZXN1bHQuYmFnVmFsdWUgfSk7XG4gICAgICAgIGlmIChCQUdfQVRUUklCVVRFUyBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5iYWdBdHRyaWJ1dGVzID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdC5iYWdBdHRyaWJ1dGVzLCBlbGVtZW50ID0+IG5ldyBBdHRyaWJ1dGUoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtcbiAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLmJhZ0lkIH0pLFxuICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW3RoaXMuYmFnVmFsdWUudG9TY2hlbWEoKV1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIF07XG4gICAgICAgIGlmICh0aGlzLmJhZ0F0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5TZXQoe1xuICAgICAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMuYmFnQXR0cmlidXRlcywgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0ID0ge1xuICAgICAgICAgICAgYmFnSWQ6IHRoaXMuYmFnSWQsXG4gICAgICAgICAgICBiYWdWYWx1ZTogdGhpcy5iYWdWYWx1ZS50b0pTT04oKVxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5iYWdBdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICBvdXRwdXQuYmFnQXR0cmlidXRlcyA9IEFycmF5LmZyb20odGhpcy5iYWdBdHRyaWJ1dGVzLCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxufVxuU2FmZUJhZy5DTEFTU19OQU1FID0gXCJTYWZlQmFnXCI7XG5cbmNvbnN0IFNBRkVfQlVHUyA9IFwic2FmZUJhZ3NcIjtcbmNsYXNzIFNhZmVDb250ZW50cyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuc2FmZUJhZ3MgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTQUZFX0JVR1MsIFNhZmVDb250ZW50cy5kZWZhdWx0VmFsdWVzKFNBRkVfQlVHUykpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgU0FGRV9CVUdTOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgU0FGRV9CVUdTOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUubGVuZ3RoID09PSAwKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5zYWZlQmFncyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogU2FmZUJhZy5zY2hlbWEoKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgW1xuICAgICAgICAgICAgU0FGRV9CVUdTXG4gICAgICAgIF0pO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFNhZmVDb250ZW50cy5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBzYWZlQmFnczogU0FGRV9CVUdTXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5zYWZlQmFncyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHQuc2FmZUJhZ3MsIGVsZW1lbnQgPT4gbmV3IFNhZmVCYWcoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMuc2FmZUJhZ3MsIG8gPT4gby50b1NjaGVtYSgpKVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHNhZmVCYWdzOiBBcnJheS5mcm9tKHRoaXMuc2FmZUJhZ3MsIG8gPT4gby50b0pTT04oKSlcbiAgICAgICAgfTtcbiAgICB9XG59XG5TYWZlQ29udGVudHMuQ0xBU1NfTkFNRSA9IFwiU2FmZUNvbnRlbnRzXCI7XG5cbmNvbnN0IE9USEVSX0NFUlRfRk9STUFUID0gXCJvdGhlckNlcnRGb3JtYXRcIjtcbmNvbnN0IE9USEVSX0NFUlQgPSBcIm90aGVyQ2VydFwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkSCA9IFtcbiAgICBPVEhFUl9DRVJUX0ZPUk1BVCxcbiAgICBPVEhFUl9DRVJUXG5dO1xuY2xhc3MgT3RoZXJDZXJ0aWZpY2F0ZUZvcm1hdCBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMub3RoZXJDZXJ0Rm9ybWF0ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgT1RIRVJfQ0VSVF9GT1JNQVQsIE90aGVyQ2VydGlmaWNhdGVGb3JtYXQuZGVmYXVsdFZhbHVlcyhPVEhFUl9DRVJUX0ZPUk1BVCkpO1xuICAgICAgICB0aGlzLm90aGVyQ2VydCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE9USEVSX0NFUlQsIE90aGVyQ2VydGlmaWNhdGVGb3JtYXQuZGVmYXVsdFZhbHVlcyhPVEhFUl9DRVJUKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBPVEhFUl9DRVJUX0ZPUk1BVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfU1RSSU5HO1xuICAgICAgICAgICAgY2FzZSBPVEhFUl9DRVJUOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkFueSgpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyBuYW1lOiAobmFtZXMub3RoZXJDZXJ0Rm9ybWF0IHx8IE9USEVSX0NFUlRfRk9STUFUKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkFueSh7IG5hbWU6IChuYW1lcy5vdGhlckNlcnQgfHwgT1RIRVJfQ0VSVCkgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRIKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBPdGhlckNlcnRpZmljYXRlRm9ybWF0LnNjaGVtYSgpKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5vdGhlckNlcnRGb3JtYXQgPSBhc24xLnJlc3VsdC5vdGhlckNlcnRGb3JtYXQudmFsdWVCbG9jay50b1N0cmluZygpO1xuICAgICAgICB0aGlzLm90aGVyQ2VydCA9IGFzbjEucmVzdWx0Lm90aGVyQ2VydDtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLm90aGVyQ2VydEZvcm1hdCB9KSxcbiAgICAgICAgICAgICAgICB0aGlzLm90aGVyQ2VydFxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgICAgb3RoZXJDZXJ0Rm9ybWF0OiB0aGlzLm90aGVyQ2VydEZvcm1hdFxuICAgICAgICB9O1xuICAgICAgICBpZiAoISh0aGlzLm90aGVyQ2VydCBpbnN0YW5jZW9mIGFzbjFqcy5BbnkpKSB7XG4gICAgICAgICAgICByZXMub3RoZXJDZXJ0ID0gdGhpcy5vdGhlckNlcnQudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5cbmNvbnN0IENFUlRJRklDQVRFUyQxID0gXCJjZXJ0aWZpY2F0ZXNcIjtcbmNvbnN0IENMRUFSX1BST1BTJEcgPSBbXG4gICAgQ0VSVElGSUNBVEVTJDEsXG5dO1xuY2xhc3MgQ2VydGlmaWNhdGVTZXQgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmNlcnRpZmljYXRlcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIENFUlRJRklDQVRFUyQxLCBDZXJ0aWZpY2F0ZVNldC5kZWZhdWx0VmFsdWVzKENFUlRJRklDQVRFUyQxKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBDRVJUSUZJQ0FURVMkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXQoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmNlcnRpZmljYXRlcyB8fCBDRVJUSUZJQ0FURVMkMSksXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBuZXcgYXNuMWpzLkNob2ljZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIENlcnRpZmljYXRlLnNjaGVtYSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5BbnkoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlNlcXVlbmNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IEF0dHJpYnV0ZUNlcnRpZmljYXRlVjIuc2NoZW1hKCkudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogM1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogT3RoZXJDZXJ0aWZpY2F0ZUZvcm1hdC5zY2hlbWEoKS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJEcpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIENlcnRpZmljYXRlU2V0LnNjaGVtYSgpKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5jZXJ0aWZpY2F0ZXMgPSBBcnJheS5mcm9tKGFzbjEucmVzdWx0LmNlcnRpZmljYXRlcyB8fCBbXSwgKGVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGluaXRpYWxUYWdOdW1iZXIgPSBlbGVtZW50LmlkQmxvY2sudGFnTnVtYmVyO1xuICAgICAgICAgICAgaWYgKGVsZW1lbnQuaWRCbG9jay50YWdDbGFzcyA9PT0gMSlcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENlcnRpZmljYXRlKHsgc2NoZW1hOiBlbGVtZW50IH0pO1xuICAgICAgICAgICAgY29uc3QgZWxlbWVudFNlcXVlbmNlID0gbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgdmFsdWU6IGVsZW1lbnQudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzd2l0Y2ggKGluaXRpYWxUYWdOdW1iZXIpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50U2VxdWVuY2UudmFsdWVCbG9jay52YWx1ZVswXS52YWx1ZUJsb2NrLnZhbHVlWzBdLnZhbHVlQmxvY2sudmFsdWVEZWMgPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXR0cmlidXRlQ2VydGlmaWNhdGVWMih7IHNjaGVtYTogZWxlbWVudFNlcXVlbmNlIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZVYxKHsgc2NoZW1hOiBlbGVtZW50U2VxdWVuY2UgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXR0cmlidXRlQ2VydGlmaWNhdGVWMih7IHNjaGVtYTogZWxlbWVudFNlcXVlbmNlIH0pO1xuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBPdGhlckNlcnRpZmljYXRlRm9ybWF0KHsgc2NoZW1hOiBlbGVtZW50U2VxdWVuY2UgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudDtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2V0KHtcbiAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMuY2VydGlmaWNhdGVzLCBlbGVtZW50ID0+IHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAoZWxlbWVudCBpbnN0YW5jZW9mIENlcnRpZmljYXRlKTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50LnRvU2NoZW1hKCk7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgKGVsZW1lbnQgaW5zdGFuY2VvZiBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZVYxKTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBlbGVtZW50LnRvU2NoZW1hKCkudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgKGVsZW1lbnQgaW5zdGFuY2VvZiBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZVYyKTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBlbGVtZW50LnRvU2NoZW1hKCkudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgKGVsZW1lbnQgaW5zdGFuY2VvZiBPdGhlckNlcnRpZmljYXRlRm9ybWF0KTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBlbGVtZW50LnRvU2NoZW1hKCkudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50LnRvU2NoZW1hKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNlcnRpZmljYXRlczogQXJyYXkuZnJvbSh0aGlzLmNlcnRpZmljYXRlcywgbyA9PiBvLnRvSlNPTigpKVxuICAgICAgICB9O1xuICAgIH1cbn1cbkNlcnRpZmljYXRlU2V0LkNMQVNTX05BTUUgPSBcIkNlcnRpZmljYXRlU2V0XCI7XG5cbmNvbnN0IE9USEVSX1JFVl9JTkZPX0ZPUk1BVCA9IFwib3RoZXJSZXZJbmZvRm9ybWF0XCI7XG5jb25zdCBPVEhFUl9SRVZfSU5GTyA9IFwib3RoZXJSZXZJbmZvXCI7XG5jb25zdCBDTEVBUl9QUk9QUyRGID0gW1xuICAgIE9USEVSX1JFVl9JTkZPX0ZPUk1BVCxcbiAgICBPVEhFUl9SRVZfSU5GT1xuXTtcbmNsYXNzIE90aGVyUmV2b2NhdGlvbkluZm9Gb3JtYXQgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLm90aGVyUmV2SW5mb0Zvcm1hdCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE9USEVSX1JFVl9JTkZPX0ZPUk1BVCwgT3RoZXJSZXZvY2F0aW9uSW5mb0Zvcm1hdC5kZWZhdWx0VmFsdWVzKE9USEVSX1JFVl9JTkZPX0ZPUk1BVCkpO1xuICAgICAgICB0aGlzLm90aGVyUmV2SW5mbyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE9USEVSX1JFVl9JTkZPLCBPdGhlclJldm9jYXRpb25JbmZvRm9ybWF0LmRlZmF1bHRWYWx1ZXMoT1RIRVJfUkVWX0lORk8pKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIE9USEVSX1JFVl9JTkZPX0ZPUk1BVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfU1RSSU5HO1xuICAgICAgICAgICAgY2FzZSBPVEhFUl9SRVZfSU5GTzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5BbnkoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgbmFtZTogKG5hbWVzLm90aGVyUmV2SW5mb0Zvcm1hdCB8fCBPVEhFUl9SRVZfSU5GT19GT1JNQVQpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQW55KHsgbmFtZTogKG5hbWVzLm90aGVyUmV2SW5mbyB8fCBPVEhFUl9SRVZfSU5GTykgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRGKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBPdGhlclJldm9jYXRpb25JbmZvRm9ybWF0LnNjaGVtYSgpKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5vdGhlclJldkluZm9Gb3JtYXQgPSBhc24xLnJlc3VsdC5vdGhlclJldkluZm9Gb3JtYXQudmFsdWVCbG9jay50b1N0cmluZygpO1xuICAgICAgICB0aGlzLm90aGVyUmV2SW5mbyA9IGFzbjEucmVzdWx0Lm90aGVyUmV2SW5mbztcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLm90aGVyUmV2SW5mb0Zvcm1hdCB9KSxcbiAgICAgICAgICAgICAgICB0aGlzLm90aGVyUmV2SW5mb1xuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgICAgb3RoZXJSZXZJbmZvRm9ybWF0OiB0aGlzLm90aGVyUmV2SW5mb0Zvcm1hdFxuICAgICAgICB9O1xuICAgICAgICBpZiAoISh0aGlzLm90aGVyUmV2SW5mbyBpbnN0YW5jZW9mIGFzbjFqcy5BbnkpKSB7XG4gICAgICAgICAgICByZXMub3RoZXJSZXZJbmZvID0gdGhpcy5vdGhlclJldkluZm8udG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5PdGhlclJldm9jYXRpb25JbmZvRm9ybWF0LkNMQVNTX05BTUUgPSBcIk90aGVyUmV2b2NhdGlvbkluZm9Gb3JtYXRcIjtcblxuY29uc3QgQ1JMUyQzID0gXCJjcmxzXCI7XG5jb25zdCBPVEhFUl9SRVZPQ0FUSU9OX0lORk9TID0gXCJvdGhlclJldm9jYXRpb25JbmZvc1wiO1xuY29uc3QgQ0xFQVJfUFJPUFMkRSA9IFtcbiAgICBDUkxTJDNcbl07XG5jbGFzcyBSZXZvY2F0aW9uSW5mb0Nob2ljZXMgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmNybHMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBDUkxTJDMsIFJldm9jYXRpb25JbmZvQ2hvaWNlcy5kZWZhdWx0VmFsdWVzKENSTFMkMykpO1xuICAgICAgICB0aGlzLm90aGVyUmV2b2NhdGlvbkluZm9zID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgT1RIRVJfUkVWT0NBVElPTl9JTkZPUywgUmV2b2NhdGlvbkluZm9DaG9pY2VzLmRlZmF1bHRWYWx1ZXMoT1RIRVJfUkVWT0NBVElPTl9JTkZPUykpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgQ1JMUyQzOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGNhc2UgT1RIRVJfUkVWT0NBVElPTl9JTkZPUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXQoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmNybHMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IG5ldyBhc24xanMuQ2hvaWNlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdC5zY2hlbWEoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcigpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5BbnkoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJEUpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFJldm9jYXRpb25JbmZvQ2hvaWNlcy5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBjcmxzOiBDUkxTJDNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICBpZiAoYXNuMS5yZXN1bHQuY3Jscykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBlbGVtZW50IG9mIGFzbjEucmVzdWx0LmNybHMpIHtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC5pZEJsb2NrLnRhZ0NsYXNzID09PSAxKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNybHMucHVzaChuZXcgQ2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdCh7IHNjaGVtYTogZWxlbWVudCB9KSk7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICB0aGlzLm90aGVyUmV2b2NhdGlvbkluZm9zLnB1c2gobmV3IE90aGVyUmV2b2NhdGlvbkluZm9Gb3JtYXQoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKC4uLkFycmF5LmZyb20odGhpcy5jcmxzLCBvID0+IG8udG9TY2hlbWEoKSkpO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKC4uLkFycmF5LmZyb20odGhpcy5vdGhlclJldm9jYXRpb25JbmZvcywgZWxlbWVudCA9PiB7XG4gICAgICAgICAgICBjb25zdCBzY2hlbWEgPSBlbGVtZW50LnRvU2NoZW1hKCk7XG4gICAgICAgICAgICBzY2hlbWEuaWRCbG9jay50YWdDbGFzcyA9IDM7XG4gICAgICAgICAgICBzY2hlbWEuaWRCbG9jay50YWdOdW1iZXIgPSAxO1xuICAgICAgICAgICAgcmV0dXJuIHNjaGVtYTtcbiAgICAgICAgfSkpO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2V0KHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNybHM6IEFycmF5LmZyb20odGhpcy5jcmxzLCBvID0+IG8udG9KU09OKCkpLFxuICAgICAgICAgICAgb3RoZXJSZXZvY2F0aW9uSW5mb3M6IEFycmF5LmZyb20odGhpcy5vdGhlclJldm9jYXRpb25JbmZvcywgbyA9PiBvLnRvSlNPTigpKVxuICAgICAgICB9O1xuICAgIH1cbn1cblJldm9jYXRpb25JbmZvQ2hvaWNlcy5DTEFTU19OQU1FID0gXCJSZXZvY2F0aW9uSW5mb0Nob2ljZXNcIjtcblxuY29uc3QgQ0VSVFMkMyA9IFwiY2VydHNcIjtcbmNvbnN0IENSTFMkMiA9IFwiY3Jsc1wiO1xuY29uc3QgQ0xFQVJfUFJPUFMkRCA9IFtcbiAgICBDRVJUUyQzLFxuICAgIENSTFMkMixcbl07XG5jbGFzcyBPcmlnaW5hdG9ySW5mbyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuY3JscyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIENSTFMkMiwgT3JpZ2luYXRvckluZm8uZGVmYXVsdFZhbHVlcyhDUkxTJDIpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIENFUlRTJDM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDZXJ0aWZpY2F0ZVNldCgpO1xuICAgICAgICAgICAgY2FzZSBDUkxTJDI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBSZXZvY2F0aW9uSW5mb0Nob2ljZXMoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgQ0VSVFMkMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmNlcnRpZmljYXRlcy5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgY2FzZSBDUkxTJDI6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgobWVtYmVyVmFsdWUuY3Jscy5sZW5ndGggPT09IDApICYmIChtZW1iZXJWYWx1ZS5vdGhlclJldm9jYXRpb25JbmZvcy5sZW5ndGggPT09IDApKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5jZXJ0cyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IENlcnRpZmljYXRlU2V0LnNjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmNybHMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBSZXZvY2F0aW9uSW5mb0Nob2ljZXMuc2NoZW1hKCkudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkRCk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgT3JpZ2luYXRvckluZm8uc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgY2VydHM6IENFUlRTJDMsXG4gICAgICAgICAgICAgICAgY3JsczogQ1JMUyQyXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgaWYgKENFUlRTJDMgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHRoaXMuY2VydHMgPSBuZXcgQ2VydGlmaWNhdGVTZXQoe1xuICAgICAgICAgICAgICAgIHNjaGVtYTogbmV3IGFzbjFqcy5TZXQoe1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogYXNuMS5yZXN1bHQuY2VydHMudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoQ1JMUyQyIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLmNybHMgPSBuZXcgUmV2b2NhdGlvbkluZm9DaG9pY2VzKHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IG5ldyBhc24xanMuU2V0KHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGFzbjEucmVzdWx0LmNybHMudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgc2VxdWVuY2VWYWx1ZSA9IFtdO1xuICAgICAgICBpZiAodGhpcy5jZXJ0cykge1xuICAgICAgICAgICAgc2VxdWVuY2VWYWx1ZS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuY2VydHMudG9TY2hlbWEoKS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY3Jscykge1xuICAgICAgICAgICAgc2VxdWVuY2VWYWx1ZS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuY3Jscy50b1NjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IHNlcXVlbmNlVmFsdWVcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHt9O1xuICAgICAgICBpZiAodGhpcy5jZXJ0cykge1xuICAgICAgICAgICAgcmVzLmNlcnRzID0gdGhpcy5jZXJ0cy50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jcmxzKSB7XG4gICAgICAgICAgICByZXMuY3JscyA9IHRoaXMuY3Jscy50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbn1cbk9yaWdpbmF0b3JJbmZvLkNMQVNTX05BTUUgPSBcIk9yaWdpbmF0b3JJbmZvXCI7XG5cbmNvbnN0IElTU1VFUiA9IFwiaXNzdWVyXCI7XG5jb25zdCBTRVJJQUxfTlVNQkVSJDIgPSBcInNlcmlhbE51bWJlclwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkQyA9IFtcbiAgICBJU1NVRVIsXG4gICAgU0VSSUFMX05VTUJFUiQyLFxuXTtcbmNsYXNzIElzc3VlckFuZFNlcmlhbE51bWJlciBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuaXNzdWVyID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgSVNTVUVSLCBJc3N1ZXJBbmRTZXJpYWxOdW1iZXIuZGVmYXVsdFZhbHVlcyhJU1NVRVIpKTtcbiAgICAgICAgdGhpcy5zZXJpYWxOdW1iZXIgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTRVJJQUxfTlVNQkVSJDIsIElzc3VlckFuZFNlcmlhbE51bWJlci5kZWZhdWx0VmFsdWVzKFNFUklBTF9OVU1CRVIkMikpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgSVNTVUVSOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZXMoKTtcbiAgICAgICAgICAgIGNhc2UgU0VSSUFMX05VTUJFUiQyOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkludGVnZXIoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZXMuc2NoZW1hKG5hbWVzLmlzc3VlciB8fCB7fSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLnNlcmlhbE51bWJlciB8fCBFTVBUWV9TVFJJTkcpIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkQyk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgSXNzdWVyQW5kU2VyaWFsTnVtYmVyLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGlzc3Vlcjoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBJU1NVRVJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc2VyaWFsTnVtYmVyOiBTRVJJQUxfTlVNQkVSJDJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmlzc3VlciA9IG5ldyBSZWxhdGl2ZURpc3Rpbmd1aXNoZWROYW1lcyh7IHNjaGVtYTogYXNuMS5yZXN1bHQuaXNzdWVyIH0pO1xuICAgICAgICB0aGlzLnNlcmlhbE51bWJlciA9IGFzbjEucmVzdWx0LnNlcmlhbE51bWJlcjtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIHRoaXMuaXNzdWVyLnRvU2NoZW1hKCksXG4gICAgICAgICAgICAgICAgdGhpcy5zZXJpYWxOdW1iZXJcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpc3N1ZXI6IHRoaXMuaXNzdWVyLnRvSlNPTigpLFxuICAgICAgICAgICAgc2VyaWFsTnVtYmVyOiB0aGlzLnNlcmlhbE51bWJlci50b0pTT04oKSxcbiAgICAgICAgfTtcbiAgICB9XG59XG5Jc3N1ZXJBbmRTZXJpYWxOdW1iZXIuQ0xBU1NfTkFNRSA9IFwiSXNzdWVyQW5kU2VyaWFsTnVtYmVyXCI7XG5cbmNvbnN0IFZBUklBTlQkMyA9IFwidmFyaWFudFwiO1xuY29uc3QgVkFMVUUkMyA9IFwidmFsdWVcIjtcbmNvbnN0IENMRUFSX1BST1BTJEIgPSBbXG4gICAgXCJibG9ja05hbWVcIlxuXTtcbmNsYXNzIFJlY2lwaWVudElkZW50aWZpZXIgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnZhcmlhbnQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBWQVJJQU5UJDMsIFJlY2lwaWVudElkZW50aWZpZXIuZGVmYXVsdFZhbHVlcyhWQVJJQU5UJDMpKTtcbiAgICAgICAgaWYgKFZBTFVFJDMgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZBTFVFJDMsIFJlY2lwaWVudElkZW50aWZpZXIuZGVmYXVsdFZhbHVlcyhWQUxVRSQzKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFZBUklBTlQkMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKC0xKTtcbiAgICAgICAgICAgIGNhc2UgVkFMVUUkMzpcbiAgICAgICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFZBUklBTlQkMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlID09PSAoLTEpKTtcbiAgICAgICAgICAgIGNhc2UgVkFMVUUkMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKE9iamVjdC5rZXlzKG1lbWJlclZhbHVlKS5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuQ2hvaWNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgSXNzdWVyQW5kU2VyaWFsTnVtYmVyLnNjaGVtYSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJEIpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFJlY2lwaWVudElkZW50aWZpZXIuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBcImJsb2NrTmFtZVwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgaWYgKGFzbjEucmVzdWx0LmJsb2NrTmFtZS5pZEJsb2NrLnRhZ0NsYXNzID09PSAxKSB7XG4gICAgICAgICAgICB0aGlzLnZhcmlhbnQgPSAxO1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IG5ldyBJc3N1ZXJBbmRTZXJpYWxOdW1iZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0LmJsb2NrTmFtZSB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMudmFyaWFudCA9IDI7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiBhc24xLnJlc3VsdC5ibG9ja05hbWUudmFsdWVCbG9jay52YWx1ZUhleCB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgc3dpdGNoICh0aGlzLnZhcmlhbnQpIHtcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICBpZiAoISh0aGlzLnZhbHVlIGluc3RhbmNlb2YgSXNzdWVyQW5kU2VyaWFsTnVtYmVyKSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbmNvcnJlY3QgdHlwZSBvZiBSZWNpcGllbnRJZGVudGlmaWVyLnZhbHVlLiBJdCBzaG91bGQgYmUgSXNzdWVyQW5kU2VyaWFsTnVtYmVyLlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudmFsdWUudG9TY2hlbWEoKTtcbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICBpZiAoISh0aGlzLnZhbHVlIGluc3RhbmNlb2YgYXNuMWpzLk9jdGV0U3RyaW5nKSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbmNvcnJlY3QgdHlwZSBvZiBSZWNpcGllbnRJZGVudGlmaWVyLnZhbHVlLiBJdCBzaG91bGQgYmUgQVNOLjEgT2N0ZXRTdHJpbmcuXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZUhleDogdGhpcy52YWx1ZS52YWx1ZUJsb2NrLnZhbHVlSGV4Vmlld1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5BbnkoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICAgIHZhcmlhbnQ6IHRoaXMudmFyaWFudFxuICAgICAgICB9O1xuICAgICAgICBpZiAoKHRoaXMudmFyaWFudCA9PT0gMSB8fCB0aGlzLnZhcmlhbnQgPT09IDIpICYmIHRoaXMudmFsdWUpIHtcbiAgICAgICAgICAgIHJlcy52YWx1ZSA9IHRoaXMudmFsdWUudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5SZWNpcGllbnRJZGVudGlmaWVyLkNMQVNTX05BTUUgPSBcIlJlY2lwaWVudElkZW50aWZpZXJcIjtcblxuY29uc3QgVkVSU0lPTiRjID0gXCJ2ZXJzaW9uXCI7XG5jb25zdCBSSUQkMSA9IFwicmlkXCI7XG5jb25zdCBLRVlfRU5DUllQVElPTl9BTEdPUklUSE0kMyA9IFwia2V5RW5jcnlwdGlvbkFsZ29yaXRobVwiO1xuY29uc3QgRU5DUllQVEVEX0tFWSQzID0gXCJlbmNyeXB0ZWRLZXlcIjtcbmNvbnN0IFJFQ0lQSUVOVF9DRVJUSUZJQ0FURSQxID0gXCJyZWNpcGllbnRDZXJ0aWZpY2F0ZVwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkQSA9IFtcbiAgICBWRVJTSU9OJGMsXG4gICAgUklEJDEsXG4gICAgS0VZX0VOQ1JZUFRJT05fQUxHT1JJVEhNJDMsXG4gICAgRU5DUllQVEVEX0tFWSQzLFxuXTtcbmNsYXNzIEtleVRyYW5zUmVjaXBpZW50SW5mbyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZFUlNJT04kYywgS2V5VHJhbnNSZWNpcGllbnRJbmZvLmRlZmF1bHRWYWx1ZXMoVkVSU0lPTiRjKSk7XG4gICAgICAgIHRoaXMucmlkID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUklEJDEsIEtleVRyYW5zUmVjaXBpZW50SW5mby5kZWZhdWx0VmFsdWVzKFJJRCQxKSk7XG4gICAgICAgIHRoaXMua2V5RW5jcnlwdGlvbkFsZ29yaXRobSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEtFWV9FTkNSWVBUSU9OX0FMR09SSVRITSQzLCBLZXlUcmFuc1JlY2lwaWVudEluZm8uZGVmYXVsdFZhbHVlcyhLRVlfRU5DUllQVElPTl9BTEdPUklUSE0kMykpO1xuICAgICAgICB0aGlzLmVuY3J5cHRlZEtleSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEVOQ1JZUFRFRF9LRVkkMywgS2V5VHJhbnNSZWNpcGllbnRJbmZvLmRlZmF1bHRWYWx1ZXMoRU5DUllQVEVEX0tFWSQzKSk7XG4gICAgICAgIHRoaXMucmVjaXBpZW50Q2VydGlmaWNhdGUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBSRUNJUElFTlRfQ0VSVElGSUNBVEUkMSwgS2V5VHJhbnNSZWNpcGllbnRJbmZvLmRlZmF1bHRWYWx1ZXMoUkVDSVBJRU5UX0NFUlRJRklDQVRFJDEpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFZFUlNJT04kYzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKC0xKTtcbiAgICAgICAgICAgIGNhc2UgUklEJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICAgICAgY2FzZSBLRVlfRU5DUllQVElPTl9BTEdPUklUSE0kMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgRU5DUllQVEVEX0tFWSQzOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKCk7XG4gICAgICAgICAgICBjYXNlIFJFQ0lQSUVOVF9DRVJUSUZJQ0FURSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ2VydGlmaWNhdGUoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkVSU0lPTiRjOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgPT09IEtleVRyYW5zUmVjaXBpZW50SW5mby5kZWZhdWx0VmFsdWVzKFZFUlNJT04kYykpO1xuICAgICAgICAgICAgY2FzZSBSSUQkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKE9iamVjdC5rZXlzKG1lbWJlclZhbHVlKS5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgY2FzZSBLRVlfRU5DUllQVElPTl9BTEdPUklUSE0kMzpcbiAgICAgICAgICAgIGNhc2UgRU5DUllQVEVEX0tFWSQzOlxuICAgICAgICAgICAgICAgIHJldHVybiBtZW1iZXJWYWx1ZS5pc0VxdWFsKEtleVRyYW5zUmVjaXBpZW50SW5mby5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKTtcbiAgICAgICAgICAgIGNhc2UgUkVDSVBJRU5UX0NFUlRJRklDQVRFJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMudmVyc2lvbiB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIFJlY2lwaWVudElkZW50aWZpZXIuc2NoZW1hKG5hbWVzLnJpZCB8fCB7fSksXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMua2V5RW5jcnlwdGlvbkFsZ29yaXRobSB8fCB7fSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IG5hbWU6IChuYW1lcy5lbmNyeXB0ZWRLZXkgfHwgRU1QVFlfU1RSSU5HKSB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJEEpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIEtleVRyYW5zUmVjaXBpZW50SW5mby5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBWRVJTSU9OJGMsXG4gICAgICAgICAgICAgICAgcmlkOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFJJRCQxXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGtleUVuY3J5cHRpb25BbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogS0VZX0VOQ1JZUFRJT05fQUxHT1JJVEhNJDNcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZW5jcnlwdGVkS2V5OiBFTkNSWVBURURfS0VZJDNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLnZlcnNpb24gPSBhc24xLnJlc3VsdC52ZXJzaW9uLnZhbHVlQmxvY2sudmFsdWVEZWM7XG4gICAgICAgIGlmIChhc24xLnJlc3VsdC5yaWQuaWRCbG9jay50YWdDbGFzcyA9PT0gMykge1xuICAgICAgICAgICAgdGhpcy5yaWQgPSBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgdmFsdWVIZXg6IGFzbjEucmVzdWx0LnJpZC52YWx1ZUJsb2NrLnZhbHVlSGV4IH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5yaWQgPSBuZXcgSXNzdWVyQW5kU2VyaWFsTnVtYmVyKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5yaWQgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0LmtleUVuY3J5cHRpb25BbGdvcml0aG0gfSk7XG4gICAgICAgIHRoaXMuZW5jcnlwdGVkS2V5ID0gYXNuMS5yZXN1bHQuZW5jcnlwdGVkS2V5O1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgaWYgKHRoaXMucmlkIGluc3RhbmNlb2YgSXNzdWVyQW5kU2VyaWFsTnVtYmVyKSB7XG4gICAgICAgICAgICB0aGlzLnZlcnNpb24gPSAwO1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy52ZXJzaW9uIH0pKTtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5yaWQudG9TY2hlbWEoKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnZlcnNpb24gPSAyO1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy52ZXJzaW9uIH0pKTtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWVIZXg6IHRoaXMucmlkLnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLmtleUVuY3J5cHRpb25BbGdvcml0aG0udG9TY2hlbWEoKSk7XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5lbmNyeXB0ZWRLZXkpO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdmVyc2lvbjogdGhpcy52ZXJzaW9uLFxuICAgICAgICAgICAgcmlkOiB0aGlzLnJpZC50b0pTT04oKSxcbiAgICAgICAgICAgIGtleUVuY3J5cHRpb25BbGdvcml0aG06IHRoaXMua2V5RW5jcnlwdGlvbkFsZ29yaXRobS50b0pTT04oKSxcbiAgICAgICAgICAgIGVuY3J5cHRlZEtleTogdGhpcy5lbmNyeXB0ZWRLZXkudG9KU09OKCksXG4gICAgICAgIH07XG4gICAgfVxufVxuS2V5VHJhbnNSZWNpcGllbnRJbmZvLkNMQVNTX05BTUUgPSBcIktleVRyYW5zUmVjaXBpZW50SW5mb1wiO1xuXG5jb25zdCBBTEdPUklUSE0gPSBcImFsZ29yaXRobVwiO1xuY29uc3QgUFVCTElDX0tFWSA9IFwicHVibGljS2V5XCI7XG5jb25zdCBDTEVBUl9QUk9QUyR6ID0gW1xuICAgIEFMR09SSVRITSxcbiAgICBQVUJMSUNfS0VZXG5dO1xuY2xhc3MgT3JpZ2luYXRvclB1YmxpY0tleSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuYWxnb3JpdGhtID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQUxHT1JJVEhNLCBPcmlnaW5hdG9yUHVibGljS2V5LmRlZmF1bHRWYWx1ZXMoQUxHT1JJVEhNKSk7XG4gICAgICAgIHRoaXMucHVibGljS2V5ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUFVCTElDX0tFWSwgT3JpZ2luYXRvclB1YmxpY0tleS5kZWZhdWx0VmFsdWVzKFBVQkxJQ19LRVkpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIEFMR09SSVRITTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgUFVCTElDX0tFWTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5CaXRTdHJpbmcoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgQUxHT1JJVEhNOlxuICAgICAgICAgICAgY2FzZSBQVUJMSUNfS0VZOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUuaXNFcXVhbChPcmlnaW5hdG9yUHVibGljS2V5LmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkpKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMuYWxnb3JpdGhtIHx8IHt9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkJpdFN0cmluZyh7IG5hbWU6IChuYW1lcy5wdWJsaWNLZXkgfHwgRU1QVFlfU1RSSU5HKSB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJHopO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIE9yaWdpbmF0b3JQdWJsaWNLZXkuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IEFMR09SSVRITVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBwdWJsaWNLZXk6IFBVQkxJQ19LRVlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmFsZ29yaXRobSA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5hbGdvcml0aG0gfSk7XG4gICAgICAgIHRoaXMucHVibGljS2V5ID0gYXNuMS5yZXN1bHQucHVibGljS2V5O1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgdGhpcy5hbGdvcml0aG0udG9TY2hlbWEoKSxcbiAgICAgICAgICAgICAgICB0aGlzLnB1YmxpY0tleVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGFsZ29yaXRobTogdGhpcy5hbGdvcml0aG0udG9KU09OKCksXG4gICAgICAgICAgICBwdWJsaWNLZXk6IHRoaXMucHVibGljS2V5LnRvSlNPTigpLFxuICAgICAgICB9O1xuICAgIH1cbn1cbk9yaWdpbmF0b3JQdWJsaWNLZXkuQ0xBU1NfTkFNRSA9IFwiT3JpZ2luYXRvclB1YmxpY0tleVwiO1xuXG5jb25zdCBWQVJJQU5UJDIgPSBcInZhcmlhbnRcIjtcbmNvbnN0IFZBTFVFJDIgPSBcInZhbHVlXCI7XG5jb25zdCBDTEVBUl9QUk9QUyR5ID0gW1xuICAgIFwiYmxvY2tOYW1lXCIsXG5dO1xuY2xhc3MgT3JpZ2luYXRvcklkZW50aWZpZXJPcktleSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudmFyaWFudCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZBUklBTlQkMiwgT3JpZ2luYXRvcklkZW50aWZpZXJPcktleS5kZWZhdWx0VmFsdWVzKFZBUklBTlQkMikpO1xuICAgICAgICBpZiAoVkFMVUUkMiBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVkFMVUUkMiwgT3JpZ2luYXRvcklkZW50aWZpZXJPcktleS5kZWZhdWx0VmFsdWVzKFZBTFVFJDIpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkFSSUFOVCQyOlxuICAgICAgICAgICAgICAgIHJldHVybiAoLTEpO1xuICAgICAgICAgICAgY2FzZSBWQUxVRSQyOlxuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkFSSUFOVCQyOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgPT09ICgtMSkpO1xuICAgICAgICAgICAgY2FzZSBWQUxVRSQyOlxuICAgICAgICAgICAgICAgIHJldHVybiAoT2JqZWN0LmtleXMobWVtYmVyVmFsdWUpLmxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5DaG9pY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBJc3N1ZXJBbmRTZXJpYWxOdW1iZXIuc2NoZW1hKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBPcmlnaW5hdG9yUHVibGljS2V5LnNjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJHkpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIE9yaWdpbmF0b3JJZGVudGlmaWVyT3JLZXkuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBcImJsb2NrTmFtZVwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgaWYgKGFzbjEucmVzdWx0LmJsb2NrTmFtZS5pZEJsb2NrLnRhZ0NsYXNzID09PSAxKSB7XG4gICAgICAgICAgICB0aGlzLnZhcmlhbnQgPSAxO1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IG5ldyBJc3N1ZXJBbmRTZXJpYWxOdW1iZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0LmJsb2NrTmFtZSB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChhc24xLnJlc3VsdC5ibG9ja05hbWUuaWRCbG9jay50YWdOdW1iZXIgPT09IDApIHtcbiAgICAgICAgICAgICAgICBhc24xLnJlc3VsdC5ibG9ja05hbWUuaWRCbG9jay50YWdDbGFzcyA9IDE7XG4gICAgICAgICAgICAgICAgYXNuMS5yZXN1bHQuYmxvY2tOYW1lLmlkQmxvY2sudGFnTnVtYmVyID0gNDtcbiAgICAgICAgICAgICAgICB0aGlzLnZhcmlhbnQgPSAyO1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSBhc24xLnJlc3VsdC5ibG9ja05hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZhcmlhbnQgPSAzO1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSBuZXcgT3JpZ2luYXRvclB1YmxpY0tleSh7XG4gICAgICAgICAgICAgICAgICAgIHNjaGVtYTogbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogYXNuMS5yZXN1bHQuYmxvY2tOYW1lLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgc3dpdGNoICh0aGlzLnZhcmlhbnQpIHtcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy52YWx1ZS50b1NjaGVtYSgpO1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIHRoaXMudmFsdWUuaWRCbG9jay50YWdDbGFzcyA9IDM7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZS5pZEJsb2NrLnRhZ051bWJlciA9IDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudmFsdWU7XG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBfc2NoZW1hID0gdGhpcy52YWx1ZS50b1NjaGVtYSgpO1xuICAgICAgICAgICAgICAgICAgICBfc2NoZW1hLmlkQmxvY2sudGFnQ2xhc3MgPSAzO1xuICAgICAgICAgICAgICAgICAgICBfc2NoZW1hLmlkQmxvY2sudGFnTnVtYmVyID0gMTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9zY2hlbWE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5BbnkoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICAgIHZhcmlhbnQ6IHRoaXMudmFyaWFudFxuICAgICAgICB9O1xuICAgICAgICBpZiAoKHRoaXMudmFyaWFudCA9PT0gMSkgfHwgKHRoaXMudmFyaWFudCA9PT0gMikgfHwgKHRoaXMudmFyaWFudCA9PT0gMykpIHtcbiAgICAgICAgICAgIHJlcy52YWx1ZSA9IHRoaXMudmFsdWUudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5PcmlnaW5hdG9ySWRlbnRpZmllck9yS2V5LkNMQVNTX05BTUUgPSBcIk9yaWdpbmF0b3JJZGVudGlmaWVyT3JLZXlcIjtcblxuY29uc3QgS0VZX0FUVFJfSUQgPSBcImtleUF0dHJJZFwiO1xuY29uc3QgS0VZX0FUVFIgPSBcImtleUF0dHJcIjtcbmNvbnN0IENMRUFSX1BST1BTJHggPSBbXG4gICAgS0VZX0FUVFJfSUQsXG4gICAgS0VZX0FUVFIsXG5dO1xuY2xhc3MgT3RoZXJLZXlBdHRyaWJ1dGUgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmtleUF0dHJJZCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEtFWV9BVFRSX0lELCBPdGhlcktleUF0dHJpYnV0ZS5kZWZhdWx0VmFsdWVzKEtFWV9BVFRSX0lEKSk7XG4gICAgICAgIGlmIChLRVlfQVRUUiBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLmtleUF0dHIgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBLRVlfQVRUUiwgT3RoZXJLZXlBdHRyaWJ1dGUuZGVmYXVsdFZhbHVlcyhLRVlfQVRUUikpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBLRVlfQVRUUl9JRDpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfU1RSSU5HO1xuICAgICAgICAgICAgY2FzZSBLRVlfQVRUUjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIEtFWV9BVFRSX0lEOlxuICAgICAgICAgICAgICAgIHJldHVybiAodHlwZW9mIG1lbWJlclZhbHVlID09PSBcInN0cmluZ1wiICYmIG1lbWJlclZhbHVlID09PSBFTVBUWV9TVFJJTkcpO1xuICAgICAgICAgICAgY2FzZSBLRVlfQVRUUjpcbiAgICAgICAgICAgICAgICByZXR1cm4gKE9iamVjdC5rZXlzKG1lbWJlclZhbHVlKS5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgb3B0aW9uYWw6IChuYW1lcy5vcHRpb25hbCB8fCB0cnVlKSxcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgbmFtZTogKG5hbWVzLmtleUF0dHJJZCB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQW55KHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5rZXlBdHRyIHx8IEVNUFRZX1NUUklORylcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJHgpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIE90aGVyS2V5QXR0cmlidXRlLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGtleUF0dHJJZDogS0VZX0FUVFJfSUQsXG4gICAgICAgICAgICAgICAga2V5QXR0cjogS0VZX0FUVFJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmtleUF0dHJJZCA9IGFzbjEucmVzdWx0LmtleUF0dHJJZC52YWx1ZUJsb2NrLnRvU3RyaW5nKCk7XG4gICAgICAgIGlmIChLRVlfQVRUUiBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5rZXlBdHRyID0gYXNuMS5yZXN1bHQua2V5QXR0cjtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyB2YWx1ZTogdGhpcy5rZXlBdHRySWQgfSkpO1xuICAgICAgICBpZiAoS0VZX0FUVFIgaW4gdGhpcykge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLmtleUF0dHIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXksXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICBrZXlBdHRySWQ6IHRoaXMua2V5QXR0cklkXG4gICAgICAgIH07XG4gICAgICAgIGlmIChLRVlfQVRUUiBpbiB0aGlzKSB7XG4gICAgICAgICAgICByZXMua2V5QXR0ciA9IHRoaXMua2V5QXR0ci50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbn1cbk90aGVyS2V5QXR0cmlidXRlLkNMQVNTX05BTUUgPSBcIk90aGVyS2V5QXR0cmlidXRlXCI7XG5cbmNvbnN0IFNVQkpFQ1RfS0VZX0lERU5USUZJRVIgPSBcInN1YmplY3RLZXlJZGVudGlmaWVyXCI7XG5jb25zdCBEQVRFJDEgPSBcImRhdGVcIjtcbmNvbnN0IE9USEVSJDEgPSBcIm90aGVyXCI7XG5jb25zdCBDTEVBUl9QUk9QUyR3ID0gW1xuICAgIFNVQkpFQ1RfS0VZX0lERU5USUZJRVIsXG4gICAgREFURSQxLFxuICAgIE9USEVSJDEsXG5dO1xuY2xhc3MgUmVjaXBpZW50S2V5SWRlbnRpZmllciBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuc3ViamVjdEtleUlkZW50aWZpZXIgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTVUJKRUNUX0tFWV9JREVOVElGSUVSLCBSZWNpcGllbnRLZXlJZGVudGlmaWVyLmRlZmF1bHRWYWx1ZXMoU1VCSkVDVF9LRVlfSURFTlRJRklFUikpO1xuICAgICAgICBpZiAoREFURSQxIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuZGF0ZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIERBVEUkMSwgUmVjaXBpZW50S2V5SWRlbnRpZmllci5kZWZhdWx0VmFsdWVzKERBVEUkMSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChPVEhFUiQxIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMub3RoZXIgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBPVEhFUiQxLCBSZWNpcGllbnRLZXlJZGVudGlmaWVyLmRlZmF1bHRWYWx1ZXMoT1RIRVIkMSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBTVUJKRUNUX0tFWV9JREVOVElGSUVSOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKCk7XG4gICAgICAgICAgICBjYXNlIERBVEUkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5HZW5lcmFsaXplZFRpbWUoKTtcbiAgICAgICAgICAgIGNhc2UgT1RIRVIkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IE90aGVyS2V5QXR0cmlidXRlKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFNVQkpFQ1RfS0VZX0lERU5USUZJRVI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5pc0VxdWFsKFJlY2lwaWVudEtleUlkZW50aWZpZXIuZGVmYXVsdFZhbHVlcyhTVUJKRUNUX0tFWV9JREVOVElGSUVSKSkpO1xuICAgICAgICAgICAgY2FzZSBEQVRFJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgobWVtYmVyVmFsdWUueWVhciA9PT0gMCkgJiZcbiAgICAgICAgICAgICAgICAgICAgKG1lbWJlclZhbHVlLm1vbnRoID09PSAwKSAmJlxuICAgICAgICAgICAgICAgICAgICAobWVtYmVyVmFsdWUuZGF5ID09PSAwKSAmJlxuICAgICAgICAgICAgICAgICAgICAobWVtYmVyVmFsdWUuaG91ciA9PT0gMCkgJiZcbiAgICAgICAgICAgICAgICAgICAgKG1lbWJlclZhbHVlLm1pbnV0ZSA9PT0gMCkgJiZcbiAgICAgICAgICAgICAgICAgICAgKG1lbWJlclZhbHVlLnNlY29uZCA9PT0gMCkgJiZcbiAgICAgICAgICAgICAgICAgICAgKG1lbWJlclZhbHVlLm1pbGxpc2Vjb25kID09PSAwKSk7XG4gICAgICAgICAgICBjYXNlIE9USEVSJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgobWVtYmVyVmFsdWUua2V5QXR0cklkID09PSBFTVBUWV9TVFJJTkcpICYmICgoXCJrZXlBdHRyXCIgaW4gbWVtYmVyVmFsdWUpID09PSBmYWxzZSkpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgbmFtZTogKG5hbWVzLnN1YmplY3RLZXlJZGVudGlmaWVyIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5HZW5lcmFsaXplZFRpbWUoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmRhdGUgfHwgRU1QVFlfU1RSSU5HKVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIE90aGVyS2V5QXR0cmlidXRlLnNjaGVtYShuYW1lcy5vdGhlciB8fCB7fSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyR3KTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBSZWNpcGllbnRLZXlJZGVudGlmaWVyLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIHN1YmplY3RLZXlJZGVudGlmaWVyOiBTVUJKRUNUX0tFWV9JREVOVElGSUVSLFxuICAgICAgICAgICAgICAgIGRhdGU6IERBVEUkMSxcbiAgICAgICAgICAgICAgICBvdGhlcjoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBPVEhFUiQxXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5zdWJqZWN0S2V5SWRlbnRpZmllciA9IGFzbjEucmVzdWx0LnN1YmplY3RLZXlJZGVudGlmaWVyO1xuICAgICAgICBpZiAoREFURSQxIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5kYXRlID0gYXNuMS5yZXN1bHQuZGF0ZTtcbiAgICAgICAgaWYgKE9USEVSJDEgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLm90aGVyID0gbmV3IE90aGVyS2V5QXR0cmlidXRlKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5vdGhlciB9KTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5zdWJqZWN0S2V5SWRlbnRpZmllcik7XG4gICAgICAgIGlmICh0aGlzLmRhdGUpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5kYXRlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5vdGhlcikge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLm90aGVyLnRvU2NoZW1hKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICAgIHN1YmplY3RLZXlJZGVudGlmaWVyOiB0aGlzLnN1YmplY3RLZXlJZGVudGlmaWVyLnRvSlNPTigpXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLmRhdGUpIHtcbiAgICAgICAgICAgIHJlcy5kYXRlID0gdGhpcy5kYXRlLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm90aGVyKSB7XG4gICAgICAgICAgICByZXMub3RoZXIgPSB0aGlzLm90aGVyLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxufVxuUmVjaXBpZW50S2V5SWRlbnRpZmllci5DTEFTU19OQU1FID0gXCJSZWNpcGllbnRLZXlJZGVudGlmaWVyXCI7XG5cbmNvbnN0IFZBUklBTlQkMSA9IFwidmFyaWFudFwiO1xuY29uc3QgVkFMVUUkMSA9IFwidmFsdWVcIjtcbmNvbnN0IENMRUFSX1BST1BTJHYgPSBbXG4gICAgXCJibG9ja05hbWVcIixcbl07XG5jbGFzcyBLZXlBZ3JlZVJlY2lwaWVudElkZW50aWZpZXIgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnZhcmlhbnQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBWQVJJQU5UJDEsIEtleUFncmVlUmVjaXBpZW50SWRlbnRpZmllci5kZWZhdWx0VmFsdWVzKFZBUklBTlQkMSkpO1xuICAgICAgICB0aGlzLnZhbHVlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVkFMVUUkMSwgS2V5QWdyZWVSZWNpcGllbnRJZGVudGlmaWVyLmRlZmF1bHRWYWx1ZXMoVkFMVUUkMSkpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkFSSUFOVCQxOlxuICAgICAgICAgICAgICAgIHJldHVybiAoLTEpO1xuICAgICAgICAgICAgY2FzZSBWQUxVRSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkFSSUFOVCQxOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgPT09ICgtMSkpO1xuICAgICAgICAgICAgY2FzZSBWQUxVRSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiAoT2JqZWN0LmtleXMobWVtYmVyVmFsdWUpLmxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5DaG9pY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBJc3N1ZXJBbmRTZXJpYWxOdW1iZXIuc2NoZW1hKG5hbWVzLmlzc3VlckFuZFNlcmlhbE51bWJlciB8fCB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFJlY2lwaWVudEtleUlkZW50aWZpZXIuc2NoZW1hKG5hbWVzLnJLZXlJZCB8fCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJHYpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIEtleUFncmVlUmVjaXBpZW50SWRlbnRpZmllci5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBibG9ja05hbWU6IFwiYmxvY2tOYW1lXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICBpZiAoYXNuMS5yZXN1bHQuYmxvY2tOYW1lLmlkQmxvY2sudGFnQ2xhc3MgPT09IDEpIHtcbiAgICAgICAgICAgIHRoaXMudmFyaWFudCA9IDE7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gbmV3IElzc3VlckFuZFNlcmlhbE51bWJlcih7IHNjaGVtYTogYXNuMS5yZXN1bHQuYmxvY2tOYW1lIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy52YXJpYW50ID0gMjtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSBuZXcgUmVjaXBpZW50S2V5SWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGFzbjEucmVzdWx0LmJsb2NrTmFtZS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBzd2l0Y2ggKHRoaXMudmFyaWFudCkge1xuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLnRvU2NoZW1hKCk7XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy52YWx1ZS50b1NjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuQW55KCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICB2YXJpYW50OiB0aGlzLnZhcmlhbnQsXG4gICAgICAgIH07XG4gICAgICAgIGlmICgodGhpcy52YXJpYW50ID09PSAxKSB8fCAodGhpcy52YXJpYW50ID09PSAyKSkge1xuICAgICAgICAgICAgcmVzLnZhbHVlID0gdGhpcy52YWx1ZS50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbn1cbktleUFncmVlUmVjaXBpZW50SWRlbnRpZmllci5DTEFTU19OQU1FID0gXCJLZXlBZ3JlZVJlY2lwaWVudElkZW50aWZpZXJcIjtcblxuY29uc3QgUklEID0gXCJyaWRcIjtcbmNvbnN0IEVOQ1JZUFRFRF9LRVkkMiA9IFwiZW5jcnlwdGVkS2V5XCI7XG5jb25zdCBDTEVBUl9QUk9QUyR1ID0gW1xuICAgIFJJRCxcbiAgICBFTkNSWVBURURfS0VZJDIsXG5dO1xuY2xhc3MgUmVjaXBpZW50RW5jcnlwdGVkS2V5IGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5yaWQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBSSUQsIFJlY2lwaWVudEVuY3J5cHRlZEtleS5kZWZhdWx0VmFsdWVzKFJJRCkpO1xuICAgICAgICB0aGlzLmVuY3J5cHRlZEtleSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEVOQ1JZUFRFRF9LRVkkMiwgUmVjaXBpZW50RW5jcnlwdGVkS2V5LmRlZmF1bHRWYWx1ZXMoRU5DUllQVEVEX0tFWSQyKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBSSUQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBLZXlBZ3JlZVJlY2lwaWVudElkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgRU5DUllQVEVEX0tFWSQyOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFJJRDpcbiAgICAgICAgICAgICAgICByZXR1cm4gKChtZW1iZXJWYWx1ZS52YXJpYW50ID09PSAoLTEpKSAmJiAoKFwidmFsdWVcIiBpbiBtZW1iZXJWYWx1ZSkgPT09IGZhbHNlKSk7XG4gICAgICAgICAgICBjYXNlIEVOQ1JZUFRFRF9LRVkkMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmlzRXF1YWwoUmVjaXBpZW50RW5jcnlwdGVkS2V5LmRlZmF1bHRWYWx1ZXMoRU5DUllQVEVEX0tFWSQyKSkpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBLZXlBZ3JlZVJlY2lwaWVudElkZW50aWZpZXIuc2NoZW1hKG5hbWVzLnJpZCB8fCB7fSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IG5hbWU6IChuYW1lcy5lbmNyeXB0ZWRLZXkgfHwgRU1QVFlfU1RSSU5HKSB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJHUpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFJlY2lwaWVudEVuY3J5cHRlZEtleS5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICByaWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogUklEXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVuY3J5cHRlZEtleTogRU5DUllQVEVEX0tFWSQyXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5yaWQgPSBuZXcgS2V5QWdyZWVSZWNpcGllbnRJZGVudGlmaWVyKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5yaWQgfSk7XG4gICAgICAgIHRoaXMuZW5jcnlwdGVkS2V5ID0gYXNuMS5yZXN1bHQuZW5jcnlwdGVkS2V5O1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgdGhpcy5yaWQudG9TY2hlbWEoKSxcbiAgICAgICAgICAgICAgICB0aGlzLmVuY3J5cHRlZEtleVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJpZDogdGhpcy5yaWQudG9KU09OKCksXG4gICAgICAgICAgICBlbmNyeXB0ZWRLZXk6IHRoaXMuZW5jcnlwdGVkS2V5LnRvSlNPTigpLFxuICAgICAgICB9O1xuICAgIH1cbn1cblJlY2lwaWVudEVuY3J5cHRlZEtleS5DTEFTU19OQU1FID0gXCJSZWNpcGllbnRFbmNyeXB0ZWRLZXlcIjtcblxuY29uc3QgRU5DUllQVEVEX0tFWVMgPSBcImVuY3J5cHRlZEtleXNcIjtcbmNvbnN0IFJFQ0lQSUVOVF9FTkNSWVBURURfS0VZUyA9IFwiUmVjaXBpZW50RW5jcnlwdGVkS2V5c1wiO1xuY29uc3QgQ0xFQVJfUFJPUFMkdCA9IFtcbiAgICBSRUNJUElFTlRfRU5DUllQVEVEX0tFWVMsXG5dO1xuY2xhc3MgUmVjaXBpZW50RW5jcnlwdGVkS2V5cyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuZW5jcnlwdGVkS2V5cyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEVOQ1JZUFRFRF9LRVlTLCBSZWNpcGllbnRFbmNyeXB0ZWRLZXlzLmRlZmF1bHRWYWx1ZXMoRU5DUllQVEVEX0tFWVMpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIEVOQ1JZUFRFRF9LRVlTOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgRU5DUllQVEVEX0tFWVM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLlJlY2lwaWVudEVuY3J5cHRlZEtleXMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFJlY2lwaWVudEVuY3J5cHRlZEtleS5zY2hlbWEoKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkdCk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgUmVjaXBpZW50RW5jcnlwdGVkS2V5cy5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBSZWNpcGllbnRFbmNyeXB0ZWRLZXlzOiBSRUNJUElFTlRfRU5DUllQVEVEX0tFWVNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmVuY3J5cHRlZEtleXMgPSBBcnJheS5mcm9tKGFzbjEucmVzdWx0LlJlY2lwaWVudEVuY3J5cHRlZEtleXMsIGVsZW1lbnQgPT4gbmV3IFJlY2lwaWVudEVuY3J5cHRlZEtleSh7IHNjaGVtYTogZWxlbWVudCB9KSk7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy5lbmNyeXB0ZWRLZXlzLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBlbmNyeXB0ZWRLZXlzOiBBcnJheS5mcm9tKHRoaXMuZW5jcnlwdGVkS2V5cywgbyA9PiBvLnRvSlNPTigpKVxuICAgICAgICB9O1xuICAgIH1cbn1cblJlY2lwaWVudEVuY3J5cHRlZEtleXMuQ0xBU1NfTkFNRSA9IFwiUmVjaXBpZW50RW5jcnlwdGVkS2V5c1wiO1xuXG5jb25zdCBWRVJTSU9OJGIgPSBcInZlcnNpb25cIjtcbmNvbnN0IE9SSUdJTkFUT1IgPSBcIm9yaWdpbmF0b3JcIjtcbmNvbnN0IFVLTSA9IFwidWttXCI7XG5jb25zdCBLRVlfRU5DUllQVElPTl9BTEdPUklUSE0kMiA9IFwia2V5RW5jcnlwdGlvbkFsZ29yaXRobVwiO1xuY29uc3QgUkVDSVBJRU5UX0VOQ1JZUFRFRF9LRVkgPSBcInJlY2lwaWVudEVuY3J5cHRlZEtleXNcIjtcbmNvbnN0IFJFQ0lQSUVOVF9DRVJUSUZJQ0FURSA9IFwicmVjaXBpZW50Q2VydGlmaWNhdGVcIjtcbmNvbnN0IFJFQ0lQSUVOVF9QVUJMSUNfS0VZID0gXCJyZWNpcGllbnRQdWJsaWNLZXlcIjtcbmNvbnN0IENMRUFSX1BST1BTJHMgPSBbXG4gICAgVkVSU0lPTiRiLFxuICAgIE9SSUdJTkFUT1IsXG4gICAgVUtNLFxuICAgIEtFWV9FTkNSWVBUSU9OX0FMR09SSVRITSQyLFxuICAgIFJFQ0lQSUVOVF9FTkNSWVBURURfS0VZLFxuXTtcbmNsYXNzIEtleUFncmVlUmVjaXBpZW50SW5mbyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZFUlNJT04kYiwgS2V5QWdyZWVSZWNpcGllbnRJbmZvLmRlZmF1bHRWYWx1ZXMoVkVSU0lPTiRiKSk7XG4gICAgICAgIHRoaXMub3JpZ2luYXRvciA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE9SSUdJTkFUT1IsIEtleUFncmVlUmVjaXBpZW50SW5mby5kZWZhdWx0VmFsdWVzKE9SSUdJTkFUT1IpKTtcbiAgICAgICAgaWYgKFVLTSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnVrbSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFVLTSwgS2V5QWdyZWVSZWNpcGllbnRJbmZvLmRlZmF1bHRWYWx1ZXMoVUtNKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgS0VZX0VOQ1JZUFRJT05fQUxHT1JJVEhNJDIsIEtleUFncmVlUmVjaXBpZW50SW5mby5kZWZhdWx0VmFsdWVzKEtFWV9FTkNSWVBUSU9OX0FMR09SSVRITSQyKSk7XG4gICAgICAgIHRoaXMucmVjaXBpZW50RW5jcnlwdGVkS2V5cyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFJFQ0lQSUVOVF9FTkNSWVBURURfS0VZLCBLZXlBZ3JlZVJlY2lwaWVudEluZm8uZGVmYXVsdFZhbHVlcyhSRUNJUElFTlRfRU5DUllQVEVEX0tFWSkpO1xuICAgICAgICB0aGlzLnJlY2lwaWVudENlcnRpZmljYXRlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUkVDSVBJRU5UX0NFUlRJRklDQVRFLCBLZXlBZ3JlZVJlY2lwaWVudEluZm8uZGVmYXVsdFZhbHVlcyhSRUNJUElFTlRfQ0VSVElGSUNBVEUpKTtcbiAgICAgICAgdGhpcy5yZWNpcGllbnRQdWJsaWNLZXkgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBSRUNJUElFTlRfUFVCTElDX0tFWSwgS2V5QWdyZWVSZWNpcGllbnRJbmZvLmRlZmF1bHRWYWx1ZXMoUkVDSVBJRU5UX1BVQkxJQ19LRVkpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFZFUlNJT04kYjpcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGNhc2UgT1JJR0lOQVRPUjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IE9yaWdpbmF0b3JJZGVudGlmaWVyT3JLZXkoKTtcbiAgICAgICAgICAgIGNhc2UgVUtNOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKCk7XG4gICAgICAgICAgICBjYXNlIEtFWV9FTkNSWVBUSU9OX0FMR09SSVRITSQyOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcigpO1xuICAgICAgICAgICAgY2FzZSBSRUNJUElFTlRfRU5DUllQVEVEX0tFWTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFJlY2lwaWVudEVuY3J5cHRlZEtleXMoKTtcbiAgICAgICAgICAgIGNhc2UgUkVDSVBJRU5UX0NFUlRJRklDQVRFOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ2VydGlmaWNhdGUoKTtcbiAgICAgICAgICAgIGNhc2UgUkVDSVBJRU5UX1BVQkxJQ19LRVk6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFZFUlNJT04kYjpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlID09PSAwKTtcbiAgICAgICAgICAgIGNhc2UgT1JJR0lOQVRPUjpcbiAgICAgICAgICAgICAgICByZXR1cm4gKChtZW1iZXJWYWx1ZS52YXJpYW50ID09PSAoLTEpKSAmJiAoKFwidmFsdWVcIiBpbiBtZW1iZXJWYWx1ZSkgPT09IGZhbHNlKSk7XG4gICAgICAgICAgICBjYXNlIFVLTTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmlzRXF1YWwoS2V5QWdyZWVSZWNpcGllbnRJbmZvLmRlZmF1bHRWYWx1ZXMoVUtNKSkpO1xuICAgICAgICAgICAgY2FzZSBLRVlfRU5DUllQVElPTl9BTEdPUklUSE0kMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gKChtZW1iZXJWYWx1ZS5hbGdvcml0aG1JZCA9PT0gRU1QVFlfU1RSSU5HKSAmJiAoKFwiYWxnb3JpdGhtUGFyYW1zXCIgaW4gbWVtYmVyVmFsdWUpID09PSBmYWxzZSkpO1xuICAgICAgICAgICAgY2FzZSBSRUNJUElFTlRfRU5DUllQVEVEX0tFWTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmVuY3J5cHRlZEtleXMubGVuZ3RoID09PSAwKTtcbiAgICAgICAgICAgIGNhc2UgUkVDSVBJRU5UX0NFUlRJRklDQVRFOlxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIGNhc2UgUkVDSVBJRU5UX1BVQkxJQ19LRVk6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogbmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogbmFtZXMudmVyc2lvbiB8fCBFTVBUWV9TVFJJTkcgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBPcmlnaW5hdG9ySWRlbnRpZmllck9yS2V5LnNjaGVtYShuYW1lcy5vcmlnaW5hdG9yIHx8IHt9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW25ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyBuYW1lOiBuYW1lcy51a20gfHwgRU1QVFlfU1RSSU5HIH0pXVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIEFsZ29yaXRobUlkZW50aWZpZXIuc2NoZW1hKG5hbWVzLmtleUVuY3J5cHRpb25BbGdvcml0aG0gfHwge30pLFxuICAgICAgICAgICAgICAgIFJlY2lwaWVudEVuY3J5cHRlZEtleXMuc2NoZW1hKG5hbWVzLnJlY2lwaWVudEVuY3J5cHRlZEtleXMgfHwge30pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkcyk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgS2V5QWdyZWVSZWNpcGllbnRJbmZvLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIHZlcnNpb246IFZFUlNJT04kYixcbiAgICAgICAgICAgICAgICBvcmlnaW5hdG9yOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IE9SSUdJTkFUT1JcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdWttOiBVS00sXG4gICAgICAgICAgICAgICAga2V5RW5jcnlwdGlvbkFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBLRVlfRU5DUllQVElPTl9BTEdPUklUSE0kMlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICByZWNpcGllbnRFbmNyeXB0ZWRLZXlzOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFJFQ0lQSUVOVF9FTkNSWVBURURfS0VZXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gYXNuMS5yZXN1bHQudmVyc2lvbi52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgICAgICB0aGlzLm9yaWdpbmF0b3IgPSBuZXcgT3JpZ2luYXRvcklkZW50aWZpZXJPcktleSh7IHNjaGVtYTogYXNuMS5yZXN1bHQub3JpZ2luYXRvciB9KTtcbiAgICAgICAgaWYgKFVLTSBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMudWttID0gYXNuMS5yZXN1bHQudWttO1xuICAgICAgICB0aGlzLmtleUVuY3J5cHRpb25BbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHQua2V5RW5jcnlwdGlvbkFsZ29yaXRobSB9KTtcbiAgICAgICAgdGhpcy5yZWNpcGllbnRFbmNyeXB0ZWRLZXlzID0gbmV3IFJlY2lwaWVudEVuY3J5cHRlZEtleXMoeyBzY2hlbWE6IGFzbjEucmVzdWx0LnJlY2lwaWVudEVuY3J5cHRlZEtleXMgfSk7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlOiB0aGlzLnZlcnNpb24gfSkpO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHZhbHVlOiBbdGhpcy5vcmlnaW5hdG9yLnRvU2NoZW1hKCldXG4gICAgICAgIH0pKTtcbiAgICAgICAgaWYgKHRoaXMudWttKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFt0aGlzLnVrbV1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMua2V5RW5jcnlwdGlvbkFsZ29yaXRobS50b1NjaGVtYSgpKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnJlY2lwaWVudEVuY3J5cHRlZEtleXMudG9TY2hlbWEoKSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICAgIHZlcnNpb246IHRoaXMudmVyc2lvbixcbiAgICAgICAgICAgIG9yaWdpbmF0b3I6IHRoaXMub3JpZ2luYXRvci50b0pTT04oKSxcbiAgICAgICAgICAgIGtleUVuY3J5cHRpb25BbGdvcml0aG06IHRoaXMua2V5RW5jcnlwdGlvbkFsZ29yaXRobS50b0pTT04oKSxcbiAgICAgICAgICAgIHJlY2lwaWVudEVuY3J5cHRlZEtleXM6IHRoaXMucmVjaXBpZW50RW5jcnlwdGVkS2V5cy50b0pTT04oKSxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMudWttKSB7XG4gICAgICAgICAgICByZXMudWttID0gdGhpcy51a20udG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5LZXlBZ3JlZVJlY2lwaWVudEluZm8uQ0xBU1NfTkFNRSA9IFwiS2V5QWdyZWVSZWNpcGllbnRJbmZvXCI7XG5cbmNvbnN0IEtFWV9JREVOVElGSUVSID0gXCJrZXlJZGVudGlmaWVyXCI7XG5jb25zdCBEQVRFID0gXCJkYXRlXCI7XG5jb25zdCBPVEhFUiA9IFwib3RoZXJcIjtcbmNvbnN0IENMRUFSX1BST1BTJHIgPSBbXG4gICAgS0VZX0lERU5USUZJRVIsXG4gICAgREFURSxcbiAgICBPVEhFUixcbl07XG5jbGFzcyBLRUtJZGVudGlmaWVyIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5rZXlJZGVudGlmaWVyID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgS0VZX0lERU5USUZJRVIsIEtFS0lkZW50aWZpZXIuZGVmYXVsdFZhbHVlcyhLRVlfSURFTlRJRklFUikpO1xuICAgICAgICBpZiAoREFURSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLmRhdGUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBEQVRFLCBLRUtJZGVudGlmaWVyLmRlZmF1bHRWYWx1ZXMoREFURSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChPVEhFUiBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLm90aGVyID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgT1RIRVIsIEtFS0lkZW50aWZpZXIuZGVmYXVsdFZhbHVlcyhPVEhFUikpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBLRVlfSURFTlRJRklFUjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5PY3RldFN0cmluZygpO1xuICAgICAgICAgICAgY2FzZSBEQVRFOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkdlbmVyYWxpemVkVGltZSgpO1xuICAgICAgICAgICAgY2FzZSBPVEhFUjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IE90aGVyS2V5QXR0cmlidXRlKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIEtFWV9JREVOVElGSUVSOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUuaXNFcXVhbChLRUtJZGVudGlmaWVyLmRlZmF1bHRWYWx1ZXMoS0VZX0lERU5USUZJRVIpKSk7XG4gICAgICAgICAgICBjYXNlIERBVEU6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgobWVtYmVyVmFsdWUueWVhciA9PT0gMCkgJiZcbiAgICAgICAgICAgICAgICAgICAgKG1lbWJlclZhbHVlLm1vbnRoID09PSAwKSAmJlxuICAgICAgICAgICAgICAgICAgICAobWVtYmVyVmFsdWUuZGF5ID09PSAwKSAmJlxuICAgICAgICAgICAgICAgICAgICAobWVtYmVyVmFsdWUuaG91ciA9PT0gMCkgJiZcbiAgICAgICAgICAgICAgICAgICAgKG1lbWJlclZhbHVlLm1pbnV0ZSA9PT0gMCkgJiZcbiAgICAgICAgICAgICAgICAgICAgKG1lbWJlclZhbHVlLnNlY29uZCA9PT0gMCkgJiZcbiAgICAgICAgICAgICAgICAgICAgKG1lbWJlclZhbHVlLm1pbGxpc2Vjb25kID09PSAwKSk7XG4gICAgICAgICAgICBjYXNlIE9USEVSOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKG1lbWJlclZhbHVlLmNvbXBhcmVXaXRoRGVmYXVsdChcImtleUF0dHJJZFwiLCBtZW1iZXJWYWx1ZS5rZXlBdHRySWQpKSAmJlxuICAgICAgICAgICAgICAgICAgICAoKFwia2V5QXR0clwiIGluIG1lbWJlclZhbHVlKSA9PT0gZmFsc2UpKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IG5hbWU6IChuYW1lcy5rZXlJZGVudGlmaWVyIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5HZW5lcmFsaXplZFRpbWUoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmRhdGUgfHwgRU1QVFlfU1RSSU5HKVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIE90aGVyS2V5QXR0cmlidXRlLnNjaGVtYShuYW1lcy5vdGhlciB8fCB7fSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRyKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBLRUtJZGVudGlmaWVyLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGtleUlkZW50aWZpZXI6IEtFWV9JREVOVElGSUVSLFxuICAgICAgICAgICAgICAgIGRhdGU6IERBVEUsXG4gICAgICAgICAgICAgICAgb3RoZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogT1RIRVJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmtleUlkZW50aWZpZXIgPSBhc24xLnJlc3VsdC5rZXlJZGVudGlmaWVyO1xuICAgICAgICBpZiAoREFURSBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMuZGF0ZSA9IGFzbjEucmVzdWx0LmRhdGU7XG4gICAgICAgIGlmIChPVEhFUiBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMub3RoZXIgPSBuZXcgT3RoZXJLZXlBdHRyaWJ1dGUoeyBzY2hlbWE6IGFzbjEucmVzdWx0Lm90aGVyIH0pO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLmtleUlkZW50aWZpZXIpO1xuICAgICAgICBpZiAodGhpcy5kYXRlKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMuZGF0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMub3RoZXIpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5vdGhlci50b1NjaGVtYSgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICBrZXlJZGVudGlmaWVyOiB0aGlzLmtleUlkZW50aWZpZXIudG9KU09OKClcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuZGF0ZSkge1xuICAgICAgICAgICAgcmVzLmRhdGUgPSB0aGlzLmRhdGU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMub3RoZXIpIHtcbiAgICAgICAgICAgIHJlcy5vdGhlciA9IHRoaXMub3RoZXIudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5LRUtJZGVudGlmaWVyLkNMQVNTX05BTUUgPSBcIktFS0lkZW50aWZpZXJcIjtcblxuY29uc3QgVkVSU0lPTiRhID0gXCJ2ZXJzaW9uXCI7XG5jb25zdCBLRUtfSUQgPSBcImtla2lkXCI7XG5jb25zdCBLRVlfRU5DUllQVElPTl9BTEdPUklUSE0kMSA9IFwia2V5RW5jcnlwdGlvbkFsZ29yaXRobVwiO1xuY29uc3QgRU5DUllQVEVEX0tFWSQxID0gXCJlbmNyeXB0ZWRLZXlcIjtcbmNvbnN0IFBFUl9ERUZJTkVEX0tFSyA9IFwicHJlRGVmaW5lZEtFS1wiO1xuY29uc3QgQ0xFQVJfUFJPUFMkcSA9IFtcbiAgICBWRVJTSU9OJGEsXG4gICAgS0VLX0lELFxuICAgIEtFWV9FTkNSWVBUSU9OX0FMR09SSVRITSQxLFxuICAgIEVOQ1JZUFRFRF9LRVkkMSxcbl07XG5jbGFzcyBLRUtSZWNpcGllbnRJbmZvIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVkVSU0lPTiRhLCBLRUtSZWNpcGllbnRJbmZvLmRlZmF1bHRWYWx1ZXMoVkVSU0lPTiRhKSk7XG4gICAgICAgIHRoaXMua2VraWQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBLRUtfSUQsIEtFS1JlY2lwaWVudEluZm8uZGVmYXVsdFZhbHVlcyhLRUtfSUQpKTtcbiAgICAgICAgdGhpcy5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgS0VZX0VOQ1JZUFRJT05fQUxHT1JJVEhNJDEsIEtFS1JlY2lwaWVudEluZm8uZGVmYXVsdFZhbHVlcyhLRVlfRU5DUllQVElPTl9BTEdPUklUSE0kMSkpO1xuICAgICAgICB0aGlzLmVuY3J5cHRlZEtleSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEVOQ1JZUFRFRF9LRVkkMSwgS0VLUmVjaXBpZW50SW5mby5kZWZhdWx0VmFsdWVzKEVOQ1JZUFRFRF9LRVkkMSkpO1xuICAgICAgICB0aGlzLnByZURlZmluZWRLRUsgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBQRVJfREVGSU5FRF9LRUssIEtFS1JlY2lwaWVudEluZm8uZGVmYXVsdFZhbHVlcyhQRVJfREVGSU5FRF9LRUspKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFZFUlNJT04kYTpcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGNhc2UgS0VLX0lEOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgS0VLSWRlbnRpZmllcigpO1xuICAgICAgICAgICAgY2FzZSBLRVlfRU5DUllQVElPTl9BTEdPUklUSE0kMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgRU5DUllQVEVEX0tFWSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKCk7XG4gICAgICAgICAgICBjYXNlIFBFUl9ERUZJTkVEX0tFSzpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfQlVGRkVSO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBcIktFS1JlY2lwaWVudEluZm9cIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlID09PSBLRUtSZWNpcGllbnRJbmZvLmRlZmF1bHRWYWx1ZXMoVkVSU0lPTiRhKSk7XG4gICAgICAgICAgICBjYXNlIEtFS19JRDpcbiAgICAgICAgICAgICAgICByZXR1cm4gKChtZW1iZXJWYWx1ZS5jb21wYXJlV2l0aERlZmF1bHQoXCJrZXlJZGVudGlmaWVyXCIsIG1lbWJlclZhbHVlLmtleUlkZW50aWZpZXIpKSAmJlxuICAgICAgICAgICAgICAgICAgICAoKFwiZGF0ZVwiIGluIG1lbWJlclZhbHVlKSA9PT0gZmFsc2UpICYmXG4gICAgICAgICAgICAgICAgICAgICgoXCJvdGhlclwiIGluIG1lbWJlclZhbHVlKSA9PT0gZmFsc2UpKTtcbiAgICAgICAgICAgIGNhc2UgS0VZX0VOQ1JZUFRJT05fQUxHT1JJVEhNJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgobWVtYmVyVmFsdWUuYWxnb3JpdGhtSWQgPT09IEVNUFRZX1NUUklORykgJiYgKChcImFsZ29yaXRobVBhcmFtc1wiIGluIG1lbWJlclZhbHVlKSA9PT0gZmFsc2UpKTtcbiAgICAgICAgICAgIGNhc2UgRU5DUllQVEVEX0tFWSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUuaXNFcXVhbChLRUtSZWNpcGllbnRJbmZvLmRlZmF1bHRWYWx1ZXMoRU5DUllQVEVEX0tFWSQxKSkpO1xuICAgICAgICAgICAgY2FzZSBQRVJfREVGSU5FRF9LRUs6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5ieXRlTGVuZ3RoID09PSAwKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLnZlcnNpb24gfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBLRUtJZGVudGlmaWVyLnNjaGVtYShuYW1lcy5rZWtpZCB8fCB7fSksXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMua2V5RW5jcnlwdGlvbkFsZ29yaXRobSB8fCB7fSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IG5hbWU6IChuYW1lcy5lbmNyeXB0ZWRLZXkgfHwgRU1QVFlfU1RSSU5HKSB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJHEpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIEtFS1JlY2lwaWVudEluZm8uc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgdmVyc2lvbjogVkVSU0lPTiRhLFxuICAgICAgICAgICAgICAgIGtla2lkOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IEtFS19JRFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBrZXlFbmNyeXB0aW9uQWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IEtFWV9FTkNSWVBUSU9OX0FMR09SSVRITSQxXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVuY3J5cHRlZEtleTogRU5DUllQVEVEX0tFWSQxXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gYXNuMS5yZXN1bHQudmVyc2lvbi52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgICAgICB0aGlzLmtla2lkID0gbmV3IEtFS0lkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0Lmtla2lkIH0pO1xuICAgICAgICB0aGlzLmtleUVuY3J5cHRpb25BbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHQua2V5RW5jcnlwdGlvbkFsZ29yaXRobSB9KTtcbiAgICAgICAgdGhpcy5lbmNyeXB0ZWRLZXkgPSBhc24xLnJlc3VsdC5lbmNyeXB0ZWRLZXk7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy52ZXJzaW9uIH0pLFxuICAgICAgICAgICAgICAgIHRoaXMua2VraWQudG9TY2hlbWEoKSxcbiAgICAgICAgICAgICAgICB0aGlzLmtleUVuY3J5cHRpb25BbGdvcml0aG0udG9TY2hlbWEoKSxcbiAgICAgICAgICAgICAgICB0aGlzLmVuY3J5cHRlZEtleVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZlcnNpb246IHRoaXMudmVyc2lvbixcbiAgICAgICAgICAgIGtla2lkOiB0aGlzLmtla2lkLnRvSlNPTigpLFxuICAgICAgICAgICAga2V5RW5jcnlwdGlvbkFsZ29yaXRobTogdGhpcy5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtLnRvSlNPTigpLFxuICAgICAgICAgICAgZW5jcnlwdGVkS2V5OiB0aGlzLmVuY3J5cHRlZEtleS50b0pTT04oKSxcbiAgICAgICAgfTtcbiAgICB9XG59XG5LRUtSZWNpcGllbnRJbmZvLkNMQVNTX05BTUUgPSBcIktFS1JlY2lwaWVudEluZm9cIjtcblxuY29uc3QgVkVSU0lPTiQ5ID0gXCJ2ZXJzaW9uXCI7XG5jb25zdCBLRVlfREVSSVZBVElPTl9BTEdPUklUSE0gPSBcImtleURlcml2YXRpb25BbGdvcml0aG1cIjtcbmNvbnN0IEtFWV9FTkNSWVBUSU9OX0FMR09SSVRITSA9IFwia2V5RW5jcnlwdGlvbkFsZ29yaXRobVwiO1xuY29uc3QgRU5DUllQVEVEX0tFWSA9IFwiZW5jcnlwdGVkS2V5XCI7XG5jb25zdCBQQVNTV09SRCA9IFwicGFzc3dvcmRcIjtcbmNvbnN0IENMRUFSX1BST1BTJHAgPSBbXG4gICAgVkVSU0lPTiQ5LFxuICAgIEtFWV9ERVJJVkFUSU9OX0FMR09SSVRITSxcbiAgICBLRVlfRU5DUllQVElPTl9BTEdPUklUSE0sXG4gICAgRU5DUllQVEVEX0tFWVxuXTtcbmNsYXNzIFBhc3N3b3JkUmVjaXBpZW50aW5mbyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZFUlNJT04kOSwgUGFzc3dvcmRSZWNpcGllbnRpbmZvLmRlZmF1bHRWYWx1ZXMoVkVSU0lPTiQ5KSk7XG4gICAgICAgIGlmIChLRVlfREVSSVZBVElPTl9BTEdPUklUSE0gaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5rZXlEZXJpdmF0aW9uQWxnb3JpdGhtID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgS0VZX0RFUklWQVRJT05fQUxHT1JJVEhNLCBQYXNzd29yZFJlY2lwaWVudGluZm8uZGVmYXVsdFZhbHVlcyhLRVlfREVSSVZBVElPTl9BTEdPUklUSE0pKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmtleUVuY3J5cHRpb25BbGdvcml0aG0gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBLRVlfRU5DUllQVElPTl9BTEdPUklUSE0sIFBhc3N3b3JkUmVjaXBpZW50aW5mby5kZWZhdWx0VmFsdWVzKEtFWV9FTkNSWVBUSU9OX0FMR09SSVRITSkpO1xuICAgICAgICB0aGlzLmVuY3J5cHRlZEtleSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEVOQ1JZUFRFRF9LRVksIFBhc3N3b3JkUmVjaXBpZW50aW5mby5kZWZhdWx0VmFsdWVzKEVOQ1JZUFRFRF9LRVkpKTtcbiAgICAgICAgdGhpcy5wYXNzd29yZCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFBBU1NXT1JELCBQYXNzd29yZFJlY2lwaWVudGluZm8uZGVmYXVsdFZhbHVlcyhQQVNTV09SRCkpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkVSU0lPTiQ5OlxuICAgICAgICAgICAgICAgIHJldHVybiAoLTEpO1xuICAgICAgICAgICAgY2FzZSBLRVlfREVSSVZBVElPTl9BTEdPUklUSE06XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKCk7XG4gICAgICAgICAgICBjYXNlIEtFWV9FTkNSWVBUSU9OX0FMR09SSVRITTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgRU5DUllQVEVEX0tFWTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5PY3RldFN0cmluZygpO1xuICAgICAgICAgICAgY2FzZSBQQVNTV09SRDpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfQlVGRkVSO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJDk6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gKC0xKSk7XG4gICAgICAgICAgICBjYXNlIEtFWV9ERVJJVkFUSU9OX0FMR09SSVRITTpcbiAgICAgICAgICAgIGNhc2UgS0VZX0VOQ1JZUFRJT05fQUxHT1JJVEhNOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKG1lbWJlclZhbHVlLmFsZ29yaXRobUlkID09PSBFTVBUWV9TVFJJTkcpICYmICgoXCJhbGdvcml0aG1QYXJhbXNcIiBpbiBtZW1iZXJWYWx1ZSkgPT09IGZhbHNlKSk7XG4gICAgICAgICAgICBjYXNlIEVOQ1JZUFRFRF9LRVk6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5pc0VxdWFsKFBhc3N3b3JkUmVjaXBpZW50aW5mby5kZWZhdWx0VmFsdWVzKEVOQ1JZUFRFRF9LRVkpKSk7XG4gICAgICAgICAgICBjYXNlIFBBU1NXT1JEOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUuYnl0ZUxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy52ZXJzaW9uIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5rZXlEZXJpdmF0aW9uQWxnb3JpdGhtIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEoKS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMua2V5RW5jcnlwdGlvbkFsZ29yaXRobSB8fCB7fSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IG5hbWU6IChuYW1lcy5lbmNyeXB0ZWRLZXkgfHwgRU1QVFlfU1RSSU5HKSB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJHApO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFBhc3N3b3JkUmVjaXBpZW50aW5mby5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBWRVJTSU9OJDksXG4gICAgICAgICAgICAgICAga2V5RGVyaXZhdGlvbkFsZ29yaXRobTogS0VZX0RFUklWQVRJT05fQUxHT1JJVEhNLFxuICAgICAgICAgICAgICAgIGtleUVuY3J5cHRpb25BbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogS0VZX0VOQ1JZUFRJT05fQUxHT1JJVEhNXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVuY3J5cHRlZEtleTogRU5DUllQVEVEX0tFWVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IGFzbjEucmVzdWx0LnZlcnNpb24udmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgaWYgKEtFWV9ERVJJVkFUSU9OX0FMR09SSVRITSBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5rZXlEZXJpdmF0aW9uQWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoe1xuICAgICAgICAgICAgICAgIHNjaGVtYTogbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBhc24xLnJlc3VsdC5rZXlEZXJpdmF0aW9uQWxnb3JpdGhtLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0LmtleUVuY3J5cHRpb25BbGdvcml0aG0gfSk7XG4gICAgICAgIHRoaXMuZW5jcnlwdGVkS2V5ID0gYXNuMS5yZXN1bHQuZW5jcnlwdGVkS2V5O1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy52ZXJzaW9uIH0pKTtcbiAgICAgICAgaWYgKHRoaXMua2V5RGVyaXZhdGlvbkFsZ29yaXRobSkge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLmtleURlcml2YXRpb25BbGdvcml0aG0udG9TY2hlbWEoKS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLmtleUVuY3J5cHRpb25BbGdvcml0aG0udG9TY2hlbWEoKSk7XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5lbmNyeXB0ZWRLZXkpO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICB2ZXJzaW9uOiB0aGlzLnZlcnNpb24sXG4gICAgICAgICAgICBrZXlFbmNyeXB0aW9uQWxnb3JpdGhtOiB0aGlzLmtleUVuY3J5cHRpb25BbGdvcml0aG0udG9KU09OKCksXG4gICAgICAgICAgICBlbmNyeXB0ZWRLZXk6IHRoaXMuZW5jcnlwdGVkS2V5LnRvSlNPTigpLFxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5rZXlEZXJpdmF0aW9uQWxnb3JpdGhtKSB7XG4gICAgICAgICAgICByZXMua2V5RGVyaXZhdGlvbkFsZ29yaXRobSA9IHRoaXMua2V5RGVyaXZhdGlvbkFsZ29yaXRobS50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbn1cblBhc3N3b3JkUmVjaXBpZW50aW5mby5DTEFTU19OQU1FID0gXCJQYXNzd29yZFJlY2lwaWVudEluZm9cIjtcblxuY29uc3QgT1JJX1RZUEUgPSBcIm9yaVR5cGVcIjtcbmNvbnN0IE9SSV9WQUxVRSA9IFwib3JpVmFsdWVcIjtcbmNvbnN0IENMRUFSX1BST1BTJG8gPSBbXG4gICAgT1JJX1RZUEUsXG4gICAgT1JJX1ZBTFVFXG5dO1xuY2xhc3MgT3RoZXJSZWNpcGllbnRJbmZvIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5vcmlUeXBlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgT1JJX1RZUEUsIE90aGVyUmVjaXBpZW50SW5mby5kZWZhdWx0VmFsdWVzKE9SSV9UWVBFKSk7XG4gICAgICAgIHRoaXMub3JpVmFsdWUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBPUklfVkFMVUUsIE90aGVyUmVjaXBpZW50SW5mby5kZWZhdWx0VmFsdWVzKE9SSV9WQUxVRSkpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgT1JJX1RZUEU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX1NUUklORztcbiAgICAgICAgICAgIGNhc2UgT1JJX1ZBTFVFOlxuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgT1JJX1RZUEU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gRU1QVFlfU1RSSU5HKTtcbiAgICAgICAgICAgIGNhc2UgT1JJX1ZBTFVFOlxuICAgICAgICAgICAgICAgIHJldHVybiAoT2JqZWN0LmtleXMobWVtYmVyVmFsdWUpLmxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IG5hbWU6IChuYW1lcy5vcmlUeXBlIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5BbnkoeyBuYW1lOiAobmFtZXMub3JpVmFsdWUgfHwgRU1QVFlfU1RSSU5HKSB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJG8pO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIE90aGVyUmVjaXBpZW50SW5mby5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBvcmlUeXBlOiBPUklfVFlQRSxcbiAgICAgICAgICAgICAgICBvcmlWYWx1ZTogT1JJX1ZBTFVFXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5vcmlUeXBlID0gYXNuMS5yZXN1bHQub3JpVHlwZS52YWx1ZUJsb2NrLnRvU3RyaW5nKCk7XG4gICAgICAgIHRoaXMub3JpVmFsdWUgPSBhc24xLnJlc3VsdC5vcmlWYWx1ZTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLm9yaVR5cGUgfSksXG4gICAgICAgICAgICAgICAgdGhpcy5vcmlWYWx1ZVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgICAgb3JpVHlwZTogdGhpcy5vcmlUeXBlXG4gICAgICAgIH07XG4gICAgICAgIGlmICghT3RoZXJSZWNpcGllbnRJbmZvLmNvbXBhcmVXaXRoRGVmYXVsdChPUklfVkFMVUUsIHRoaXMub3JpVmFsdWUpKSB7XG4gICAgICAgICAgICByZXMub3JpVmFsdWUgPSB0aGlzLm9yaVZhbHVlLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxufVxuT3RoZXJSZWNpcGllbnRJbmZvLkNMQVNTX05BTUUgPSBcIk90aGVyUmVjaXBpZW50SW5mb1wiO1xuXG5jb25zdCBWQVJJQU5UID0gXCJ2YXJpYW50XCI7XG5jb25zdCBWQUxVRSA9IFwidmFsdWVcIjtcbmNvbnN0IENMRUFSX1BST1BTJG4gPSBbXG4gICAgXCJibG9ja05hbWVcIlxuXTtcbmNsYXNzIFJlY2lwaWVudEluZm8gZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnZhcmlhbnQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBWQVJJQU5ULCBSZWNpcGllbnRJbmZvLmRlZmF1bHRWYWx1ZXMoVkFSSUFOVCkpO1xuICAgICAgICBpZiAoVkFMVUUgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZBTFVFLCBSZWNpcGllbnRJbmZvLmRlZmF1bHRWYWx1ZXMoVkFMVUUpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkFSSUFOVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gKC0xKTtcbiAgICAgICAgICAgIGNhc2UgVkFMVUU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWQVJJQU5UOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgPT09IFJlY2lwaWVudEluZm8uZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSk7XG4gICAgICAgICAgICBjYXNlIFZBTFVFOlxuICAgICAgICAgICAgICAgIHJldHVybiAoT2JqZWN0LmtleXMobWVtYmVyVmFsdWUpLmxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5DaG9pY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBLZXlUcmFuc1JlY2lwaWVudEluZm8uc2NoZW1hKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogS2V5QWdyZWVSZWNpcGllbnRJbmZvLnNjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogS0VLUmVjaXBpZW50SW5mby5zY2hlbWEoKS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDNcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFBhc3N3b3JkUmVjaXBpZW50aW5mby5zY2hlbWEoKS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDRcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IE90aGVyUmVjaXBpZW50SW5mby5zY2hlbWEoKS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRuKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBSZWNpcGllbnRJbmZvLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogXCJibG9ja05hbWVcIlxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIGlmIChhc24xLnJlc3VsdC5ibG9ja05hbWUuaWRCbG9jay50YWdDbGFzcyA9PT0gMSkge1xuICAgICAgICAgICAgdGhpcy52YXJpYW50ID0gMTtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSBuZXcgS2V5VHJhbnNSZWNpcGllbnRJbmZvKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5ibG9ja05hbWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBibG9ja1NlcXVlbmNlID0gbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgdmFsdWU6IGFzbjEucmVzdWx0LmJsb2NrTmFtZS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHN3aXRjaCAoYXNuMS5yZXN1bHQuYmxvY2tOYW1lLmlkQmxvY2sudGFnTnVtYmVyKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhcmlhbnQgPSAyO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gbmV3IEtleUFncmVlUmVjaXBpZW50SW5mbyh7IHNjaGVtYTogYmxvY2tTZXF1ZW5jZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhcmlhbnQgPSAzO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gbmV3IEtFS1JlY2lwaWVudEluZm8oeyBzY2hlbWE6IGJsb2NrU2VxdWVuY2UgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YXJpYW50ID0gNDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IG5ldyBQYXNzd29yZFJlY2lwaWVudGluZm8oeyBzY2hlbWE6IGJsb2NrU2VxdWVuY2UgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YXJpYW50ID0gNTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IG5ldyBPdGhlclJlY2lwaWVudEluZm8oeyBzY2hlbWE6IGJsb2NrU2VxdWVuY2UgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkluY29ycmVjdCBzdHJ1Y3R1cmUgb2YgUmVjaXBpZW50SW5mbyBibG9ja1wiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgUGFyYW1ldGVyRXJyb3IuYXNzZXJ0RW1wdHkodGhpcy52YWx1ZSwgXCJ2YWx1ZVwiLCBcIlJlY2lwaWVudEluZm9cIik7XG4gICAgICAgIGNvbnN0IF9zY2hlbWEgPSB0aGlzLnZhbHVlLnRvU2NoZW1hKCk7XG4gICAgICAgIHN3aXRjaCAodGhpcy52YXJpYW50KSB7XG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9zY2hlbWE7XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgX3NjaGVtYS5pZEJsb2NrLnRhZ0NsYXNzID0gMztcbiAgICAgICAgICAgICAgICBfc2NoZW1hLmlkQmxvY2sudGFnTnVtYmVyID0gKHRoaXMudmFyaWFudCAtIDEpO1xuICAgICAgICAgICAgICAgIHJldHVybiBfc2NoZW1hO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5BbnkoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICAgIHZhcmlhbnQ6IHRoaXMudmFyaWFudFxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy52YWx1ZSAmJiAodGhpcy52YXJpYW50ID49IDEpICYmICh0aGlzLnZhcmlhbnQgPD0gNCkpIHtcbiAgICAgICAgICAgIHJlcy52YWx1ZSA9IHRoaXMudmFsdWUudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5SZWNpcGllbnRJbmZvLkNMQVNTX05BTUUgPSBcIlJlY2lwaWVudEluZm9cIjtcblxuY29uc3QgSEFTSF9BTEdPUklUSE0kMiA9IFwiaGFzaEFsZ29yaXRobVwiO1xuY29uc3QgTUFTS19HRU5fQUxHT1JJVEhNID0gXCJtYXNrR2VuQWxnb3JpdGhtXCI7XG5jb25zdCBQX1NPVVJDRV9BTEdPUklUSE0gPSBcInBTb3VyY2VBbGdvcml0aG1cIjtcbmNvbnN0IENMRUFSX1BST1BTJG0gPSBbXG4gICAgSEFTSF9BTEdPUklUSE0kMixcbiAgICBNQVNLX0dFTl9BTEdPUklUSE0sXG4gICAgUF9TT1VSQ0VfQUxHT1JJVEhNXG5dO1xuY2xhc3MgUlNBRVNPQUVQUGFyYW1zIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5oYXNoQWxnb3JpdGhtID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgSEFTSF9BTEdPUklUSE0kMiwgUlNBRVNPQUVQUGFyYW1zLmRlZmF1bHRWYWx1ZXMoSEFTSF9BTEdPUklUSE0kMikpO1xuICAgICAgICB0aGlzLm1hc2tHZW5BbGdvcml0aG0gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBNQVNLX0dFTl9BTEdPUklUSE0sIFJTQUVTT0FFUFBhcmFtcy5kZWZhdWx0VmFsdWVzKE1BU0tfR0VOX0FMR09SSVRITSkpO1xuICAgICAgICB0aGlzLnBTb3VyY2VBbGdvcml0aG0gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBQX1NPVVJDRV9BTEdPUklUSE0sIFJTQUVTT0FFUFBhcmFtcy5kZWZhdWx0VmFsdWVzKFBfU09VUkNFX0FMR09SSVRITSkpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgSEFTSF9BTEdPUklUSE0kMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoe1xuICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1JZDogXCIxLjMuMTQuMy4yLjI2XCIsXG4gICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogbmV3IGFzbjFqcy5OdWxsKClcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNhc2UgTUFTS19HRU5fQUxHT1JJVEhNOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobUlkOiBcIjEuMi44NDAuMTEzNTQ5LjEuMS44XCIsXG4gICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogKG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobUlkOiBcIjEuMy4xNC4zLjIuMjZcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogbmV3IGFzbjFqcy5OdWxsKClcbiAgICAgICAgICAgICAgICAgICAgfSkpLnRvU2NoZW1hKClcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNhc2UgUF9TT1VSQ0VfQUxHT1JJVEhNOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobUlkOiBcIjEuMi44NDAuMTEzNTQ5LjEuMS45XCIsXG4gICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiAobmV3IFVpbnQ4QXJyYXkoWzB4ZGEsIDB4MzksIDB4YTMsIDB4ZWUsIDB4NWUsIDB4NmIsIDB4NGIsIDB4MGQsIDB4MzIsIDB4NTUsIDB4YmYsIDB4ZWYsIDB4OTUsIDB4NjAsIDB4MTgsIDB4OTAsIDB4YWYsIDB4ZDgsIDB4MDcsIDB4MDldKSkuYnVmZmVyIH0pXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtBbGdvcml0aG1JZGVudGlmaWVyLnNjaGVtYShuYW1lcy5oYXNoQWxnb3JpdGhtIHx8IHt9KV1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMubWFza0dlbkFsZ29yaXRobSB8fCB7fSldXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAyXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW0FsZ29yaXRobUlkZW50aWZpZXIuc2NoZW1hKG5hbWVzLnBTb3VyY2VBbGdvcml0aG0gfHwge30pXVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkbSk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgUlNBRVNPQUVQUGFyYW1zLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGhhc2hBbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogSEFTSF9BTEdPUklUSE0kMlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBtYXNrR2VuQWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IE1BU0tfR0VOX0FMR09SSVRITVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBwU291cmNlQWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFBfU09VUkNFX0FMR09SSVRITVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIGlmIChIQVNIX0FMR09SSVRITSQyIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5oYXNoQWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0Lmhhc2hBbGdvcml0aG0gfSk7XG4gICAgICAgIGlmIChNQVNLX0dFTl9BTEdPUklUSE0gaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLm1hc2tHZW5BbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHQubWFza0dlbkFsZ29yaXRobSB9KTtcbiAgICAgICAgaWYgKFBfU09VUkNFX0FMR09SSVRITSBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMucFNvdXJjZUFsZ29yaXRobSA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5wU291cmNlQWxnb3JpdGhtIH0pO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgaWYgKCF0aGlzLmhhc2hBbGdvcml0aG0uaXNFcXVhbChSU0FFU09BRVBQYXJhbXMuZGVmYXVsdFZhbHVlcyhIQVNIX0FMR09SSVRITSQyKSkpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW3RoaXMuaGFzaEFsZ29yaXRobS50b1NjaGVtYSgpXVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5tYXNrR2VuQWxnb3JpdGhtLmlzRXF1YWwoUlNBRVNPQUVQUGFyYW1zLmRlZmF1bHRWYWx1ZXMoTUFTS19HRU5fQUxHT1JJVEhNKSkpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW3RoaXMubWFza0dlbkFsZ29yaXRobS50b1NjaGVtYSgpXVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5wU291cmNlQWxnb3JpdGhtLmlzRXF1YWwoUlNBRVNPQUVQUGFyYW1zLmRlZmF1bHRWYWx1ZXMoUF9TT1VSQ0VfQUxHT1JJVEhNKSkpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAyXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW3RoaXMucFNvdXJjZUFsZ29yaXRobS50b1NjaGVtYSgpXVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHt9O1xuICAgICAgICBpZiAoIXRoaXMuaGFzaEFsZ29yaXRobS5pc0VxdWFsKFJTQUVTT0FFUFBhcmFtcy5kZWZhdWx0VmFsdWVzKEhBU0hfQUxHT1JJVEhNJDIpKSkge1xuICAgICAgICAgICAgcmVzLmhhc2hBbGdvcml0aG0gPSB0aGlzLmhhc2hBbGdvcml0aG0udG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLm1hc2tHZW5BbGdvcml0aG0uaXNFcXVhbChSU0FFU09BRVBQYXJhbXMuZGVmYXVsdFZhbHVlcyhNQVNLX0dFTl9BTEdPUklUSE0pKSkge1xuICAgICAgICAgICAgcmVzLm1hc2tHZW5BbGdvcml0aG0gPSB0aGlzLm1hc2tHZW5BbGdvcml0aG0udG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLnBTb3VyY2VBbGdvcml0aG0uaXNFcXVhbChSU0FFU09BRVBQYXJhbXMuZGVmYXVsdFZhbHVlcyhQX1NPVVJDRV9BTEdPUklUSE0pKSkge1xuICAgICAgICAgICAgcmVzLnBTb3VyY2VBbGdvcml0aG0gPSB0aGlzLnBTb3VyY2VBbGdvcml0aG0udG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5SU0FFU09BRVBQYXJhbXMuQ0xBU1NfTkFNRSA9IFwiUlNBRVNPQUVQUGFyYW1zXCI7XG5cbmNvbnN0IEtFWV9JTkZPID0gXCJrZXlJbmZvXCI7XG5jb25zdCBFTlRJVFlfVV9JTkZPID0gXCJlbnRpdHlVSW5mb1wiO1xuY29uc3QgU1VQUF9QVUJfSU5GTyA9IFwic3VwcFB1YkluZm9cIjtcbmNvbnN0IENMRUFSX1BST1BTJGwgPSBbXG4gICAgS0VZX0lORk8sXG4gICAgRU5USVRZX1VfSU5GTyxcbiAgICBTVVBQX1BVQl9JTkZPXG5dO1xuY2xhc3MgRUNDQ01TU2hhcmVkSW5mbyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMua2V5SW5mbyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEtFWV9JTkZPLCBFQ0NDTVNTaGFyZWRJbmZvLmRlZmF1bHRWYWx1ZXMoS0VZX0lORk8pKTtcbiAgICAgICAgaWYgKEVOVElUWV9VX0lORk8gaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5lbnRpdHlVSW5mbyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEVOVElUWV9VX0lORk8sIEVDQ0NNU1NoYXJlZEluZm8uZGVmYXVsdFZhbHVlcyhFTlRJVFlfVV9JTkZPKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdXBwUHViSW5mbyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNVUFBfUFVCX0lORk8sIEVDQ0NNU1NoYXJlZEluZm8uZGVmYXVsdFZhbHVlcyhTVVBQX1BVQl9JTkZPKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBLRVlfSU5GTzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgRU5USVRZX1VfSU5GTzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5PY3RldFN0cmluZygpO1xuICAgICAgICAgICAgY2FzZSBTVVBQX1BVQl9JTkZPOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIEtFWV9JTkZPOlxuICAgICAgICAgICAgY2FzZSBFTlRJVFlfVV9JTkZPOlxuICAgICAgICAgICAgY2FzZSBTVVBQX1BVQl9JTkZPOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUuaXNFcXVhbChFQ0NDTVNTaGFyZWRJbmZvLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkpKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMua2V5SW5mbyB8fCB7fSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5lbnRpdHlVSW5mbyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKCldXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5zdXBwUHViSW5mbyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW25ldyBhc24xanMuT2N0ZXRTdHJpbmcoKV1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJGwpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIEVDQ0NNU1NoYXJlZEluZm8uc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAga2V5SW5mbzoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBLRVlfSU5GT1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlbnRpdHlVSW5mbzogRU5USVRZX1VfSU5GTyxcbiAgICAgICAgICAgICAgICBzdXBwUHViSW5mbzogU1VQUF9QVUJfSU5GT1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMua2V5SW5mbyA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5rZXlJbmZvIH0pO1xuICAgICAgICBpZiAoRU5USVRZX1VfSU5GTyBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMuZW50aXR5VUluZm8gPSBhc24xLnJlc3VsdC5lbnRpdHlVSW5mby52YWx1ZUJsb2NrLnZhbHVlWzBdO1xuICAgICAgICB0aGlzLnN1cHBQdWJJbmZvID0gYXNuMS5yZXN1bHQuc3VwcFB1YkluZm8udmFsdWVCbG9jay52YWx1ZVswXTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5rZXlJbmZvLnRvU2NoZW1hKCkpO1xuICAgICAgICBpZiAodGhpcy5lbnRpdHlVSW5mbykge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBbdGhpcy5lbnRpdHlVSW5mb11cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHZhbHVlOiBbdGhpcy5zdXBwUHViSW5mb11cbiAgICAgICAgfSkpO1xuICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgICAga2V5SW5mbzogdGhpcy5rZXlJbmZvLnRvSlNPTigpLFxuICAgICAgICAgICAgc3VwcFB1YkluZm86IHRoaXMuc3VwcFB1YkluZm8udG9KU09OKCksXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLmVudGl0eVVJbmZvKSB7XG4gICAgICAgICAgICByZXMuZW50aXR5VUluZm8gPSB0aGlzLmVudGl0eVVJbmZvLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxufVxuRUNDQ01TU2hhcmVkSW5mby5DTEFTU19OQU1FID0gXCJFQ0NDTVNTaGFyZWRJbmZvXCI7XG5cbmNvbnN0IFZFUlNJT04kOCA9IFwidmVyc2lvblwiO1xuY29uc3QgT1JJR0lOQVRPUl9JTkZPID0gXCJvcmlnaW5hdG9ySW5mb1wiO1xuY29uc3QgUkVDSVBJRU5UX0lORk9TID0gXCJyZWNpcGllbnRJbmZvc1wiO1xuY29uc3QgRU5DUllQVEVEX0NPTlRFTlRfSU5GTyA9IFwiZW5jcnlwdGVkQ29udGVudEluZm9cIjtcbmNvbnN0IFVOUFJPVEVDVEVEX0FUVFJTID0gXCJ1bnByb3RlY3RlZEF0dHJzXCI7XG5jb25zdCBDTEVBUl9QUk9QUyRrID0gW1xuICAgIFZFUlNJT04kOCxcbiAgICBPUklHSU5BVE9SX0lORk8sXG4gICAgUkVDSVBJRU5UX0lORk9TLFxuICAgIEVOQ1JZUFRFRF9DT05URU5UX0lORk8sXG4gICAgVU5QUk9URUNURURfQVRUUlNcbl07XG5jb25zdCBkZWZhdWx0RW5jcnlwdGlvblBhcmFtcyA9IHtcbiAgICBrZGZBbGdvcml0aG06IFwiU0hBLTUxMlwiLFxuICAgIGtla0VuY3J5cHRpb25MZW5ndGg6IDI1NlxufTtcbmNvbnN0IGN1cnZlTGVuZ3RoQnlOYW1lID0ge1xuICAgIFwiUC0yNTZcIjogMjU2LFxuICAgIFwiUC0zODRcIjogMzg0LFxuICAgIFwiUC01MjFcIjogNTI4XG59O1xuY2xhc3MgRW52ZWxvcGVkRGF0YSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZFUlNJT04kOCwgRW52ZWxvcGVkRGF0YS5kZWZhdWx0VmFsdWVzKFZFUlNJT04kOCkpO1xuICAgICAgICBpZiAoT1JJR0lOQVRPUl9JTkZPIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMub3JpZ2luYXRvckluZm8gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBPUklHSU5BVE9SX0lORk8sIEVudmVsb3BlZERhdGEuZGVmYXVsdFZhbHVlcyhPUklHSU5BVE9SX0lORk8pKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlY2lwaWVudEluZm9zID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUkVDSVBJRU5UX0lORk9TLCBFbnZlbG9wZWREYXRhLmRlZmF1bHRWYWx1ZXMoUkVDSVBJRU5UX0lORk9TKSk7XG4gICAgICAgIHRoaXMuZW5jcnlwdGVkQ29udGVudEluZm8gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBFTkNSWVBURURfQ09OVEVOVF9JTkZPLCBFbnZlbG9wZWREYXRhLmRlZmF1bHRWYWx1ZXMoRU5DUllQVEVEX0NPTlRFTlRfSU5GTykpO1xuICAgICAgICBpZiAoVU5QUk9URUNURURfQVRUUlMgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy51bnByb3RlY3RlZEF0dHJzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVU5QUk9URUNURURfQVRUUlMsIEVudmVsb3BlZERhdGEuZGVmYXVsdFZhbHVlcyhVTlBST1RFQ1RFRF9BVFRSUykpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucG9saWN5ID0ge1xuICAgICAgICAgICAgZGlzYWJsZVNwbGl0OiAhIXBhcmFtZXRlcnMuZGlzYWJsZVNwbGl0LFxuICAgICAgICB9O1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkVSU0lPTiQ4OlxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgY2FzZSBPUklHSU5BVE9SX0lORk86XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBPcmlnaW5hdG9ySW5mbygpO1xuICAgICAgICAgICAgY2FzZSBSRUNJUElFTlRfSU5GT1M6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgY2FzZSBFTkNSWVBURURfQ09OVEVOVF9JTkZPOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRW5jcnlwdGVkQ29udGVudEluZm8oKTtcbiAgICAgICAgICAgIGNhc2UgVU5QUk9URUNURURfQVRUUlM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJDg6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gRW52ZWxvcGVkRGF0YS5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKTtcbiAgICAgICAgICAgIGNhc2UgT1JJR0lOQVRPUl9JTkZPOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKG1lbWJlclZhbHVlLmNlcnRzLmNlcnRpZmljYXRlcy5sZW5ndGggPT09IDApICYmIChtZW1iZXJWYWx1ZS5jcmxzLmNybHMubGVuZ3RoID09PSAwKSk7XG4gICAgICAgICAgICBjYXNlIFJFQ0lQSUVOVF9JTkZPUzpcbiAgICAgICAgICAgIGNhc2UgVU5QUk9URUNURURfQVRUUlM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgY2FzZSBFTkNSWVBURURfQ09OVEVOVF9JTkZPOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKEVuY3J5cHRlZENvbnRlbnRJbmZvLmNvbXBhcmVXaXRoRGVmYXVsdChcImNvbnRlbnRUeXBlXCIsIG1lbWJlclZhbHVlLmNvbnRlbnRUeXBlKSkgJiZcbiAgICAgICAgICAgICAgICAgICAgKEVuY3J5cHRlZENvbnRlbnRJbmZvLmNvbXBhcmVXaXRoRGVmYXVsdChcImNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtXCIsIG1lbWJlclZhbHVlLmNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgKEVuY3J5cHRlZENvbnRlbnRJbmZvLmNvbXBhcmVXaXRoRGVmYXVsdChcImVuY3J5cHRlZENvbnRlbnRcIiwgbWVtYmVyVmFsdWUuZW5jcnlwdGVkQ29udGVudCkpKSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy52ZXJzaW9uIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5vcmlnaW5hdG9ySW5mbyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IE9yaWdpbmF0b3JJbmZvLnNjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlNldCh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMucmVjaXBpZW50SW5mb3MgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogUmVjaXBpZW50SW5mby5zY2hlbWEoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIEVuY3J5cHRlZENvbnRlbnRJbmZvLnNjaGVtYShuYW1lcy5lbmNyeXB0ZWRDb250ZW50SW5mbyB8fCB7fSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnVucHJvdGVjdGVkQXR0cnMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQXR0cmlidXRlLnNjaGVtYSgpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRrKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBFbnZlbG9wZWREYXRhLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIHZlcnNpb246IFZFUlNJT04kOCxcbiAgICAgICAgICAgICAgICBvcmlnaW5hdG9ySW5mbzogT1JJR0lOQVRPUl9JTkZPLFxuICAgICAgICAgICAgICAgIHJlY2lwaWVudEluZm9zOiBSRUNJUElFTlRfSU5GT1MsXG4gICAgICAgICAgICAgICAgZW5jcnlwdGVkQ29udGVudEluZm86IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogRU5DUllQVEVEX0NPTlRFTlRfSU5GT1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB1bnByb3RlY3RlZEF0dHJzOiBVTlBST1RFQ1RFRF9BVFRSU1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IGFzbjEucmVzdWx0LnZlcnNpb24udmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgaWYgKE9SSUdJTkFUT1JfSU5GTyBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5vcmlnaW5hdG9ySW5mbyA9IG5ldyBPcmlnaW5hdG9ySW5mbyh7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGFzbjEucmVzdWx0Lm9yaWdpbmF0b3JJbmZvLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZWNpcGllbnRJbmZvcyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHQucmVjaXBpZW50SW5mb3MsIG8gPT4gbmV3IFJlY2lwaWVudEluZm8oeyBzY2hlbWE6IG8gfSkpO1xuICAgICAgICB0aGlzLmVuY3J5cHRlZENvbnRlbnRJbmZvID0gbmV3IEVuY3J5cHRlZENvbnRlbnRJbmZvKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5lbmNyeXB0ZWRDb250ZW50SW5mbyB9KTtcbiAgICAgICAgaWYgKFVOUFJPVEVDVEVEX0FUVFJTIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy51bnByb3RlY3RlZEF0dHJzID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdC51bnByb3RlY3RlZEF0dHJzLCBvID0+IG5ldyBBdHRyaWJ1dGUoeyBzY2hlbWE6IG8gfSkpO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy52ZXJzaW9uIH0pKTtcbiAgICAgICAgaWYgKHRoaXMub3JpZ2luYXRvckluZm8pIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5vcmlnaW5hdG9ySW5mby50b1NjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuU2V0KHtcbiAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMucmVjaXBpZW50SW5mb3MsIG8gPT4gby50b1NjaGVtYSgpKVxuICAgICAgICB9KSk7XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5lbmNyeXB0ZWRDb250ZW50SW5mby50b1NjaGVtYSgpKTtcbiAgICAgICAgaWYgKHRoaXMudW5wcm90ZWN0ZWRBdHRycykge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMudW5wcm90ZWN0ZWRBdHRycywgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgICAgdmVyc2lvbjogdGhpcy52ZXJzaW9uLFxuICAgICAgICAgICAgcmVjaXBpZW50SW5mb3M6IEFycmF5LmZyb20odGhpcy5yZWNpcGllbnRJbmZvcywgbyA9PiBvLnRvSlNPTigpKSxcbiAgICAgICAgICAgIGVuY3J5cHRlZENvbnRlbnRJbmZvOiB0aGlzLmVuY3J5cHRlZENvbnRlbnRJbmZvLnRvSlNPTigpLFxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5vcmlnaW5hdG9ySW5mbylcbiAgICAgICAgICAgIHJlcy5vcmlnaW5hdG9ySW5mbyA9IHRoaXMub3JpZ2luYXRvckluZm8udG9KU09OKCk7XG4gICAgICAgIGlmICh0aGlzLnVucHJvdGVjdGVkQXR0cnMpXG4gICAgICAgICAgICByZXMudW5wcm90ZWN0ZWRBdHRycyA9IEFycmF5LmZyb20odGhpcy51bnByb3RlY3RlZEF0dHJzLCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbiAgICBhZGRSZWNpcGllbnRCeUNlcnRpZmljYXRlKGNlcnRpZmljYXRlLCBwYXJhbWV0ZXJzLCB2YXJpYW50LCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgY29uc3QgZW5jcnlwdGlvblBhcmFtZXRlcnMgPSBPYmplY3QuYXNzaWduKHsgdXNlT0FFUDogdHJ1ZSwgb2FlcEhhc2hBbGdvcml0aG06IFwiU0hBLTUxMlwiIH0sIGRlZmF1bHRFbmNyeXB0aW9uUGFyYW1zLCBwYXJhbWV0ZXJzIHx8IHt9KTtcbiAgICAgICAgaWYgKGNlcnRpZmljYXRlLnN1YmplY3RQdWJsaWNLZXlJbmZvLmFsZ29yaXRobS5hbGdvcml0aG1JZC5pbmRleE9mKFwiMS4yLjg0MC4xMTM1NDlcIikgIT09ICgtMSkpXG4gICAgICAgICAgICB2YXJpYW50ID0gMTtcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoY2VydGlmaWNhdGUuc3ViamVjdFB1YmxpY0tleUluZm8uYWxnb3JpdGhtLmFsZ29yaXRobUlkLmluZGV4T2YoXCIxLjIuODQwLjEwMDQ1XCIpICE9PSAoLTEpKVxuICAgICAgICAgICAgICAgIHZhcmlhbnQgPSAyO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biB0eXBlIG9mIGNlcnRpZmljYXRlJ3MgcHVibGljIGtleTogJHtjZXJ0aWZpY2F0ZS5zdWJqZWN0UHVibGljS2V5SW5mby5hbGdvcml0aG0uYWxnb3JpdGhtSWR9YCk7XG4gICAgICAgIH1cbiAgICAgICAgc3dpdGNoICh2YXJpYW50KSB7XG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBsZXQgYWxnb3JpdGhtSWQ7XG4gICAgICAgICAgICAgICAgICAgIGxldCBhbGdvcml0aG1QYXJhbXM7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlbmNyeXB0aW9uUGFyYW1ldGVycy51c2VPQUVQID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1JZCA9IGNyeXB0by5nZXRPSURCeUFsZ29yaXRobSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJSU0EtT0FFUFwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCB0cnVlLCBcImtleUVuY3J5cHRpb25BbGdvcml0aG1cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBoYXNoT0lEID0gY3J5cHRvLmdldE9JREJ5QWxnb3JpdGhtKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBlbmNyeXB0aW9uUGFyYW1ldGVycy5vYWVwSGFzaEFsZ29yaXRobVxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgdHJ1ZSwgXCJSU0FFUy1PQUVQLXBhcmFtc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGhhc2hBbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtSWQ6IGhhc2hPSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtUGFyYW1zOiBuZXcgYXNuMWpzLk51bGwoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByc2FPQUVQUGFyYW1zID0gbmV3IFJTQUVTT0FFUFBhcmFtcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzaEFsZ29yaXRobSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXNrR2VuQWxnb3JpdGhtOiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobUlkOiBcIjEuMi44NDAuMTEzNTQ5LjEuMS44XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogaGFzaEFsZ29yaXRobS50b1NjaGVtYSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtUGFyYW1zID0gcnNhT0FFUFBhcmFtcy50b1NjaGVtYSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtSWQgPSBjcnlwdG8uZ2V0T0lEQnlBbGdvcml0aG0oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiUlNBRVMtUEtDUzEtdjFfNVwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbGdvcml0aG1JZCA9PT0gRU1QVFlfU1RSSU5HKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbiBub3QgZmluZCBPSUQgZm9yIFJTQUVTLVBLQ1MxLXYxXzVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1QYXJhbXMgPSBuZXcgYXNuMWpzLk51bGwoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBrZXlJbmZvID0gbmV3IEtleVRyYW5zUmVjaXBpZW50SW5mbyh7XG4gICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmlkOiBuZXcgSXNzdWVyQW5kU2VyaWFsTnVtYmVyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc3N1ZXI6IGNlcnRpZmljYXRlLmlzc3VlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXJpYWxOdW1iZXI6IGNlcnRpZmljYXRlLnNlcmlhbE51bWJlclxuICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXlFbmNyeXB0aW9uQWxnb3JpdGhtOiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtUGFyYW1zXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudENlcnRpZmljYXRlOiBjZXJ0aWZpY2F0ZSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVjaXBpZW50SW5mb3MucHVzaChuZXcgUmVjaXBpZW50SW5mbyh7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50OiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGtleUluZm9cbiAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlY2lwaWVudElkZW50aWZpZXIgPSBuZXcgS2V5QWdyZWVSZWNpcGllbnRJZGVudGlmaWVyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogbmV3IElzc3VlckFuZFNlcmlhbE51bWJlcih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNzdWVyOiBjZXJ0aWZpY2F0ZS5pc3N1ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VyaWFsTnVtYmVyOiBjZXJ0aWZpY2F0ZS5zZXJpYWxOdW1iZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRLZXlBZ3JlZVJlY2lwaWVudEluZm8ocmVjaXBpZW50SWRlbnRpZmllciwgZW5jcnlwdGlvblBhcmFtZXRlcnMsIHsgcmVjaXBpZW50Q2VydGlmaWNhdGU6IGNlcnRpZmljYXRlIH0sIGNyeXB0byk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gXCJ2YXJpYW50XCIgdmFsdWU6ICR7dmFyaWFudH1gKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgYWRkUmVjaXBpZW50QnlQcmVEZWZpbmVkRGF0YShwcmVEZWZpbmVkRGF0YSwgcGFyYW1ldGVycyA9IHt9LCB2YXJpYW50LCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgQXJndW1lbnRFcnJvci5hc3NlcnQocHJlRGVmaW5lZERhdGEsIFwicHJlRGVmaW5lZERhdGFcIiwgXCJBcnJheUJ1ZmZlclwiKTtcbiAgICAgICAgaWYgKCFwcmVEZWZpbmVkRGF0YS5ieXRlTGVuZ3RoKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQcmUtZGVmaW5lZCBkYXRhIGNvdWxkIGhhdmUgemVybyBsZW5ndGhcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFwYXJhbWV0ZXJzLmtleUlkZW50aWZpZXIpIHtcbiAgICAgICAgICAgIGNvbnN0IGtleUlkZW50aWZpZXJCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoMTYpO1xuICAgICAgICAgICAgY29uc3Qga2V5SWRlbnRpZmllclZpZXcgPSBuZXcgVWludDhBcnJheShrZXlJZGVudGlmaWVyQnVmZmVyKTtcbiAgICAgICAgICAgIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMoa2V5SWRlbnRpZmllclZpZXcpO1xuICAgICAgICAgICAgcGFyYW1ldGVycy5rZXlJZGVudGlmaWVyID0ga2V5SWRlbnRpZmllckJ1ZmZlcjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXBhcmFtZXRlcnMuaG1hY0hhc2hBbGdvcml0aG0pXG4gICAgICAgICAgICBwYXJhbWV0ZXJzLmhtYWNIYXNoQWxnb3JpdGhtID0gXCJTSEEtNTEyXCI7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLml0ZXJhdGlvbkNvdW50ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHBhcmFtZXRlcnMuaXRlcmF0aW9uQ291bnQgPSAyMDQ4O1xuICAgICAgICB9XG4gICAgICAgIGlmICghcGFyYW1ldGVycy5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtKSB7XG4gICAgICAgICAgICBwYXJhbWV0ZXJzLmtleUVuY3J5cHRpb25BbGdvcml0aG0gPSB7XG4gICAgICAgICAgICAgICAgbmFtZTogXCJBRVMtS1dcIixcbiAgICAgICAgICAgICAgICBsZW5ndGg6IDI1NlxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXBhcmFtZXRlcnMua2V5RW5jcnlwdGlvbkFsZ29yaXRobVBhcmFtcylcbiAgICAgICAgICAgIHBhcmFtZXRlcnMua2V5RW5jcnlwdGlvbkFsZ29yaXRobVBhcmFtcyA9IG5ldyBhc24xanMuTnVsbCgpO1xuICAgICAgICBzd2l0Y2ggKHZhcmlhbnQpIHtcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGtla09JRCA9IGNyeXB0by5nZXRPSURCeUFsZ29yaXRobShwYXJhbWV0ZXJzLmtleUVuY3J5cHRpb25BbGdvcml0aG0sIHRydWUsIFwia2V5RW5jcnlwdGlvbkFsZ29yaXRobVwiKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5SW5mbyA9IG5ldyBLRUtSZWNpcGllbnRJbmZvKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb246IDQsXG4gICAgICAgICAgICAgICAgICAgICAgICBrZWtpZDogbmV3IEtFS0lkZW50aWZpZXIoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleUlkZW50aWZpZXI6IG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyB2YWx1ZUhleDogcGFyYW1ldGVycy5rZXlJZGVudGlmaWVyIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleUVuY3J5cHRpb25BbGdvcml0aG06IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1JZDoga2VrT0lELFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogcGFyYW1ldGVycy5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtUGFyYW1zXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZURlZmluZWRLRUs6IHByZURlZmluZWREYXRhXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlY2lwaWVudEluZm9zLnB1c2gobmV3IFJlY2lwaWVudEluZm8oe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudDogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBrZXlJbmZvXG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYmtkZjJPSUQgPSBjcnlwdG8uZ2V0T0lEQnlBbGdvcml0aG0oeyBuYW1lOiBcIlBCS0RGMlwiIH0sIHRydWUsIFwia2V5RGVyaXZhdGlvbkFsZ29yaXRobVwiKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2FsdEJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcig2NCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNhbHRWaWV3ID0gbmV3IFVpbnQ4QXJyYXkoc2FsdEJ1ZmZlcik7XG4gICAgICAgICAgICAgICAgICAgIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMoc2FsdFZpZXcpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBobWFjT0lEID0gY3J5cHRvLmdldE9JREJ5QWxnb3JpdGhtKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiSE1BQ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgaGFzaDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHBhcmFtZXRlcnMuaG1hY0hhc2hBbGdvcml0aG1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSwgdHJ1ZSwgXCJobWFjSGFzaEFsZ29yaXRobVwiKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGJrZGYyUGFyYW1zID0gbmV3IFBCS0RGMlBhcmFtcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICBzYWx0OiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgdmFsdWVIZXg6IHNhbHRCdWZmZXIgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVyYXRpb25Db3VudDogcGFyYW1ldGVycy5pdGVyYXRpb25Db3VudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZjogbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobUlkOiBobWFjT0lELFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogbmV3IGFzbjFqcy5OdWxsKClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBrZWtPSUQgPSBjcnlwdG8uZ2V0T0lEQnlBbGdvcml0aG0ocGFyYW1ldGVycy5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtLCB0cnVlLCBcImtleUVuY3J5cHRpb25BbGdvcml0aG1cIik7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGtleUluZm8gPSBuZXcgUGFzc3dvcmRSZWNpcGllbnRpbmZvKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb246IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXlEZXJpdmF0aW9uQWxnb3JpdGhtOiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtSWQ6IHBia2RmMk9JRCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1QYXJhbXM6IHBia2RmMlBhcmFtcy50b1NjaGVtYSgpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleUVuY3J5cHRpb25BbGdvcml0aG06IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1JZDoga2VrT0lELFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogcGFyYW1ldGVycy5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtUGFyYW1zXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBwcmVEZWZpbmVkRGF0YVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWNpcGllbnRJbmZvcy5wdXNoKG5ldyBSZWNpcGllbnRJbmZvKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ6IDQsXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZToga2V5SW5mb1xuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gdmFsdWUgZm9yIFwidmFyaWFudFwiOiAke3ZhcmlhbnR9YCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYWRkUmVjaXBpZW50QnlLZXlJZGVudGlmaWVyKGtleSwga2V5SWQsIHBhcmFtZXRlcnMsIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICBjb25zdCBlbmNyeXB0aW9uUGFyYW1ldGVycyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRFbmNyeXB0aW9uUGFyYW1zLCBwYXJhbWV0ZXJzIHx8IHt9KTtcbiAgICAgICAgY29uc3QgcmVjaXBpZW50SWRlbnRpZmllciA9IG5ldyBLZXlBZ3JlZVJlY2lwaWVudElkZW50aWZpZXIoe1xuICAgICAgICAgICAgdmFyaWFudDogMixcbiAgICAgICAgICAgIHZhbHVlOiBuZXcgUmVjaXBpZW50S2V5SWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgc3ViamVjdEtleUlkZW50aWZpZXI6IG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyB2YWx1ZUhleDoga2V5SWQgfSksXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fYWRkS2V5QWdyZWVSZWNpcGllbnRJbmZvKHJlY2lwaWVudElkZW50aWZpZXIsIGVuY3J5cHRpb25QYXJhbWV0ZXJzLCB7IHJlY2lwaWVudFB1YmxpY0tleToga2V5IH0sIGNyeXB0byk7XG4gICAgfVxuICAgIF9hZGRLZXlBZ3JlZVJlY2lwaWVudEluZm8ocmVjaXBpZW50SWRlbnRpZmllciwgZW5jcnlwdGlvblBhcmFtZXRlcnMsIGV4dHJhUmVjaXBpZW50SW5mb1BhcmFtcywgY3J5cHRvID0gZ2V0Q3J5cHRvKHRydWUpKSB7XG4gICAgICAgIGNvbnN0IGVuY3J5cHRlZEtleSA9IG5ldyBSZWNpcGllbnRFbmNyeXB0ZWRLZXkoe1xuICAgICAgICAgICAgcmlkOiByZWNpcGllbnRJZGVudGlmaWVyXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBhZXNLV29pZCA9IGNyeXB0by5nZXRPSURCeUFsZ29yaXRobSh7XG4gICAgICAgICAgICBuYW1lOiBcIkFFUy1LV1wiLFxuICAgICAgICAgICAgbGVuZ3RoOiBlbmNyeXB0aW9uUGFyYW1ldGVycy5rZWtFbmNyeXB0aW9uTGVuZ3RoXG4gICAgICAgIH0sIHRydWUsIFwia2V5RW5jcnlwdGlvbkFsZ29yaXRobVwiKTtcbiAgICAgICAgY29uc3QgYWVzS1cgPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICBhbGdvcml0aG1JZDogYWVzS1dvaWQsXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBlY2RoT0lEID0gY3J5cHRvLmdldE9JREJ5QWxnb3JpdGhtKHtcbiAgICAgICAgICAgIG5hbWU6IFwiRUNESFwiLFxuICAgICAgICAgICAga2RmOiBlbmNyeXB0aW9uUGFyYW1ldGVycy5rZGZBbGdvcml0aG1cbiAgICAgICAgfSwgdHJ1ZSwgXCJLZXlBZ3JlZVJlY2lwaWVudEluZm9cIik7XG4gICAgICAgIGNvbnN0IHVrbUJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcig2NCk7XG4gICAgICAgIGNvbnN0IHVrbVZpZXcgPSBuZXcgVWludDhBcnJheSh1a21CdWZmZXIpO1xuICAgICAgICBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKHVrbVZpZXcpO1xuICAgICAgICBjb25zdCByZWNpcGllbnRJbmZvUGFyYW1zID0ge1xuICAgICAgICAgICAgdmVyc2lvbjogMyxcbiAgICAgICAgICAgIHVrbTogbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiB1a21CdWZmZXIgfSksXG4gICAgICAgICAgICBrZXlFbmNyeXB0aW9uQWxnb3JpdGhtOiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgYWxnb3JpdGhtSWQ6IGVjZGhPSUQsXG4gICAgICAgICAgICAgICAgYWxnb3JpdGhtUGFyYW1zOiBhZXNLVy50b1NjaGVtYSgpXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHJlY2lwaWVudEVuY3J5cHRlZEtleXM6IG5ldyBSZWNpcGllbnRFbmNyeXB0ZWRLZXlzKHtcbiAgICAgICAgICAgICAgICBlbmNyeXB0ZWRLZXlzOiBbZW5jcnlwdGVkS2V5XVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3Qga2V5SW5mbyA9IG5ldyBLZXlBZ3JlZVJlY2lwaWVudEluZm8oT2JqZWN0LmFzc2lnbihyZWNpcGllbnRJbmZvUGFyYW1zLCBleHRyYVJlY2lwaWVudEluZm9QYXJhbXMpKTtcbiAgICAgICAgdGhpcy5yZWNpcGllbnRJbmZvcy5wdXNoKG5ldyBSZWNpcGllbnRJbmZvKHtcbiAgICAgICAgICAgIHZhcmlhbnQ6IDIsXG4gICAgICAgICAgICB2YWx1ZToga2V5SW5mb1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGFzeW5jIGVuY3J5cHQoY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0sIGNvbnRlbnRUb0VuY3J5cHQsIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICBjb25zdCBpdkJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcigxNik7XG4gICAgICAgIGNvbnN0IGl2VmlldyA9IG5ldyBVaW50OEFycmF5KGl2QnVmZmVyKTtcbiAgICAgICAgY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhpdlZpZXcpO1xuICAgICAgICBjb25zdCBjb250ZW50VmlldyA9IG5ldyBVaW50OEFycmF5KGNvbnRlbnRUb0VuY3J5cHQpO1xuICAgICAgICBjb25zdCBjb250ZW50RW5jcnlwdGlvbk9JRCA9IGNyeXB0by5nZXRPSURCeUFsZ29yaXRobShjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobSwgdHJ1ZSwgXCJjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobVwiKTtcbiAgICAgICAgY29uc3Qgc2Vzc2lvbktleSA9IGF3YWl0IGNyeXB0by5nZW5lcmF0ZUtleShjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobSwgdHJ1ZSwgW1wiZW5jcnlwdFwiXSk7XG4gICAgICAgIGNvbnN0IGVuY3J5cHRlZENvbnRlbnQgPSBhd2FpdCBjcnlwdG8uZW5jcnlwdCh7XG4gICAgICAgICAgICBuYW1lOiBjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobS5uYW1lLFxuICAgICAgICAgICAgaXY6IGl2Vmlld1xuICAgICAgICB9LCBzZXNzaW9uS2V5LCBjb250ZW50Vmlldyk7XG4gICAgICAgIGNvbnN0IGV4cG9ydGVkU2Vzc2lvbktleSA9IGF3YWl0IGNyeXB0by5leHBvcnRLZXkoXCJyYXdcIiwgc2Vzc2lvbktleSk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IDI7XG4gICAgICAgIHRoaXMuZW5jcnlwdGVkQ29udGVudEluZm8gPSBuZXcgRW5jcnlwdGVkQ29udGVudEluZm8oe1xuICAgICAgICAgICAgZGlzYWJsZVNwbGl0OiB0aGlzLnBvbGljeS5kaXNhYmxlU3BsaXQsXG4gICAgICAgICAgICBjb250ZW50VHlwZTogXCIxLjIuODQwLjExMzU0OS4xLjcuMVwiLFxuICAgICAgICAgICAgY29udGVudEVuY3J5cHRpb25BbGdvcml0aG06IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHtcbiAgICAgICAgICAgICAgICBhbGdvcml0aG1JZDogY29udGVudEVuY3J5cHRpb25PSUQsXG4gICAgICAgICAgICAgICAgYWxnb3JpdGhtUGFyYW1zOiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgdmFsdWVIZXg6IGl2QnVmZmVyIH0pXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIGVuY3J5cHRlZENvbnRlbnQ6IG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyB2YWx1ZUhleDogZW5jcnlwdGVkQ29udGVudCB9KVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgU3ViS2V5QWdyZWVSZWNpcGllbnRJbmZvID0gYXN5bmMgKGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZWNpcGllbnRJbmZvID0gdGhpcy5yZWNpcGllbnRJbmZvc1tpbmRleF0udmFsdWU7XG4gICAgICAgICAgICBsZXQgcmVjaXBpZW50Q3VydmU7XG4gICAgICAgICAgICBsZXQgcmVjaXBpZW50UHVibGljS2V5O1xuICAgICAgICAgICAgaWYgKHJlY2lwaWVudEluZm8ucmVjaXBpZW50UHVibGljS2V5KSB7XG4gICAgICAgICAgICAgICAgcmVjaXBpZW50Q3VydmUgPSByZWNpcGllbnRJbmZvLnJlY2lwaWVudFB1YmxpY0tleS5hbGdvcml0aG0ubmFtZWRDdXJ2ZTtcbiAgICAgICAgICAgICAgICByZWNpcGllbnRQdWJsaWNLZXkgPSByZWNpcGllbnRJbmZvLnJlY2lwaWVudFB1YmxpY0tleTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHJlY2lwaWVudEluZm8ucmVjaXBpZW50Q2VydGlmaWNhdGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJ2ZU9iamVjdCA9IHJlY2lwaWVudEluZm8ucmVjaXBpZW50Q2VydGlmaWNhdGUuc3ViamVjdFB1YmxpY0tleUluZm8uYWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcztcbiAgICAgICAgICAgICAgICBpZiAoY3VydmVPYmplY3QuY29uc3RydWN0b3IuYmxvY2tOYW1lKCkgIT09IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyLmJsb2NrTmFtZSgpKVxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBcInJlY2lwaWVudENlcnRpZmljYXRlXCIgZm9yIGluZGV4ICR7aW5kZXh9YCk7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VydmVPSUQgPSBjdXJ2ZU9iamVjdC52YWx1ZUJsb2NrLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChjdXJ2ZU9JRCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMDA0NS4zLjEuN1wiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50Q3VydmUgPSBcIlAtMjU2XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIjEuMy4xMzIuMC4zNFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50Q3VydmUgPSBcIlAtMzg0XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIjEuMy4xMzIuMC4zNVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50Q3VydmUgPSBcIlAtNTIxXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5jb3JyZWN0IGN1cnZlIE9JRCBmb3IgaW5kZXggJHtpbmRleH1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmVjaXBpZW50UHVibGljS2V5ID0gYXdhaXQgcmVjaXBpZW50SW5mby5yZWNpcGllbnRDZXJ0aWZpY2F0ZS5nZXRQdWJsaWNLZXkoe1xuICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiRUNESFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVkQ3VydmU6IHJlY2lwaWVudEN1cnZlXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgY3J5cHRvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVuc3VwcG9ydGVkIFJlY2lwaWVudEluZm9cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCByZWNpcGllbnRDdXJ2ZUxlbmd0aCA9IGN1cnZlTGVuZ3RoQnlOYW1lW3JlY2lwaWVudEN1cnZlXTtcbiAgICAgICAgICAgIGNvbnN0IGVjZGhLZXlzID0gYXdhaXQgY3J5cHRvLmdlbmVyYXRlS2V5KHsgbmFtZTogXCJFQ0RIXCIsIG5hbWVkQ3VydmU6IHJlY2lwaWVudEN1cnZlIH0sIHRydWUsIFtcImRlcml2ZUJpdHNcIl0pO1xuICAgICAgICAgICAgY29uc3QgZXhwb3J0ZWRFQ0RIUHVibGljS2V5ID0gYXdhaXQgY3J5cHRvLmV4cG9ydEtleShcInNwa2lcIiwgZWNkaEtleXMucHVibGljS2V5KTtcbiAgICAgICAgICAgIGNvbnN0IGRlcml2ZWRCaXRzID0gYXdhaXQgY3J5cHRvLmRlcml2ZUJpdHMoe1xuICAgICAgICAgICAgICAgIG5hbWU6IFwiRUNESFwiLFxuICAgICAgICAgICAgICAgIHB1YmxpYzogcmVjaXBpZW50UHVibGljS2V5XG4gICAgICAgICAgICB9LCBlY2RoS2V5cy5wcml2YXRlS2V5LCByZWNpcGllbnRDdXJ2ZUxlbmd0aCk7XG4gICAgICAgICAgICBjb25zdCBhZXNLV0FsZ29yaXRobSA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHsgc2NoZW1hOiByZWNpcGllbnRJbmZvLmtleUVuY3J5cHRpb25BbGdvcml0aG0uYWxnb3JpdGhtUGFyYW1zIH0pO1xuICAgICAgICAgICAgY29uc3Qga3dBbGdvcml0aG0gPSBjcnlwdG8uZ2V0QWxnb3JpdGhtQnlPSUQoYWVzS1dBbGdvcml0aG0uYWxnb3JpdGhtSWQsIHRydWUsIFwiYWVzS1dBbGdvcml0aG1cIik7XG4gICAgICAgICAgICBsZXQga3dMZW5ndGggPSBrd0FsZ29yaXRobS5sZW5ndGg7XG4gICAgICAgICAgICBjb25zdCBrd0xlbmd0aEJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcig0KTtcbiAgICAgICAgICAgIGNvbnN0IGt3TGVuZ3RoVmlldyA9IG5ldyBVaW50OEFycmF5KGt3TGVuZ3RoQnVmZmVyKTtcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAzOyBqID49IDA7IGotLSkge1xuICAgICAgICAgICAgICAgIGt3TGVuZ3RoVmlld1tqXSA9IGt3TGVuZ3RoO1xuICAgICAgICAgICAgICAgIGt3TGVuZ3RoID4+PSA4O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgZWNjSW5mbyA9IG5ldyBFQ0NDTVNTaGFyZWRJbmZvKHtcbiAgICAgICAgICAgICAgICBrZXlJbmZvOiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobUlkOiBhZXNLV0FsZ29yaXRobS5hbGdvcml0aG1JZFxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIGVudGl0eVVJbmZvOiByZWNpcGllbnRJbmZvLnVrbSxcbiAgICAgICAgICAgICAgICBzdXBwUHViSW5mbzogbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiBrd0xlbmd0aEJ1ZmZlciB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBlbmNvZGVkSW5mbyA9IGVjY0luZm8udG9TY2hlbWEoKS50b0JFUihmYWxzZSk7XG4gICAgICAgICAgICBjb25zdCBlY2RoQWxnb3JpdGhtID0gY3J5cHRvLmdldEFsZ29yaXRobUJ5T0lEKHJlY2lwaWVudEluZm8ua2V5RW5jcnlwdGlvbkFsZ29yaXRobS5hbGdvcml0aG1JZCwgdHJ1ZSwgXCJlY2RoQWxnb3JpdGhtXCIpO1xuICAgICAgICAgICAgY29uc3QgZGVyaXZlZEtleVJhdyA9IGF3YWl0IGtkZihlY2RoQWxnb3JpdGhtLmtkZiwgZGVyaXZlZEJpdHMsIGt3QWxnb3JpdGhtLmxlbmd0aCwgZW5jb2RlZEluZm8sIGNyeXB0byk7XG4gICAgICAgICAgICBjb25zdCBhd3NLVyA9IGF3YWl0IGNyeXB0by5pbXBvcnRLZXkoXCJyYXdcIiwgZGVyaXZlZEtleVJhdywgeyBuYW1lOiBcIkFFUy1LV1wiIH0sIHRydWUsIFtcIndyYXBLZXlcIl0pO1xuICAgICAgICAgICAgY29uc3Qgd3JhcHBlZEtleSA9IGF3YWl0IGNyeXB0by53cmFwS2V5KFwicmF3XCIsIHNlc3Npb25LZXksIGF3c0tXLCB7IG5hbWU6IFwiQUVTLUtXXCIgfSk7XG4gICAgICAgICAgICBjb25zdCBvcmlnaW5hdG9yID0gbmV3IE9yaWdpbmF0b3JJZGVudGlmaWVyT3JLZXkoKTtcbiAgICAgICAgICAgIG9yaWdpbmF0b3IudmFyaWFudCA9IDM7XG4gICAgICAgICAgICBvcmlnaW5hdG9yLnZhbHVlID0gT3JpZ2luYXRvclB1YmxpY0tleS5mcm9tQkVSKGV4cG9ydGVkRUNESFB1YmxpY0tleSk7XG4gICAgICAgICAgICByZWNpcGllbnRJbmZvLm9yaWdpbmF0b3IgPSBvcmlnaW5hdG9yO1xuICAgICAgICAgICAgcmVjaXBpZW50SW5mby5yZWNpcGllbnRFbmNyeXB0ZWRLZXlzLmVuY3J5cHRlZEtleXNbMF0uZW5jcnlwdGVkS2V5ID0gbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiB3cmFwcGVkS2V5IH0pO1xuICAgICAgICAgICAgcmV0dXJuIHsgZWNkaFByaXZhdGVLZXk6IGVjZGhLZXlzLnByaXZhdGVLZXkgfTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgU3ViS2V5VHJhbnNSZWNpcGllbnRJbmZvID0gYXN5bmMgKGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZWNpcGllbnRJbmZvID0gdGhpcy5yZWNpcGllbnRJbmZvc1tpbmRleF0udmFsdWU7XG4gICAgICAgICAgICBjb25zdCBhbGdvcml0aG1QYXJhbWV0ZXJzID0gY3J5cHRvLmdldEFsZ29yaXRobUJ5T0lEKHJlY2lwaWVudEluZm8ua2V5RW5jcnlwdGlvbkFsZ29yaXRobS5hbGdvcml0aG1JZCwgdHJ1ZSwgXCJrZXlFbmNyeXB0aW9uQWxnb3JpdGhtXCIpO1xuICAgICAgICAgICAgaWYgKGFsZ29yaXRobVBhcmFtZXRlcnMubmFtZSA9PT0gXCJSU0EtT0FFUFwiKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2NoZW1hID0gcmVjaXBpZW50SW5mby5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcztcbiAgICAgICAgICAgICAgICBjb25zdCByc2FPQUVQUGFyYW1zID0gbmV3IFJTQUVTT0FFUFBhcmFtcyh7IHNjaGVtYSB9KTtcbiAgICAgICAgICAgICAgICBhbGdvcml0aG1QYXJhbWV0ZXJzLmhhc2ggPSBjcnlwdG8uZ2V0QWxnb3JpdGhtQnlPSUQocnNhT0FFUFBhcmFtcy5oYXNoQWxnb3JpdGhtLmFsZ29yaXRobUlkKTtcbiAgICAgICAgICAgICAgICBpZiAoKFwibmFtZVwiIGluIGFsZ29yaXRobVBhcmFtZXRlcnMuaGFzaCkgPT09IGZhbHNlKVxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBPSUQgZm9yIGhhc2ggYWxnb3JpdGhtOiAke3JzYU9BRVBQYXJhbXMuaGFzaEFsZ29yaXRobS5hbGdvcml0aG1JZH1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcHVibGljS2V5ID0gYXdhaXQgcmVjaXBpZW50SW5mby5yZWNpcGllbnRDZXJ0aWZpY2F0ZS5nZXRQdWJsaWNLZXkoe1xuICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobTogYWxnb3JpdGhtUGFyYW1ldGVycyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzYWdlczogW1wiZW5jcnlwdFwiLCBcIndyYXBLZXlcIl1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGNyeXB0byk7XG4gICAgICAgICAgICAgICAgY29uc3QgZW5jcnlwdGVkS2V5ID0gYXdhaXQgY3J5cHRvLmVuY3J5cHQocHVibGljS2V5LmFsZ29yaXRobSwgcHVibGljS2V5LCBleHBvcnRlZFNlc3Npb25LZXkpO1xuICAgICAgICAgICAgICAgIHJlY2lwaWVudEluZm8uZW5jcnlwdGVkS2V5ID0gbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiBlbmNyeXB0ZWRLZXkgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCB7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IFN1YktFS1JlY2lwaWVudEluZm8gPSBhc3luYyAoaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlY2lwaWVudEluZm8gPSB0aGlzLnJlY2lwaWVudEluZm9zW2luZGV4XS52YWx1ZTtcbiAgICAgICAgICAgIGNvbnN0IGtla0FsZ29yaXRobSA9IGNyeXB0by5nZXRBbGdvcml0aG1CeU9JRChyZWNpcGllbnRJbmZvLmtleUVuY3J5cHRpb25BbGdvcml0aG0uYWxnb3JpdGhtSWQsIHRydWUsIFwia2VrQWxnb3JpdGhtXCIpO1xuICAgICAgICAgICAgY29uc3Qga2VrS2V5ID0gYXdhaXQgY3J5cHRvLmltcG9ydEtleShcInJhd1wiLCBuZXcgVWludDhBcnJheShyZWNpcGllbnRJbmZvLnByZURlZmluZWRLRUspLCBrZWtBbGdvcml0aG0sIHRydWUsIFtcIndyYXBLZXlcIl0pO1xuICAgICAgICAgICAgY29uc3Qgd3JhcHBlZEtleSA9IGF3YWl0IGNyeXB0by53cmFwS2V5KFwicmF3XCIsIHNlc3Npb25LZXksIGtla0tleSwga2VrQWxnb3JpdGhtKTtcbiAgICAgICAgICAgIHJlY2lwaWVudEluZm8uZW5jcnlwdGVkS2V5ID0gbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiB3cmFwcGVkS2V5IH0pO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCBTdWJQYXNzd29yZFJlY2lwaWVudGluZm8gPSBhc3luYyAoaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlY2lwaWVudEluZm8gPSB0aGlzLnJlY2lwaWVudEluZm9zW2luZGV4XS52YWx1ZTtcbiAgICAgICAgICAgIGxldCBwYmtkZjJQYXJhbXM7XG4gICAgICAgICAgICBpZiAoIXJlY2lwaWVudEluZm8ua2V5RGVyaXZhdGlvbkFsZ29yaXRobSlcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQbGVhc2UgYXBwZW5kIGVuY29kZWQgXFxcImtleURlcml2YXRpb25BbGdvcml0aG1cXFwiXCIpO1xuICAgICAgICAgICAgaWYgKCFyZWNpcGllbnRJbmZvLmtleURlcml2YXRpb25BbGdvcml0aG0uYWxnb3JpdGhtUGFyYW1zKVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkluY29ycmVjdGx5IGVuY29kZWQgXFxcImtleURlcml2YXRpb25BbGdvcml0aG1cXFwiXCIpO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBwYmtkZjJQYXJhbXMgPSBuZXcgUEJLREYyUGFyYW1zKHsgc2NoZW1hOiByZWNpcGllbnRJbmZvLmtleURlcml2YXRpb25BbGdvcml0aG0uYWxnb3JpdGhtUGFyYW1zIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2gge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkluY29ycmVjdGx5IGVuY29kZWQgXFxcImtleURlcml2YXRpb25BbGdvcml0aG1cXFwiXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgcGFzc3dvcmRWaWV3ID0gbmV3IFVpbnQ4QXJyYXkocmVjaXBpZW50SW5mby5wYXNzd29yZCk7XG4gICAgICAgICAgICBjb25zdCBkZXJpdmF0aW9uS2V5ID0gYXdhaXQgY3J5cHRvLmltcG9ydEtleShcInJhd1wiLCBwYXNzd29yZFZpZXcsIFwiUEJLREYyXCIsIGZhbHNlLCBbXCJkZXJpdmVLZXlcIl0pO1xuICAgICAgICAgICAgY29uc3Qga2VrQWxnb3JpdGhtID0gY3J5cHRvLmdldEFsZ29yaXRobUJ5T0lEKHJlY2lwaWVudEluZm8ua2V5RW5jcnlwdGlvbkFsZ29yaXRobS5hbGdvcml0aG1JZCwgdHJ1ZSwgXCJrZWtBbGdvcml0aG1cIik7XG4gICAgICAgICAgICBsZXQgaG1hY0hhc2hBbGdvcml0aG0gPSBcIlNIQS0xXCI7XG4gICAgICAgICAgICBpZiAocGJrZGYyUGFyYW1zLnByZikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHByZkFsZ29yaXRobSA9IGNyeXB0by5nZXRBbGdvcml0aG1CeU9JRChwYmtkZjJQYXJhbXMucHJmLmFsZ29yaXRobUlkLCB0cnVlLCBcInByZkFsZ29yaXRobVwiKTtcbiAgICAgICAgICAgICAgICBobWFjSGFzaEFsZ29yaXRobSA9IHByZkFsZ29yaXRobS5oYXNoLm5hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBzYWx0VmlldyA9IG5ldyBVaW50OEFycmF5KHBia2RmMlBhcmFtcy5zYWx0LnZhbHVlQmxvY2sudmFsdWVIZXgpO1xuICAgICAgICAgICAgY29uc3QgaXRlcmF0aW9ucyA9IHBia2RmMlBhcmFtcy5pdGVyYXRpb25Db3VudDtcbiAgICAgICAgICAgIGNvbnN0IGRlcml2ZWRLZXkgPSBhd2FpdCBjcnlwdG8uZGVyaXZlS2V5KHtcbiAgICAgICAgICAgICAgICBuYW1lOiBcIlBCS0RGMlwiLFxuICAgICAgICAgICAgICAgIGhhc2g6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogaG1hY0hhc2hBbGdvcml0aG1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHNhbHQ6IHNhbHRWaWV3LFxuICAgICAgICAgICAgICAgIGl0ZXJhdGlvbnNcbiAgICAgICAgICAgIH0sIGRlcml2YXRpb25LZXksIGtla0FsZ29yaXRobSwgdHJ1ZSwgW1wid3JhcEtleVwiXSk7XG4gICAgICAgICAgICBjb25zdCB3cmFwcGVkS2V5ID0gYXdhaXQgY3J5cHRvLndyYXBLZXkoXCJyYXdcIiwgc2Vzc2lvbktleSwgZGVyaXZlZEtleSwga2VrQWxnb3JpdGhtKTtcbiAgICAgICAgICAgIHJlY2lwaWVudEluZm8uZW5jcnlwdGVkS2V5ID0gbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiB3cmFwcGVkS2V5IH0pO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCByZXMgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnJlY2lwaWVudEluZm9zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHRoaXMucmVjaXBpZW50SW5mb3NbaV0udmFyaWFudCkge1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgcmVzLnB1c2goYXdhaXQgU3ViS2V5VHJhbnNSZWNpcGllbnRJbmZvKGkpKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICByZXMucHVzaChhd2FpdCBTdWJLZXlBZ3JlZVJlY2lwaWVudEluZm8oaSkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgIHJlcy5wdXNoKGF3YWl0IFN1YktFS1JlY2lwaWVudEluZm8oaSkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgIHJlcy5wdXNoKGF3YWl0IFN1YlBhc3N3b3JkUmVjaXBpZW50aW5mbyhpKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biByZWNpcGllbnQgdHlwZSBpbiBhcnJheSB3aXRoIGluZGV4ICR7aX1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbiAgICBhc3luYyBkZWNyeXB0KHJlY2lwaWVudEluZGV4LCBwYXJhbWV0ZXJzLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgY29uc3QgZGVjcnlwdGlvblBhcmFtZXRlcnMgPSBwYXJhbWV0ZXJzIHx8IHt9O1xuICAgICAgICBpZiAoKHJlY2lwaWVudEluZGV4ICsgMSkgPiB0aGlzLnJlY2lwaWVudEluZm9zLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBNYXhpbXVtIHZhbHVlIGZvciBcImluZGV4XCIgaXM6ICR7dGhpcy5yZWNpcGllbnRJbmZvcy5sZW5ndGggLSAxfWApO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IFN1YktleUFncmVlUmVjaXBpZW50SW5mbyA9IGFzeW5jIChpbmRleCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVjaXBpZW50SW5mbyA9IHRoaXMucmVjaXBpZW50SW5mb3NbaW5kZXhdLnZhbHVlO1xuICAgICAgICAgICAgbGV0IGN1cnZlT0lEO1xuICAgICAgICAgICAgbGV0IHJlY2lwaWVudEN1cnZlO1xuICAgICAgICAgICAgbGV0IHJlY2lwaWVudEN1cnZlTGVuZ3RoO1xuICAgICAgICAgICAgY29uc3Qgb3JpZ2luYXRvciA9IHJlY2lwaWVudEluZm8ub3JpZ2luYXRvcjtcbiAgICAgICAgICAgIGlmIChkZWNyeXB0aW9uUGFyYW1ldGVycy5yZWNpcGllbnRDZXJ0aWZpY2F0ZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnZlT2JqZWN0ID0gZGVjcnlwdGlvblBhcmFtZXRlcnMucmVjaXBpZW50Q2VydGlmaWNhdGUuc3ViamVjdFB1YmxpY0tleUluZm8uYWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcztcbiAgICAgICAgICAgICAgICBpZiAoY3VydmVPYmplY3QuY29uc3RydWN0b3IuYmxvY2tOYW1lKCkgIT09IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyLmJsb2NrTmFtZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5jb3JyZWN0IFwicmVjaXBpZW50Q2VydGlmaWNhdGVcIiBmb3IgaW5kZXggJHtpbmRleH1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY3VydmVPSUQgPSBjdXJ2ZU9iamVjdC52YWx1ZUJsb2NrLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChvcmlnaW5hdG9yLnZhbHVlLmFsZ29yaXRobS5hbGdvcml0aG1QYXJhbXMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJ2ZU9iamVjdCA9IG9yaWdpbmF0b3IudmFsdWUuYWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcztcbiAgICAgICAgICAgICAgICBpZiAoY3VydmVPYmplY3QuY29uc3RydWN0b3IuYmxvY2tOYW1lKCkgIT09IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyLmJsb2NrTmFtZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5jb3JyZWN0IG9yaWdpbmF0b3IgZm9yIGluZGV4ICR7aW5kZXh9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGN1cnZlT0lEID0gY3VydmVPYmplY3QudmFsdWVCbG9jay50b1N0cmluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUGFyYW1ldGVyIFxcXCJyZWNpcGllbnRDZXJ0aWZpY2F0ZVxcXCIgaXMgbWFuZGF0b3J5IGZvciBcXFwiS2V5QWdyZWVSZWNpcGllbnRJbmZvXFxcIiBpZiBhbGdvcml0aG0gcGFyYW1zIGFyZSBtaXNzaW5nIGZyb20gb3JpZ2luYXRvclwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghZGVjcnlwdGlvblBhcmFtZXRlcnMucmVjaXBpZW50UHJpdmF0ZUtleSlcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQYXJhbWV0ZXIgXFxcInJlY2lwaWVudFByaXZhdGVLZXlcXFwiIGlzIG1hbmRhdG9yeSBmb3IgXFxcIktleUFncmVlUmVjaXBpZW50SW5mb1xcXCJcIik7XG4gICAgICAgICAgICBzd2l0Y2ggKGN1cnZlT0lEKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcIjEuMi44NDAuMTAwNDUuMy4xLjdcIjpcbiAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50Q3VydmUgPSBcIlAtMjU2XCI7XG4gICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudEN1cnZlTGVuZ3RoID0gMjU2O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwiMS4zLjEzMi4wLjM0XCI6XG4gICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudEN1cnZlID0gXCJQLTM4NFwiO1xuICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRDdXJ2ZUxlbmd0aCA9IDM4NDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcIjEuMy4xMzIuMC4zNVwiOlxuICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRDdXJ2ZSA9IFwiUC01MjFcIjtcbiAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50Q3VydmVMZW5ndGggPSA1Mjg7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5jb3JyZWN0IGN1cnZlIE9JRCBmb3IgaW5kZXggJHtpbmRleH1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCBlY2RoUHJpdmF0ZUtleTtcbiAgICAgICAgICAgIGxldCBrZXlDcnlwdG8gPSBjcnlwdG87XG4gICAgICAgICAgICBpZiAoQnVmZmVyU291cmNlQ29udmVydGVyLmlzQnVmZmVyU291cmNlKGRlY3J5cHRpb25QYXJhbWV0ZXJzLnJlY2lwaWVudFByaXZhdGVLZXkpKSB7XG4gICAgICAgICAgICAgICAgZWNkaFByaXZhdGVLZXkgPSBhd2FpdCBjcnlwdG8uaW1wb3J0S2V5KFwicGtjczhcIiwgZGVjcnlwdGlvblBhcmFtZXRlcnMucmVjaXBpZW50UHJpdmF0ZUtleSwge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkVDREhcIixcbiAgICAgICAgICAgICAgICAgICAgbmFtZWRDdXJ2ZTogcmVjaXBpZW50Q3VydmVcbiAgICAgICAgICAgICAgICB9LCB0cnVlLCBbXCJkZXJpdmVCaXRzXCJdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGVjZGhQcml2YXRlS2V5ID0gZGVjcnlwdGlvblBhcmFtZXRlcnMucmVjaXBpZW50UHJpdmF0ZUtleTtcbiAgICAgICAgICAgICAgICBpZiAoXCJjcnlwdG9cIiBpbiBkZWNyeXB0aW9uUGFyYW1ldGVycyAmJiBkZWNyeXB0aW9uUGFyYW1ldGVycy5jcnlwdG8pIHtcbiAgICAgICAgICAgICAgICAgICAga2V5Q3J5cHRvID0gZGVjcnlwdGlvblBhcmFtZXRlcnMuY3J5cHRvLnN1YnRsZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoKFwiYWxnb3JpdGhtUGFyYW1zXCIgaW4gb3JpZ2luYXRvci52YWx1ZS5hbGdvcml0aG0pID09PSBmYWxzZSlcbiAgICAgICAgICAgICAgICBvcmlnaW5hdG9yLnZhbHVlLmFsZ29yaXRobS5hbGdvcml0aG1QYXJhbXMgPSBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyB2YWx1ZTogY3VydmVPSUQgfSk7XG4gICAgICAgICAgICBjb25zdCBidWZmZXIgPSBvcmlnaW5hdG9yLnZhbHVlLnRvU2NoZW1hKCkudG9CRVIoZmFsc2UpO1xuICAgICAgICAgICAgY29uc3QgZWNkaFB1YmxpY0tleSA9IGF3YWl0IGNyeXB0by5pbXBvcnRLZXkoXCJzcGtpXCIsIGJ1ZmZlciwge1xuICAgICAgICAgICAgICAgIG5hbWU6IFwiRUNESFwiLFxuICAgICAgICAgICAgICAgIG5hbWVkQ3VydmU6IHJlY2lwaWVudEN1cnZlXG4gICAgICAgICAgICB9LCB0cnVlLCBbXSk7XG4gICAgICAgICAgICBjb25zdCBzaGFyZWRTZWNyZXQgPSBhd2FpdCBrZXlDcnlwdG8uZGVyaXZlQml0cyh7XG4gICAgICAgICAgICAgICAgbmFtZTogXCJFQ0RIXCIsXG4gICAgICAgICAgICAgICAgcHVibGljOiBlY2RoUHVibGljS2V5XG4gICAgICAgICAgICB9LCBlY2RoUHJpdmF0ZUtleSwgcmVjaXBpZW50Q3VydmVMZW5ndGgpO1xuICAgICAgICAgICAgYXN5bmMgZnVuY3Rpb24gYXBwbHlLREYoaW5jbHVkZUFsZ29yaXRobVBhcmFtcykge1xuICAgICAgICAgICAgICAgIGluY2x1ZGVBbGdvcml0aG1QYXJhbXMgPSBpbmNsdWRlQWxnb3JpdGhtUGFyYW1zIHx8IGZhbHNlO1xuICAgICAgICAgICAgICAgIGNvbnN0IGFlc0tXQWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IHJlY2lwaWVudEluZm8ua2V5RW5jcnlwdGlvbkFsZ29yaXRobS5hbGdvcml0aG1QYXJhbXMgfSk7XG4gICAgICAgICAgICAgICAgY29uc3Qga3dBbGdvcml0aG0gPSBjcnlwdG8uZ2V0QWxnb3JpdGhtQnlPSUQoYWVzS1dBbGdvcml0aG0uYWxnb3JpdGhtSWQsIHRydWUsIFwia3dBbGdvcml0aG1cIik7XG4gICAgICAgICAgICAgICAgbGV0IGt3TGVuZ3RoID0ga3dBbGdvcml0aG0ubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGNvbnN0IGt3TGVuZ3RoQnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKDQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGt3TGVuZ3RoVmlldyA9IG5ldyBVaW50OEFycmF5KGt3TGVuZ3RoQnVmZmVyKTtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMzsgaiA+PSAwOyBqLS0pIHtcbiAgICAgICAgICAgICAgICAgICAga3dMZW5ndGhWaWV3W2pdID0ga3dMZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIGt3TGVuZ3RoID4+PSA4O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBrZXlJbmZvQWxnb3JpdGhtID0ge1xuICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1JZDogYWVzS1dBbGdvcml0aG0uYWxnb3JpdGhtSWRcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlmIChpbmNsdWRlQWxnb3JpdGhtUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgICAgIGtleUluZm9BbGdvcml0aG0uYWxnb3JpdGhtUGFyYW1zID0gbmV3IGFzbjFqcy5OdWxsKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGVjY0luZm8gPSBuZXcgRUNDQ01TU2hhcmVkSW5mbyh7XG4gICAgICAgICAgICAgICAgICAgIGtleUluZm86IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKGtleUluZm9BbGdvcml0aG0pLFxuICAgICAgICAgICAgICAgICAgICBlbnRpdHlVSW5mbzogcmVjaXBpZW50SW5mby51a20sXG4gICAgICAgICAgICAgICAgICAgIHN1cHBQdWJJbmZvOiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgdmFsdWVIZXg6IGt3TGVuZ3RoQnVmZmVyIH0pXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY29uc3QgZW5jb2RlZEluZm8gPSBlY2NJbmZvLnRvU2NoZW1hKCkudG9CRVIoZmFsc2UpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGVjZGhBbGdvcml0aG0gPSBjcnlwdG8uZ2V0QWxnb3JpdGhtQnlPSUQocmVjaXBpZW50SW5mby5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtLmFsZ29yaXRobUlkLCB0cnVlLCBcImVjZGhBbGdvcml0aG1cIik7XG4gICAgICAgICAgICAgICAgaWYgKCFlY2RoQWxnb3JpdGhtLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbmNvcnJlY3QgT0lEIGZvciBrZXkgZW5jcnlwdGlvbiBhbGdvcml0aG06ICR7cmVjaXBpZW50SW5mby5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtLmFsZ29yaXRobUlkfWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4ga2RmKGVjZGhBbGdvcml0aG0ua2RmLCBzaGFyZWRTZWNyZXQsIGt3QWxnb3JpdGhtLmxlbmd0aCwgZW5jb2RlZEluZm8sIGNyeXB0byk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBrZGZSZXN1bHQgPSBhd2FpdCBhcHBseUtERigpO1xuICAgICAgICAgICAgY29uc3QgaW1wb3J0QWVzS3dLZXkgPSBhc3luYyAoa2RmUmVzdWx0KSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNyeXB0by5pbXBvcnRLZXkoXCJyYXdcIiwga2RmUmVzdWx0LCB7IG5hbWU6IFwiQUVTLUtXXCIgfSwgdHJ1ZSwgW1widW53cmFwS2V5XCJdKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjb25zdCBhZXNLd0tleSA9IGF3YWl0IGltcG9ydEFlc0t3S2V5KGtkZlJlc3VsdCk7XG4gICAgICAgICAgICBjb25zdCB1bndyYXBTZXNzaW9uS2V5ID0gYXN5bmMgKGFlc0t3S2V5KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgYWxnb3JpdGhtSWQgPSB0aGlzLmVuY3J5cHRlZENvbnRlbnRJbmZvLmNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtLmFsZ29yaXRobUlkO1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtID0gY3J5cHRvLmdldEFsZ29yaXRobUJ5T0lEKGFsZ29yaXRobUlkLCB0cnVlLCBcImNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybiBjcnlwdG8udW53cmFwS2V5KFwicmF3XCIsIHJlY2lwaWVudEluZm8ucmVjaXBpZW50RW5jcnlwdGVkS2V5cy5lbmNyeXB0ZWRLZXlzWzBdLmVuY3J5cHRlZEtleS52YWx1ZUJsb2NrLnZhbHVlSGV4VmlldywgYWVzS3dLZXksIHsgbmFtZTogXCJBRVMtS1dcIiB9LCBjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobSwgdHJ1ZSwgW1wiZGVjcnlwdFwiXSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdW53cmFwU2Vzc2lvbktleShhZXNLd0tleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCB7XG4gICAgICAgICAgICAgICAgY29uc3Qga2RmUmVzdWx0ID0gYXdhaXQgYXBwbHlLREYodHJ1ZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgYWVzS3dLZXkgPSBhd2FpdCBpbXBvcnRBZXNLd0tleShrZGZSZXN1bHQpO1xuICAgICAgICAgICAgICAgIHJldHVybiB1bndyYXBTZXNzaW9uS2V5KGFlc0t3S2V5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgU3ViS2V5VHJhbnNSZWNpcGllbnRJbmZvID0gYXN5bmMgKGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZWNpcGllbnRJbmZvID0gdGhpcy5yZWNpcGllbnRJbmZvc1tpbmRleF0udmFsdWU7XG4gICAgICAgICAgICBpZiAoIWRlY3J5cHRpb25QYXJhbWV0ZXJzLnJlY2lwaWVudFByaXZhdGVLZXkpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQYXJhbWV0ZXIgXFxcInJlY2lwaWVudFByaXZhdGVLZXlcXFwiIGlzIG1hbmRhdG9yeSBmb3IgXFxcIktleVRyYW5zUmVjaXBpZW50SW5mb1xcXCJcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBhbGdvcml0aG1QYXJhbWV0ZXJzID0gY3J5cHRvLmdldEFsZ29yaXRobUJ5T0lEKHJlY2lwaWVudEluZm8ua2V5RW5jcnlwdGlvbkFsZ29yaXRobS5hbGdvcml0aG1JZCwgdHJ1ZSwgXCJrZXlFbmNyeXB0aW9uQWxnb3JpdGhtXCIpO1xuICAgICAgICAgICAgaWYgKGFsZ29yaXRobVBhcmFtZXRlcnMubmFtZSA9PT0gXCJSU0EtT0FFUFwiKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2NoZW1hID0gcmVjaXBpZW50SW5mby5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcztcbiAgICAgICAgICAgICAgICBjb25zdCByc2FPQUVQUGFyYW1zID0gbmV3IFJTQUVTT0FFUFBhcmFtcyh7IHNjaGVtYSB9KTtcbiAgICAgICAgICAgICAgICBhbGdvcml0aG1QYXJhbWV0ZXJzLmhhc2ggPSBjcnlwdG8uZ2V0QWxnb3JpdGhtQnlPSUQocnNhT0FFUFBhcmFtcy5oYXNoQWxnb3JpdGhtLmFsZ29yaXRobUlkKTtcbiAgICAgICAgICAgICAgICBpZiAoKFwibmFtZVwiIGluIGFsZ29yaXRobVBhcmFtZXRlcnMuaGFzaCkgPT09IGZhbHNlKVxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBPSUQgZm9yIGhhc2ggYWxnb3JpdGhtOiAke3JzYU9BRVBQYXJhbXMuaGFzaEFsZ29yaXRobS5hbGdvcml0aG1JZH1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCBwcml2YXRlS2V5O1xuICAgICAgICAgICAgbGV0IGtleUNyeXB0byA9IGNyeXB0bztcbiAgICAgICAgICAgIGlmIChCdWZmZXJTb3VyY2VDb252ZXJ0ZXIuaXNCdWZmZXJTb3VyY2UoZGVjcnlwdGlvblBhcmFtZXRlcnMucmVjaXBpZW50UHJpdmF0ZUtleSkpIHtcbiAgICAgICAgICAgICAgICBwcml2YXRlS2V5ID0gYXdhaXQgY3J5cHRvLmltcG9ydEtleShcInBrY3M4XCIsIGRlY3J5cHRpb25QYXJhbWV0ZXJzLnJlY2lwaWVudFByaXZhdGVLZXksIGFsZ29yaXRobVBhcmFtZXRlcnMsIHRydWUsIFtcImRlY3J5cHRcIl0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcHJpdmF0ZUtleSA9IGRlY3J5cHRpb25QYXJhbWV0ZXJzLnJlY2lwaWVudFByaXZhdGVLZXk7XG4gICAgICAgICAgICAgICAgaWYgKFwiY3J5cHRvXCIgaW4gZGVjcnlwdGlvblBhcmFtZXRlcnMgJiYgZGVjcnlwdGlvblBhcmFtZXRlcnMuY3J5cHRvKSB7XG4gICAgICAgICAgICAgICAgICAgIGtleUNyeXB0byA9IGRlY3J5cHRpb25QYXJhbWV0ZXJzLmNyeXB0by5zdWJ0bGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3Qgc2Vzc2lvbktleSA9IGF3YWl0IGtleUNyeXB0by5kZWNyeXB0KHByaXZhdGVLZXkuYWxnb3JpdGhtLCBwcml2YXRlS2V5LCByZWNpcGllbnRJbmZvLmVuY3J5cHRlZEtleS52YWx1ZUJsb2NrLnZhbHVlSGV4Vmlldyk7XG4gICAgICAgICAgICBjb25zdCBhbGdvcml0aG1JZCA9IHRoaXMuZW5jcnlwdGVkQ29udGVudEluZm8uY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0uYWxnb3JpdGhtSWQ7XG4gICAgICAgICAgICBjb25zdCBjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobSA9IGNyeXB0by5nZXRBbGdvcml0aG1CeU9JRChhbGdvcml0aG1JZCwgdHJ1ZSwgXCJjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobVwiKTtcbiAgICAgICAgICAgIGlmICgoXCJuYW1lXCIgaW4gY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0pID09PSBmYWxzZSlcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBcImNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtXCI6ICR7YWxnb3JpdGhtSWR9YCk7XG4gICAgICAgICAgICByZXR1cm4gY3J5cHRvLmltcG9ydEtleShcInJhd1wiLCBzZXNzaW9uS2V5LCBjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobSwgdHJ1ZSwgW1wiZGVjcnlwdFwiXSk7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IFN1YktFS1JlY2lwaWVudEluZm8gPSBhc3luYyAoaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlY2lwaWVudEluZm8gPSB0aGlzLnJlY2lwaWVudEluZm9zW2luZGV4XS52YWx1ZTtcbiAgICAgICAgICAgIGlmICghZGVjcnlwdGlvblBhcmFtZXRlcnMucHJlRGVmaW5lZERhdGEpXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUGFyYW1ldGVyIFxcXCJwcmVEZWZpbmVkRGF0YVxcXCIgaXMgbWFuZGF0b3J5IGZvciBcXFwiS0VLUmVjaXBpZW50SW5mb1xcXCJcIik7XG4gICAgICAgICAgICBjb25zdCBrZWtBbGdvcml0aG0gPSBjcnlwdG8uZ2V0QWxnb3JpdGhtQnlPSUQocmVjaXBpZW50SW5mby5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtLmFsZ29yaXRobUlkLCB0cnVlLCBcImtla0FsZ29yaXRobVwiKTtcbiAgICAgICAgICAgIGNvbnN0IGltcG9ydGVkS2V5ID0gYXdhaXQgY3J5cHRvLmltcG9ydEtleShcInJhd1wiLCBkZWNyeXB0aW9uUGFyYW1ldGVycy5wcmVEZWZpbmVkRGF0YSwga2VrQWxnb3JpdGhtLCB0cnVlLCBbXCJ1bndyYXBLZXlcIl0pO1xuICAgICAgICAgICAgY29uc3QgYWxnb3JpdGhtSWQgPSB0aGlzLmVuY3J5cHRlZENvbnRlbnRJbmZvLmNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtLmFsZ29yaXRobUlkO1xuICAgICAgICAgICAgY29uc3QgY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0gPSBjcnlwdG8uZ2V0QWxnb3JpdGhtQnlPSUQoYWxnb3JpdGhtSWQsIHRydWUsIFwiY29udGVudEVuY3J5cHRpb25BbGdvcml0aG1cIik7XG4gICAgICAgICAgICBpZiAoIWNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtLm5hbWUpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBcImNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtXCI6ICR7YWxnb3JpdGhtSWR9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY3J5cHRvLnVud3JhcEtleShcInJhd1wiLCByZWNpcGllbnRJbmZvLmVuY3J5cHRlZEtleS52YWx1ZUJsb2NrLnZhbHVlSGV4VmlldywgaW1wb3J0ZWRLZXksIGtla0FsZ29yaXRobSwgY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0sIHRydWUsIFtcImRlY3J5cHRcIl0pO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCBTdWJQYXNzd29yZFJlY2lwaWVudGluZm8gPSBhc3luYyAoaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlY2lwaWVudEluZm8gPSB0aGlzLnJlY2lwaWVudEluZm9zW2luZGV4XS52YWx1ZTtcbiAgICAgICAgICAgIGxldCBwYmtkZjJQYXJhbXM7XG4gICAgICAgICAgICBpZiAoIWRlY3J5cHRpb25QYXJhbWV0ZXJzLnByZURlZmluZWREYXRhKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUGFyYW1ldGVyIFxcXCJwcmVEZWZpbmVkRGF0YVxcXCIgaXMgbWFuZGF0b3J5IGZvciBcXFwiS0VLUmVjaXBpZW50SW5mb1xcXCJcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXJlY2lwaWVudEluZm8ua2V5RGVyaXZhdGlvbkFsZ29yaXRobSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlBsZWFzZSBhcHBlbmQgZW5jb2RlZCBcXFwia2V5RGVyaXZhdGlvbkFsZ29yaXRobVxcXCJcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXJlY2lwaWVudEluZm8ua2V5RGVyaXZhdGlvbkFsZ29yaXRobS5hbGdvcml0aG1QYXJhbXMpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbmNvcnJlY3RseSBlbmNvZGVkIFxcXCJrZXlEZXJpdmF0aW9uQWxnb3JpdGhtXFxcIlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgcGJrZGYyUGFyYW1zID0gbmV3IFBCS0RGMlBhcmFtcyh7IHNjaGVtYTogcmVjaXBpZW50SW5mby5rZXlEZXJpdmF0aW9uQWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbmNvcnJlY3RseSBlbmNvZGVkIFxcXCJrZXlEZXJpdmF0aW9uQWxnb3JpdGhtXFxcIlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHBia2RmMktleSA9IGF3YWl0IGNyeXB0by5pbXBvcnRLZXkoXCJyYXdcIiwgZGVjcnlwdGlvblBhcmFtZXRlcnMucHJlRGVmaW5lZERhdGEsIFwiUEJLREYyXCIsIGZhbHNlLCBbXCJkZXJpdmVLZXlcIl0pO1xuICAgICAgICAgICAgY29uc3Qga2VrQWxnb3JpdGhtID0gY3J5cHRvLmdldEFsZ29yaXRobUJ5T0lEKHJlY2lwaWVudEluZm8ua2V5RW5jcnlwdGlvbkFsZ29yaXRobS5hbGdvcml0aG1JZCwgdHJ1ZSwgXCJrZXlFbmNyeXB0aW9uQWxnb3JpdGhtXCIpO1xuICAgICAgICAgICAgY29uc3QgaG1hY0hhc2hBbGdvcml0aG0gPSBwYmtkZjJQYXJhbXMucHJmXG4gICAgICAgICAgICAgICAgPyBjcnlwdG8uZ2V0QWxnb3JpdGhtQnlPSUQocGJrZGYyUGFyYW1zLnByZi5hbGdvcml0aG1JZCwgdHJ1ZSwgXCJwcmZBbGdvcml0aG1cIikuaGFzaC5uYW1lXG4gICAgICAgICAgICAgICAgOiBcIlNIQS0xXCI7XG4gICAgICAgICAgICBjb25zdCBzYWx0VmlldyA9IG5ldyBVaW50OEFycmF5KHBia2RmMlBhcmFtcy5zYWx0LnZhbHVlQmxvY2sudmFsdWVIZXgpO1xuICAgICAgICAgICAgY29uc3QgaXRlcmF0aW9ucyA9IHBia2RmMlBhcmFtcy5pdGVyYXRpb25Db3VudDtcbiAgICAgICAgICAgIGNvbnN0IGtla0tleSA9IGF3YWl0IGNyeXB0by5kZXJpdmVLZXkoe1xuICAgICAgICAgICAgICAgIG5hbWU6IFwiUEJLREYyXCIsXG4gICAgICAgICAgICAgICAgaGFzaDoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBobWFjSGFzaEFsZ29yaXRobVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc2FsdDogc2FsdFZpZXcsXG4gICAgICAgICAgICAgICAgaXRlcmF0aW9uc1xuICAgICAgICAgICAgfSwgcGJrZGYyS2V5LCBrZWtBbGdvcml0aG0sIHRydWUsIFtcInVud3JhcEtleVwiXSk7XG4gICAgICAgICAgICBjb25zdCBhbGdvcml0aG1JZCA9IHRoaXMuZW5jcnlwdGVkQ29udGVudEluZm8uY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0uYWxnb3JpdGhtSWQ7XG4gICAgICAgICAgICBjb25zdCBjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobSA9IGNyeXB0by5nZXRBbGdvcml0aG1CeU9JRChhbGdvcml0aG1JZCwgdHJ1ZSwgXCJjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobVwiKTtcbiAgICAgICAgICAgIHJldHVybiBjcnlwdG8udW53cmFwS2V5KFwicmF3XCIsIHJlY2lwaWVudEluZm8uZW5jcnlwdGVkS2V5LnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3LCBrZWtLZXksIGtla0FsZ29yaXRobSwgY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0sIHRydWUsIFtcImRlY3J5cHRcIl0pO1xuICAgICAgICB9O1xuICAgICAgICBsZXQgdW53cmFwcGVkS2V5O1xuICAgICAgICBzd2l0Y2ggKHRoaXMucmVjaXBpZW50SW5mb3NbcmVjaXBpZW50SW5kZXhdLnZhcmlhbnQpIHtcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICB1bndyYXBwZWRLZXkgPSBhd2FpdCBTdWJLZXlUcmFuc1JlY2lwaWVudEluZm8ocmVjaXBpZW50SW5kZXgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIHVud3JhcHBlZEtleSA9IGF3YWl0IFN1YktleUFncmVlUmVjaXBpZW50SW5mbyhyZWNpcGllbnRJbmRleCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgdW53cmFwcGVkS2V5ID0gYXdhaXQgU3ViS0VLUmVjaXBpZW50SW5mbyhyZWNpcGllbnRJbmRleCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgdW53cmFwcGVkS2V5ID0gYXdhaXQgU3ViUGFzc3dvcmRSZWNpcGllbnRpbmZvKHJlY2lwaWVudEluZGV4KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIHJlY2lwaWVudCB0eXBlIGluIGFycmF5IHdpdGggaW5kZXggJHtyZWNpcGllbnRJbmRleH1gKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBhbGdvcml0aG1JZCA9IHRoaXMuZW5jcnlwdGVkQ29udGVudEluZm8uY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0uYWxnb3JpdGhtSWQ7XG4gICAgICAgIGNvbnN0IGNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtID0gY3J5cHRvLmdldEFsZ29yaXRobUJ5T0lEKGFsZ29yaXRobUlkLCB0cnVlLCBcImNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtXCIpO1xuICAgICAgICBjb25zdCBpdkJ1ZmZlciA9IHRoaXMuZW5jcnlwdGVkQ29udGVudEluZm8uY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0uYWxnb3JpdGhtUGFyYW1zLnZhbHVlQmxvY2sudmFsdWVIZXg7XG4gICAgICAgIGNvbnN0IGl2VmlldyA9IG5ldyBVaW50OEFycmF5KGl2QnVmZmVyKTtcbiAgICAgICAgaWYgKCF0aGlzLmVuY3J5cHRlZENvbnRlbnRJbmZvLmVuY3J5cHRlZENvbnRlbnQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlJlcXVpcmVkIHByb3BlcnR5IGBlbmNyeXB0ZWRDb250ZW50YCBpcyBlbXB0eVwiKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBkYXRhQnVmZmVyID0gdGhpcy5lbmNyeXB0ZWRDb250ZW50SW5mby5nZXRFbmNyeXB0ZWRDb250ZW50KCk7XG4gICAgICAgIHJldHVybiBjcnlwdG8uZGVjcnlwdCh7XG4gICAgICAgICAgICBuYW1lOiBjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobS5uYW1lLFxuICAgICAgICAgICAgaXY6IGl2Vmlld1xuICAgICAgICB9LCB1bndyYXBwZWRLZXksIGRhdGFCdWZmZXIpO1xuICAgIH1cbn1cbkVudmVsb3BlZERhdGEuQ0xBU1NfTkFNRSA9IFwiRW52ZWxvcGVkRGF0YVwiO1xuXG5jb25zdCBTQUZFX0NPTlRFTlRTID0gXCJzYWZlQ29udGVudHNcIjtcbmNvbnN0IFBBUlNFRF9WQUxVRSQxID0gXCJwYXJzZWRWYWx1ZVwiO1xuY29uc3QgQ09OVEVOVF9JTkZPUyA9IFwiY29udGVudEluZm9zXCI7XG5jbGFzcyBBdXRoZW50aWNhdGVkU2FmZSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuc2FmZUNvbnRlbnRzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU0FGRV9DT05URU5UUywgQXV0aGVudGljYXRlZFNhZmUuZGVmYXVsdFZhbHVlcyhTQUZFX0NPTlRFTlRTKSk7XG4gICAgICAgIGlmIChQQVJTRURfVkFMVUUkMSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnBhcnNlZFZhbHVlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUEFSU0VEX1ZBTFVFJDEsIEF1dGhlbnRpY2F0ZWRTYWZlLmRlZmF1bHRWYWx1ZXMoUEFSU0VEX1ZBTFVFJDEpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgU0FGRV9DT05URU5UUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBjYXNlIFBBUlNFRF9WQUxVRSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgU0FGRV9DT05URU5UUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBjYXNlIFBBUlNFRF9WQUxVRSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKG1lbWJlclZhbHVlIGluc3RhbmNlb2YgT2JqZWN0KSAmJiAoT2JqZWN0LmtleXMobWVtYmVyVmFsdWUpLmxlbmd0aCA9PT0gMCkpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmNvbnRlbnRJbmZvcyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQ29udGVudEluZm8uc2NoZW1hKClcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIFtcbiAgICAgICAgICAgIENPTlRFTlRfSU5GT1NcbiAgICAgICAgXSk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgQXV0aGVudGljYXRlZFNhZmUuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgY29udGVudEluZm9zOiBDT05URU5UX0lORk9TXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5zYWZlQ29udGVudHMgPSBBcnJheS5mcm9tKGFzbjEucmVzdWx0LmNvbnRlbnRJbmZvcywgZWxlbWVudCA9PiBuZXcgQ29udGVudEluZm8oeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMuc2FmZUNvbnRlbnRzLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzYWZlQ29udGVudHM6IEFycmF5LmZyb20odGhpcy5zYWZlQ29udGVudHMsIG8gPT4gby50b0pTT04oKSlcbiAgICAgICAgfTtcbiAgICB9XG4gICAgYXN5bmMgcGFyc2VJbnRlcm5hbFZhbHVlcyhwYXJhbWV0ZXJzLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgUGFyYW1ldGVyRXJyb3IuYXNzZXJ0KHBhcmFtZXRlcnMsIFNBRkVfQ09OVEVOVFMpO1xuICAgICAgICBBcmd1bWVudEVycm9yLmFzc2VydChwYXJhbWV0ZXJzLnNhZmVDb250ZW50cywgU0FGRV9DT05URU5UUywgXCJBcnJheVwiKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2FmZUNvbnRlbnRzLmxlbmd0aCAhPT0gdGhpcy5zYWZlQ29udGVudHMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnRFcnJvcihcIkxlbmd0aCBvZiBcXFwicGFyYW1ldGVycy5zYWZlQ29udGVudHNcXFwiIG11c3QgYmUgZXF1YWwgdG8gXFxcInRoaXMuc2FmZUNvbnRlbnRzLmxlbmd0aFxcXCJcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wYXJzZWRWYWx1ZSA9IHtcbiAgICAgICAgICAgIHNhZmVDb250ZW50czogW10sXG4gICAgICAgIH07XG4gICAgICAgIGZvciAoY29uc3QgW2luZGV4LCBjb250ZW50XSBvZiB0aGlzLnNhZmVDb250ZW50cy5lbnRyaWVzKCkpIHtcbiAgICAgICAgICAgIGNvbnN0IHNhZmVDb250ZW50ID0gcGFyYW1ldGVycy5zYWZlQ29udGVudHNbaW5kZXhdO1xuICAgICAgICAgICAgY29uc3QgZXJyb3JUYXJnZXQgPSBgcGFyYW1ldGVycy5zYWZlQ29udGVudHNbJHtpbmRleH1dYDtcbiAgICAgICAgICAgIHN3aXRjaCAoY29udGVudC5jb250ZW50VHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgaWRfQ29udGVudFR5cGVfRGF0YTpcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgQXJndW1lbnRFcnJvci5hc3NlcnQoY29udGVudC5jb250ZW50LCBcInRoaXMuc2FmZUNvbnRlbnRzW2pdLmNvbnRlbnRcIiwgYXNuMWpzLk9jdGV0U3RyaW5nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGF1dGhTYWZlQ29udGVudCA9IGNvbnRlbnQuY29udGVudC5nZXRWYWx1ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJzZWRWYWx1ZS5zYWZlQ29udGVudHMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpdmFjeU1vZGU6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFNhZmVDb250ZW50cy5mcm9tQkVSKGF1dGhTYWZlQ29udGVudClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgaWRfQ29udGVudFR5cGVfRW52ZWxvcGVkRGF0YTpcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY21zRW52ZWxvcGVkID0gbmV3IEVudmVsb3BlZERhdGEoeyBzY2hlbWE6IGNvbnRlbnQuY29udGVudCB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFBhcmFtZXRlckVycm9yLmFzc2VydChlcnJvclRhcmdldCwgc2FmZUNvbnRlbnQsIFwicmVjaXBpZW50Q2VydGlmaWNhdGVcIiwgXCJyZWNpcGllbnRLZXlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlbnZlbG9wZWREYXRhID0gc2FmZUNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZWNpcGllbnRDZXJ0aWZpY2F0ZSA9IGVudmVsb3BlZERhdGEucmVjaXBpZW50Q2VydGlmaWNhdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZWNpcGllbnRLZXkgPSBlbnZlbG9wZWREYXRhLnJlY2lwaWVudEtleTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlY3J5cHRlZCA9IGF3YWl0IGNtc0VudmVsb3BlZC5kZWNyeXB0KDAsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRDZXJ0aWZpY2F0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRQcml2YXRlS2V5OiByZWNpcGllbnRLZXlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGNyeXB0byk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcnNlZFZhbHVlLnNhZmVDb250ZW50cy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcml2YWN5TW9kZTogMixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogU2FmZUNvbnRlbnRzLmZyb21CRVIoZGVjcnlwdGVkKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgaWRfQ29udGVudFR5cGVfRW5jcnlwdGVkRGF0YTpcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY21zRW5jcnlwdGVkID0gbmV3IEVuY3J5cHRlZERhdGEoeyBzY2hlbWE6IGNvbnRlbnQuY29udGVudCB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFBhcmFtZXRlckVycm9yLmFzc2VydChlcnJvclRhcmdldCwgc2FmZUNvbnRlbnQsIFwicGFzc3dvcmRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXNzd29yZCA9IHNhZmVDb250ZW50LnBhc3N3b3JkO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVjcnlwdGVkID0gYXdhaXQgY21zRW5jcnlwdGVkLmRlY3J5cHQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBjcnlwdG8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJzZWRWYWx1ZS5zYWZlQ29udGVudHMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpdmFjeU1vZGU6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFNhZmVDb250ZW50cy5mcm9tQkVSKGRlY3J5cHRlZCksXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gXCJjb250ZW50VHlwZVwiIGZvciBBdXRoZW50aWNhdGVkU2FmZTogXCIgJHtjb250ZW50LmNvbnRlbnRUeXBlfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGFzeW5jIG1ha2VJbnRlcm5hbFZhbHVlcyhwYXJhbWV0ZXJzLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgaWYgKCEodGhpcy5wYXJzZWRWYWx1ZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlBsZWFzZSBydW4gXFxcInBhcnNlVmFsdWVzXFxcIiBmaXJzdCBvciBhZGQgXFxcInBhcnNlZFZhbHVlXFxcIiBtYW51YWxseVwiKTtcbiAgICAgICAgfVxuICAgICAgICBBcmd1bWVudEVycm9yLmFzc2VydCh0aGlzLnBhcnNlZFZhbHVlLCBcInRoaXMucGFyc2VkVmFsdWVcIiwgXCJvYmplY3RcIik7XG4gICAgICAgIEFyZ3VtZW50RXJyb3IuYXNzZXJ0KHRoaXMucGFyc2VkVmFsdWUuc2FmZUNvbnRlbnRzLCBcInRoaXMucGFyc2VkVmFsdWUuc2FmZUNvbnRlbnRzXCIsIFwiQXJyYXlcIik7XG4gICAgICAgIEFyZ3VtZW50RXJyb3IuYXNzZXJ0KHBhcmFtZXRlcnMsIFwicGFyYW1ldGVyc1wiLCBcIm9iamVjdFwiKTtcbiAgICAgICAgUGFyYW1ldGVyRXJyb3IuYXNzZXJ0KHBhcmFtZXRlcnMsIFwic2FmZUNvbnRlbnRzXCIpO1xuICAgICAgICBBcmd1bWVudEVycm9yLmFzc2VydChwYXJhbWV0ZXJzLnNhZmVDb250ZW50cywgXCJwYXJhbWV0ZXJzLnNhZmVDb250ZW50c1wiLCBcIkFycmF5XCIpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zYWZlQ29udGVudHMubGVuZ3RoICE9PSB0aGlzLnBhcnNlZFZhbHVlLnNhZmVDb250ZW50cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBcmd1bWVudEVycm9yKFwiTGVuZ3RoIG9mIFxcXCJwYXJhbWV0ZXJzLnNhZmVDb250ZW50c1xcXCIgbXVzdCBiZSBlcXVhbCB0byBcXFwidGhpcy5wYXJzZWRWYWx1ZS5zYWZlQ29udGVudHNcXFwiXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2FmZUNvbnRlbnRzID0gW107XG4gICAgICAgIGZvciAoY29uc3QgW2luZGV4LCBjb250ZW50XSBvZiB0aGlzLnBhcnNlZFZhbHVlLnNhZmVDb250ZW50cy5lbnRyaWVzKCkpIHtcbiAgICAgICAgICAgIFBhcmFtZXRlckVycm9yLmFzc2VydChcImNvbnRlbnRcIiwgY29udGVudCwgXCJwcml2YWN5TW9kZVwiLCBcInZhbHVlXCIpO1xuICAgICAgICAgICAgQXJndW1lbnRFcnJvci5hc3NlcnQoY29udGVudC52YWx1ZSwgXCJjb250ZW50LnZhbHVlXCIsIFNhZmVDb250ZW50cyk7XG4gICAgICAgICAgICBzd2l0Y2ggKGNvbnRlbnQucHJpdmFjeU1vZGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRCdWZmZXIgPSBjb250ZW50LnZhbHVlLnRvU2NoZW1hKCkudG9CRVIoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zYWZlQ29udGVudHMucHVzaChuZXcgQ29udGVudEluZm8oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiBcIjEuMi44NDAuMTEzNTQ5LjEuNy4xXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiBjb250ZW50QnVmZmVyIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjbXNFbmNyeXB0ZWQgPSBuZXcgRW5jcnlwdGVkRGF0YSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFBhcmFtZXRlcnMgPSBwYXJhbWV0ZXJzLnNhZmVDb250ZW50c1tpbmRleF07XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UGFyYW1ldGVycy5jb250ZW50VG9FbmNyeXB0ID0gY29udGVudC52YWx1ZS50b1NjaGVtYSgpLnRvQkVSKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGNtc0VuY3J5cHRlZC5lbmNyeXB0KGN1cnJlbnRQYXJhbWV0ZXJzLCBjcnlwdG8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zYWZlQ29udGVudHMucHVzaChuZXcgQ29udGVudEluZm8oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiBcIjEuMi44NDAuMTEzNTQ5LjEuNy42XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogY21zRW5jcnlwdGVkLnRvU2NoZW1hKClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNtc0VudmVsb3BlZCA9IG5ldyBFbnZlbG9wZWREYXRhKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50VG9FbmNyeXB0ID0gY29udGVudC52YWx1ZS50b1NjaGVtYSgpLnRvQkVSKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNhZmVDb250ZW50ID0gcGFyYW1ldGVycy5zYWZlQ29udGVudHNbaW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgUGFyYW1ldGVyRXJyb3IuYXNzZXJ0KGBwYXJhbWV0ZXJzLnNhZmVDb250ZW50c1ske2luZGV4fV1gLCBzYWZlQ29udGVudCwgXCJlbmNyeXB0aW5nQ2VydGlmaWNhdGVcIiwgXCJlbmNyeXB0aW9uQWxnb3JpdGhtXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAoc2FmZUNvbnRlbnQuZW5jcnlwdGlvbkFsZ29yaXRobS5uYW1lLnRvTG93ZXJDYXNlKCkgPT09IFwiYWVzLWNiY1wiKTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIChzYWZlQ29udGVudC5lbmNyeXB0aW9uQWxnb3JpdGhtLm5hbWUudG9Mb3dlckNhc2UoKSA9PT0gXCJhZXMtZ2NtXCIpOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBwYXJhbWV0ZXIgXCJlbmNyeXB0aW9uQWxnb3JpdGhtXCIgaW4gXCJwYXJhbWV0ZXJzLnNhZmVDb250ZW50c1tpXVwiOiAke3NhZmVDb250ZW50LmVuY3J5cHRpb25BbGdvcml0aG19YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIChzYWZlQ29udGVudC5lbmNyeXB0aW9uQWxnb3JpdGhtLmxlbmd0aCA9PT0gMTI4KTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIChzYWZlQ29udGVudC5lbmNyeXB0aW9uQWxnb3JpdGhtLmxlbmd0aCA9PT0gMTkyKTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIChzYWZlQ29udGVudC5lbmNyeXB0aW9uQWxnb3JpdGhtLmxlbmd0aCA9PT0gMjU2KTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbmNvcnJlY3QgcGFyYW1ldGVyIFwiZW5jcnlwdGlvbkFsZ29yaXRobS5sZW5ndGhcIiBpbiBcInBhcmFtZXRlcnMuc2FmZUNvbnRlbnRzW2ldXCI6ICR7c2FmZUNvbnRlbnQuZW5jcnlwdGlvbkFsZ29yaXRobS5sZW5ndGh9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmNyeXB0aW9uQWxnb3JpdGhtID0gc2FmZUNvbnRlbnQuZW5jcnlwdGlvbkFsZ29yaXRobTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNtc0VudmVsb3BlZC5hZGRSZWNpcGllbnRCeUNlcnRpZmljYXRlKHNhZmVDb250ZW50LmVuY3J5cHRpbmdDZXJ0aWZpY2F0ZSwge30sIHVuZGVmaW5lZCwgY3J5cHRvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGNtc0VudmVsb3BlZC5lbmNyeXB0KGVuY3J5cHRpb25BbGdvcml0aG0sIGNvbnRlbnRUb0VuY3J5cHQsIGNyeXB0byk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNhZmVDb250ZW50cy5wdXNoKG5ldyBDb250ZW50SW5mbyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFR5cGU6IFwiMS4yLjg0MC4xMTM1NDkuMS43LjNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBjbXNFbnZlbG9wZWQudG9TY2hlbWEoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5jb3JyZWN0IHZhbHVlIGZvciBcImNvbnRlbnQucHJpdmFjeU1vZGVcIjogJHtjb250ZW50LnByaXZhY3lNb2RlfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbn1cbkF1dGhlbnRpY2F0ZWRTYWZlLkNMQVNTX05BTUUgPSBcIkF1dGhlbnRpY2F0ZWRTYWZlXCI7XG5cbmNvbnN0IEhBU0hfQUxHT1JJVEhNJDEgPSBcImhhc2hBbGdvcml0aG1cIjtcbmNvbnN0IElTU1VFUl9OQU1FX0hBU0ggPSBcImlzc3Vlck5hbWVIYXNoXCI7XG5jb25zdCBJU1NVRVJfS0VZX0hBU0ggPSBcImlzc3VlcktleUhhc2hcIjtcbmNvbnN0IFNFUklBTF9OVU1CRVIkMSA9IFwic2VyaWFsTnVtYmVyXCI7XG5jb25zdCBDTEVBUl9QUk9QUyRqID0gW1xuICAgIEhBU0hfQUxHT1JJVEhNJDEsXG4gICAgSVNTVUVSX05BTUVfSEFTSCxcbiAgICBJU1NVRVJfS0VZX0hBU0gsXG4gICAgU0VSSUFMX05VTUJFUiQxLFxuXTtcbmNsYXNzIENlcnRJRCBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgc3RhdGljIGFzeW5jIGNyZWF0ZShjZXJ0aWZpY2F0ZSwgcGFyYW1ldGVycywgY3J5cHRvID0gZ2V0Q3J5cHRvKHRydWUpKSB7XG4gICAgICAgIGNvbnN0IGNlcnRJRCA9IG5ldyBDZXJ0SUQoKTtcbiAgICAgICAgYXdhaXQgY2VydElELmNyZWF0ZUZvckNlcnRpZmljYXRlKGNlcnRpZmljYXRlLCBwYXJhbWV0ZXJzLCBjcnlwdG8pO1xuICAgICAgICByZXR1cm4gY2VydElEO1xuICAgIH1cbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5oYXNoQWxnb3JpdGhtID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgSEFTSF9BTEdPUklUSE0kMSwgQ2VydElELmRlZmF1bHRWYWx1ZXMoSEFTSF9BTEdPUklUSE0kMSkpO1xuICAgICAgICB0aGlzLmlzc3Vlck5hbWVIYXNoID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgSVNTVUVSX05BTUVfSEFTSCwgQ2VydElELmRlZmF1bHRWYWx1ZXMoSVNTVUVSX05BTUVfSEFTSCkpO1xuICAgICAgICB0aGlzLmlzc3VlcktleUhhc2ggPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBJU1NVRVJfS0VZX0hBU0gsIENlcnRJRC5kZWZhdWx0VmFsdWVzKElTU1VFUl9LRVlfSEFTSCkpO1xuICAgICAgICB0aGlzLnNlcmlhbE51bWJlciA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNFUklBTF9OVU1CRVIkMSwgQ2VydElELmRlZmF1bHRWYWx1ZXMoU0VSSUFMX05VTUJFUiQxKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBIQVNIX0FMR09SSVRITSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcigpO1xuICAgICAgICAgICAgY2FzZSBJU1NVRVJfTkFNRV9IQVNIOlxuICAgICAgICAgICAgY2FzZSBJU1NVRVJfS0VZX0hBU0g6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoKTtcbiAgICAgICAgICAgIGNhc2UgU0VSSUFMX05VTUJFUiQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkludGVnZXIoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgSEFTSF9BTEdPUklUSE0kMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKChtZW1iZXJWYWx1ZS5hbGdvcml0aG1JZCA9PT0gRU1QVFlfU1RSSU5HKSAmJiAoKFwiYWxnb3JpdGhtUGFyYW1zXCIgaW4gbWVtYmVyVmFsdWUpID09PSBmYWxzZSkpO1xuICAgICAgICAgICAgY2FzZSBJU1NVRVJfTkFNRV9IQVNIOlxuICAgICAgICAgICAgY2FzZSBJU1NVRVJfS0VZX0hBU0g6XG4gICAgICAgICAgICBjYXNlIFNFUklBTF9OVU1CRVIkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmlzRXF1YWwoQ2VydElELmRlZmF1bHRWYWx1ZXMoU0VSSUFMX05VTUJFUiQxKSkpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBBbGdvcml0aG1JZGVudGlmaWVyLnNjaGVtYShuYW1lcy5oYXNoQWxnb3JpdGhtT2JqZWN0IHx8IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogKG5hbWVzLmhhc2hBbGdvcml0aG0gfHwgRU1QVFlfU1RSSU5HKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IG5hbWU6IChuYW1lcy5pc3N1ZXJOYW1lSGFzaCB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyBuYW1lOiAobmFtZXMuaXNzdWVyS2V5SGFzaCB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy5zZXJpYWxOdW1iZXIgfHwgRU1QVFlfU1RSSU5HKSB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJGopO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIENlcnRJRC5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBoYXNoQWxnb3JpdGhtOiBIQVNIX0FMR09SSVRITSQxLFxuICAgICAgICAgICAgICAgIGlzc3Vlck5hbWVIYXNoOiBJU1NVRVJfTkFNRV9IQVNILFxuICAgICAgICAgICAgICAgIGlzc3VlcktleUhhc2g6IElTU1VFUl9LRVlfSEFTSCxcbiAgICAgICAgICAgICAgICBzZXJpYWxOdW1iZXI6IFNFUklBTF9OVU1CRVIkMVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuaGFzaEFsZ29yaXRobSA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5oYXNoQWxnb3JpdGhtIH0pO1xuICAgICAgICB0aGlzLmlzc3Vlck5hbWVIYXNoID0gYXNuMS5yZXN1bHQuaXNzdWVyTmFtZUhhc2g7XG4gICAgICAgIHRoaXMuaXNzdWVyS2V5SGFzaCA9IGFzbjEucmVzdWx0Lmlzc3VlcktleUhhc2g7XG4gICAgICAgIHRoaXMuc2VyaWFsTnVtYmVyID0gYXNuMS5yZXN1bHQuc2VyaWFsTnVtYmVyO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgdGhpcy5oYXNoQWxnb3JpdGhtLnRvU2NoZW1hKCksXG4gICAgICAgICAgICAgICAgdGhpcy5pc3N1ZXJOYW1lSGFzaCxcbiAgICAgICAgICAgICAgICB0aGlzLmlzc3VlcktleUhhc2gsXG4gICAgICAgICAgICAgICAgdGhpcy5zZXJpYWxOdW1iZXJcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBoYXNoQWxnb3JpdGhtOiB0aGlzLmhhc2hBbGdvcml0aG0udG9KU09OKCksXG4gICAgICAgICAgICBpc3N1ZXJOYW1lSGFzaDogdGhpcy5pc3N1ZXJOYW1lSGFzaC50b0pTT04oKSxcbiAgICAgICAgICAgIGlzc3VlcktleUhhc2g6IHRoaXMuaXNzdWVyS2V5SGFzaC50b0pTT04oKSxcbiAgICAgICAgICAgIHNlcmlhbE51bWJlcjogdGhpcy5zZXJpYWxOdW1iZXIudG9KU09OKCksXG4gICAgICAgIH07XG4gICAgfVxuICAgIGlzRXF1YWwoY2VydGlmaWNhdGVJRCkge1xuICAgICAgICBpZiAodGhpcy5oYXNoQWxnb3JpdGhtLmFsZ29yaXRobUlkICE9PSBjZXJ0aWZpY2F0ZUlELmhhc2hBbGdvcml0aG0uYWxnb3JpdGhtSWQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXB2dHN1dGlscy5CdWZmZXJTb3VyY2VDb252ZXJ0ZXIuaXNFcXVhbCh0aGlzLmlzc3Vlck5hbWVIYXNoLnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3LCBjZXJ0aWZpY2F0ZUlELmlzc3Vlck5hbWVIYXNoLnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3KSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcHZ0c3V0aWxzLkJ1ZmZlclNvdXJjZUNvbnZlcnRlci5pc0VxdWFsKHRoaXMuaXNzdWVyS2V5SGFzaC52YWx1ZUJsb2NrLnZhbHVlSGV4VmlldywgY2VydGlmaWNhdGVJRC5pc3N1ZXJLZXlIYXNoLnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3KSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5zZXJpYWxOdW1iZXIuaXNFcXVhbChjZXJ0aWZpY2F0ZUlELnNlcmlhbE51bWJlcikpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgYXN5bmMgY3JlYXRlRm9yQ2VydGlmaWNhdGUoY2VydGlmaWNhdGUsIHBhcmFtZXRlcnMsIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICBQYXJhbWV0ZXJFcnJvci5hc3NlcnQocGFyYW1ldGVycywgSEFTSF9BTEdPUklUSE0kMSwgXCJpc3N1ZXJDZXJ0aWZpY2F0ZVwiKTtcbiAgICAgICAgY29uc3QgaGFzaE9JRCA9IGNyeXB0by5nZXRPSURCeUFsZ29yaXRobSh7IG5hbWU6IHBhcmFtZXRlcnMuaGFzaEFsZ29yaXRobSB9LCB0cnVlLCBcImhhc2hBbGdvcml0aG1cIik7XG4gICAgICAgIHRoaXMuaGFzaEFsZ29yaXRobSA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHtcbiAgICAgICAgICAgIGFsZ29yaXRobUlkOiBoYXNoT0lELFxuICAgICAgICAgICAgYWxnb3JpdGhtUGFyYW1zOiBuZXcgYXNuMWpzLk51bGwoKVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgaXNzdWVyQ2VydGlmaWNhdGUgPSBwYXJhbWV0ZXJzLmlzc3VlckNlcnRpZmljYXRlO1xuICAgICAgICB0aGlzLnNlcmlhbE51bWJlciA9IGNlcnRpZmljYXRlLnNlcmlhbE51bWJlcjtcbiAgICAgICAgY29uc3QgaGFzaElzc3Vlck5hbWUgPSBhd2FpdCBjcnlwdG8uZGlnZXN0KHsgbmFtZTogcGFyYW1ldGVycy5oYXNoQWxnb3JpdGhtIH0sIGlzc3VlckNlcnRpZmljYXRlLnN1YmplY3QudG9TY2hlbWEoKS50b0JFUihmYWxzZSkpO1xuICAgICAgICB0aGlzLmlzc3Vlck5hbWVIYXNoID0gbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiBoYXNoSXNzdWVyTmFtZSB9KTtcbiAgICAgICAgY29uc3QgaXNzdWVyS2V5QnVmZmVyID0gaXNzdWVyQ2VydGlmaWNhdGUuc3ViamVjdFB1YmxpY0tleUluZm8uc3ViamVjdFB1YmxpY0tleS52YWx1ZUJsb2NrLnZhbHVlSGV4VmlldztcbiAgICAgICAgY29uc3QgaGFzaElzc3VlcktleSA9IGF3YWl0IGNyeXB0by5kaWdlc3QoeyBuYW1lOiBwYXJhbWV0ZXJzLmhhc2hBbGdvcml0aG0gfSwgaXNzdWVyS2V5QnVmZmVyKTtcbiAgICAgICAgdGhpcy5pc3N1ZXJLZXlIYXNoID0gbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiBoYXNoSXNzdWVyS2V5IH0pO1xuICAgIH1cbn1cbkNlcnRJRC5DTEFTU19OQU1FID0gXCJDZXJ0SURcIjtcblxuY29uc3QgQ0VSVF9JRCA9IFwiY2VydElEXCI7XG5jb25zdCBDRVJUX1NUQVRVUyA9IFwiY2VydFN0YXR1c1wiO1xuY29uc3QgVEhJU19VUERBVEUgPSBcInRoaXNVcGRhdGVcIjtcbmNvbnN0IE5FWFRfVVBEQVRFID0gXCJuZXh0VXBkYXRlXCI7XG5jb25zdCBTSU5HTEVfRVhURU5TSU9OUyA9IFwic2luZ2xlRXh0ZW5zaW9uc1wiO1xuY29uc3QgQ0xFQVJfUFJPUFMkaSA9IFtcbiAgICBDRVJUX0lELFxuICAgIENFUlRfU1RBVFVTLFxuICAgIFRISVNfVVBEQVRFLFxuICAgIE5FWFRfVVBEQVRFLFxuICAgIFNJTkdMRV9FWFRFTlNJT05TLFxuXTtcbmNsYXNzIFNpbmdsZVJlc3BvbnNlIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5jZXJ0SUQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBDRVJUX0lELCBTaW5nbGVSZXNwb25zZS5kZWZhdWx0VmFsdWVzKENFUlRfSUQpKTtcbiAgICAgICAgdGhpcy5jZXJ0U3RhdHVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQ0VSVF9TVEFUVVMsIFNpbmdsZVJlc3BvbnNlLmRlZmF1bHRWYWx1ZXMoQ0VSVF9TVEFUVVMpKTtcbiAgICAgICAgdGhpcy50aGlzVXBkYXRlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVEhJU19VUERBVEUsIFNpbmdsZVJlc3BvbnNlLmRlZmF1bHRWYWx1ZXMoVEhJU19VUERBVEUpKTtcbiAgICAgICAgaWYgKE5FWFRfVVBEQVRFIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMubmV4dFVwZGF0ZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE5FWFRfVVBEQVRFLCBTaW5nbGVSZXNwb25zZS5kZWZhdWx0VmFsdWVzKE5FWFRfVVBEQVRFKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFNJTkdMRV9FWFRFTlNJT05TIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuc2luZ2xlRXh0ZW5zaW9ucyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNJTkdMRV9FWFRFTlNJT05TLCBTaW5nbGVSZXNwb25zZS5kZWZhdWx0VmFsdWVzKFNJTkdMRV9FWFRFTlNJT05TKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIENFUlRfSUQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDZXJ0SUQoKTtcbiAgICAgICAgICAgIGNhc2UgQ0VSVF9TVEFUVVM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICAgICAgY2FzZSBUSElTX1VQREFURTpcbiAgICAgICAgICAgIGNhc2UgTkVYVF9VUERBVEU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKDAsIDAsIDApO1xuICAgICAgICAgICAgY2FzZSBTSU5HTEVfRVhURU5TSU9OUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIENFUlRfSUQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgoQ2VydElELmNvbXBhcmVXaXRoRGVmYXVsdChcImhhc2hBbGdvcml0aG1cIiwgbWVtYmVyVmFsdWUuaGFzaEFsZ29yaXRobSkpICYmXG4gICAgICAgICAgICAgICAgICAgIChDZXJ0SUQuY29tcGFyZVdpdGhEZWZhdWx0KFwiaXNzdWVyTmFtZUhhc2hcIiwgbWVtYmVyVmFsdWUuaXNzdWVyTmFtZUhhc2gpKSAmJlxuICAgICAgICAgICAgICAgICAgICAoQ2VydElELmNvbXBhcmVXaXRoRGVmYXVsdChcImlzc3VlcktleUhhc2hcIiwgbWVtYmVyVmFsdWUuaXNzdWVyS2V5SGFzaCkpICYmXG4gICAgICAgICAgICAgICAgICAgIChDZXJ0SUQuY29tcGFyZVdpdGhEZWZhdWx0KFwic2VyaWFsTnVtYmVyXCIsIG1lbWJlclZhbHVlLnNlcmlhbE51bWJlcikpKTtcbiAgICAgICAgICAgIGNhc2UgQ0VSVF9TVEFUVVM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChPYmplY3Qua2V5cyhtZW1iZXJWYWx1ZSkubGVuZ3RoID09PSAwKTtcbiAgICAgICAgICAgIGNhc2UgVEhJU19VUERBVEU6XG4gICAgICAgICAgICBjYXNlIE5FWFRfVVBEQVRFOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgPT09IFNpbmdsZVJlc3BvbnNlLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBDZXJ0SUQuc2NoZW1hKG5hbWVzLmNlcnRJRCB8fCB7fSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5DaG9pY2Uoe1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5jZXJ0U3RhdHVzIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmNlcnRTdGF0dXMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuR2VuZXJhbGl6ZWRUaW1lKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtuZXcgYXNuMWpzLkVudW1lcmF0ZWQoKV1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuY2VydFN0YXR1cyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVuQmxvY2s6IHsgbGVuZ3RoOiAxIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkdlbmVyYWxpemVkVGltZSh7IG5hbWU6IChuYW1lcy50aGlzVXBkYXRlIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW25ldyBhc24xanMuR2VuZXJhbGl6ZWRUaW1lKHsgbmFtZTogKG5hbWVzLm5leHRVcGRhdGUgfHwgRU1QVFlfU1RSSU5HKSB9KV1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbRXh0ZW5zaW9ucy5zY2hlbWEobmFtZXMuc2luZ2xlRXh0ZW5zaW9ucyB8fCB7fSldXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRpKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBTaW5nbGVSZXNwb25zZS5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBjZXJ0SUQ6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogQ0VSVF9JRFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjZXJ0U3RhdHVzOiBDRVJUX1NUQVRVUyxcbiAgICAgICAgICAgICAgICB0aGlzVXBkYXRlOiBUSElTX1VQREFURSxcbiAgICAgICAgICAgICAgICBuZXh0VXBkYXRlOiBORVhUX1VQREFURSxcbiAgICAgICAgICAgICAgICBzaW5nbGVFeHRlbnNpb25zOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFNJTkdMRV9FWFRFTlNJT05TXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5jZXJ0SUQgPSBuZXcgQ2VydElEKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5jZXJ0SUQgfSk7XG4gICAgICAgIHRoaXMuY2VydFN0YXR1cyA9IGFzbjEucmVzdWx0LmNlcnRTdGF0dXM7XG4gICAgICAgIHRoaXMudGhpc1VwZGF0ZSA9IGFzbjEucmVzdWx0LnRoaXNVcGRhdGUudG9EYXRlKCk7XG4gICAgICAgIGlmIChORVhUX1VQREFURSBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMubmV4dFVwZGF0ZSA9IGFzbjEucmVzdWx0Lm5leHRVcGRhdGUudG9EYXRlKCk7XG4gICAgICAgIGlmIChTSU5HTEVfRVhURU5TSU9OUyBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMuc2luZ2xlRXh0ZW5zaW9ucyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHQuc2luZ2xlRXh0ZW5zaW9ucy52YWx1ZUJsb2NrLnZhbHVlLCBlbGVtZW50ID0+IG5ldyBFeHRlbnNpb24oeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLmNlcnRJRC50b1NjaGVtYSgpKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLmNlcnRTdGF0dXMpO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuR2VuZXJhbGl6ZWRUaW1lKHsgdmFsdWVEYXRlOiB0aGlzLnRoaXNVcGRhdGUgfSkpO1xuICAgICAgICBpZiAodGhpcy5uZXh0VXBkYXRlKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFtuZXcgYXNuMWpzLkdlbmVyYWxpemVkVGltZSh7IHZhbHVlRGF0ZTogdGhpcy5uZXh0VXBkYXRlIH0pXVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNpbmdsZUV4dGVuc2lvbnMpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy5zaW5nbGVFeHRlbnNpb25zLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICBjZXJ0SUQ6IHRoaXMuY2VydElELnRvSlNPTigpLFxuICAgICAgICAgICAgY2VydFN0YXR1czogdGhpcy5jZXJ0U3RhdHVzLnRvSlNPTigpLFxuICAgICAgICAgICAgdGhpc1VwZGF0ZTogdGhpcy50aGlzVXBkYXRlXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLm5leHRVcGRhdGUpIHtcbiAgICAgICAgICAgIHJlcy5uZXh0VXBkYXRlID0gdGhpcy5uZXh0VXBkYXRlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNpbmdsZUV4dGVuc2lvbnMpIHtcbiAgICAgICAgICAgIHJlcy5zaW5nbGVFeHRlbnNpb25zID0gQXJyYXkuZnJvbSh0aGlzLnNpbmdsZUV4dGVuc2lvbnMsIG8gPT4gby50b0pTT04oKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5TaW5nbGVSZXNwb25zZS5DTEFTU19OQU1FID0gXCJTaW5nbGVSZXNwb25zZVwiO1xuXG5jb25zdCBUQlMkMiA9IFwidGJzXCI7XG5jb25zdCBWRVJTSU9OJDcgPSBcInZlcnNpb25cIjtcbmNvbnN0IFJFU1BPTkRFUl9JRCA9IFwicmVzcG9uZGVySURcIjtcbmNvbnN0IFBST0RVQ0VEX0FUID0gXCJwcm9kdWNlZEF0XCI7XG5jb25zdCBSRVNQT05TRVMgPSBcInJlc3BvbnNlc1wiO1xuY29uc3QgUkVTUE9OU0VfRVhURU5TSU9OUyA9IFwicmVzcG9uc2VFeHRlbnNpb25zXCI7XG5jb25zdCBSRVNQT05TRV9EQVRBID0gXCJSZXNwb25zZURhdGFcIjtcbmNvbnN0IFJFU1BPTlNFX0RBVEFfVkVSU0lPTiA9IGAke1JFU1BPTlNFX0RBVEF9LiR7VkVSU0lPTiQ3fWA7XG5jb25zdCBSRVNQT05TRV9EQVRBX1JFU1BPTkRFUl9JRCA9IGAke1JFU1BPTlNFX0RBVEF9LiR7UkVTUE9OREVSX0lEfWA7XG5jb25zdCBSRVNQT05TRV9EQVRBX1BST0RVQ0VEX0FUID0gYCR7UkVTUE9OU0VfREFUQX0uJHtQUk9EVUNFRF9BVH1gO1xuY29uc3QgUkVTUE9OU0VfREFUQV9SRVNQT05TRVMgPSBgJHtSRVNQT05TRV9EQVRBfS4ke1JFU1BPTlNFU31gO1xuY29uc3QgUkVTUE9OU0VfREFUQV9SRVNQT05TRV9FWFRFTlNJT05TID0gYCR7UkVTUE9OU0VfREFUQX0uJHtSRVNQT05TRV9FWFRFTlNJT05TfWA7XG5jb25zdCBDTEVBUl9QUk9QUyRoID0gW1xuICAgIFJFU1BPTlNFX0RBVEEsXG4gICAgUkVTUE9OU0VfREFUQV9WRVJTSU9OLFxuICAgIFJFU1BPTlNFX0RBVEFfUkVTUE9OREVSX0lELFxuICAgIFJFU1BPTlNFX0RBVEFfUFJPRFVDRURfQVQsXG4gICAgUkVTUE9OU0VfREFUQV9SRVNQT05TRVMsXG4gICAgUkVTUE9OU0VfREFUQV9SRVNQT05TRV9FWFRFTlNJT05TXG5dO1xuY2xhc3MgUmVzcG9uc2VEYXRhIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBnZXQgdGJzKCkge1xuICAgICAgICByZXR1cm4gcHZ0c3V0aWxzLkJ1ZmZlclNvdXJjZUNvbnZlcnRlci50b0FycmF5QnVmZmVyKHRoaXMudGJzVmlldyk7XG4gICAgfVxuICAgIHNldCB0YnModmFsdWUpIHtcbiAgICAgICAgdGhpcy50YnNWaWV3ID0gbmV3IFVpbnQ4QXJyYXkodmFsdWUpO1xuICAgIH1cbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy50YnNWaWV3ID0gbmV3IFVpbnQ4QXJyYXkocHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVEJTJDIsIFJlc3BvbnNlRGF0YS5kZWZhdWx0VmFsdWVzKFRCUyQyKSkpO1xuICAgICAgICBpZiAoVkVSU0lPTiQ3IGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMudmVyc2lvbiA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZFUlNJT04kNywgUmVzcG9uc2VEYXRhLmRlZmF1bHRWYWx1ZXMoVkVSU0lPTiQ3KSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZXNwb25kZXJJRCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFJFU1BPTkRFUl9JRCwgUmVzcG9uc2VEYXRhLmRlZmF1bHRWYWx1ZXMoUkVTUE9OREVSX0lEKSk7XG4gICAgICAgIHRoaXMucHJvZHVjZWRBdCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFBST0RVQ0VEX0FULCBSZXNwb25zZURhdGEuZGVmYXVsdFZhbHVlcyhQUk9EVUNFRF9BVCkpO1xuICAgICAgICB0aGlzLnJlc3BvbnNlcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFJFU1BPTlNFUywgUmVzcG9uc2VEYXRhLmRlZmF1bHRWYWx1ZXMoUkVTUE9OU0VTKSk7XG4gICAgICAgIGlmIChSRVNQT05TRV9FWFRFTlNJT05TIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMucmVzcG9uc2VFeHRlbnNpb25zID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUkVTUE9OU0VfRVhURU5TSU9OUywgUmVzcG9uc2VEYXRhLmRlZmF1bHRWYWx1ZXMoUkVTUE9OU0VfRVhURU5TSU9OUykpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJDc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICBjYXNlIFRCUyQyOlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9CVUZGRVI7XG4gICAgICAgICAgICBjYXNlIFJFU1BPTkRFUl9JRDpcbiAgICAgICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgICAgICBjYXNlIFBST0RVQ0VEX0FUOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZSgwLCAwLCAwKTtcbiAgICAgICAgICAgIGNhc2UgUkVTUE9OU0VTOlxuICAgICAgICAgICAgY2FzZSBSRVNQT05TRV9FWFRFTlNJT05TOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVEJTJDI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5ieXRlTGVuZ3RoID09PSAwKTtcbiAgICAgICAgICAgIGNhc2UgUkVTUE9OREVSX0lEOlxuICAgICAgICAgICAgICAgIHJldHVybiAoT2JqZWN0LmtleXMobWVtYmVyVmFsdWUpLmxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBjYXNlIFBST0RVQ0VEX0FUOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgPT09IFJlc3BvbnNlRGF0YS5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKTtcbiAgICAgICAgICAgIGNhc2UgUkVTUE9OU0VTOlxuICAgICAgICAgICAgY2FzZSBSRVNQT05TRV9FWFRFTlNJT05TOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUubGVuZ3RoID09PSAwKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgUkVTUE9OU0VfREFUQSksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMudmVyc2lvbiB8fCBSRVNQT05TRV9EQVRBX1ZFUlNJT04pIH0pXVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ2hvaWNlKHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5yZXNwb25kZXJJRCB8fCBSRVNQT05TRV9EQVRBX1JFU1BPTkRFUl9JRCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1JlbGF0aXZlRGlzdGluZ3Vpc2hlZE5hbWVzLnNjaGVtYShuYW1lcy5SZXNwb25zZURhdGFCeU5hbWUgfHwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFwiUmVzcG9uc2VEYXRhLmJ5TmFtZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXVxuICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMucmVzcG9uZGVySUQgfHwgUkVTUE9OU0VfREFUQV9SRVNQT05ERVJfSUQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgbmFtZTogKG5hbWVzLlJlc3BvbnNlRGF0YUJ5S2V5IHx8IFwiUmVzcG9uc2VEYXRhLmJ5S2V5XCIpIH0pXVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuR2VuZXJhbGl6ZWRUaW1lKHsgbmFtZTogKG5hbWVzLnByb2R1Y2VkQXQgfHwgUkVTUE9OU0VfREFUQV9QUk9EVUNFRF9BVCkgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBSRVNQT05TRV9EQVRBX1JFU1BPTlNFUyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogU2luZ2xlUmVzcG9uc2Uuc2NoZW1hKG5hbWVzLnJlc3BvbnNlIHx8IHt9KVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtFeHRlbnNpb25zLnNjaGVtYShuYW1lcy5leHRlbnNpb25zIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFJFU1BPTlNFX0RBVEFfUkVTUE9OU0VfRVhURU5TSU9OU1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkaCk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgUmVzcG9uc2VEYXRhLnNjaGVtYSgpKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy50YnNWaWV3ID0gYXNuMS5yZXN1bHQuUmVzcG9uc2VEYXRhLnZhbHVlQmVmb3JlRGVjb2RlVmlldztcbiAgICAgICAgaWYgKFJFU1BPTlNFX0RBVEFfVkVSU0lPTiBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMudmVyc2lvbiA9IGFzbjEucmVzdWx0W1JFU1BPTlNFX0RBVEFfVkVSU0lPTl0udmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgaWYgKGFzbjEucmVzdWx0W1JFU1BPTlNFX0RBVEFfUkVTUE9OREVSX0lEXS5pZEJsb2NrLnRhZ051bWJlciA9PT0gMSlcbiAgICAgICAgICAgIHRoaXMucmVzcG9uZGVySUQgPSBuZXcgUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZXMoeyBzY2hlbWE6IGFzbjEucmVzdWx0W1JFU1BPTlNFX0RBVEFfUkVTUE9OREVSX0lEXS52YWx1ZUJsb2NrLnZhbHVlWzBdIH0pO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICB0aGlzLnJlc3BvbmRlcklEID0gYXNuMS5yZXN1bHRbUkVTUE9OU0VfREFUQV9SRVNQT05ERVJfSURdLnZhbHVlQmxvY2sudmFsdWVbMF07XG4gICAgICAgIHRoaXMucHJvZHVjZWRBdCA9IGFzbjEucmVzdWx0W1JFU1BPTlNFX0RBVEFfUFJPRFVDRURfQVRdLnRvRGF0ZSgpO1xuICAgICAgICB0aGlzLnJlc3BvbnNlcyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHRbUkVTUE9OU0VfREFUQV9SRVNQT05TRVNdLCBlbGVtZW50ID0+IG5ldyBTaW5nbGVSZXNwb25zZSh7IHNjaGVtYTogZWxlbWVudCB9KSk7XG4gICAgICAgIGlmIChSRVNQT05TRV9EQVRBX1JFU1BPTlNFX0VYVEVOU0lPTlMgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLnJlc3BvbnNlRXh0ZW5zaW9ucyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHRbUkVTUE9OU0VfREFUQV9SRVNQT05TRV9FWFRFTlNJT05TXS52YWx1ZUJsb2NrLnZhbHVlLCBlbGVtZW50ID0+IG5ldyBFeHRlbnNpb24oeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgIH1cbiAgICB0b1NjaGVtYShlbmNvZGVGbGFnID0gZmFsc2UpIHtcbiAgICAgICAgbGV0IHRic1NjaGVtYTtcbiAgICAgICAgaWYgKGVuY29kZUZsYWcgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMudGJzVmlldy5ieXRlTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFJlc3BvbnNlRGF0YS5zY2hlbWEoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuZnJvbUJFUih0aGlzLnRic1ZpZXcpO1xuICAgICAgICAgICAgQXNuRXJyb3IuYXNzZXJ0KGFzbjEsIFwiVEJTIFJlc3BvbnNlIERhdGFcIik7XG4gICAgICAgICAgICB0YnNTY2hlbWEgPSBhc24xLnJlc3VsdDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgICAgICBpZiAoVkVSU0lPTiQ3IGluIHRoaXMpIHtcbiAgICAgICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW25ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlOiB0aGlzLnZlcnNpb24gfSldXG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucmVzcG9uZGVySUQgaW5zdGFuY2VvZiBSZWxhdGl2ZURpc3Rpbmd1aXNoZWROYW1lcykge1xuICAgICAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbdGhpcy5yZXNwb25kZXJJRC50b1NjaGVtYSgpXVxuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAyXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbdGhpcy5yZXNwb25kZXJJRF1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuR2VuZXJhbGl6ZWRUaW1lKHsgdmFsdWVEYXRlOiB0aGlzLnByb2R1Y2VkQXQgfSkpO1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLnJlc3BvbnNlcywgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICBpZiAodGhpcy5yZXNwb25zZUV4dGVuc2lvbnMpIHtcbiAgICAgICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW25ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMucmVzcG9uc2VFeHRlbnNpb25zLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXVxuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRic1NjaGVtYSA9IG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRic1NjaGVtYTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7fTtcbiAgICAgICAgaWYgKFZFUlNJT04kNyBpbiB0aGlzKSB7XG4gICAgICAgICAgICByZXMudmVyc2lvbiA9IHRoaXMudmVyc2lvbjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5yZXNwb25kZXJJRCkge1xuICAgICAgICAgICAgcmVzLnJlc3BvbmRlcklEID0gdGhpcy5yZXNwb25kZXJJRDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wcm9kdWNlZEF0KSB7XG4gICAgICAgICAgICByZXMucHJvZHVjZWRBdCA9IHRoaXMucHJvZHVjZWRBdDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5yZXNwb25zZXMpIHtcbiAgICAgICAgICAgIHJlcy5yZXNwb25zZXMgPSBBcnJheS5mcm9tKHRoaXMucmVzcG9uc2VzLCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnJlc3BvbnNlRXh0ZW5zaW9ucykge1xuICAgICAgICAgICAgcmVzLnJlc3BvbnNlRXh0ZW5zaW9ucyA9IEFycmF5LmZyb20odGhpcy5yZXNwb25zZUV4dGVuc2lvbnMsIG8gPT4gby50b0pTT04oKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5SZXNwb25zZURhdGEuQ0xBU1NfTkFNRSA9IFwiUmVzcG9uc2VEYXRhXCI7XG5cbmNvbnN0IFRSVVNURURfQ0VSVFMgPSBcInRydXN0ZWRDZXJ0c1wiO1xuY29uc3QgQ0VSVFMkMiA9IFwiY2VydHNcIjtcbmNvbnN0IENSTFMkMSA9IFwiY3Jsc1wiO1xuY29uc3QgT0NTUFMkMSA9IFwib2NzcHNcIjtcbmNvbnN0IENIRUNLX0RBVEUgPSBcImNoZWNrRGF0ZVwiO1xuY29uc3QgRklORF9PUklHSU4gPSBcImZpbmRPcmlnaW5cIjtcbmNvbnN0IEZJTkRfSVNTVUVSID0gXCJmaW5kSXNzdWVyXCI7XG52YXIgQ2hhaW5WYWxpZGF0aW9uQ29kZTtcbihmdW5jdGlvbiAoQ2hhaW5WYWxpZGF0aW9uQ29kZSkge1xuICAgIENoYWluVmFsaWRhdGlvbkNvZGVbQ2hhaW5WYWxpZGF0aW9uQ29kZVtcInVua25vd25cIl0gPSAtMV0gPSBcInVua25vd25cIjtcbiAgICBDaGFpblZhbGlkYXRpb25Db2RlW0NoYWluVmFsaWRhdGlvbkNvZGVbXCJzdWNjZXNzXCJdID0gMF0gPSBcInN1Y2Nlc3NcIjtcbiAgICBDaGFpblZhbGlkYXRpb25Db2RlW0NoYWluVmFsaWRhdGlvbkNvZGVbXCJub1Jldm9jYXRpb25cIl0gPSAxMV0gPSBcIm5vUmV2b2NhdGlvblwiO1xuICAgIENoYWluVmFsaWRhdGlvbkNvZGVbQ2hhaW5WYWxpZGF0aW9uQ29kZVtcIm5vUGF0aFwiXSA9IDYwXSA9IFwibm9QYXRoXCI7XG4gICAgQ2hhaW5WYWxpZGF0aW9uQ29kZVtDaGFpblZhbGlkYXRpb25Db2RlW1wibm9WYWxpZFBhdGhcIl0gPSA5N10gPSBcIm5vVmFsaWRQYXRoXCI7XG59KShDaGFpblZhbGlkYXRpb25Db2RlIHx8IChDaGFpblZhbGlkYXRpb25Db2RlID0ge30pKTtcbmNsYXNzIENoYWluVmFsaWRhdGlvbkVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKGNvZGUsIG1lc3NhZ2UpIHtcbiAgICAgICAgc3VwZXIobWVzc2FnZSk7XG4gICAgICAgIHRoaXMubmFtZSA9IENoYWluVmFsaWRhdGlvbkVycm9yLk5BTUU7XG4gICAgICAgIHRoaXMuY29kZSA9IGNvZGU7XG4gICAgICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgfVxufVxuQ2hhaW5WYWxpZGF0aW9uRXJyb3IuTkFNRSA9IFwiQ2hhaW5WYWxpZGF0aW9uRXJyb3JcIjtcbmZ1bmN0aW9uIGlzVHJ1c3RlZChjZXJ0LCB0cnVzdGVkTGlzdCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdHJ1c3RlZExpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHB2dHN1dGlscy5CdWZmZXJTb3VyY2VDb252ZXJ0ZXIuaXNFcXVhbChjZXJ0LnRic1ZpZXcsIHRydXN0ZWRMaXN0W2ldLnRic1ZpZXcpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5jbGFzcyBDZXJ0aWZpY2F0ZUNoYWluVmFsaWRhdGlvbkVuZ2luZSB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHRoaXMudHJ1c3RlZENlcnRzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVFJVU1RFRF9DRVJUUywgdGhpcy5kZWZhdWx0VmFsdWVzKFRSVVNURURfQ0VSVFMpKTtcbiAgICAgICAgdGhpcy5jZXJ0cyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIENFUlRTJDIsIHRoaXMuZGVmYXVsdFZhbHVlcyhDRVJUUyQyKSk7XG4gICAgICAgIHRoaXMuY3JscyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIENSTFMkMSwgdGhpcy5kZWZhdWx0VmFsdWVzKENSTFMkMSkpO1xuICAgICAgICB0aGlzLm9jc3BzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgT0NTUFMkMSwgdGhpcy5kZWZhdWx0VmFsdWVzKE9DU1BTJDEpKTtcbiAgICAgICAgdGhpcy5jaGVja0RhdGUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBDSEVDS19EQVRFLCB0aGlzLmRlZmF1bHRWYWx1ZXMoQ0hFQ0tfREFURSkpO1xuICAgICAgICB0aGlzLmZpbmRPcmlnaW4gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBGSU5EX09SSUdJTiwgdGhpcy5kZWZhdWx0VmFsdWVzKEZJTkRfT1JJR0lOKSk7XG4gICAgICAgIHRoaXMuZmluZElzc3VlciA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEZJTkRfSVNTVUVSLCB0aGlzLmRlZmF1bHRWYWx1ZXMoRklORF9JU1NVRVIpKTtcbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRGaW5kT3JpZ2luKGNlcnRpZmljYXRlLCB2YWxpZGF0aW9uRW5naW5lKSB7XG4gICAgICAgIGlmIChjZXJ0aWZpY2F0ZS50YnNWaWV3LmJ5dGVMZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGNlcnRpZmljYXRlLnRic1ZpZXcgPSBuZXcgVWludDhBcnJheShjZXJ0aWZpY2F0ZS5lbmNvZGVUQlMoKS50b0JFUigpKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IGxvY2FsQ2VydCBvZiB2YWxpZGF0aW9uRW5naW5lLmNlcnRzKSB7XG4gICAgICAgICAgICBpZiAobG9jYWxDZXJ0LnRic1ZpZXcuYnl0ZUxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGxvY2FsQ2VydC50YnNWaWV3ID0gbmV3IFVpbnQ4QXJyYXkobG9jYWxDZXJ0LmVuY29kZVRCUygpLnRvQkVSKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHB2dHN1dGlscy5CdWZmZXJTb3VyY2VDb252ZXJ0ZXIuaXNFcXVhbChjZXJ0aWZpY2F0ZS50YnNWaWV3LCBsb2NhbENlcnQudGJzVmlldykpXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiSW50ZXJtZWRpYXRlIENlcnRpZmljYXRlc1wiO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgdHJ1c3RlZENlcnQgb2YgdmFsaWRhdGlvbkVuZ2luZS50cnVzdGVkQ2VydHMpIHtcbiAgICAgICAgICAgIGlmICh0cnVzdGVkQ2VydC50YnNWaWV3LmJ5dGVMZW5ndGggPT09IDApXG4gICAgICAgICAgICAgICAgdHJ1c3RlZENlcnQudGJzVmlldyA9IG5ldyBVaW50OEFycmF5KHRydXN0ZWRDZXJ0LmVuY29kZVRCUygpLnRvQkVSKCkpO1xuICAgICAgICAgICAgaWYgKHB2dHN1dGlscy5CdWZmZXJTb3VyY2VDb252ZXJ0ZXIuaXNFcXVhbChjZXJ0aWZpY2F0ZS50YnNWaWV3LCB0cnVzdGVkQ2VydC50YnNWaWV3KSlcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJUcnVzdGVkIENlcnRpZmljYXRlc1wiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBcIlVua25vd25cIjtcbiAgICB9XG4gICAgYXN5bmMgZGVmYXVsdEZpbmRJc3N1ZXIoY2VydGlmaWNhdGUsIHZhbGlkYXRpb25FbmdpbmUsIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBbXTtcbiAgICAgICAgbGV0IGtleUlkZW50aWZpZXIgPSBudWxsO1xuICAgICAgICBsZXQgYXV0aG9yaXR5Q2VydElzc3VlciA9IG51bGw7XG4gICAgICAgIGxldCBhdXRob3JpdHlDZXJ0U2VyaWFsTnVtYmVyID0gbnVsbDtcbiAgICAgICAgaWYgKGNlcnRpZmljYXRlLnN1YmplY3QuaXNFcXVhbChjZXJ0aWZpY2F0ZS5pc3N1ZXIpKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHZlcmlmaWNhdGlvblJlc3VsdCA9IGF3YWl0IGNlcnRpZmljYXRlLnZlcmlmeSh1bmRlZmluZWQsIGNyeXB0byk7XG4gICAgICAgICAgICAgICAgaWYgKHZlcmlmaWNhdGlvblJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW2NlcnRpZmljYXRlXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCB7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNlcnRpZmljYXRlLmV4dGVuc2lvbnMpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgZXh0ZW5zaW9uIG9mIGNlcnRpZmljYXRlLmV4dGVuc2lvbnMpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXh0ZW5zaW9uLmV4dG5JRCA9PT0gaWRfQXV0aG9yaXR5S2V5SWRlbnRpZmllciAmJiBleHRlbnNpb24ucGFyc2VkVmFsdWUgaW5zdGFuY2VvZiBBdXRob3JpdHlLZXlJZGVudGlmaWVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChleHRlbnNpb24ucGFyc2VkVmFsdWUua2V5SWRlbnRpZmllcikge1xuICAgICAgICAgICAgICAgICAgICAgICAga2V5SWRlbnRpZmllciA9IGV4dGVuc2lvbi5wYXJzZWRWYWx1ZS5rZXlJZGVudGlmaWVyO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4dGVuc2lvbi5wYXJzZWRWYWx1ZS5hdXRob3JpdHlDZXJ0SXNzdWVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aG9yaXR5Q2VydElzc3VlciA9IGV4dGVuc2lvbi5wYXJzZWRWYWx1ZS5hdXRob3JpdHlDZXJ0SXNzdWVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4dGVuc2lvbi5wYXJzZWRWYWx1ZS5hdXRob3JpdHlDZXJ0U2VyaWFsTnVtYmVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aG9yaXR5Q2VydFNlcmlhbE51bWJlciA9IGV4dGVuc2lvbi5wYXJzZWRWYWx1ZS5hdXRob3JpdHlDZXJ0U2VyaWFsTnVtYmVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjaGVja0NlcnRpZmljYXRlKHBvc3NpYmxlSXNzdWVyKSB7XG4gICAgICAgICAgICBpZiAoa2V5SWRlbnRpZmllciAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGlmIChwb3NzaWJsZUlzc3Vlci5leHRlbnNpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBleHRlbnNpb25Gb3VuZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGV4dGVuc2lvbiBvZiBwb3NzaWJsZUlzc3Vlci5leHRlbnNpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXh0ZW5zaW9uLmV4dG5JRCA9PT0gaWRfU3ViamVjdEtleUlkZW50aWZpZXIgJiYgZXh0ZW5zaW9uLnBhcnNlZFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0ZW5zaW9uRm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwdnRzdXRpbHMuQnVmZmVyU291cmNlQ29udmVydGVyLmlzRXF1YWwoZXh0ZW5zaW9uLnBhcnNlZFZhbHVlLnZhbHVlQmxvY2sudmFsdWVIZXgsIGtleUlkZW50aWZpZXIudmFsdWVCbG9jay52YWx1ZUhleFZpZXcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHBvc3NpYmxlSXNzdWVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4dGVuc2lvbkZvdW5kKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXQgYXV0aG9yaXR5Q2VydFNlcmlhbE51bWJlckVxdWFsID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAoYXV0aG9yaXR5Q2VydFNlcmlhbE51bWJlciAhPT0gbnVsbClcbiAgICAgICAgICAgICAgICBhdXRob3JpdHlDZXJ0U2VyaWFsTnVtYmVyRXF1YWwgPSBwb3NzaWJsZUlzc3Vlci5zZXJpYWxOdW1iZXIuaXNFcXVhbChhdXRob3JpdHlDZXJ0U2VyaWFsTnVtYmVyKTtcbiAgICAgICAgICAgIGlmIChhdXRob3JpdHlDZXJ0SXNzdWVyICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBvc3NpYmxlSXNzdWVyLnN1YmplY3QuaXNFcXVhbChhdXRob3JpdHlDZXJ0SXNzdWVyKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYXV0aG9yaXR5Q2VydFNlcmlhbE51bWJlckVxdWFsKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gocG9zc2libGVJc3N1ZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChjZXJ0aWZpY2F0ZS5pc3N1ZXIuaXNFcXVhbChwb3NzaWJsZUlzc3Vlci5zdWJqZWN0KSlcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gocG9zc2libGVJc3N1ZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgdHJ1c3RlZENlcnQgb2YgdmFsaWRhdGlvbkVuZ2luZS50cnVzdGVkQ2VydHMpIHtcbiAgICAgICAgICAgIGNoZWNrQ2VydGlmaWNhdGUodHJ1c3RlZENlcnQpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgaW50ZXJtZWRpYXRlQ2VydCBvZiB2YWxpZGF0aW9uRW5naW5lLmNlcnRzKSB7XG4gICAgICAgICAgICBjaGVja0NlcnRpZmljYXRlKGludGVybWVkaWF0ZUNlcnQpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IGkgPSByZXN1bHQubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdmVyaWZpY2F0aW9uUmVzdWx0ID0gYXdhaXQgY2VydGlmaWNhdGUudmVyaWZ5KHJlc3VsdFtpXSwgY3J5cHRvKTtcbiAgICAgICAgICAgICAgICBpZiAodmVyaWZpY2F0aW9uUmVzdWx0ID09PSBmYWxzZSlcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIHtcbiAgICAgICAgICAgICAgICByZXN1bHQuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVFJVU1RFRF9DRVJUUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBjYXNlIENFUlRTJDI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgY2FzZSBDUkxTJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgY2FzZSBPQ1NQUyQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGNhc2UgQ0hFQ0tfREFURTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoKTtcbiAgICAgICAgICAgIGNhc2UgRklORF9PUklHSU46XG4gICAgICAgICAgICAgICAgcmV0dXJuIENlcnRpZmljYXRlQ2hhaW5WYWxpZGF0aW9uRW5naW5lLmRlZmF1bHRGaW5kT3JpZ2luO1xuICAgICAgICAgICAgY2FzZSBGSU5EX0lTU1VFUjpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5kZWZhdWx0RmluZElzc3VlcjtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIG1lbWJlciBuYW1lIGZvciBDZXJ0aWZpY2F0ZUNoYWluVmFsaWRhdGlvbkVuZ2luZSBjbGFzczogJHttZW1iZXJOYW1lfWApO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFzeW5jIHNvcnQocGFzc2VkV2hlbk5vdFJldlZhbHVlcyA9IGZhbHNlLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgY29uc3QgbG9jYWxDZXJ0cyA9IFtdO1xuICAgICAgICBjb25zdCBidWlsZFBhdGggPSBhc3luYyAoY2VydGlmaWNhdGUsIGNyeXB0bykgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gW107XG4gICAgICAgICAgICBmdW5jdGlvbiBjaGVja1VuaXF1ZShhcnJheSkge1xuICAgICAgICAgICAgICAgIGxldCB1bmlxdWUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBhcnJheS5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGogPT09IGkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXJyYXlbaV0gPT09IGFycmF5W2pdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5pcXVlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCF1bmlxdWUpXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVuaXF1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpc1RydXN0ZWQoY2VydGlmaWNhdGUsIHRoaXMudHJ1c3RlZENlcnRzKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBbW2NlcnRpZmljYXRlXV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBmaW5kSXNzdWVyUmVzdWx0ID0gYXdhaXQgdGhpcy5maW5kSXNzdWVyKGNlcnRpZmljYXRlLCB0aGlzLCBjcnlwdG8pO1xuICAgICAgICAgICAgaWYgKGZpbmRJc3N1ZXJSZXN1bHQubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gdmFsaWQgY2VydGlmaWNhdGUgcGF0aHMgZm91bmRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZpbmRJc3N1ZXJSZXN1bHQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAocHZ0c3V0aWxzLkJ1ZmZlclNvdXJjZUNvbnZlcnRlci5pc0VxdWFsKGZpbmRJc3N1ZXJSZXN1bHRbaV0udGJzVmlldywgY2VydGlmaWNhdGUudGJzVmlldykpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goW2ZpbmRJc3N1ZXJSZXN1bHRbaV1dKTtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGJ1aWxkUGF0aFJlc3VsdCA9IGF3YWl0IGJ1aWxkUGF0aChmaW5kSXNzdWVyUmVzdWx0W2ldLCBjcnlwdG8pO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgYnVpbGRQYXRoUmVzdWx0Lmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvcHkgPSBidWlsZFBhdGhSZXN1bHRbal0uc2xpY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgY29weS5zcGxpY2UoMCwgMCwgZmluZElzc3VlclJlc3VsdFtpXSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGVja1VuaXF1ZShjb3B5KSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGNvcHkpO1xuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChidWlsZFBhdGhSZXN1bHRbal0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGZpbmRDUkwgPSBhc3luYyAoY2VydGlmaWNhdGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGlzc3VlckNlcnRpZmljYXRlcyA9IFtdO1xuICAgICAgICAgICAgY29uc3QgY3JscyA9IFtdO1xuICAgICAgICAgICAgY29uc3QgY3Jsc0FuZENlcnRpZmljYXRlcyA9IFtdO1xuICAgICAgICAgICAgaXNzdWVyQ2VydGlmaWNhdGVzLnB1c2goLi4ubG9jYWxDZXJ0cy5maWx0ZXIoZWxlbWVudCA9PiBjZXJ0aWZpY2F0ZS5pc3N1ZXIuaXNFcXVhbChlbGVtZW50LnN1YmplY3QpKSk7XG4gICAgICAgICAgICBpZiAoaXNzdWVyQ2VydGlmaWNhdGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogMSxcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzTWVzc2FnZTogXCJObyBjZXJ0aWZpY2F0ZSdzIGlzc3VlcnNcIlxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjcmxzLnB1c2goLi4udGhpcy5jcmxzLmZpbHRlcihvID0+IG8uaXNzdWVyLmlzRXF1YWwoY2VydGlmaWNhdGUuaXNzdWVyKSkpO1xuICAgICAgICAgICAgaWYgKGNybHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAyLFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXNNZXNzYWdlOiBcIk5vIENSTHMgZm9yIHNwZWNpZmljIGNlcnRpZmljYXRlIGlzc3VlclwiXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY3Jscy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNybCA9IGNybHNbaV07XG4gICAgICAgICAgICAgICAgaWYgKGNybC5uZXh0VXBkYXRlICYmIGNybC5uZXh0VXBkYXRlLnZhbHVlIDwgdGhpcy5jaGVja0RhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgaXNzdWVyQ2VydGlmaWNhdGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjcmxzW2ldLnZlcmlmeSh7IGlzc3VlckNlcnRpZmljYXRlOiBpc3N1ZXJDZXJ0aWZpY2F0ZXNbal0gfSwgY3J5cHRvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmxzQW5kQ2VydGlmaWNhdGVzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmw6IGNybHNbaV0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRpZmljYXRlOiBpc3N1ZXJDZXJ0aWZpY2F0ZXNbal1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY3Jsc0FuZENlcnRpZmljYXRlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IDAsXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1c01lc3NhZ2U6IEVNUFRZX1NUUklORyxcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0OiBjcmxzQW5kQ2VydGlmaWNhdGVzXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiAzLFxuICAgICAgICAgICAgICAgIHN0YXR1c01lc3NhZ2U6IFwiTm8gdmFsaWQgQ1JMcyBmb3VuZFwiXG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCBmaW5kT0NTUCA9IGFzeW5jIChjZXJ0aWZpY2F0ZSwgaXNzdWVyQ2VydGlmaWNhdGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGhhc2hBbGdvcml0aG0gPSBjcnlwdG8uZ2V0QWxnb3JpdGhtQnlPSUQoY2VydGlmaWNhdGUuc2lnbmF0dXJlQWxnb3JpdGhtLmFsZ29yaXRobUlkKTtcbiAgICAgICAgICAgIGlmICghaGFzaEFsZ29yaXRobS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWhhc2hBbGdvcml0aG0uaGFzaCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm9jc3BzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgb2NzcCA9IHRoaXMub2NzcHNbaV07XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgb2NzcC5nZXRDZXJ0aWZpY2F0ZVN0YXR1cyhjZXJ0aWZpY2F0ZSwgaXNzdWVyQ2VydGlmaWNhdGUsIGNyeXB0byk7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5pc0ZvckNlcnRpZmljYXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAyO1xuICAgICAgICB9O1xuICAgICAgICBhc3luYyBmdW5jdGlvbiBjaGVja0ZvckNBKGNlcnRpZmljYXRlLCBuZWVkVG9DaGVja0NSTCA9IGZhbHNlKSB7XG4gICAgICAgICAgICBsZXQgaXNDQSA9IGZhbHNlO1xuICAgICAgICAgICAgbGV0IG11c3RCZUNBID0gZmFsc2U7XG4gICAgICAgICAgICBsZXQga2V5VXNhZ2VQcmVzZW50ID0gZmFsc2U7XG4gICAgICAgICAgICBsZXQgY1JMU2lnbiA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKGNlcnRpZmljYXRlLmV4dGVuc2lvbnMpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGNlcnRpZmljYXRlLmV4dGVuc2lvbnMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZXh0ZW5zaW9uID0gY2VydGlmaWNhdGUuZXh0ZW5zaW9uc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4dGVuc2lvbi5jcml0aWNhbCAmJiAhZXh0ZW5zaW9uLnBhcnNlZFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0Q29kZTogNixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRNZXNzYWdlOiBgVW5hYmxlIHRvIHBhcnNlIGNyaXRpY2FsIGNlcnRpZmljYXRlIGV4dGVuc2lvbjogJHtleHRlbnNpb24uZXh0bklEfWBcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4dGVuc2lvbi5leHRuSUQgPT09IGlkX0tleVVzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBrZXlVc2FnZVByZXNlbnQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmlldyA9IG5ldyBVaW50OEFycmF5KGV4dGVuc2lvbi5wYXJzZWRWYWx1ZS52YWx1ZUJsb2NrLnZhbHVlSGV4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmlld1swXSAmIDB4MDQpID09PSAweDA0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG11c3RCZUNBID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmlld1swXSAmIDB4MDIpID09PSAweDAyKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNSTFNpZ24gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChleHRlbnNpb24uZXh0bklEID09PSBpZF9CYXNpY0NvbnN0cmFpbnRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoXCJjQVwiIGluIGV4dGVuc2lvbi5wYXJzZWRWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleHRlbnNpb24ucGFyc2VkVmFsdWUuY0EgPT09IHRydWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQ0EgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICgobXVzdEJlQ0EgPT09IHRydWUpICYmIChpc0NBID09PSBmYWxzZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRDb2RlOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0TWVzc2FnZTogXCJVbmFibGUgdG8gYnVpbGQgY2VydGlmaWNhdGUgY2hhaW4gLSB1c2luZyBcXFwia2V5Q2VydFNpZ25cXFwiIGZsYWcgc2V0IHdpdGhvdXQgQmFzaWNDb25zdHJhaW50c1wiXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICgoa2V5VXNhZ2VQcmVzZW50ID09PSB0cnVlKSAmJiAoaXNDQSA9PT0gdHJ1ZSkgJiYgKG11c3RCZUNBID09PSBmYWxzZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRDb2RlOiA0LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0TWVzc2FnZTogXCJVbmFibGUgdG8gYnVpbGQgY2VydGlmaWNhdGUgY2hhaW4gLSBcXFwia2V5Q2VydFNpZ25cXFwiIGZsYWcgd2FzIG5vdCBzZXRcIlxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoKGlzQ0EgPT09IHRydWUpICYmIChrZXlVc2FnZVByZXNlbnQgPT09IHRydWUpICYmICgobmVlZFRvQ2hlY2tDUkwpICYmIChjUkxTaWduID09PSBmYWxzZSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0Q29kZTogNSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdE1lc3NhZ2U6IFwiVW5hYmxlIHRvIGJ1aWxkIGNlcnRpZmljYXRlIGNoYWluIC0gaW50ZXJtZWRpYXRlIGNlcnRpZmljYXRlIG11c3QgaGF2ZSBcXFwiY1JMU2lnblxcXCIga2V5IHVzYWdlIGZsYWdcIlxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpc0NBID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdENvZGU6IDcsXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdE1lc3NhZ2U6IFwiVW5hYmxlIHRvIGJ1aWxkIGNlcnRpZmljYXRlIGNoYWluIC0gbW9yZSB0aGFuIG9uZSBwb3NzaWJsZSBlbmQtdXNlciBjZXJ0aWZpY2F0ZVwiXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcmVzdWx0OiB0cnVlLFxuICAgICAgICAgICAgICAgIHJlc3VsdENvZGU6IDAsXG4gICAgICAgICAgICAgICAgcmVzdWx0TWVzc2FnZTogRU1QVFlfU1RSSU5HXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGJhc2ljQ2hlY2sgPSBhc3luYyAocGF0aCwgY2hlY2tEYXRlKSA9PiB7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhdGgubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoKHBhdGhbaV0ubm90QmVmb3JlLnZhbHVlID4gY2hlY2tEYXRlKSB8fFxuICAgICAgICAgICAgICAgICAgICAocGF0aFtpXS5ub3RBZnRlci52YWx1ZSA8IGNoZWNrRGF0ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRDb2RlOiA4LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0TWVzc2FnZTogXCJUaGUgY2VydGlmaWNhdGUgaXMgZWl0aGVyIG5vdCB5ZXQgdmFsaWQgb3IgZXhwaXJlZFwiXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHBhdGgubGVuZ3RoIDwgMikge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdENvZGU6IDksXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdE1lc3NhZ2U6IFwiVG9vIHNob3J0IGNlcnRpZmljYXRlIHBhdGhcIlxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gKHBhdGgubGVuZ3RoIC0gMik7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhdGhbaV0uaXNzdWVyLmlzRXF1YWwocGF0aFtpXS5zdWJqZWN0KSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhdGhbaV0uaXNzdWVyLmlzRXF1YWwocGF0aFtpICsgMV0uc3ViamVjdCkgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0Q29kZTogMTAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0TWVzc2FnZTogXCJJbmNvcnJlY3QgbmFtZSBjaGFpbmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCh0aGlzLmNybHMubGVuZ3RoICE9PSAwKSB8fCAodGhpcy5vY3Nwcy5sZW5ndGggIT09IDApKSB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAocGF0aC5sZW5ndGggLSAxKTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBvY3NwUmVzdWx0ID0gMjtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNybFJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1c01lc3NhZ2U6IEVNUFRZX1NUUklOR1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5vY3Nwcy5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9jc3BSZXN1bHQgPSBhd2FpdCBmaW5kT0NTUChwYXRoW2ldLCBwYXRoW2kgKyAxXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKG9jc3BSZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRDb2RlOiAxMixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdE1lc3NhZ2U6IFwiT25lIG9mIGNlcnRpZmljYXRlcyB3YXMgcmV2b2tlZCB2aWEgT0NTUCByZXNwb25zZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY3Jscy5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNybFJlc3VsdCA9IGF3YWl0IGZpbmRDUkwocGF0aFtpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3JsUmVzdWx0LnN0YXR1cyA9PT0gMCAmJiBjcmxSZXN1bHQucmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBjcmxSZXN1bHQucmVzdWx0Lmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzQ2VydGlmaWNhdGVSZXZva2VkID0gY3JsUmVzdWx0LnJlc3VsdFtqXS5jcmwuaXNDZXJ0aWZpY2F0ZVJldm9rZWQocGF0aFtpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0NlcnRpZmljYXRlUmV2b2tlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdENvZGU6IDEyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdE1lc3NhZ2U6IFwiT25lIG9mIGNlcnRpZmljYXRlcyBoYWQgYmVlbiByZXZva2VkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNDZXJ0aWZpY2F0ZUNBID0gYXdhaXQgY2hlY2tGb3JDQShjcmxSZXN1bHQucmVzdWx0W2pdLmNlcnRpZmljYXRlLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQ2VydGlmaWNhdGVDQS5yZXN1bHQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0Q29kZTogMTMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0TWVzc2FnZTogXCJDUkwgaXNzdWVyIGNlcnRpZmljYXRlIGlzIG5vdCBhIENBIGNlcnRpZmljYXRlIG9yIGRvZXMgbm90IGhhdmUgY3JsU2lnbiBmbGFnXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFzc2VkV2hlbk5vdFJldlZhbHVlcyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IENoYWluVmFsaWRhdGlvbkVycm9yKENoYWluVmFsaWRhdGlvbkNvZGUubm9SZXZvY2F0aW9uLCBgTm8gcmV2b2NhdGlvbiB2YWx1ZXMgZm91bmQgZm9yIG9uZSBvZiBjZXJ0aWZpY2F0ZXM6ICR7Y3JsUmVzdWx0LnN0YXR1c01lc3NhZ2V9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9jc3BSZXN1bHQgPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRDb2RlOiAxMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0TWVzc2FnZTogXCJObyByZXZvY2F0aW9uIHZhbHVlcyBmb3VuZCBmb3Igb25lIG9mIGNlcnRpZmljYXRlc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoKG9jc3BSZXN1bHQgPT09IDIpICYmIChjcmxSZXN1bHQuc3RhdHVzID09PSAyKSAmJiBwYXNzZWRXaGVuTm90UmV2VmFsdWVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc3N1ZXJDZXJ0aWZpY2F0ZSA9IHBhdGhbaSArIDFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGV4dGVuc2lvbkZvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNzdWVyQ2VydGlmaWNhdGUuZXh0ZW5zaW9ucykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZXh0ZW5zaW9uIG9mIGlzc3VlckNlcnRpZmljYXRlLmV4dGVuc2lvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChleHRlbnNpb24uZXh0bklEKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIGlkX0NSTERpc3RyaWJ1dGlvblBvaW50czpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgaWRfRnJlc2hlc3RDUkw6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIGlkX0F1dGhvcml0eUluZm9BY2Nlc3M6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0ZW5zaW9uRm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4dGVuc2lvbkZvdW5kKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IENoYWluVmFsaWRhdGlvbkVycm9yKENoYWluVmFsaWRhdGlvbkNvZGUubm9SZXZvY2F0aW9uLCBgTm8gcmV2b2NhdGlvbiB2YWx1ZXMgZm91bmQgZm9yIG9uZSBvZiBjZXJ0aWZpY2F0ZXM6ICR7Y3JsUmVzdWx0LnN0YXR1c01lc3NhZ2V9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGNvbnN0IFtpLCBjZXJ0XSBvZiBwYXRoLmVudHJpZXMoKSkge1xuICAgICAgICAgICAgICAgIGlmICghaSkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2hlY2tGb3JDQShjZXJ0KTtcbiAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdC5yZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRDb2RlOiAxNCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdE1lc3NhZ2U6IFwiT25lIG9mIGludGVybWVkaWF0ZSBjZXJ0aWZpY2F0ZXMgaXMgbm90IGEgQ0EgY2VydGlmaWNhdGVcIlxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcmVzdWx0OiB0cnVlXG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICBsb2NhbENlcnRzLnB1c2goLi4udGhpcy50cnVzdGVkQ2VydHMpO1xuICAgICAgICBsb2NhbENlcnRzLnB1c2goLi4udGhpcy5jZXJ0cyk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbG9jYWxDZXJ0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBsb2NhbENlcnRzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGkgPT09IGopXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIGlmIChwdnRzdXRpbHMuQnVmZmVyU291cmNlQ29udmVydGVyLmlzRXF1YWwobG9jYWxDZXJ0c1tpXS50YnNWaWV3LCBsb2NhbENlcnRzW2pdLnRic1ZpZXcpKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvY2FsQ2VydHMuc3BsaWNlKGosIDEpO1xuICAgICAgICAgICAgICAgICAgICBpID0gMDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGxlYWZDZXJ0ID0gbG9jYWxDZXJ0c1tsb2NhbENlcnRzLmxlbmd0aCAtIDFdO1xuICAgICAgICBsZXQgcmVzdWx0O1xuICAgICAgICBjb25zdCBjZXJ0aWZpY2F0ZVBhdGggPSBbbGVhZkNlcnRdO1xuICAgICAgICByZXN1bHQgPSBhd2FpdCBidWlsZFBhdGgobGVhZkNlcnQsIGNyeXB0byk7XG4gICAgICAgIGlmIChyZXN1bHQubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQ2hhaW5WYWxpZGF0aW9uRXJyb3IoQ2hhaW5WYWxpZGF0aW9uQ29kZS5ub1BhdGgsIFwiVW5hYmxlIHRvIGZpbmQgY2VydGlmaWNhdGUgcGF0aFwiKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGxldCBpID0gcmVzdWx0Lmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBsZXQgZm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgKHJlc3VsdFtpXSkubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjZXJ0aWZpY2F0ZSA9IChyZXN1bHRbaV0pW2pdO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgdGhpcy50cnVzdGVkQ2VydHMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHB2dHN1dGlscy5CdWZmZXJTb3VyY2VDb252ZXJ0ZXIuaXNFcXVhbChjZXJ0aWZpY2F0ZS50YnNWaWV3LCB0aGlzLnRydXN0ZWRDZXJ0c1trXS50YnNWaWV3KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGZvdW5kKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghZm91bmQpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChyZXN1bHQubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQ2hhaW5WYWxpZGF0aW9uRXJyb3IoQ2hhaW5WYWxpZGF0aW9uQ29kZS5ub1ZhbGlkUGF0aCwgXCJObyB2YWxpZCBjZXJ0aWZpY2F0ZSBwYXRocyBmb3VuZFwiKTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgc2hvcnRlc3RMZW5ndGggPSByZXN1bHRbMF0ubGVuZ3RoO1xuICAgICAgICBsZXQgc2hvcnRlc3RJbmRleCA9IDA7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAocmVzdWx0W2ldLmxlbmd0aCA8IHNob3J0ZXN0TGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgc2hvcnRlc3RMZW5ndGggPSByZXN1bHRbaV0ubGVuZ3RoO1xuICAgICAgICAgICAgICAgIHNob3J0ZXN0SW5kZXggPSBpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzdWx0W3Nob3J0ZXN0SW5kZXhdLmxlbmd0aDsgaSsrKVxuICAgICAgICAgICAgY2VydGlmaWNhdGVQYXRoLnB1c2goKHJlc3VsdFtzaG9ydGVzdEluZGV4XSlbaV0pO1xuICAgICAgICByZXN1bHQgPSBhd2FpdCBiYXNpY0NoZWNrKGNlcnRpZmljYXRlUGF0aCwgdGhpcy5jaGVja0RhdGUpO1xuICAgICAgICBpZiAocmVzdWx0LnJlc3VsdCA9PT0gZmFsc2UpXG4gICAgICAgICAgICB0aHJvdyByZXN1bHQ7XG4gICAgICAgIHJldHVybiBjZXJ0aWZpY2F0ZVBhdGg7XG4gICAgfVxuICAgIGFzeW5jIHZlcmlmeShwYXJhbWV0ZXJzID0ge30sIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICBmdW5jdGlvbiBjb21wYXJlRE5TTmFtZShuYW1lLCBjb25zdHJhaW50KSB7XG4gICAgICAgICAgICBjb25zdCBuYW1lUHJlcGFyZWQgPSBzdHJpbmdQcmVwKG5hbWUpO1xuICAgICAgICAgICAgY29uc3QgY29uc3RyYWludFByZXBhcmVkID0gc3RyaW5nUHJlcChjb25zdHJhaW50KTtcbiAgICAgICAgICAgIGNvbnN0IG5hbWVTcGxpdHRlZCA9IG5hbWVQcmVwYXJlZC5zcGxpdChcIi5cIik7XG4gICAgICAgICAgICBjb25zdCBjb25zdHJhaW50U3BsaXR0ZWQgPSBjb25zdHJhaW50UHJlcGFyZWQuc3BsaXQoXCIuXCIpO1xuICAgICAgICAgICAgY29uc3QgbmFtZUxlbiA9IG5hbWVTcGxpdHRlZC5sZW5ndGg7XG4gICAgICAgICAgICBjb25zdCBjb25zdHJMZW4gPSBjb25zdHJhaW50U3BsaXR0ZWQubGVuZ3RoO1xuICAgICAgICAgICAgaWYgKChuYW1lTGVuID09PSAwKSB8fCAoY29uc3RyTGVuID09PSAwKSB8fCAobmFtZUxlbiA8IGNvbnN0ckxlbikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5hbWVMZW47IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChuYW1lU3BsaXR0ZWRbaV0ubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbnN0ckxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbnN0cmFpbnRTcGxpdHRlZFtpXS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb25zdHJMZW4gPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb25zdHJMZW47IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChjb25zdHJhaW50U3BsaXR0ZWRbY29uc3RyTGVuIC0gMSAtIGldLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5hbWVTcGxpdHRlZFtuYW1lTGVuIC0gMSAtIGldLmxvY2FsZUNvbXBhcmUoY29uc3RyYWludFNwbGl0dGVkW2NvbnN0ckxlbiAtIDEgLSBpXSkgIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNvbXBhcmVSRkM4MjJOYW1lKG5hbWUsIGNvbnN0cmFpbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IG5hbWVQcmVwYXJlZCA9IHN0cmluZ1ByZXAobmFtZSk7XG4gICAgICAgICAgICBjb25zdCBjb25zdHJhaW50UHJlcGFyZWQgPSBzdHJpbmdQcmVwKGNvbnN0cmFpbnQpO1xuICAgICAgICAgICAgY29uc3QgbmFtZVNwbGl0dGVkID0gbmFtZVByZXBhcmVkLnNwbGl0KFwiQFwiKTtcbiAgICAgICAgICAgIGNvbnN0IGNvbnN0cmFpbnRTcGxpdHRlZCA9IGNvbnN0cmFpbnRQcmVwYXJlZC5zcGxpdChcIkBcIik7XG4gICAgICAgICAgICBpZiAoKG5hbWVTcGxpdHRlZC5sZW5ndGggPT09IDApIHx8IChjb25zdHJhaW50U3BsaXR0ZWQubGVuZ3RoID09PSAwKSB8fCAobmFtZVNwbGl0dGVkLmxlbmd0aCA8IGNvbnN0cmFpbnRTcGxpdHRlZC5sZW5ndGgpKVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIGlmIChjb25zdHJhaW50U3BsaXR0ZWQubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gY29tcGFyZUROU05hbWUobmFtZVNwbGl0dGVkWzFdLCBjb25zdHJhaW50U3BsaXR0ZWRbMF0pO1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbnMgPSBuYW1lU3BsaXR0ZWRbMV0uc3BsaXQoXCIuXCIpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjcyA9IGNvbnN0cmFpbnRTcGxpdHRlZFswXS5zcGxpdChcIi5cIik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjc1swXS5sZW5ndGggPT09IDApXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5zLmxlbmd0aCA9PT0gY3MubGVuZ3RoO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gKG5hbWVQcmVwYXJlZC5sb2NhbGVDb21wYXJlKGNvbnN0cmFpbnRQcmVwYXJlZCkgPT09IDApO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNvbXBhcmVVbmlmb3JtUmVzb3VyY2VJZGVudGlmaWVyKG5hbWUsIGNvbnN0cmFpbnQpIHtcbiAgICAgICAgICAgIGxldCBuYW1lUHJlcGFyZWQgPSBzdHJpbmdQcmVwKG5hbWUpO1xuICAgICAgICAgICAgY29uc3QgY29uc3RyYWludFByZXBhcmVkID0gc3RyaW5nUHJlcChjb25zdHJhaW50KTtcbiAgICAgICAgICAgIGNvbnN0IG5zID0gbmFtZVByZXBhcmVkLnNwbGl0KFwiL1wiKTtcbiAgICAgICAgICAgIGNvbnN0IGNzID0gY29uc3RyYWludFByZXBhcmVkLnNwbGl0KFwiL1wiKTtcbiAgICAgICAgICAgIGlmIChjcy5sZW5ndGggPiAxKVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIGlmIChucy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoKG5zW2ldLmxlbmd0aCA+IDApICYmIChuc1tpXS5jaGFyQXQobnNbaV0ubGVuZ3RoIC0gMSkgIT09IFwiOlwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbnNQb3J0ID0gbnNbaV0uc3BsaXQoXCI6XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVByZXBhcmVkID0gbnNQb3J0WzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBjb21wYXJlRE5TTmFtZShuYW1lUHJlcGFyZWQsIGNvbnN0cmFpbnRQcmVwYXJlZCk7XG4gICAgICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmFtZVNwbGl0dGVkID0gbmFtZVByZXBhcmVkLnNwbGl0KFwiLlwiKTtcbiAgICAgICAgICAgICAgICBjb25zdCBjb25zdHJhaW50U3BsaXR0ZWQgPSBjb25zdHJhaW50UHJlcGFyZWQuc3BsaXQoXCIuXCIpO1xuICAgICAgICAgICAgICAgIGlmIChjb25zdHJhaW50U3BsaXR0ZWRbMF0ubGVuZ3RoID09PSAwKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmFtZVNwbGl0dGVkLmxlbmd0aCA9PT0gY29uc3RyYWludFNwbGl0dGVkLmxlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjb21wYXJlSVBBZGRyZXNzKG5hbWUsIGNvbnN0cmFpbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IG5hbWVWaWV3ID0gbmFtZS52YWx1ZUJsb2NrLnZhbHVlSGV4VmlldztcbiAgICAgICAgICAgIGNvbnN0IGNvbnN0cmFpbnRWaWV3ID0gY29uc3RyYWludC52YWx1ZUJsb2NrLnZhbHVlSGV4VmlldztcbiAgICAgICAgICAgIGlmICgobmFtZVZpZXcubGVuZ3RoID09PSA0KSAmJiAoY29uc3RyYWludFZpZXcubGVuZ3RoID09PSA4KSkge1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgobmFtZVZpZXdbaV0gXiBjb25zdHJhaW50Vmlld1tpXSkgJiBjb25zdHJhaW50Vmlld1tpICsgNF0pXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKChuYW1lVmlldy5sZW5ndGggPT09IDE2KSAmJiAoY29uc3RyYWludFZpZXcubGVuZ3RoID09PSAzMikpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDE2OyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChuYW1lVmlld1tpXSBeIGNvbnN0cmFpbnRWaWV3W2ldKSAmIGNvbnN0cmFpbnRWaWV3W2kgKyAxNl0pXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNvbXBhcmVEaXJlY3RvcnlOYW1lKG5hbWUsIGNvbnN0cmFpbnQpIHtcbiAgICAgICAgICAgIGlmICgobmFtZS50eXBlc0FuZFZhbHVlcy5sZW5ndGggPT09IDApIHx8IChjb25zdHJhaW50LnR5cGVzQW5kVmFsdWVzLmxlbmd0aCA9PT0gMCkpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICBpZiAobmFtZS50eXBlc0FuZFZhbHVlcy5sZW5ndGggPCBjb25zdHJhaW50LnR5cGVzQW5kVmFsdWVzLmxlbmd0aClcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gdHJ1ZTtcbiAgICAgICAgICAgIGxldCBuYW1lU3RhcnQgPSAwO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb25zdHJhaW50LnR5cGVzQW5kVmFsdWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgbGV0IGxvY2FsUmVzdWx0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IG5hbWVTdGFydDsgaiA8IG5hbWUudHlwZXNBbmRWYWx1ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbG9jYWxSZXN1bHQgPSBuYW1lLnR5cGVzQW5kVmFsdWVzW2pdLmlzRXF1YWwoY29uc3RyYWludC50eXBlc0FuZFZhbHVlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuYW1lLnR5cGVzQW5kVmFsdWVzW2pdLnR5cGUgPT09IGNvbnN0cmFpbnQudHlwZXNBbmRWYWx1ZXNbaV0udHlwZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdCAmJiBsb2NhbFJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2FsUmVzdWx0ID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKG5hbWVTdGFydCA9PT0gMCkgfHwgKG5hbWVTdGFydCA9PT0gaikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lU3RhcnQgPSBqICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGxvY2FsUmVzdWx0ID09PSBmYWxzZSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIChuYW1lU3RhcnQgPT09IDApID8gZmFsc2UgOiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNlcnRzLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFbXB0eSBjZXJ0aWZpY2F0ZSBhcnJheVwiKTtcbiAgICAgICAgICAgIGNvbnN0IHBhc3NlZFdoZW5Ob3RSZXZWYWx1ZXMgPSBwYXJhbWV0ZXJzLnBhc3NlZFdoZW5Ob3RSZXZWYWx1ZXMgfHwgZmFsc2U7XG4gICAgICAgICAgICBjb25zdCBpbml0aWFsUG9saWN5U2V0ID0gcGFyYW1ldGVycy5pbml0aWFsUG9saWN5U2V0IHx8IFtpZF9BbnlQb2xpY3ldO1xuICAgICAgICAgICAgY29uc3QgaW5pdGlhbEV4cGxpY2l0UG9saWN5ID0gcGFyYW1ldGVycy5pbml0aWFsRXhwbGljaXRQb2xpY3kgfHwgZmFsc2U7XG4gICAgICAgICAgICBjb25zdCBpbml0aWFsUG9saWN5TWFwcGluZ0luaGliaXQgPSBwYXJhbWV0ZXJzLmluaXRpYWxQb2xpY3lNYXBwaW5nSW5oaWJpdCB8fCBmYWxzZTtcbiAgICAgICAgICAgIGNvbnN0IGluaXRpYWxJbmhpYml0UG9saWN5ID0gcGFyYW1ldGVycy5pbml0aWFsSW5oaWJpdFBvbGljeSB8fCBmYWxzZTtcbiAgICAgICAgICAgIGNvbnN0IGluaXRpYWxQZXJtaXR0ZWRTdWJ0cmVlc1NldCA9IHBhcmFtZXRlcnMuaW5pdGlhbFBlcm1pdHRlZFN1YnRyZWVzU2V0IHx8IFtdO1xuICAgICAgICAgICAgY29uc3QgaW5pdGlhbEV4Y2x1ZGVkU3VidHJlZXNTZXQgPSBwYXJhbWV0ZXJzLmluaXRpYWxFeGNsdWRlZFN1YnRyZWVzU2V0IHx8IFtdO1xuICAgICAgICAgICAgY29uc3QgaW5pdGlhbFJlcXVpcmVkTmFtZUZvcm1zID0gcGFyYW1ldGVycy5pbml0aWFsUmVxdWlyZWROYW1lRm9ybXMgfHwgW107XG4gICAgICAgICAgICBsZXQgZXhwbGljaXRQb2xpY3lJbmRpY2F0b3IgPSBpbml0aWFsRXhwbGljaXRQb2xpY3k7XG4gICAgICAgICAgICBsZXQgcG9saWN5TWFwcGluZ0luaGliaXRJbmRpY2F0b3IgPSBpbml0aWFsUG9saWN5TWFwcGluZ0luaGliaXQ7XG4gICAgICAgICAgICBsZXQgaW5oaWJpdEFueVBvbGljeUluZGljYXRvciA9IGluaXRpYWxJbmhpYml0UG9saWN5O1xuICAgICAgICAgICAgY29uc3QgcGVuZGluZ0NvbnN0cmFpbnRzID0gW1xuICAgICAgICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIGxldCBleHBsaWNpdFBvbGljeVBlbmRpbmcgPSAwO1xuICAgICAgICAgICAgbGV0IHBvbGljeU1hcHBpbmdJbmhpYml0UGVuZGluZyA9IDA7XG4gICAgICAgICAgICBsZXQgaW5oaWJpdEFueVBvbGljeVBlbmRpbmcgPSAwO1xuICAgICAgICAgICAgbGV0IHBlcm1pdHRlZFN1YnRyZWVzID0gaW5pdGlhbFBlcm1pdHRlZFN1YnRyZWVzU2V0O1xuICAgICAgICAgICAgbGV0IGV4Y2x1ZGVkU3VidHJlZXMgPSBpbml0aWFsRXhjbHVkZWRTdWJ0cmVlc1NldDtcbiAgICAgICAgICAgIGNvbnN0IHJlcXVpcmVkTmFtZUZvcm1zID0gaW5pdGlhbFJlcXVpcmVkTmFtZUZvcm1zO1xuICAgICAgICAgICAgbGV0IHBhdGhEZXB0aCA9IDE7XG4gICAgICAgICAgICB0aGlzLmNlcnRzID0gYXdhaXQgdGhpcy5zb3J0KHBhc3NlZFdoZW5Ob3RSZXZWYWx1ZXMsIGNyeXB0byk7XG4gICAgICAgICAgICBjb25zdCBhbGxQb2xpY2llcyA9IFtdO1xuICAgICAgICAgICAgYWxsUG9saWNpZXMucHVzaChpZF9BbnlQb2xpY3kpO1xuICAgICAgICAgICAgY29uc3QgcG9saWNpZXNBbmRDZXJ0cyA9IFtdO1xuICAgICAgICAgICAgY29uc3QgYW55UG9saWN5QXJyYXkgPSBuZXcgQXJyYXkodGhpcy5jZXJ0cy5sZW5ndGggLSAxKTtcbiAgICAgICAgICAgIGZvciAobGV0IGlpID0gMDsgaWkgPCAodGhpcy5jZXJ0cy5sZW5ndGggLSAxKTsgaWkrKylcbiAgICAgICAgICAgICAgICBhbnlQb2xpY3lBcnJheVtpaV0gPSB0cnVlO1xuICAgICAgICAgICAgcG9saWNpZXNBbmRDZXJ0cy5wdXNoKGFueVBvbGljeUFycmF5KTtcbiAgICAgICAgICAgIGNvbnN0IHBvbGljeU1hcHBpbmdzID0gbmV3IEFycmF5KHRoaXMuY2VydHMubGVuZ3RoIC0gMSk7XG4gICAgICAgICAgICBjb25zdCBjZXJ0UG9saWNpZXMgPSBuZXcgQXJyYXkodGhpcy5jZXJ0cy5sZW5ndGggLSAxKTtcbiAgICAgICAgICAgIGxldCBleHBsaWNpdFBvbGljeVN0YXJ0ID0gKGV4cGxpY2l0UG9saWN5SW5kaWNhdG9yKSA/ICh0aGlzLmNlcnRzLmxlbmd0aCAtIDEpIDogKC0xKTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAodGhpcy5jZXJ0cy5sZW5ndGggLSAyKTsgaSA+PSAwOyBpLS0sIHBhdGhEZXB0aCsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2VydCA9IHRoaXMuY2VydHNbaV07XG4gICAgICAgICAgICAgICAgaWYgKGNlcnQuZXh0ZW5zaW9ucykge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGNlcnQuZXh0ZW5zaW9ucy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXh0ZW5zaW9uID0gY2VydC5leHRlbnNpb25zW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4dGVuc2lvbi5leHRuSUQgPT09IGlkX0NlcnRpZmljYXRlUG9saWNpZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZXJ0UG9saWNpZXNbaV0gPSBleHRlbnNpb24ucGFyc2VkVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgcyA9IDA7IHMgPCBhbGxQb2xpY2llcy5sZW5ndGg7IHMrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWxsUG9saWNpZXNbc10gPT09IGlkX0FueVBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIChwb2xpY2llc0FuZENlcnRzW3NdKVtpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgZXh0ZW5zaW9uLnBhcnNlZFZhbHVlLmNlcnRpZmljYXRlUG9saWNpZXMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHBvbGljeUluZGV4ID0gKC0xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcG9saWN5SWQgPSBleHRlbnNpb24ucGFyc2VkVmFsdWUuY2VydGlmaWNhdGVQb2xpY2llc1trXS5wb2xpY3lJZGVudGlmaWVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBzID0gMDsgcyA8IGFsbFBvbGljaWVzLmxlbmd0aDsgcysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocG9saWN5SWQgPT09IGFsbFBvbGljaWVzW3NdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9saWN5SW5kZXggPSBzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwb2xpY3lJbmRleCA9PT0gKC0xKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxsUG9saWNpZXMucHVzaChwb2xpY3lJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjZXJ0QXJyYXkgPSBuZXcgQXJyYXkodGhpcy5jZXJ0cy5sZW5ndGggLSAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRBcnJheVtpXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2xpY2llc0FuZENlcnRzLnB1c2goY2VydEFycmF5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAocG9saWNpZXNBbmRDZXJ0c1twb2xpY3lJbmRleF0pW2ldID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXh0ZW5zaW9uLmV4dG5JRCA9PT0gaWRfUG9saWN5TWFwcGluZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocG9saWN5TWFwcGluZ0luaGliaXRJbmRpY2F0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRDb2RlOiA5OCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdE1lc3NhZ2U6IFwiUG9saWN5IG1hcHBpbmcgcHJvaGliaXRlZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeU1hcHBpbmdzW2ldID0gZXh0ZW5zaW9uLnBhcnNlZFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4dGVuc2lvbi5leHRuSUQgPT09IGlkX1BvbGljeUNvbnN0cmFpbnRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4cGxpY2l0UG9saWN5SW5kaWNhdG9yID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXh0ZW5zaW9uLnBhcnNlZFZhbHVlLnJlcXVpcmVFeHBsaWNpdFBvbGljeSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwbGljaXRQb2xpY3lJbmRpY2F0b3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwbGljaXRQb2xpY3lTdGFydCA9IGk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGVuZGluZ0NvbnN0cmFpbnRzWzBdID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlbmRpbmdDb25zdHJhaW50c1swXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwbGljaXRQb2xpY3lQZW5kaW5nID0gZXh0ZW5zaW9uLnBhcnNlZFZhbHVlLnJlcXVpcmVFeHBsaWNpdFBvbGljeTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBsaWNpdFBvbGljeVBlbmRpbmcgPSAoZXhwbGljaXRQb2xpY3lQZW5kaW5nID4gZXh0ZW5zaW9uLnBhcnNlZFZhbHVlLnJlcXVpcmVFeHBsaWNpdFBvbGljeSkgPyBleHRlbnNpb24ucGFyc2VkVmFsdWUucmVxdWlyZUV4cGxpY2l0UG9saWN5IDogZXhwbGljaXRQb2xpY3lQZW5kaW5nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleHRlbnNpb24ucGFyc2VkVmFsdWUuaW5oaWJpdFBvbGljeU1hcHBpbmcgPT09IDApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2xpY3lNYXBwaW5nSW5oaWJpdEluZGljYXRvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBlbmRpbmdDb25zdHJhaW50c1sxXSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZW5kaW5nQ29uc3RyYWludHNbMV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeU1hcHBpbmdJbmhpYml0UGVuZGluZyA9IGV4dGVuc2lvbi5wYXJzZWRWYWx1ZS5pbmhpYml0UG9saWN5TWFwcGluZyArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9saWN5TWFwcGluZ0luaGliaXRQZW5kaW5nID0gKHBvbGljeU1hcHBpbmdJbmhpYml0UGVuZGluZyA+IChleHRlbnNpb24ucGFyc2VkVmFsdWUuaW5oaWJpdFBvbGljeU1hcHBpbmcgKyAxKSkgPyAoZXh0ZW5zaW9uLnBhcnNlZFZhbHVlLmluaGliaXRQb2xpY3lNYXBwaW5nICsgMSkgOiBwb2xpY3lNYXBwaW5nSW5oaWJpdFBlbmRpbmc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXh0ZW5zaW9uLmV4dG5JRCA9PT0gaWRfSW5oaWJpdEFueVBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmhpYml0QW55UG9saWN5SW5kaWNhdG9yID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXh0ZW5zaW9uLnBhcnNlZFZhbHVlLnZhbHVlQmxvY2sudmFsdWVEZWMgPT09IDApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmhpYml0QW55UG9saWN5SW5kaWNhdG9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGVuZGluZ0NvbnN0cmFpbnRzWzJdID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlbmRpbmdDb25zdHJhaW50c1syXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5oaWJpdEFueVBvbGljeVBlbmRpbmcgPSBleHRlbnNpb24ucGFyc2VkVmFsdWUudmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmhpYml0QW55UG9saWN5UGVuZGluZyA9IChpbmhpYml0QW55UG9saWN5UGVuZGluZyA+IGV4dGVuc2lvbi5wYXJzZWRWYWx1ZS52YWx1ZUJsb2NrLnZhbHVlRGVjKSA/IGV4dGVuc2lvbi5wYXJzZWRWYWx1ZS52YWx1ZUJsb2NrLnZhbHVlRGVjIDogaW5oaWJpdEFueVBvbGljeVBlbmRpbmc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGluaGliaXRBbnlQb2xpY3lJbmRpY2F0b3IgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwb2xpY3lJbmRleCA9ICgtMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBzZWFyY2hBbnlQb2xpY3kgPSAwOyBzZWFyY2hBbnlQb2xpY3kgPCBhbGxQb2xpY2llcy5sZW5ndGg7IHNlYXJjaEFueVBvbGljeSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFsbFBvbGljaWVzW3NlYXJjaEFueVBvbGljeV0gPT09IGlkX0FueVBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2xpY3lJbmRleCA9IHNlYXJjaEFueVBvbGljeTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvbGljeUluZGV4ICE9PSAoLTEpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSAocG9saWNpZXNBbmRDZXJ0c1swXSlbaV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4cGxpY2l0UG9saWN5SW5kaWNhdG9yID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBlbmRpbmdDb25zdHJhaW50c1swXSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGxpY2l0UG9saWN5UGVuZGluZy0tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleHBsaWNpdFBvbGljeVBlbmRpbmcgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwbGljaXRQb2xpY3lJbmRpY2F0b3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBsaWNpdFBvbGljeVN0YXJ0ID0gaTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVuZGluZ0NvbnN0cmFpbnRzWzBdID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb2xpY3lNYXBwaW5nSW5oaWJpdEluZGljYXRvciA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwZW5kaW5nQ29uc3RyYWludHNbMV0gPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2xpY3lNYXBwaW5nSW5oaWJpdFBlbmRpbmctLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocG9saWN5TWFwcGluZ0luaGliaXRQZW5kaW5nID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeU1hcHBpbmdJbmhpYml0SW5kaWNhdG9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVuZGluZ0NvbnN0cmFpbnRzWzFdID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmhpYml0QW55UG9saWN5SW5kaWNhdG9yID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBlbmRpbmdDb25zdHJhaW50c1syXSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluaGliaXRBbnlQb2xpY3lQZW5kaW5nLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluaGliaXRBbnlQb2xpY3lQZW5kaW5nID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluaGliaXRBbnlQb2xpY3lJbmRpY2F0b3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZW5kaW5nQ29uc3RyYWludHNbMl0gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8ICh0aGlzLmNlcnRzLmxlbmd0aCAtIDEpOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoKGkgPCAodGhpcy5jZXJ0cy5sZW5ndGggLSAyKSkgJiYgKHR5cGVvZiBwb2xpY3lNYXBwaW5nc1tpICsgMV0gIT09IFwidW5kZWZpbmVkXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgcG9saWN5TWFwcGluZ3NbaSArIDFdLm1hcHBpbmdzLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHBvbGljeU1hcHBpbmdzW2kgKyAxXS5tYXBwaW5nc1trXS5pc3N1ZXJEb21haW5Qb2xpY3kgPT09IGlkX0FueVBvbGljeSkgfHwgKHBvbGljeU1hcHBpbmdzW2kgKyAxXS5tYXBwaW5nc1trXS5zdWJqZWN0RG9tYWluUG9saWN5ID09PSBpZF9BbnlQb2xpY3kpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0OiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0Q29kZTogOTksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdE1lc3NhZ2U6IFwiVGhlIFxcXCJhbnlQb2xpY3lcXFwiIHNob3VsZCBub3QgYmUgYSBwYXJ0IG9mIHBvbGljeSBtYXBwaW5nIHNjaGVtZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpc3N1ZXJEb21haW5Qb2xpY3lJbmRleCA9ICgtMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgc3ViamVjdERvbWFpblBvbGljeUluZGV4ID0gKC0xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgYWxsUG9saWNpZXMubGVuZ3RoOyBuKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWxsUG9saWNpZXNbbl0gPT09IHBvbGljeU1hcHBpbmdzW2kgKyAxXS5tYXBwaW5nc1trXS5pc3N1ZXJEb21haW5Qb2xpY3kpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzc3VlckRvbWFpblBvbGljeUluZGV4ID0gbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWxsUG9saWNpZXNbbl0gPT09IHBvbGljeU1hcHBpbmdzW2kgKyAxXS5tYXBwaW5nc1trXS5zdWJqZWN0RG9tYWluUG9saWN5KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJqZWN0RG9tYWluUG9saWN5SW5kZXggPSBuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiAocG9saWNpZXNBbmRDZXJ0c1tpc3N1ZXJEb21haW5Qb2xpY3lJbmRleF0pW2ldICE9PSBcInVuZGVmaW5lZFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSAocG9saWNpZXNBbmRDZXJ0c1tpc3N1ZXJEb21haW5Qb2xpY3lJbmRleF0pW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBjZXJ0UG9saWNpZXNbaV0uY2VydGlmaWNhdGVQb2xpY2llcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwb2xpY3lNYXBwaW5nc1tpICsgMV0ubWFwcGluZ3Nba10uc3ViamVjdERvbWFpblBvbGljeSA9PT0gY2VydFBvbGljaWVzW2ldLmNlcnRpZmljYXRlUG9saWNpZXNbal0ucG9saWN5SWRlbnRpZmllcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGlzc3VlckRvbWFpblBvbGljeUluZGV4ICE9PSAoLTEpKSAmJiAoc3ViamVjdERvbWFpblBvbGljeUluZGV4ICE9PSAoLTEpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgbSA9IDA7IG0gPD0gaTsgbSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiAocG9saWNpZXNBbmRDZXJ0c1tzdWJqZWN0RG9tYWluUG9saWN5SW5kZXhdKVttXSAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAocG9saWNpZXNBbmRDZXJ0c1tpc3N1ZXJEb21haW5Qb2xpY3lJbmRleF0pW21dID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIChwb2xpY2llc0FuZENlcnRzW3N1YmplY3REb21haW5Qb2xpY3lJbmRleF0pW21dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWxsUG9saWNpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoYWxsUG9saWNpZXNbaV0gPT09IGlkX0FueVBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGV4cGxpY2l0UG9saWN5U3RhcnQ7IGorKylcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSAocG9saWNpZXNBbmRDZXJ0c1tpXSlbal07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgYXV0aENvbnN0clBvbGljaWVzID0gW107XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBvbGljaWVzQW5kQ2VydHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBsZXQgZm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgKHRoaXMuY2VydHMubGVuZ3RoIC0gMSk7IGorKykge1xuICAgICAgICAgICAgICAgICAgICBsZXQgYW55UG9saWN5Rm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChqIDwgZXhwbGljaXRQb2xpY3lTdGFydCkgJiYgKGFsbFBvbGljaWVzW2ldID09PSBpZF9BbnlQb2xpY3kpICYmIChhbGxQb2xpY2llcy5sZW5ndGggPiAxKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgKHBvbGljaWVzQW5kQ2VydHNbaV0pW2pdID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaiA+PSBleHBsaWNpdFBvbGljeVN0YXJ0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBhbGxQb2xpY2llcy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWxsUG9saWNpZXNba10gPT09IGlkX0FueVBvbGljeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChwb2xpY2llc0FuZENlcnRzW2tdKVtqXSA9PT0gdHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbnlQb2xpY3lGb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYW55UG9saWN5Rm91bmQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3VuZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChmb3VuZCA9PT0gdHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgYXV0aENvbnN0clBvbGljaWVzLnB1c2goYWxsUG9saWNpZXNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IHVzZXJDb25zdHJQb2xpY2llcyA9IFtdO1xuICAgICAgICAgICAgaWYgKChpbml0aWFsUG9saWN5U2V0Lmxlbmd0aCA9PT0gMSkgJiYgKGluaXRpYWxQb2xpY3lTZXRbMF0gPT09IGlkX0FueVBvbGljeSkgJiYgKGV4cGxpY2l0UG9saWN5SW5kaWNhdG9yID09PSBmYWxzZSkpXG4gICAgICAgICAgICAgICAgdXNlckNvbnN0clBvbGljaWVzID0gaW5pdGlhbFBvbGljeVNldDtcbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICgoYXV0aENvbnN0clBvbGljaWVzLmxlbmd0aCA9PT0gMSkgJiYgKGF1dGhDb25zdHJQb2xpY2llc1swXSA9PT0gaWRfQW55UG9saWN5KSlcbiAgICAgICAgICAgICAgICAgICAgdXNlckNvbnN0clBvbGljaWVzID0gaW5pdGlhbFBvbGljeVNldDtcbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhdXRoQ29uc3RyUG9saWNpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgaW5pdGlhbFBvbGljeVNldC5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoaW5pdGlhbFBvbGljeVNldFtqXSA9PT0gYXV0aENvbnN0clBvbGljaWVzW2ldKSB8fCAoaW5pdGlhbFBvbGljeVNldFtqXSA9PT0gaWRfQW55UG9saWN5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyQ29uc3RyUG9saWNpZXMucHVzaChhdXRoQ29uc3RyUG9saWNpZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBwb2xpY3lSZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0OiAodXNlckNvbnN0clBvbGljaWVzLmxlbmd0aCA+IDApLFxuICAgICAgICAgICAgICAgIHJlc3VsdENvZGU6IDAsXG4gICAgICAgICAgICAgICAgcmVzdWx0TWVzc2FnZTogKHVzZXJDb25zdHJQb2xpY2llcy5sZW5ndGggPiAwKSA/IEVNUFRZX1NUUklORyA6IFwiWmVybyBcXFwidXNlckNvbnN0clBvbGljaWVzXFxcIiBhcnJheSwgbm8gaW50ZXJzZWN0aW9ucyB3aXRoIFxcXCJhdXRoQ29uc3RyUG9saWNpZXNcXFwiXCIsXG4gICAgICAgICAgICAgICAgYXV0aENvbnN0clBvbGljaWVzLFxuICAgICAgICAgICAgICAgIHVzZXJDb25zdHJQb2xpY2llcyxcbiAgICAgICAgICAgICAgICBleHBsaWNpdFBvbGljeUluZGljYXRvcixcbiAgICAgICAgICAgICAgICBwb2xpY3lNYXBwaW5ncyxcbiAgICAgICAgICAgICAgICBjZXJ0aWZpY2F0ZVBhdGg6IHRoaXMuY2VydHNcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAodXNlckNvbnN0clBvbGljaWVzLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgICAgICByZXR1cm4gcG9saWN5UmVzdWx0O1xuICAgICAgICAgICAgaWYgKHBvbGljeVJlc3VsdC5yZXN1bHQgPT09IGZhbHNlKVxuICAgICAgICAgICAgICAgIHJldHVybiBwb2xpY3lSZXN1bHQ7XG4gICAgICAgICAgICBwYXRoRGVwdGggPSAxO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9ICh0aGlzLmNlcnRzLmxlbmd0aCAtIDIpOyBpID49IDA7IGktLSwgcGF0aERlcHRoKyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjZXJ0ID0gdGhpcy5jZXJ0c1tpXTtcbiAgICAgICAgICAgICAgICBsZXQgc3ViamVjdEFsdE5hbWVzID0gW107XG4gICAgICAgICAgICAgICAgbGV0IGNlcnRQZXJtaXR0ZWRTdWJ0cmVlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGxldCBjZXJ0RXhjbHVkZWRTdWJ0cmVlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGlmIChjZXJ0LmV4dGVuc2lvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBjZXJ0LmV4dGVuc2lvbnMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4dGVuc2lvbiA9IGNlcnQuZXh0ZW5zaW9uc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleHRlbnNpb24uZXh0bklEID09PSBpZF9OYW1lQ29uc3RyYWludHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoXCJwZXJtaXR0ZWRTdWJ0cmVlc1wiIGluIGV4dGVuc2lvbi5wYXJzZWRWYWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2VydFBlcm1pdHRlZFN1YnRyZWVzID0gY2VydFBlcm1pdHRlZFN1YnRyZWVzLmNvbmNhdChleHRlbnNpb24ucGFyc2VkVmFsdWUucGVybWl0dGVkU3VidHJlZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcImV4Y2x1ZGVkU3VidHJlZXNcIiBpbiBleHRlbnNpb24ucGFyc2VkVmFsdWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRFeGNsdWRlZFN1YnRyZWVzID0gY2VydEV4Y2x1ZGVkU3VidHJlZXMuY29uY2F0KGV4dGVuc2lvbi5wYXJzZWRWYWx1ZS5leGNsdWRlZFN1YnRyZWVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleHRlbnNpb24uZXh0bklEID09PSBpZF9TdWJqZWN0QWx0TmFtZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJqZWN0QWx0TmFtZXMgPSBzdWJqZWN0QWx0TmFtZXMuY29uY2F0KGV4dGVuc2lvbi5wYXJzZWRWYWx1ZS5hbHROYW1lcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbGV0IGZvcm1Gb3VuZCA9IChyZXF1aXJlZE5hbWVGb3Jtcy5sZW5ndGggPD0gMCk7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCByZXF1aXJlZE5hbWVGb3Jtcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHJlcXVpcmVkTmFtZUZvcm1zW2pdLmJhc2UudHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcXVpcmVkTmFtZUZvcm1zW2pdLmJhc2UudmFsdWUudHlwZXNBbmRWYWx1ZXMubGVuZ3RoICE9PSBjZXJ0LnN1YmplY3QudHlwZXNBbmRWYWx1ZXMubGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1Gb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgY2VydC5zdWJqZWN0LnR5cGVzQW5kVmFsdWVzLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2VydC5zdWJqZWN0LnR5cGVzQW5kVmFsdWVzW2tdLnR5cGUgIT09IHJlcXVpcmVkTmFtZUZvcm1zW2pdLmJhc2UudmFsdWUudHlwZXNBbmRWYWx1ZXNba10udHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1Gb3VuZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb3JtRm91bmQgPT09IHRydWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChmb3JtRm91bmQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVJlc3VsdC5yZXN1bHQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVzdWx0LnJlc3VsdENvZGUgPSAyMTtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVzdWx0LnJlc3VsdE1lc3NhZ2UgPSBcIk5vIG5lY2Vzc2FyeSBuYW1lIGZvcm0gZm91bmRcIjtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgcG9saWN5UmVzdWx0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBjb25zdHJHcm91cHMgPSBbXG4gICAgICAgICAgICAgICAgICAgIFtdLFxuICAgICAgICAgICAgICAgICAgICBbXSxcbiAgICAgICAgICAgICAgICAgICAgW10sXG4gICAgICAgICAgICAgICAgICAgIFtdLFxuICAgICAgICAgICAgICAgICAgICBbXSxcbiAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgcGVybWl0dGVkU3VidHJlZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChwZXJtaXR0ZWRTdWJ0cmVlc1tqXS5iYXNlLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdHJHcm91cHNbMF0ucHVzaChwZXJtaXR0ZWRTdWJ0cmVlc1tqXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3RyR3JvdXBzWzFdLnB1c2gocGVybWl0dGVkU3VidHJlZXNbal0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0ckdyb3Vwc1syXS5wdXNoKHBlcm1pdHRlZFN1YnRyZWVzW2pdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdHJHcm91cHNbM10ucHVzaChwZXJtaXR0ZWRTdWJ0cmVlc1tqXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3RyR3JvdXBzWzRdLnB1c2gocGVybWl0dGVkU3VidHJlZXNbal0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb3IgKGxldCBwID0gMDsgcCA8IDU7IHArKykge1xuICAgICAgICAgICAgICAgICAgICBsZXQgZ3JvdXBQZXJtaXR0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlRXhpc3RzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGdyb3VwID0gY29uc3RyR3JvdXBzW3BdO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGdyb3VwLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJqZWN0QWx0TmFtZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBzdWJqZWN0QWx0TmFtZXMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3ViamVjdEFsdE5hbWVzW2tdLnR5cGUgPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVFeGlzdHMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cFBlcm1pdHRlZCA9IGdyb3VwUGVybWl0dGVkIHx8IGNvbXBhcmVSRkM4MjJOYW1lKHN1YmplY3RBbHROYW1lc1trXS52YWx1ZSwgZ3JvdXBbal0uYmFzZS52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBjZXJ0LnN1YmplY3QudHlwZXNBbmRWYWx1ZXMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGNlcnQuc3ViamVjdC50eXBlc0FuZFZhbHVlc1trXS50eXBlID09PSBcIjEuMi44NDAuMTEzNTQ5LjEuOS4xXCIpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChjZXJ0LnN1YmplY3QudHlwZXNBbmRWYWx1ZXNba10udHlwZSA9PT0gXCIwLjkuMjM0Mi4xOTIwMDMwMC4xMDAuMS4zXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlRXhpc3RzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBQZXJtaXR0ZWQgPSBncm91cFBlcm1pdHRlZCB8fCBjb21wYXJlUkZDODIyTmFtZShjZXJ0LnN1YmplY3QudHlwZXNBbmRWYWx1ZXNba10udmFsdWUudmFsdWVCbG9jay52YWx1ZSwgZ3JvdXBbal0uYmFzZS52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YmplY3RBbHROYW1lcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IHN1YmplY3RBbHROYW1lcy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJqZWN0QWx0TmFtZXNba10udHlwZSA9PT0gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZUV4aXN0cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwUGVybWl0dGVkID0gZ3JvdXBQZXJtaXR0ZWQgfHwgY29tcGFyZUROU05hbWUoc3ViamVjdEFsdE5hbWVzW2tdLnZhbHVlLCBncm91cFtqXS5iYXNlLnZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZUV4aXN0cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwUGVybWl0dGVkID0gY29tcGFyZURpcmVjdG9yeU5hbWUoY2VydC5zdWJqZWN0LCBncm91cFtqXS5iYXNlLnZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3ViamVjdEFsdE5hbWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgc3ViamVjdEFsdE5hbWVzLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YmplY3RBbHROYW1lc1trXS50eXBlID09PSA2KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlRXhpc3RzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBQZXJtaXR0ZWQgPSBncm91cFBlcm1pdHRlZCB8fCBjb21wYXJlVW5pZm9ybVJlc291cmNlSWRlbnRpZmllcihzdWJqZWN0QWx0TmFtZXNba10udmFsdWUsIGdyb3VwW2pdLmJhc2UudmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJqZWN0QWx0TmFtZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBzdWJqZWN0QWx0TmFtZXMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3ViamVjdEFsdE5hbWVzW2tdLnR5cGUgPT09IDcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVFeGlzdHMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cFBlcm1pdHRlZCA9IGdyb3VwUGVybWl0dGVkIHx8IGNvbXBhcmVJUEFkZHJlc3Moc3ViamVjdEFsdE5hbWVzW2tdLnZhbHVlLCBncm91cFtqXS5iYXNlLnZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChncm91cFBlcm1pdHRlZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoKGdyb3VwUGVybWl0dGVkID09PSBmYWxzZSkgJiYgKGdyb3VwLmxlbmd0aCA+IDApICYmIHZhbHVlRXhpc3RzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2xpY3lSZXN1bHQucmVzdWx0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2xpY3lSZXN1bHQucmVzdWx0Q29kZSA9IDQxO1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVzdWx0LnJlc3VsdE1lc3NhZ2UgPSBcIkZhaWxlZCB0byBtZWV0IFxcXCJwZXJtaXR0ZWQgc3ViLXRyZWVzXFxcIiBuYW1lIGNvbnN0cmFpbnRcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IHBvbGljeVJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBsZXQgZXhjbHVkZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGV4Y2x1ZGVkU3VidHJlZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChleGNsdWRlZFN1YnRyZWVzW2pdLmJhc2UudHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJqZWN0QWx0TmFtZXMubGVuZ3RoID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBzdWJqZWN0QWx0TmFtZXMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJqZWN0QWx0TmFtZXNba10udHlwZSA9PT0gMSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNsdWRlZCA9IGV4Y2x1ZGVkIHx8IGNvbXBhcmVSRkM4MjJOYW1lKHN1YmplY3RBbHROYW1lc1trXS52YWx1ZSwgZXhjbHVkZWRTdWJ0cmVlc1tqXS5iYXNlLnZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBjZXJ0LnN1YmplY3QudHlwZXNBbmRWYWx1ZXMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoY2VydC5zdWJqZWN0LnR5cGVzQW5kVmFsdWVzW2tdLnR5cGUgPT09IFwiMS4yLjg0MC4xMTM1NDkuMS45LjFcIikgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoY2VydC5zdWJqZWN0LnR5cGVzQW5kVmFsdWVzW2tdLnR5cGUgPT09IFwiMC45LjIzNDIuMTkyMDAzMDAuMTAwLjEuM1wiKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNsdWRlZCA9IGV4Y2x1ZGVkIHx8IGNvbXBhcmVSRkM4MjJOYW1lKGNlcnQuc3ViamVjdC50eXBlc0FuZFZhbHVlc1trXS52YWx1ZS52YWx1ZUJsb2NrLnZhbHVlLCBleGNsdWRlZFN1YnRyZWVzW2pdLmJhc2UudmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJqZWN0QWx0TmFtZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IHN1YmplY3RBbHROYW1lcy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YmplY3RBbHROYW1lc1trXS50eXBlID09PSAyKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVkID0gZXhjbHVkZWQgfHwgY29tcGFyZUROU05hbWUoc3ViamVjdEFsdE5hbWVzW2tdLnZhbHVlLCBleGNsdWRlZFN1YnRyZWVzW2pdLmJhc2UudmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVkID0gZXhjbHVkZWQgfHwgY29tcGFyZURpcmVjdG9yeU5hbWUoY2VydC5zdWJqZWN0LCBleGNsdWRlZFN1YnRyZWVzW2pdLmJhc2UudmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJqZWN0QWx0TmFtZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IHN1YmplY3RBbHROYW1lcy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YmplY3RBbHROYW1lc1trXS50eXBlID09PSA2KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVkID0gZXhjbHVkZWQgfHwgY29tcGFyZVVuaWZvcm1SZXNvdXJjZUlkZW50aWZpZXIoc3ViamVjdEFsdE5hbWVzW2tdLnZhbHVlLCBleGNsdWRlZFN1YnRyZWVzW2pdLmJhc2UudmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJqZWN0QWx0TmFtZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IHN1YmplY3RBbHROYW1lcy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YmplY3RBbHROYW1lc1trXS50eXBlID09PSA3KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVkID0gZXhjbHVkZWQgfHwgY29tcGFyZUlQQWRkcmVzcyhzdWJqZWN0QWx0TmFtZXNba10udmFsdWUsIGV4Y2x1ZGVkU3VidHJlZXNbal0uYmFzZS52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChleGNsdWRlZClcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZXhjbHVkZWQgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVzdWx0LnJlc3VsdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lSZXN1bHQucmVzdWx0Q29kZSA9IDQyO1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lSZXN1bHQucmVzdWx0TWVzc2FnZSA9IFwiRmFpbGVkIHRvIG1lZXQgXFxcImV4Y2x1ZGVkIHN1Yi10cmVlc1xcXCIgbmFtZSBjb25zdHJhaW50XCI7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IHBvbGljeVJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcGVybWl0dGVkU3VidHJlZXMgPSBwZXJtaXR0ZWRTdWJ0cmVlcy5jb25jYXQoY2VydFBlcm1pdHRlZFN1YnRyZWVzKTtcbiAgICAgICAgICAgICAgICBleGNsdWRlZFN1YnRyZWVzID0gZXhjbHVkZWRTdWJ0cmVlcy5jb25jYXQoY2VydEV4Y2x1ZGVkU3VidHJlZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHBvbGljeVJlc3VsdDtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgQ2hhaW5WYWxpZGF0aW9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRDb2RlOiBlcnJvci5jb2RlLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0TWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvcixcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0OiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0Q29kZTogQ2hhaW5WYWxpZGF0aW9uQ29kZS51bmtub3duLFxuICAgICAgICAgICAgICAgICAgICByZXN1bHRNZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlcnJvciAmJiB0eXBlb2YgZXJyb3IgPT09IFwib2JqZWN0XCIgJiYgXCJyZXN1bHRNZXNzYWdlXCIgaW4gZXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXJyb3I7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHJlc3VsdDogZmFsc2UsXG4gICAgICAgICAgICAgICAgcmVzdWx0Q29kZTogLTEsXG4gICAgICAgICAgICAgICAgcmVzdWx0TWVzc2FnZTogYCR7ZXJyb3J9YCxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmNvbnN0IFRCU19SRVNQT05TRV9EQVRBID0gXCJ0YnNSZXNwb25zZURhdGFcIjtcbmNvbnN0IFNJR05BVFVSRV9BTEdPUklUSE0kMyA9IFwic2lnbmF0dXJlQWxnb3JpdGhtXCI7XG5jb25zdCBTSUdOQVRVUkUkMiA9IFwic2lnbmF0dXJlXCI7XG5jb25zdCBDRVJUUyQxID0gXCJjZXJ0c1wiO1xuY29uc3QgQkFTSUNfT0NTUF9SRVNQT05TRSA9IFwiQmFzaWNPQ1NQUmVzcG9uc2VcIjtcbmNvbnN0IEJBU0lDX09DU1BfUkVTUE9OU0VfVEJTX1JFU1BPTlNFX0RBVEEgPSBgJHtCQVNJQ19PQ1NQX1JFU1BPTlNFfS4ke1RCU19SRVNQT05TRV9EQVRBfWA7XG5jb25zdCBCQVNJQ19PQ1NQX1JFU1BPTlNFX1NJR05BVFVSRV9BTEdPUklUSE0gPSBgJHtCQVNJQ19PQ1NQX1JFU1BPTlNFfS4ke1NJR05BVFVSRV9BTEdPUklUSE0kM31gO1xuY29uc3QgQkFTSUNfT0NTUF9SRVNQT05TRV9TSUdOQVRVUkUgPSBgJHtCQVNJQ19PQ1NQX1JFU1BPTlNFfS4ke1NJR05BVFVSRSQyfWA7XG5jb25zdCBCQVNJQ19PQ1NQX1JFU1BPTlNFX0NFUlRTID0gYCR7QkFTSUNfT0NTUF9SRVNQT05TRX0uJHtDRVJUUyQxfWA7XG5jb25zdCBDTEVBUl9QUk9QUyRnID0gW1xuICAgIEJBU0lDX09DU1BfUkVTUE9OU0VfVEJTX1JFU1BPTlNFX0RBVEEsXG4gICAgQkFTSUNfT0NTUF9SRVNQT05TRV9TSUdOQVRVUkVfQUxHT1JJVEhNLFxuICAgIEJBU0lDX09DU1BfUkVTUE9OU0VfU0lHTkFUVVJFLFxuICAgIEJBU0lDX09DU1BfUkVTUE9OU0VfQ0VSVFNcbl07XG5jbGFzcyBCYXNpY09DU1BSZXNwb25zZSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudGJzUmVzcG9uc2VEYXRhID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVEJTX1JFU1BPTlNFX0RBVEEsIEJhc2ljT0NTUFJlc3BvbnNlLmRlZmF1bHRWYWx1ZXMoVEJTX1JFU1BPTlNFX0RBVEEpKTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmVBbGdvcml0aG0gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTSUdOQVRVUkVfQUxHT1JJVEhNJDMsIEJhc2ljT0NTUFJlc3BvbnNlLmRlZmF1bHRWYWx1ZXMoU0lHTkFUVVJFX0FMR09SSVRITSQzKSk7XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU0lHTkFUVVJFJDIsIEJhc2ljT0NTUFJlc3BvbnNlLmRlZmF1bHRWYWx1ZXMoU0lHTkFUVVJFJDIpKTtcbiAgICAgICAgaWYgKENFUlRTJDEgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5jZXJ0cyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIENFUlRTJDEsIEJhc2ljT0NTUFJlc3BvbnNlLmRlZmF1bHRWYWx1ZXMoQ0VSVFMkMSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBUQlNfUkVTUE9OU0VfREFUQTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFJlc3BvbnNlRGF0YSgpO1xuICAgICAgICAgICAgY2FzZSBTSUdOQVRVUkVfQUxHT1JJVEhNJDM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKCk7XG4gICAgICAgICAgICBjYXNlIFNJR05BVFVSRSQyOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkJpdFN0cmluZygpO1xuICAgICAgICAgICAgY2FzZSBDRVJUUyQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJ0eXBlXCI6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBsZXQgY29tcGFyaXNvblJlc3VsdCA9ICgoUmVzcG9uc2VEYXRhLmNvbXBhcmVXaXRoRGVmYXVsdChcInRic1wiLCBtZW1iZXJWYWx1ZS50YnMpKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgKFJlc3BvbnNlRGF0YS5jb21wYXJlV2l0aERlZmF1bHQoXCJyZXNwb25kZXJJRFwiLCBtZW1iZXJWYWx1ZS5yZXNwb25kZXJJRCkpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAoUmVzcG9uc2VEYXRhLmNvbXBhcmVXaXRoRGVmYXVsdChcInByb2R1Y2VkQXRcIiwgbWVtYmVyVmFsdWUucHJvZHVjZWRBdCkpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAoUmVzcG9uc2VEYXRhLmNvbXBhcmVXaXRoRGVmYXVsdChcInJlc3BvbnNlc1wiLCBtZW1iZXJWYWx1ZS5yZXNwb25zZXMpKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChcInJlc3BvbnNlRXh0ZW5zaW9uc1wiIGluIG1lbWJlclZhbHVlKVxuICAgICAgICAgICAgICAgICAgICAgICAgY29tcGFyaXNvblJlc3VsdCA9IGNvbXBhcmlzb25SZXN1bHQgJiYgKFJlc3BvbnNlRGF0YS5jb21wYXJlV2l0aERlZmF1bHQoXCJyZXNwb25zZUV4dGVuc2lvbnNcIiwgbWVtYmVyVmFsdWUucmVzcG9uc2VFeHRlbnNpb25zKSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb21wYXJpc29uUmVzdWx0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgU0lHTkFUVVJFX0FMR09SSVRITSQzOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKG1lbWJlclZhbHVlLmFsZ29yaXRobUlkID09PSBFTVBUWV9TVFJJTkcpICYmICgoXCJhbGdvcml0aG1QYXJhbXNcIiBpbiBtZW1iZXJWYWx1ZSkgPT09IGZhbHNlKSk7XG4gICAgICAgICAgICBjYXNlIFNJR05BVFVSRSQyOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUuaXNFcXVhbChCYXNpY09DU1BSZXNwb25zZS5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKSk7XG4gICAgICAgICAgICBjYXNlIENFUlRTJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBCQVNJQ19PQ1NQX1JFU1BPTlNFKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgUmVzcG9uc2VEYXRhLnNjaGVtYShuYW1lcy50YnNSZXNwb25zZURhdGEgfHwge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBCQVNJQ19PQ1NQX1JFU1BPTlNFX1RCU19SRVNQT05TRV9EQVRBXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBBbGdvcml0aG1JZGVudGlmaWVyLnNjaGVtYShuYW1lcy5zaWduYXR1cmVBbGdvcml0aG0gfHwge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBCQVNJQ19PQ1NQX1JFU1BPTlNFX1NJR05BVFVSRV9BTEdPUklUSE1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQml0U3RyaW5nKHsgbmFtZTogKG5hbWVzLnNpZ25hdHVyZSB8fCBCQVNJQ19PQ1NQX1JFU1BPTlNFX1NJR05BVFVSRSkgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IEJBU0lDX09DU1BfUkVTUE9OU0VfQ0VSVFMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQ2VydGlmaWNhdGUuc2NoZW1hKG5hbWVzLmNlcnRzIHx8IHt9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KV1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJGcpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIEJhc2ljT0NTUFJlc3BvbnNlLnNjaGVtYSgpKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy50YnNSZXNwb25zZURhdGEgPSBuZXcgUmVzcG9uc2VEYXRhKHsgc2NoZW1hOiBhc24xLnJlc3VsdFtCQVNJQ19PQ1NQX1JFU1BPTlNFX1RCU19SRVNQT05TRV9EQVRBXSB9KTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmVBbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHRbQkFTSUNfT0NTUF9SRVNQT05TRV9TSUdOQVRVUkVfQUxHT1JJVEhNXSB9KTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmUgPSBhc24xLnJlc3VsdFtCQVNJQ19PQ1NQX1JFU1BPTlNFX1NJR05BVFVSRV07XG4gICAgICAgIGlmIChCQVNJQ19PQ1NQX1JFU1BPTlNFX0NFUlRTIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLmNlcnRzID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdFtCQVNJQ19PQ1NQX1JFU1BPTlNFX0NFUlRTXSwgZWxlbWVudCA9PiBuZXcgQ2VydGlmaWNhdGUoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMudGJzUmVzcG9uc2VEYXRhLnRvU2NoZW1hKCkpO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtLnRvU2NoZW1hKCkpO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMuc2lnbmF0dXJlKTtcbiAgICAgICAgaWYgKHRoaXMuY2VydHMpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMuY2VydHMsIG8gPT4gby50b1NjaGVtYSgpKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICB0YnNSZXNwb25zZURhdGE6IHRoaXMudGJzUmVzcG9uc2VEYXRhLnRvSlNPTigpLFxuICAgICAgICAgICAgc2lnbmF0dXJlQWxnb3JpdGhtOiB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobS50b0pTT04oKSxcbiAgICAgICAgICAgIHNpZ25hdHVyZTogdGhpcy5zaWduYXR1cmUudG9KU09OKCksXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLmNlcnRzKSB7XG4gICAgICAgICAgICByZXMuY2VydHMgPSBBcnJheS5mcm9tKHRoaXMuY2VydHMsIG8gPT4gby50b0pTT04oKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG4gICAgYXN5bmMgZ2V0Q2VydGlmaWNhdGVTdGF0dXMoY2VydGlmaWNhdGUsIGlzc3VlckNlcnRpZmljYXRlLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgaXNGb3JDZXJ0aWZpY2F0ZTogZmFsc2UsXG4gICAgICAgICAgICBzdGF0dXM6IDJcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgaGFzaGVzT2JqZWN0ID0ge307XG4gICAgICAgIGNvbnN0IGNlcnRJRHMgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCByZXNwb25zZSBvZiB0aGlzLnRic1Jlc3BvbnNlRGF0YS5yZXNwb25zZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IGhhc2hBbGdvcml0aG0gPSBjcnlwdG8uZ2V0QWxnb3JpdGhtQnlPSUQocmVzcG9uc2UuY2VydElELmhhc2hBbGdvcml0aG0uYWxnb3JpdGhtSWQsIHRydWUsIFwiQ2VydElELmhhc2hBbGdvcml0aG1cIik7XG4gICAgICAgICAgICBpZiAoIWhhc2hlc09iamVjdFtoYXNoQWxnb3JpdGhtLm5hbWVdKSB7XG4gICAgICAgICAgICAgICAgaGFzaGVzT2JqZWN0W2hhc2hBbGdvcml0aG0ubmFtZV0gPSAxO1xuICAgICAgICAgICAgICAgIGNvbnN0IGNlcnRJRCA9IG5ldyBDZXJ0SUQoKTtcbiAgICAgICAgICAgICAgICBjZXJ0SURzLnB1c2goY2VydElEKTtcbiAgICAgICAgICAgICAgICBhd2FpdCBjZXJ0SUQuY3JlYXRlRm9yQ2VydGlmaWNhdGUoY2VydGlmaWNhdGUsIHtcbiAgICAgICAgICAgICAgICAgICAgaGFzaEFsZ29yaXRobTogaGFzaEFsZ29yaXRobS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBpc3N1ZXJDZXJ0aWZpY2F0ZVxuICAgICAgICAgICAgICAgIH0sIGNyeXB0byk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCByZXNwb25zZSBvZiB0aGlzLnRic1Jlc3BvbnNlRGF0YS5yZXNwb25zZXMpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgaWQgb2YgY2VydElEcykge1xuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5jZXJ0SUQuaXNFcXVhbChpZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmlzRm9yQ2VydGlmaWNhdGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChyZXNwb25zZS5jZXJ0U3RhdHVzLmlkQmxvY2suaXNDb25zdHJ1Y3RlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgdHJ1ZTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmNlcnRTdGF0dXMuaWRCbG9jay50YWdOdW1iZXIgPT09IDEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuc3RhdHVzID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBmYWxzZTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChyZXNwb25zZS5jZXJ0U3RhdHVzLmlkQmxvY2sudGFnTnVtYmVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnN0YXR1cyA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnN0YXR1cyA9IDI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2gge1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIGFzeW5jIHNpZ24ocHJpdmF0ZUtleSwgaGFzaEFsZ29yaXRobSA9IFwiU0hBLTFcIiwgY3J5cHRvID0gZ2V0Q3J5cHRvKHRydWUpKSB7XG4gICAgICAgIGlmICghcHJpdmF0ZUtleSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTmVlZCB0byBwcm92aWRlIGEgcHJpdmF0ZSBrZXkgZm9yIHNpZ25pbmdcIik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc2lnbmF0dXJlUGFyYW1zID0gYXdhaXQgY3J5cHRvLmdldFNpZ25hdHVyZVBhcmFtZXRlcnMocHJpdmF0ZUtleSwgaGFzaEFsZ29yaXRobSk7XG4gICAgICAgIGNvbnN0IGFsZ29yaXRobSA9IHNpZ25hdHVyZVBhcmFtcy5wYXJhbWV0ZXJzLmFsZ29yaXRobTtcbiAgICAgICAgaWYgKCEoXCJuYW1lXCIgaW4gYWxnb3JpdGhtKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRW1wdHkgYWxnb3JpdGhtXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtID0gc2lnbmF0dXJlUGFyYW1zLnNpZ25hdHVyZUFsZ29yaXRobTtcbiAgICAgICAgdGhpcy50YnNSZXNwb25zZURhdGEudGJzVmlldyA9IG5ldyBVaW50OEFycmF5KHRoaXMudGJzUmVzcG9uc2VEYXRhLnRvU2NoZW1hKHRydWUpLnRvQkVSKCkpO1xuICAgICAgICBjb25zdCBzaWduYXR1cmUgPSBhd2FpdCBjcnlwdG8uc2lnbldpdGhQcml2YXRlS2V5KHRoaXMudGJzUmVzcG9uc2VEYXRhLnRic1ZpZXcsIHByaXZhdGVLZXksIHsgYWxnb3JpdGhtIH0pO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZSA9IG5ldyBhc24xanMuQml0U3RyaW5nKHsgdmFsdWVIZXg6IHNpZ25hdHVyZSB9KTtcbiAgICB9XG4gICAgYXN5bmMgdmVyaWZ5KHBhcmFtcyA9IHt9LCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgbGV0IHNpZ25lckNlcnQgPSBudWxsO1xuICAgICAgICBsZXQgY2VydEluZGV4ID0gLTE7XG4gICAgICAgIGNvbnN0IHRydXN0ZWRDZXJ0cyA9IHBhcmFtcy50cnVzdGVkQ2VydHMgfHwgW107XG4gICAgICAgIGlmICghdGhpcy5jZXJ0cykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gY2VydGlmaWNhdGVzIGF0dGFjaGVkIHRvIHRoZSBCYXNpY09DU1BSZXNwb25zZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBzd2l0Y2ggKHRydWUpIHtcbiAgICAgICAgICAgIGNhc2UgKHRoaXMudGJzUmVzcG9uc2VEYXRhLnJlc3BvbmRlcklEIGluc3RhbmNlb2YgUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZXMpOlxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgW2luZGV4LCBjZXJ0aWZpY2F0ZV0gb2YgdGhpcy5jZXJ0cy5lbnRyaWVzKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNlcnRpZmljYXRlLnN1YmplY3QuaXNFcXVhbCh0aGlzLnRic1Jlc3BvbnNlRGF0YS5yZXNwb25kZXJJRCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRJbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICh0aGlzLnRic1Jlc3BvbnNlRGF0YS5yZXNwb25kZXJJRCBpbnN0YW5jZW9mIGFzbjFqcy5PY3RldFN0cmluZyk6XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBbaW5kZXgsIGNlcnRdIG9mIHRoaXMuY2VydHMuZW50cmllcygpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGhhc2ggPSBhd2FpdCBjcnlwdG8uZGlnZXN0KHsgbmFtZTogXCJzaGEtMVwiIH0sIGNlcnQuc3ViamVjdFB1YmxpY0tleUluZm8uc3ViamVjdFB1YmxpY0tleS52YWx1ZUJsb2NrLnZhbHVlSGV4Vmlldyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwdnV0aWxzLmlzRXF1YWxCdWZmZXIoaGFzaCwgdGhpcy50YnNSZXNwb25zZURhdGEucmVzcG9uZGVySUQudmFsdWVCbG9jay52YWx1ZUhleCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRJbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIldyb25nIHZhbHVlIGZvciByZXNwb25kZXJJRFwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2VydEluZGV4ID09PSAoLTEpKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ29ycmVjdCBjZXJ0aWZpY2F0ZSB3YXMgbm90IGZvdW5kIGluIE9DU1AgcmVzcG9uc2VcIik7XG4gICAgICAgIHNpZ25lckNlcnQgPSB0aGlzLmNlcnRzW2NlcnRJbmRleF07XG4gICAgICAgIGNvbnN0IGFkZGl0aW9uYWxDZXJ0cyA9IFtzaWduZXJDZXJ0XTtcbiAgICAgICAgZm9yIChjb25zdCBjZXJ0IG9mIHRoaXMuY2VydHMpIHtcbiAgICAgICAgICAgIGNvbnN0IGNhQ2VydCA9IGF3YWl0IGNoZWNrQ0EoY2VydCwgc2lnbmVyQ2VydCk7XG4gICAgICAgICAgICBpZiAoY2FDZXJ0KSB7XG4gICAgICAgICAgICAgICAgYWRkaXRpb25hbENlcnRzLnB1c2goY2FDZXJ0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjZXJ0Q2hhaW4gPSBuZXcgQ2VydGlmaWNhdGVDaGFpblZhbGlkYXRpb25FbmdpbmUoe1xuICAgICAgICAgICAgY2VydHM6IGFkZGl0aW9uYWxDZXJ0cyxcbiAgICAgICAgICAgIHRydXN0ZWRDZXJ0cyxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHZlcmlmaWNhdGlvblJlc3VsdCA9IGF3YWl0IGNlcnRDaGFpbi52ZXJpZnkoe30sIGNyeXB0byk7XG4gICAgICAgIGlmICghdmVyaWZpY2F0aW9uUmVzdWx0LnJlc3VsdCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVmFsaWRhdGlvbiBvZiBzaWduZXIncyBjZXJ0aWZpY2F0ZSBmYWlsZWRcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNyeXB0by52ZXJpZnlXaXRoUHVibGljS2V5KHRoaXMudGJzUmVzcG9uc2VEYXRhLnRic1ZpZXcsIHRoaXMuc2lnbmF0dXJlLCB0aGlzLmNlcnRzW2NlcnRJbmRleF0uc3ViamVjdFB1YmxpY0tleUluZm8sIHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtKTtcbiAgICB9XG59XG5CYXNpY09DU1BSZXNwb25zZS5DTEFTU19OQU1FID0gXCJCYXNpY09DU1BSZXNwb25zZVwiO1xuXG5jb25zdCBUQlMkMSA9IFwidGJzXCI7XG5jb25zdCBWRVJTSU9OJDYgPSBcInZlcnNpb25cIjtcbmNvbnN0IFNVQkpFQ1QgPSBcInN1YmplY3RcIjtcbmNvbnN0IFNQS0kgPSBcInN1YmplY3RQdWJsaWNLZXlJbmZvXCI7XG5jb25zdCBBVFRSSUJVVEVTJDEgPSBcImF0dHJpYnV0ZXNcIjtcbmNvbnN0IFNJR05BVFVSRV9BTEdPUklUSE0kMiA9IFwic2lnbmF0dXJlQWxnb3JpdGhtXCI7XG5jb25zdCBTSUdOQVRVUkVfVkFMVUUgPSBcInNpZ25hdHVyZVZhbHVlXCI7XG5jb25zdCBDU1JfSU5GTyA9IFwiQ2VydGlmaWNhdGlvblJlcXVlc3RJbmZvXCI7XG5jb25zdCBDU1JfSU5GT19WRVJTSU9OID0gYCR7Q1NSX0lORk99LnZlcnNpb25gO1xuY29uc3QgQ1NSX0lORk9fU1VCSkVDVCA9IGAke0NTUl9JTkZPfS5zdWJqZWN0YDtcbmNvbnN0IENTUl9JTkZPX1NQS0kgPSBgJHtDU1JfSU5GT30uc3ViamVjdFB1YmxpY0tleUluZm9gO1xuY29uc3QgQ1NSX0lORk9fQVRUUlMgPSBgJHtDU1JfSU5GT30uYXR0cmlidXRlc2A7XG5jb25zdCBDTEVBUl9QUk9QUyRmID0gW1xuICAgIENTUl9JTkZPLFxuICAgIENTUl9JTkZPX1ZFUlNJT04sXG4gICAgQ1NSX0lORk9fU1VCSkVDVCxcbiAgICBDU1JfSU5GT19TUEtJLFxuICAgIENTUl9JTkZPX0FUVFJTLFxuICAgIFNJR05BVFVSRV9BTEdPUklUSE0kMixcbiAgICBTSUdOQVRVUkVfVkFMVUVcbl07XG5mdW5jdGlvbiBDZXJ0aWZpY2F0aW9uUmVxdWVzdEluZm8ocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICBuYW1lOiAobmFtZXMuQ2VydGlmaWNhdGlvblJlcXVlc3RJbmZvIHx8IENTUl9JTkZPKSxcbiAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy5DZXJ0aWZpY2F0aW9uUmVxdWVzdEluZm9WZXJzaW9uIHx8IENTUl9JTkZPX1ZFUlNJT04pIH0pLFxuICAgICAgICAgICAgUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZXMuc2NoZW1hKG5hbWVzLnN1YmplY3QgfHwge1xuICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogQ1NSX0lORk9fU1VCSkVDVFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgUHVibGljS2V5SW5mby5zY2hlbWEoe1xuICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogQ1NSX0lORk9fU1BLSVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLkNlcnRpZmljYXRpb25SZXF1ZXN0SW5mb0F0dHJpYnV0ZXMgfHwgQ1NSX0lORk9fQVRUUlMpLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IEF0dHJpYnV0ZS5zY2hlbWEobmFtZXMuYXR0cmlidXRlcyB8fCB7fSlcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9KVxuICAgICAgICBdXG4gICAgfSkpO1xufVxuY2xhc3MgQ2VydGlmaWNhdGlvblJlcXVlc3QgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGdldCB0YnMoKSB7XG4gICAgICAgIHJldHVybiBwdnRzdXRpbHMuQnVmZmVyU291cmNlQ29udmVydGVyLnRvQXJyYXlCdWZmZXIodGhpcy50YnNWaWV3KTtcbiAgICB9XG4gICAgc2V0IHRicyh2YWx1ZSkge1xuICAgICAgICB0aGlzLnRic1ZpZXcgPSBuZXcgVWludDhBcnJheSh2YWx1ZSk7XG4gICAgfVxuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnRic1ZpZXcgPSBuZXcgVWludDhBcnJheShwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBUQlMkMSwgQ2VydGlmaWNhdGlvblJlcXVlc3QuZGVmYXVsdFZhbHVlcyhUQlMkMSkpKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVkVSU0lPTiQ2LCBDZXJ0aWZpY2F0aW9uUmVxdWVzdC5kZWZhdWx0VmFsdWVzKFZFUlNJT04kNikpO1xuICAgICAgICB0aGlzLnN1YmplY3QgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTVUJKRUNULCBDZXJ0aWZpY2F0aW9uUmVxdWVzdC5kZWZhdWx0VmFsdWVzKFNVQkpFQ1QpKTtcbiAgICAgICAgdGhpcy5zdWJqZWN0UHVibGljS2V5SW5mbyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNQS0ksIENlcnRpZmljYXRpb25SZXF1ZXN0LmRlZmF1bHRWYWx1ZXMoU1BLSSkpO1xuICAgICAgICBpZiAoQVRUUklCVVRFUyQxIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEFUVFJJQlVURVMkMSwgQ2VydGlmaWNhdGlvblJlcXVlc3QuZGVmYXVsdFZhbHVlcyhBVFRSSUJVVEVTJDEpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNJR05BVFVSRV9BTEdPUklUSE0kMiwgQ2VydGlmaWNhdGlvblJlcXVlc3QuZGVmYXVsdFZhbHVlcyhTSUdOQVRVUkVfQUxHT1JJVEhNJDIpKTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmVWYWx1ZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNJR05BVFVSRV9WQUxVRSwgQ2VydGlmaWNhdGlvblJlcXVlc3QuZGVmYXVsdFZhbHVlcyhTSUdOQVRVUkVfVkFMVUUpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFRCUyQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9CVUZGRVI7XG4gICAgICAgICAgICBjYXNlIFZFUlNJT04kNjpcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGNhc2UgU1VCSkVDVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFJlbGF0aXZlRGlzdGluZ3Vpc2hlZE5hbWVzKCk7XG4gICAgICAgICAgICBjYXNlIFNQS0k6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQdWJsaWNLZXlJbmZvKCk7XG4gICAgICAgICAgICBjYXNlIEFUVFJJQlVURVMkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBjYXNlIFNJR05BVFVSRV9BTEdPUklUSE0kMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgU0lHTkFUVVJFX1ZBTFVFOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkJpdFN0cmluZygpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBDZXJ0aWZpY2F0aW9uUmVxdWVzdEluZm8obmFtZXMuY2VydGlmaWNhdGlvblJlcXVlc3RJbmZvIHx8IHt9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnNpZ25hdHVyZUFsZ29yaXRobSB8fCBTSUdOQVRVUkVfQUxHT1JJVEhNJDIpLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkFueSh7IG9wdGlvbmFsOiB0cnVlIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkJpdFN0cmluZyh7IG5hbWU6IChuYW1lcy5zaWduYXR1cmVWYWx1ZSB8fCBTSUdOQVRVUkVfVkFMVUUpIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkZik7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgQ2VydGlmaWNhdGlvblJlcXVlc3Quc2NoZW1hKCkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLnRic1ZpZXcgPSBhc24xLnJlc3VsdC5DZXJ0aWZpY2F0aW9uUmVxdWVzdEluZm8udmFsdWVCZWZvcmVEZWNvZGVWaWV3O1xuICAgICAgICB0aGlzLnZlcnNpb24gPSBhc24xLnJlc3VsdFtDU1JfSU5GT19WRVJTSU9OXS52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgICAgICB0aGlzLnN1YmplY3QgPSBuZXcgUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZXMoeyBzY2hlbWE6IGFzbjEucmVzdWx0W0NTUl9JTkZPX1NVQkpFQ1RdIH0pO1xuICAgICAgICB0aGlzLnN1YmplY3RQdWJsaWNLZXlJbmZvID0gbmV3IFB1YmxpY0tleUluZm8oeyBzY2hlbWE6IGFzbjEucmVzdWx0W0NTUl9JTkZPX1NQS0ldIH0pO1xuICAgICAgICBpZiAoQ1NSX0lORk9fQVRUUlMgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHRbQ1NSX0lORk9fQVRUUlNdLCBlbGVtZW50ID0+IG5ldyBBdHRyaWJ1dGUoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0LnNpZ25hdHVyZUFsZ29yaXRobSB9KTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmVWYWx1ZSA9IGFzbjEucmVzdWx0LnNpZ25hdHVyZVZhbHVlO1xuICAgIH1cbiAgICBlbmNvZGVUQlMoKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW1xuICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWU6IHRoaXMudmVyc2lvbiB9KSxcbiAgICAgICAgICAgIHRoaXMuc3ViamVjdC50b1NjaGVtYSgpLFxuICAgICAgICAgICAgdGhpcy5zdWJqZWN0UHVibGljS2V5SW5mby50b1NjaGVtYSgpXG4gICAgICAgIF07XG4gICAgICAgIGlmIChBVFRSSUJVVEVTJDEgaW4gdGhpcykge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMuYXR0cmlidXRlcyB8fCBbXSwgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvU2NoZW1hKGVuY29kZUZsYWcgPSBmYWxzZSkge1xuICAgICAgICBsZXQgdGJzU2NoZW1hO1xuICAgICAgICBpZiAoZW5jb2RlRmxhZyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnRic1ZpZXcuYnl0ZUxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBDZXJ0aWZpY2F0aW9uUmVxdWVzdC5zY2hlbWEoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuZnJvbUJFUih0aGlzLnRic1ZpZXcpO1xuICAgICAgICAgICAgQXNuRXJyb3IuYXNzZXJ0KGFzbjEsIFwiUEtDUyMxMCBDZXJ0aWZpY2F0ZSBSZXF1ZXN0XCIpO1xuICAgICAgICAgICAgdGJzU2NoZW1hID0gYXNuMS5yZXN1bHQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0YnNTY2hlbWEgPSB0aGlzLmVuY29kZVRCUygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIHRic1NjaGVtYSxcbiAgICAgICAgICAgICAgICB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobS50b1NjaGVtYSgpLFxuICAgICAgICAgICAgICAgIHRoaXMuc2lnbmF0dXJlVmFsdWVcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IG9iamVjdCA9IHtcbiAgICAgICAgICAgIHRiczogcHZ0c3V0aWxzLkNvbnZlcnQuVG9IZXgodGhpcy50YnNWaWV3KSxcbiAgICAgICAgICAgIHZlcnNpb246IHRoaXMudmVyc2lvbixcbiAgICAgICAgICAgIHN1YmplY3Q6IHRoaXMuc3ViamVjdC50b0pTT04oKSxcbiAgICAgICAgICAgIHN1YmplY3RQdWJsaWNLZXlJbmZvOiB0aGlzLnN1YmplY3RQdWJsaWNLZXlJbmZvLnRvSlNPTigpLFxuICAgICAgICAgICAgc2lnbmF0dXJlQWxnb3JpdGhtOiB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobS50b0pTT04oKSxcbiAgICAgICAgICAgIHNpZ25hdHVyZVZhbHVlOiB0aGlzLnNpZ25hdHVyZVZhbHVlLnRvSlNPTigpLFxuICAgICAgICB9O1xuICAgICAgICBpZiAoQVRUUklCVVRFUyQxIGluIHRoaXMpIHtcbiAgICAgICAgICAgIG9iamVjdC5hdHRyaWJ1dGVzID0gQXJyYXkuZnJvbSh0aGlzLmF0dHJpYnV0ZXMgfHwgW10sIG8gPT4gby50b0pTT04oKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9iamVjdDtcbiAgICB9XG4gICAgYXN5bmMgc2lnbihwcml2YXRlS2V5LCBoYXNoQWxnb3JpdGhtID0gXCJTSEEtMVwiLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgaWYgKCFwcml2YXRlS2V5KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJOZWVkIHRvIHByb3ZpZGUgYSBwcml2YXRlIGtleSBmb3Igc2lnbmluZ1wiKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzaWduYXR1cmVQYXJhbXMgPSBhd2FpdCBjcnlwdG8uZ2V0U2lnbmF0dXJlUGFyYW1ldGVycyhwcml2YXRlS2V5LCBoYXNoQWxnb3JpdGhtKTtcbiAgICAgICAgY29uc3QgcGFyYW1ldGVycyA9IHNpZ25hdHVyZVBhcmFtcy5wYXJhbWV0ZXJzO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobSA9IHNpZ25hdHVyZVBhcmFtcy5zaWduYXR1cmVBbGdvcml0aG07XG4gICAgICAgIHRoaXMudGJzVmlldyA9IG5ldyBVaW50OEFycmF5KHRoaXMuZW5jb2RlVEJTKCkudG9CRVIoKSk7XG4gICAgICAgIGNvbnN0IHNpZ25hdHVyZSA9IGF3YWl0IGNyeXB0by5zaWduV2l0aFByaXZhdGVLZXkodGhpcy50YnNWaWV3LCBwcml2YXRlS2V5LCBwYXJhbWV0ZXJzKTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmVWYWx1ZSA9IG5ldyBhc24xanMuQml0U3RyaW5nKHsgdmFsdWVIZXg6IHNpZ25hdHVyZSB9KTtcbiAgICB9XG4gICAgYXN5bmMgdmVyaWZ5KGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICByZXR1cm4gY3J5cHRvLnZlcmlmeVdpdGhQdWJsaWNLZXkodGhpcy50YnNWaWV3LCB0aGlzLnNpZ25hdHVyZVZhbHVlLCB0aGlzLnN1YmplY3RQdWJsaWNLZXlJbmZvLCB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobSk7XG4gICAgfVxuICAgIGFzeW5jIGdldFB1YmxpY0tleShwYXJhbWV0ZXJzLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgcmV0dXJuIGNyeXB0by5nZXRQdWJsaWNLZXkodGhpcy5zdWJqZWN0UHVibGljS2V5SW5mbywgdGhpcy5zaWduYXR1cmVBbGdvcml0aG0sIHBhcmFtZXRlcnMpO1xuICAgIH1cbn1cbkNlcnRpZmljYXRpb25SZXF1ZXN0LkNMQVNTX05BTUUgPSBcIkNlcnRpZmljYXRpb25SZXF1ZXN0XCI7XG5cbmNvbnN0IERJR0VTVF9BTEdPUklUSE0kMSA9IFwiZGlnZXN0QWxnb3JpdGhtXCI7XG5jb25zdCBESUdFU1QgPSBcImRpZ2VzdFwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkZSA9IFtcbiAgICBESUdFU1RfQUxHT1JJVEhNJDEsXG4gICAgRElHRVNUXG5dO1xuY2xhc3MgRGlnZXN0SW5mbyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuZGlnZXN0QWxnb3JpdGhtID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgRElHRVNUX0FMR09SSVRITSQxLCBEaWdlc3RJbmZvLmRlZmF1bHRWYWx1ZXMoRElHRVNUX0FMR09SSVRITSQxKSk7XG4gICAgICAgIHRoaXMuZGlnZXN0ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgRElHRVNULCBEaWdlc3RJbmZvLmRlZmF1bHRWYWx1ZXMoRElHRVNUKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBESUdFU1RfQUxHT1JJVEhNJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKCk7XG4gICAgICAgICAgICBjYXNlIERJR0VTVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5PY3RldFN0cmluZygpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBESUdFU1RfQUxHT1JJVEhNJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgoQWxnb3JpdGhtSWRlbnRpZmllci5jb21wYXJlV2l0aERlZmF1bHQoXCJhbGdvcml0aG1JZFwiLCBtZW1iZXJWYWx1ZS5hbGdvcml0aG1JZCkpICYmXG4gICAgICAgICAgICAgICAgICAgICgoXCJhbGdvcml0aG1QYXJhbXNcIiBpbiBtZW1iZXJWYWx1ZSkgPT09IGZhbHNlKSk7XG4gICAgICAgICAgICBjYXNlIERJR0VTVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmlzRXF1YWwoRGlnZXN0SW5mby5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIEFsZ29yaXRobUlkZW50aWZpZXIuc2NoZW1hKG5hbWVzLmRpZ2VzdEFsZ29yaXRobSB8fCB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IERJR0VTVF9BTEdPUklUSE0kMVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IG5hbWU6IChuYW1lcy5kaWdlc3QgfHwgRElHRVNUKSB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJGUpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIERpZ2VzdEluZm8uc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgZGlnZXN0QWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IERJR0VTVF9BTEdPUklUSE0kMVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBkaWdlc3Q6IERJR0VTVFxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuZGlnZXN0QWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0LmRpZ2VzdEFsZ29yaXRobSB9KTtcbiAgICAgICAgdGhpcy5kaWdlc3QgPSBhc24xLnJlc3VsdC5kaWdlc3Q7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICB0aGlzLmRpZ2VzdEFsZ29yaXRobS50b1NjaGVtYSgpLFxuICAgICAgICAgICAgICAgIHRoaXMuZGlnZXN0XG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZGlnZXN0QWxnb3JpdGhtOiB0aGlzLmRpZ2VzdEFsZ29yaXRobS50b0pTT04oKSxcbiAgICAgICAgICAgIGRpZ2VzdDogdGhpcy5kaWdlc3QudG9KU09OKCksXG4gICAgICAgIH07XG4gICAgfVxufVxuRGlnZXN0SW5mby5DTEFTU19OQU1FID0gXCJEaWdlc3RJbmZvXCI7XG5cbmNvbnN0IEVfQ09OVEVOVF9UWVBFID0gXCJlQ29udGVudFR5cGVcIjtcbmNvbnN0IEVfQ09OVEVOVCA9IFwiZUNvbnRlbnRcIjtcbmNvbnN0IENMRUFSX1BST1BTJGQgPSBbXG4gICAgRV9DT05URU5UX1RZUEUsXG4gICAgRV9DT05URU5ULFxuXTtcbmNsYXNzIEVuY2Fwc3VsYXRlZENvbnRlbnRJbmZvIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5lQ29udGVudFR5cGUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBFX0NPTlRFTlRfVFlQRSwgRW5jYXBzdWxhdGVkQ29udGVudEluZm8uZGVmYXVsdFZhbHVlcyhFX0NPTlRFTlRfVFlQRSkpO1xuICAgICAgICBpZiAoRV9DT05URU5UIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuZUNvbnRlbnQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBFX0NPTlRFTlQsIEVuY2Fwc3VsYXRlZENvbnRlbnRJbmZvLmRlZmF1bHRWYWx1ZXMoRV9DT05URU5UKSk7XG4gICAgICAgICAgICBpZiAoKHRoaXMuZUNvbnRlbnQuaWRCbG9jay50YWdDbGFzcyA9PT0gMSkgJiZcbiAgICAgICAgICAgICAgICAodGhpcy5lQ29udGVudC5pZEJsb2NrLnRhZ051bWJlciA9PT0gNCkpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5lQ29udGVudC5pZEJsb2NrLmlzQ29uc3RydWN0ZWQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnN0clN0cmluZyA9IG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWRCbG9jazogeyBpc0NvbnN0cnVjdGVkOiB0cnVlIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0NvbnN0cnVjdGVkOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBsZXQgb2Zmc2V0ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgdmlld0hleCA9IHRoaXMuZUNvbnRlbnQudmFsdWVCbG9jay52YWx1ZUhleFZpZXcuc2xpY2UoKS5idWZmZXI7XG4gICAgICAgICAgICAgICAgICAgIGxldCBsZW5ndGggPSB2aWV3SGV4LmJ5dGVMZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHdoaWxlIChsZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwaWVjZVZpZXcgPSBuZXcgVWludDhBcnJheSh2aWV3SGV4LCBvZmZzZXQsICgob2Zmc2V0ICsgNjU1MzYpID4gdmlld0hleC5ieXRlTGVuZ3RoKSA/ICh2aWV3SGV4LmJ5dGVMZW5ndGggLSBvZmZzZXQpIDogNjU1MzYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgX2FycmF5ID0gbmV3IEFycmF5QnVmZmVyKHBpZWNlVmlldy5sZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgX3ZpZXcgPSBuZXcgVWludDhBcnJheShfYXJyYXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBfdmlldy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92aWV3W2ldID0gcGllY2VWaWV3W2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3RyU3RyaW5nLnZhbHVlQmxvY2sudmFsdWUucHVzaChuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgdmFsdWVIZXg6IF9hcnJheSB9KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZW5ndGggLT0gcGllY2VWaWV3Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCArPSBwaWVjZVZpZXcubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZUNvbnRlbnQgPSBjb25zdHJTdHJpbmc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBFX0NPTlRFTlRfVFlQRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfU1RSSU5HO1xuICAgICAgICAgICAgY2FzZSBFX0NPTlRFTlQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgRV9DT05URU5UX1RZUEU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gRU1QVFlfU1RSSU5HKTtcbiAgICAgICAgICAgIGNhc2UgRV9DT05URU5UOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChtZW1iZXJWYWx1ZS5pZEJsb2NrLnRhZ0NsYXNzID09PSAxKSAmJiAobWVtYmVyVmFsdWUuaWRCbG9jay50YWdOdW1iZXIgPT09IDQpKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5pc0VxdWFsKEVuY2Fwc3VsYXRlZENvbnRlbnRJbmZvLmRlZmF1bHRWYWx1ZXMoRV9DT05URU5UKSkpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyBuYW1lOiAobmFtZXMuZUNvbnRlbnRUeXBlIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5BbnkoeyBuYW1lOiAobmFtZXMuZUNvbnRlbnQgfHwgRU1QVFlfU1RSSU5HKSB9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRkKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBFbmNhcHN1bGF0ZWRDb250ZW50SW5mby5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBlQ29udGVudFR5cGU6IEVfQ09OVEVOVF9UWVBFLFxuICAgICAgICAgICAgICAgIGVDb250ZW50OiBFX0NPTlRFTlRcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmVDb250ZW50VHlwZSA9IGFzbjEucmVzdWx0LmVDb250ZW50VHlwZS52YWx1ZUJsb2NrLnRvU3RyaW5nKCk7XG4gICAgICAgIGlmIChFX0NPTlRFTlQgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLmVDb250ZW50ID0gYXNuMS5yZXN1bHQuZUNvbnRlbnQ7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLmVDb250ZW50VHlwZSB9KSk7XG4gICAgICAgIGlmICh0aGlzLmVDb250ZW50KSB7XG4gICAgICAgICAgICBpZiAoRW5jYXBzdWxhdGVkQ29udGVudEluZm8uY29tcGFyZVdpdGhEZWZhdWx0KEVfQ09OVEVOVCwgdGhpcy5lQ29udGVudCkgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbdGhpcy5lQ29udGVudF1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgICAgZUNvbnRlbnRUeXBlOiB0aGlzLmVDb250ZW50VHlwZVxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5lQ29udGVudCAmJiBFbmNhcHN1bGF0ZWRDb250ZW50SW5mby5jb21wYXJlV2l0aERlZmF1bHQoRV9DT05URU5ULCB0aGlzLmVDb250ZW50KSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHJlcy5lQ29udGVudCA9IHRoaXMuZUNvbnRlbnQudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5FbmNhcHN1bGF0ZWRDb250ZW50SW5mby5DTEFTU19OQU1FID0gXCJFbmNhcHN1bGF0ZWRDb250ZW50SW5mb1wiO1xuXG5jbGFzcyBLZXlCYWcgZXh0ZW5kcyBQcml2YXRlS2V5SW5mbyB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKHBhcmFtZXRlcnMpO1xuICAgIH1cbn1cblxuY29uc3QgTUFDID0gXCJtYWNcIjtcbmNvbnN0IE1BQ19TQUxUID0gXCJtYWNTYWx0XCI7XG5jb25zdCBJVEVSQVRJT05TID0gXCJpdGVyYXRpb25zXCI7XG5jb25zdCBDTEVBUl9QUk9QUyRjID0gW1xuICAgIE1BQyxcbiAgICBNQUNfU0FMVCxcbiAgICBJVEVSQVRJT05TXG5dO1xuY2xhc3MgTWFjRGF0YSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMubWFjID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgTUFDLCBNYWNEYXRhLmRlZmF1bHRWYWx1ZXMoTUFDKSk7XG4gICAgICAgIHRoaXMubWFjU2FsdCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE1BQ19TQUxULCBNYWNEYXRhLmRlZmF1bHRWYWx1ZXMoTUFDX1NBTFQpKTtcbiAgICAgICAgaWYgKElURVJBVElPTlMgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5pdGVyYXRpb25zID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgSVRFUkFUSU9OUywgTWFjRGF0YS5kZWZhdWx0VmFsdWVzKElURVJBVElPTlMpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgTUFDOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGlnZXN0SW5mbygpO1xuICAgICAgICAgICAgY2FzZSBNQUNfU0FMVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5PY3RldFN0cmluZygpO1xuICAgICAgICAgICAgY2FzZSBJVEVSQVRJT05TOlxuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBNQUM6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgoRGlnZXN0SW5mby5jb21wYXJlV2l0aERlZmF1bHQoXCJkaWdlc3RBbGdvcml0aG1cIiwgbWVtYmVyVmFsdWUuZGlnZXN0QWxnb3JpdGhtKSkgJiZcbiAgICAgICAgICAgICAgICAgICAgKERpZ2VzdEluZm8uY29tcGFyZVdpdGhEZWZhdWx0KFwiZGlnZXN0XCIsIG1lbWJlclZhbHVlLmRpZ2VzdCkpKTtcbiAgICAgICAgICAgIGNhc2UgTUFDX1NBTFQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5pc0VxdWFsKE1hY0RhdGEuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSkpO1xuICAgICAgICAgICAgY2FzZSBJVEVSQVRJT05TOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgPT09IE1hY0RhdGEuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICBvcHRpb25hbDogKG5hbWVzLm9wdGlvbmFsIHx8IHRydWUpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBEaWdlc3RJbmZvLnNjaGVtYShuYW1lcy5tYWMgfHwge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBNQUNcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyBuYW1lOiAobmFtZXMubWFjU2FsdCB8fCBNQUNfU0FMVCkgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5pdGVyYXRpb25zIHx8IElURVJBVElPTlMpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRjKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBNYWNEYXRhLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIG1hYzoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBNQUNcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbWFjU2FsdDogTUFDX1NBTFQsXG4gICAgICAgICAgICAgICAgaXRlcmF0aW9uczogSVRFUkFUSU9OU1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMubWFjID0gbmV3IERpZ2VzdEluZm8oeyBzY2hlbWE6IGFzbjEucmVzdWx0Lm1hYyB9KTtcbiAgICAgICAgdGhpcy5tYWNTYWx0ID0gYXNuMS5yZXN1bHQubWFjU2FsdDtcbiAgICAgICAgaWYgKElURVJBVElPTlMgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLml0ZXJhdGlvbnMgPSBhc24xLnJlc3VsdC5pdGVyYXRpb25zLnZhbHVlQmxvY2sudmFsdWVEZWM7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtcbiAgICAgICAgICAgIHRoaXMubWFjLnRvU2NoZW1hKCksXG4gICAgICAgICAgICB0aGlzLm1hY1NhbHRcbiAgICAgICAgXTtcbiAgICAgICAgaWYgKHRoaXMuaXRlcmF0aW9ucyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlOiB0aGlzLml0ZXJhdGlvbnMgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICAgIG1hYzogdGhpcy5tYWMudG9KU09OKCksXG4gICAgICAgICAgICBtYWNTYWx0OiB0aGlzLm1hY1NhbHQudG9KU09OKCksXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLml0ZXJhdGlvbnMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmVzLml0ZXJhdGlvbnMgPSB0aGlzLml0ZXJhdGlvbnM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5NYWNEYXRhLkNMQVNTX05BTUUgPSBcIk1hY0RhdGFcIjtcblxuY29uc3QgSEFTSF9BTEdPUklUSE0gPSBcImhhc2hBbGdvcml0aG1cIjtcbmNvbnN0IEhBU0hFRF9NRVNTQUdFID0gXCJoYXNoZWRNZXNzYWdlXCI7XG5jb25zdCBDTEVBUl9QUk9QUyRiID0gW1xuICAgIEhBU0hfQUxHT1JJVEhNLFxuICAgIEhBU0hFRF9NRVNTQUdFLFxuXTtcbmNsYXNzIE1lc3NhZ2VJbXByaW50IGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBzdGF0aWMgYXN5bmMgY3JlYXRlKGhhc2hBbGdvcml0aG0sIG1lc3NhZ2UsIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICBjb25zdCBoYXNoQWxnb3JpdGhtT0lEID0gY3J5cHRvLmdldE9JREJ5QWxnb3JpdGhtKHsgbmFtZTogaGFzaEFsZ29yaXRobSB9LCB0cnVlLCBcImhhc2hBbGdvcml0aG1cIik7XG4gICAgICAgIGNvbnN0IGhhc2hlZE1lc3NhZ2UgPSBhd2FpdCBjcnlwdG8uZGlnZXN0KGhhc2hBbGdvcml0aG0sIG1lc3NhZ2UpO1xuICAgICAgICBjb25zdCByZXMgPSBuZXcgTWVzc2FnZUltcHJpbnQoe1xuICAgICAgICAgICAgaGFzaEFsZ29yaXRobTogbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoe1xuICAgICAgICAgICAgICAgIGFsZ29yaXRobUlkOiBoYXNoQWxnb3JpdGhtT0lELFxuICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogbmV3IGFzbjFqcy5OdWxsKCksXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIGhhc2hlZE1lc3NhZ2U6IG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyB2YWx1ZUhleDogaGFzaGVkTWVzc2FnZSB9KVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuaGFzaEFsZ29yaXRobSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEhBU0hfQUxHT1JJVEhNLCBNZXNzYWdlSW1wcmludC5kZWZhdWx0VmFsdWVzKEhBU0hfQUxHT1JJVEhNKSk7XG4gICAgICAgIHRoaXMuaGFzaGVkTWVzc2FnZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEhBU0hFRF9NRVNTQUdFLCBNZXNzYWdlSW1wcmludC5kZWZhdWx0VmFsdWVzKEhBU0hFRF9NRVNTQUdFKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBIQVNIX0FMR09SSVRITTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgSEFTSEVEX01FU1NBR0U6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgSEFTSF9BTEdPUklUSE06XG4gICAgICAgICAgICAgICAgcmV0dXJuICgobWVtYmVyVmFsdWUuYWxnb3JpdGhtSWQgPT09IEVNUFRZX1NUUklORykgJiYgKChcImFsZ29yaXRobVBhcmFtc1wiIGluIG1lbWJlclZhbHVlKSA9PT0gZmFsc2UpKTtcbiAgICAgICAgICAgIGNhc2UgSEFTSEVEX01FU1NBR0U6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5pc0VxdWFsKE1lc3NhZ2VJbXByaW50LmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkpID09PSAwKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMuaGFzaEFsZ29yaXRobSB8fCB7fSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IG5hbWU6IChuYW1lcy5oYXNoZWRNZXNzYWdlIHx8IEVNUFRZX1NUUklORykgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRiKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBNZXNzYWdlSW1wcmludC5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBoYXNoQWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IEhBU0hfQUxHT1JJVEhNXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGhhc2hlZE1lc3NhZ2U6IEhBU0hFRF9NRVNTQUdFXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5oYXNoQWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0Lmhhc2hBbGdvcml0aG0gfSk7XG4gICAgICAgIHRoaXMuaGFzaGVkTWVzc2FnZSA9IGFzbjEucmVzdWx0Lmhhc2hlZE1lc3NhZ2U7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICB0aGlzLmhhc2hBbGdvcml0aG0udG9TY2hlbWEoKSxcbiAgICAgICAgICAgICAgICB0aGlzLmhhc2hlZE1lc3NhZ2VcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBoYXNoQWxnb3JpdGhtOiB0aGlzLmhhc2hBbGdvcml0aG0udG9KU09OKCksXG4gICAgICAgICAgICBoYXNoZWRNZXNzYWdlOiB0aGlzLmhhc2hlZE1lc3NhZ2UudG9KU09OKCksXG4gICAgICAgIH07XG4gICAgfVxufVxuTWVzc2FnZUltcHJpbnQuQ0xBU1NfTkFNRSA9IFwiTWVzc2FnZUltcHJpbnRcIjtcblxuY29uc3QgUkVRX0NFUlQgPSBcInJlcUNlcnRcIjtcbmNvbnN0IFNJTkdMRV9SRVFVRVNUX0VYVEVOU0lPTlMgPSBcInNpbmdsZVJlcXVlc3RFeHRlbnNpb25zXCI7XG5jb25zdCBDTEVBUl9QUk9QUyRhID0gW1xuICAgIFJFUV9DRVJULFxuICAgIFNJTkdMRV9SRVFVRVNUX0VYVEVOU0lPTlMsXG5dO1xuY2xhc3MgUmVxdWVzdCBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMucmVxQ2VydCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFJFUV9DRVJULCBSZXF1ZXN0LmRlZmF1bHRWYWx1ZXMoUkVRX0NFUlQpKTtcbiAgICAgICAgaWYgKFNJTkdMRV9SRVFVRVNUX0VYVEVOU0lPTlMgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5zaW5nbGVSZXF1ZXN0RXh0ZW5zaW9ucyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNJTkdMRV9SRVFVRVNUX0VYVEVOU0lPTlMsIFJlcXVlc3QuZGVmYXVsdFZhbHVlcyhTSU5HTEVfUkVRVUVTVF9FWFRFTlNJT05TKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFJFUV9DRVJUOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ2VydElEKCk7XG4gICAgICAgICAgICBjYXNlIFNJTkdMRV9SRVFVRVNUX0VYVEVOU0lPTlM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBSRVFfQ0VSVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmlzRXF1YWwoUmVxdWVzdC5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKSk7XG4gICAgICAgICAgICBjYXNlIFNJTkdMRV9SRVFVRVNUX0VYVEVOU0lPTlM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBDZXJ0SUQuc2NoZW1hKG5hbWVzLnJlcUNlcnQgfHwge30pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtFeHRlbnNpb24uc2NoZW1hKG5hbWVzLmV4dGVuc2lvbnMgfHwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogKG5hbWVzLnNpbmdsZVJlcXVlc3RFeHRlbnNpb25zIHx8IEVNUFRZX1NUUklORylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KV1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJGEpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFJlcXVlc3Quc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgcmVxQ2VydDoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBSRVFfQ0VSVFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBleHRlbnNpb25zOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFNJTkdMRV9SRVFVRVNUX0VYVEVOU0lPTlNcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLnJlcUNlcnQgPSBuZXcgQ2VydElEKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5yZXFDZXJ0IH0pO1xuICAgICAgICBpZiAoU0lOR0xFX1JFUVVFU1RfRVhURU5TSU9OUyBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5zaW5nbGVSZXF1ZXN0RXh0ZW5zaW9ucyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHQuc2luZ2xlUmVxdWVzdEV4dGVuc2lvbnMudmFsdWVCbG9jay52YWx1ZSwgZWxlbWVudCA9PiBuZXcgRXh0ZW5zaW9uKHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnJlcUNlcnQudG9TY2hlbWEoKSk7XG4gICAgICAgIGlmICh0aGlzLnNpbmdsZVJlcXVlc3RFeHRlbnNpb25zKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLnNpbmdsZVJlcXVlc3RFeHRlbnNpb25zLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgICAgcmVxQ2VydDogdGhpcy5yZXFDZXJ0LnRvSlNPTigpXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLnNpbmdsZVJlcXVlc3RFeHRlbnNpb25zKSB7XG4gICAgICAgICAgICByZXMuc2luZ2xlUmVxdWVzdEV4dGVuc2lvbnMgPSBBcnJheS5mcm9tKHRoaXMuc2luZ2xlUmVxdWVzdEV4dGVuc2lvbnMsIG8gPT4gby50b0pTT04oKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5SZXF1ZXN0LkNMQVNTX05BTUUgPSBcIlJlcXVlc3RcIjtcblxuY29uc3QgVEJTID0gXCJ0YnNcIjtcbmNvbnN0IFZFUlNJT04kNSA9IFwidmVyc2lvblwiO1xuY29uc3QgUkVRVUVTVE9SX05BTUUgPSBcInJlcXVlc3Rvck5hbWVcIjtcbmNvbnN0IFJFUVVFU1RfTElTVCA9IFwicmVxdWVzdExpc3RcIjtcbmNvbnN0IFJFUVVFU1RfRVhURU5TSU9OUyA9IFwicmVxdWVzdEV4dGVuc2lvbnNcIjtcbmNvbnN0IFRCU19SRVFVRVNUJDEgPSBcIlRCU1JlcXVlc3RcIjtcbmNvbnN0IFRCU19SRVFVRVNUX1ZFUlNJT04gPSBgJHtUQlNfUkVRVUVTVCQxfS4ke1ZFUlNJT04kNX1gO1xuY29uc3QgVEJTX1JFUVVFU1RfUkVRVUVTVE9SX05BTUUgPSBgJHtUQlNfUkVRVUVTVCQxfS4ke1JFUVVFU1RPUl9OQU1FfWA7XG5jb25zdCBUQlNfUkVRVUVTVF9SRVFVRVNUUyA9IGAke1RCU19SRVFVRVNUJDF9LnJlcXVlc3RzYDtcbmNvbnN0IFRCU19SRVFVRVNUX1JFUVVFU1RfRVhURU5TSU9OUyA9IGAke1RCU19SRVFVRVNUJDF9LiR7UkVRVUVTVF9FWFRFTlNJT05TfWA7XG5jb25zdCBDTEVBUl9QUk9QUyQ5ID0gW1xuICAgIFRCU19SRVFVRVNUJDEsXG4gICAgVEJTX1JFUVVFU1RfVkVSU0lPTixcbiAgICBUQlNfUkVRVUVTVF9SRVFVRVNUT1JfTkFNRSxcbiAgICBUQlNfUkVRVUVTVF9SRVFVRVNUUyxcbiAgICBUQlNfUkVRVUVTVF9SRVFVRVNUX0VYVEVOU0lPTlNcbl07XG5jbGFzcyBUQlNSZXF1ZXN0IGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBnZXQgdGJzKCkge1xuICAgICAgICByZXR1cm4gcHZ0c3V0aWxzLkJ1ZmZlclNvdXJjZUNvbnZlcnRlci50b0FycmF5QnVmZmVyKHRoaXMudGJzVmlldyk7XG4gICAgfVxuICAgIHNldCB0YnModmFsdWUpIHtcbiAgICAgICAgdGhpcy50YnNWaWV3ID0gbmV3IFVpbnQ4QXJyYXkodmFsdWUpO1xuICAgIH1cbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy50YnNWaWV3ID0gbmV3IFVpbnQ4QXJyYXkocHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVEJTLCBUQlNSZXF1ZXN0LmRlZmF1bHRWYWx1ZXMoVEJTKSkpO1xuICAgICAgICBpZiAoVkVSU0lPTiQ1IGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMudmVyc2lvbiA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZFUlNJT04kNSwgVEJTUmVxdWVzdC5kZWZhdWx0VmFsdWVzKFZFUlNJT04kNSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChSRVFVRVNUT1JfTkFNRSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnJlcXVlc3Rvck5hbWUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBSRVFVRVNUT1JfTkFNRSwgVEJTUmVxdWVzdC5kZWZhdWx0VmFsdWVzKFJFUVVFU1RPUl9OQU1FKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZXF1ZXN0TGlzdCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFJFUVVFU1RfTElTVCwgVEJTUmVxdWVzdC5kZWZhdWx0VmFsdWVzKFJFUVVFU1RfTElTVCkpO1xuICAgICAgICBpZiAoUkVRVUVTVF9FWFRFTlNJT05TIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMucmVxdWVzdEV4dGVuc2lvbnMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBSRVFVRVNUX0VYVEVOU0lPTlMsIFRCU1JlcXVlc3QuZGVmYXVsdFZhbHVlcyhSRVFVRVNUX0VYVEVOU0lPTlMpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVEJTOlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9CVUZGRVI7XG4gICAgICAgICAgICBjYXNlIFZFUlNJT04kNTpcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGNhc2UgUkVRVUVTVE9SX05BTUU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmFsTmFtZSgpO1xuICAgICAgICAgICAgY2FzZSBSRVFVRVNUX0xJU1Q6XG4gICAgICAgICAgICBjYXNlIFJFUVVFU1RfRVhURU5TSU9OUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFRCUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmJ5dGVMZW5ndGggPT09IDApO1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJDU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gVEJTUmVxdWVzdC5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKTtcbiAgICAgICAgICAgIGNhc2UgUkVRVUVTVE9SX05BTUU6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgobWVtYmVyVmFsdWUudHlwZSA9PT0gR2VuZXJhbE5hbWUuZGVmYXVsdFZhbHVlcyhcInR5cGVcIikpICYmIChPYmplY3Qua2V5cyhtZW1iZXJWYWx1ZS52YWx1ZSkubGVuZ3RoID09PSAwKSk7XG4gICAgICAgICAgICBjYXNlIFJFUVVFU1RfTElTVDpcbiAgICAgICAgICAgIGNhc2UgUkVRVUVTVF9FWFRFTlNJT05TOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUubGVuZ3RoID09PSAwKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgVEJTX1JFUVVFU1QkMSksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMuVEJTUmVxdWVzdFZlcnNpb24gfHwgVEJTX1JFUVVFU1RfVkVSU0lPTikgfSldXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW0dlbmVyYWxOYW1lLnNjaGVtYShuYW1lcy5yZXF1ZXN0b3JOYW1lIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFRCU19SRVFVRVNUX1JFUVVFU1RPUl9OQU1FXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSldXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5yZXF1ZXN0TGlzdCB8fCBcIlRCU1JlcXVlc3QucmVxdWVzdExpc3RcIiksXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMucmVxdWVzdHMgfHwgVEJTX1JFUVVFU1RfUkVRVUVTVFMpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBSZXF1ZXN0LnNjaGVtYShuYW1lcy5yZXF1ZXN0TmFtZXMgfHwge30pXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW0V4dGVuc2lvbnMuc2NoZW1hKG5hbWVzLmV4dGVuc2lvbnMgfHwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogKG5hbWVzLnJlcXVlc3RFeHRlbnNpb25zIHx8IFRCU19SRVFVRVNUX1JFUVVFU1RfRVhURU5TSU9OUylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KV1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDkpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFRCU1JlcXVlc3Quc2NoZW1hKCkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLnRic1ZpZXcgPSBhc24xLnJlc3VsdC5UQlNSZXF1ZXN0LnZhbHVlQmVmb3JlRGVjb2RlVmlldztcbiAgICAgICAgaWYgKFRCU19SRVFVRVNUX1ZFUlNJT04gaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLnZlcnNpb24gPSBhc24xLnJlc3VsdFtUQlNfUkVRVUVTVF9WRVJTSU9OXS52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgICAgICBpZiAoVEJTX1JFUVVFU1RfUkVRVUVTVE9SX05BTUUgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLnJlcXVlc3Rvck5hbWUgPSBuZXcgR2VuZXJhbE5hbWUoeyBzY2hlbWE6IGFzbjEucmVzdWx0W1RCU19SRVFVRVNUX1JFUVVFU1RPUl9OQU1FXSB9KTtcbiAgICAgICAgdGhpcy5yZXF1ZXN0TGlzdCA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHRbVEJTX1JFUVVFU1RfUkVRVUVTVFNdLCBlbGVtZW50ID0+IG5ldyBSZXF1ZXN0KHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICAgICAgaWYgKFRCU19SRVFVRVNUX1JFUVVFU1RfRVhURU5TSU9OUyBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMucmVxdWVzdEV4dGVuc2lvbnMgPSBBcnJheS5mcm9tKGFzbjEucmVzdWx0W1RCU19SRVFVRVNUX1JFUVVFU1RfRVhURU5TSU9OU10udmFsdWVCbG9jay52YWx1ZSwgZWxlbWVudCA9PiBuZXcgRXh0ZW5zaW9uKHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICB9XG4gICAgdG9TY2hlbWEoZW5jb2RlRmxhZyA9IGZhbHNlKSB7XG4gICAgICAgIGxldCB0YnNTY2hlbWE7XG4gICAgICAgIGlmIChlbmNvZGVGbGFnID09PSBmYWxzZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMudGJzVmlldy5ieXRlTGVuZ3RoID09PSAwKVxuICAgICAgICAgICAgICAgIHJldHVybiBUQlNSZXF1ZXN0LnNjaGVtYSgpO1xuICAgICAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5mcm9tQkVSKHRoaXMudGJzVmlldyk7XG4gICAgICAgICAgICBBc25FcnJvci5hc3NlcnQoYXNuMSwgXCJUQlMgUmVxdWVzdFwiKTtcbiAgICAgICAgICAgIGlmICghKGFzbjEucmVzdWx0IGluc3RhbmNlb2YgYXNuMWpzLlNlcXVlbmNlKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkFTTi4xIHJlc3VsdCBzaG91bGQgYmUgU0VRVUVOQ0VcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0YnNTY2hlbWEgPSBhc24xLnJlc3VsdDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgICAgICBpZiAodGhpcy52ZXJzaW9uICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW25ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlOiB0aGlzLnZlcnNpb24gfSldXG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucmVxdWVzdG9yTmFtZSkge1xuICAgICAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbdGhpcy5yZXF1ZXN0b3JOYW1lLnRvU2NoZW1hKCldXG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLnJlcXVlc3RMaXN0LCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnJlcXVlc3RFeHRlbnNpb25zKSB7XG4gICAgICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMucmVxdWVzdEV4dGVuc2lvbnMsIG8gPT4gby50b1NjaGVtYSgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRic1NjaGVtYSA9IG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRic1NjaGVtYTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7fTtcbiAgICAgICAgaWYgKHRoaXMudmVyc2lvbiAhPSB1bmRlZmluZWQpXG4gICAgICAgICAgICByZXMudmVyc2lvbiA9IHRoaXMudmVyc2lvbjtcbiAgICAgICAgaWYgKHRoaXMucmVxdWVzdG9yTmFtZSkge1xuICAgICAgICAgICAgcmVzLnJlcXVlc3Rvck5hbWUgPSB0aGlzLnJlcXVlc3Rvck5hbWUudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmVzLnJlcXVlc3RMaXN0ID0gQXJyYXkuZnJvbSh0aGlzLnJlcXVlc3RMaXN0LCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICBpZiAodGhpcy5yZXF1ZXN0RXh0ZW5zaW9ucykge1xuICAgICAgICAgICAgcmVzLnJlcXVlc3RFeHRlbnNpb25zID0gQXJyYXkuZnJvbSh0aGlzLnJlcXVlc3RFeHRlbnNpb25zLCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxufVxuVEJTUmVxdWVzdC5DTEFTU19OQU1FID0gXCJUQlNSZXF1ZXN0XCI7XG5cbmNvbnN0IFNJR05BVFVSRV9BTEdPUklUSE0kMSA9IFwic2lnbmF0dXJlQWxnb3JpdGhtXCI7XG5jb25zdCBTSUdOQVRVUkUkMSA9IFwic2lnbmF0dXJlXCI7XG5jb25zdCBDRVJUUyA9IFwiY2VydHNcIjtcbmNsYXNzIFNpZ25hdHVyZSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU0lHTkFUVVJFX0FMR09SSVRITSQxLCBTaWduYXR1cmUuZGVmYXVsdFZhbHVlcyhTSUdOQVRVUkVfQUxHT1JJVEhNJDEpKTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTSUdOQVRVUkUkMSwgU2lnbmF0dXJlLmRlZmF1bHRWYWx1ZXMoU0lHTkFUVVJFJDEpKTtcbiAgICAgICAgaWYgKENFUlRTIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuY2VydHMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBDRVJUUywgU2lnbmF0dXJlLmRlZmF1bHRWYWx1ZXMoQ0VSVFMpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgU0lHTkFUVVJFX0FMR09SSVRITSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcigpO1xuICAgICAgICAgICAgY2FzZSBTSUdOQVRVUkUkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5CaXRTdHJpbmcoKTtcbiAgICAgICAgICAgIGNhc2UgQ0VSVFM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBTSUdOQVRVUkVfQUxHT1JJVEhNJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgobWVtYmVyVmFsdWUuYWxnb3JpdGhtSWQgPT09IEVNUFRZX1NUUklORykgJiYgKChcImFsZ29yaXRobVBhcmFtc1wiIGluIG1lbWJlclZhbHVlKSA9PT0gZmFsc2UpKTtcbiAgICAgICAgICAgIGNhc2UgU0lHTkFUVVJFJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5pc0VxdWFsKFNpZ25hdHVyZS5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKSk7XG4gICAgICAgICAgICBjYXNlIENFUlRTOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUubGVuZ3RoID09PSAwKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMuc2lnbmF0dXJlQWxnb3JpdGhtIHx8IHt9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkJpdFN0cmluZyh7IG5hbWU6IChuYW1lcy5zaWduYXR1cmUgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW25ldyBhc24xanMuUmVwZWF0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmNlcnRzIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQ2VydGlmaWNhdGUuc2NoZW1hKHt9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KV1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIFtcbiAgICAgICAgICAgIFNJR05BVFVSRV9BTEdPUklUSE0kMSxcbiAgICAgICAgICAgIFNJR05BVFVSRSQxLFxuICAgICAgICAgICAgQ0VSVFNcbiAgICAgICAgXSk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgU2lnbmF0dXJlLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIHNpZ25hdHVyZUFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBTSUdOQVRVUkVfQUxHT1JJVEhNJDFcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc2lnbmF0dXJlOiBTSUdOQVRVUkUkMSxcbiAgICAgICAgICAgICAgICBjZXJ0czogQ0VSVFNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobSA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5zaWduYXR1cmVBbGdvcml0aG0gfSk7XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlID0gYXNuMS5yZXN1bHQuc2lnbmF0dXJlO1xuICAgICAgICBpZiAoQ0VSVFMgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLmNlcnRzID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdC5jZXJ0cywgZWxlbWVudCA9PiBuZXcgQ2VydGlmaWNhdGUoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnNpZ25hdHVyZUFsZ29yaXRobS50b1NjaGVtYSgpKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnNpZ25hdHVyZSk7XG4gICAgICAgIGlmICh0aGlzLmNlcnRzKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLmNlcnRzLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgICAgc2lnbmF0dXJlQWxnb3JpdGhtOiB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobS50b0pTT04oKSxcbiAgICAgICAgICAgIHNpZ25hdHVyZTogdGhpcy5zaWduYXR1cmUudG9KU09OKCksXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLmNlcnRzKSB7XG4gICAgICAgICAgICByZXMuY2VydHMgPSBBcnJheS5mcm9tKHRoaXMuY2VydHMsIG8gPT4gby50b0pTT04oKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5TaWduYXR1cmUuQ0xBU1NfTkFNRSA9IFwiU2lnbmF0dXJlXCI7XG5cbmNvbnN0IFRCU19SRVFVRVNUID0gXCJ0YnNSZXF1ZXN0XCI7XG5jb25zdCBPUFRJT05BTF9TSUdOQVRVUkUgPSBcIm9wdGlvbmFsU2lnbmF0dXJlXCI7XG5jb25zdCBDTEVBUl9QUk9QUyQ4ID0gW1xuICAgIFRCU19SRVFVRVNULFxuICAgIE9QVElPTkFMX1NJR05BVFVSRVxuXTtcbmNsYXNzIE9DU1BSZXF1ZXN0IGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy50YnNSZXF1ZXN0ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVEJTX1JFUVVFU1QsIE9DU1BSZXF1ZXN0LmRlZmF1bHRWYWx1ZXMoVEJTX1JFUVVFU1QpKTtcbiAgICAgICAgaWYgKE9QVElPTkFMX1NJR05BVFVSRSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbmFsU2lnbmF0dXJlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgT1BUSU9OQUxfU0lHTkFUVVJFLCBPQ1NQUmVxdWVzdC5kZWZhdWx0VmFsdWVzKE9QVElPTkFMX1NJR05BVFVSRSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBUQlNfUkVRVUVTVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFRCU1JlcXVlc3QoKTtcbiAgICAgICAgICAgIGNhc2UgT1BUSU9OQUxfU0lHTkFUVVJFOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU2lnbmF0dXJlKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFRCU19SRVFVRVNUOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKFRCU1JlcXVlc3QuY29tcGFyZVdpdGhEZWZhdWx0KFwidGJzXCIsIG1lbWJlclZhbHVlLnRicykpICYmXG4gICAgICAgICAgICAgICAgICAgIChUQlNSZXF1ZXN0LmNvbXBhcmVXaXRoRGVmYXVsdChcInZlcnNpb25cIiwgbWVtYmVyVmFsdWUudmVyc2lvbikpICYmXG4gICAgICAgICAgICAgICAgICAgIChUQlNSZXF1ZXN0LmNvbXBhcmVXaXRoRGVmYXVsdChcInJlcXVlc3Rvck5hbWVcIiwgbWVtYmVyVmFsdWUucmVxdWVzdG9yTmFtZSkpICYmXG4gICAgICAgICAgICAgICAgICAgIChUQlNSZXF1ZXN0LmNvbXBhcmVXaXRoRGVmYXVsdChcInJlcXVlc3RMaXN0XCIsIG1lbWJlclZhbHVlLnJlcXVlc3RMaXN0KSkgJiZcbiAgICAgICAgICAgICAgICAgICAgKFRCU1JlcXVlc3QuY29tcGFyZVdpdGhEZWZhdWx0KFwicmVxdWVzdEV4dGVuc2lvbnNcIiwgbWVtYmVyVmFsdWUucmVxdWVzdEV4dGVuc2lvbnMpKSk7XG4gICAgICAgICAgICBjYXNlIE9QVElPTkFMX1NJR05BVFVSRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKChTaWduYXR1cmUuY29tcGFyZVdpdGhEZWZhdWx0KFwic2lnbmF0dXJlQWxnb3JpdGhtXCIsIG1lbWJlclZhbHVlLnNpZ25hdHVyZUFsZ29yaXRobSkpICYmXG4gICAgICAgICAgICAgICAgICAgIChTaWduYXR1cmUuY29tcGFyZVdpdGhEZWZhdWx0KFwic2lnbmF0dXJlXCIsIG1lbWJlclZhbHVlLnNpZ25hdHVyZSkpICYmXG4gICAgICAgICAgICAgICAgICAgIChTaWduYXR1cmUuY29tcGFyZVdpdGhEZWZhdWx0KFwiY2VydHNcIiwgbWVtYmVyVmFsdWUuY2VydHMpKSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiBuYW1lcy5ibG9ja05hbWUgfHwgXCJPQ1NQUmVxdWVzdFwiLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBUQlNSZXF1ZXN0LnNjaGVtYShuYW1lcy50YnNSZXF1ZXN0IHx8IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogVEJTX1JFUVVFU1RcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIFNpZ25hdHVyZS5zY2hlbWEobmFtZXMub3B0aW9uYWxTaWduYXR1cmUgfHwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogT1BUSU9OQUxfU0lHTkFUVVJFXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkOCk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgT0NTUFJlcXVlc3Quc2NoZW1hKCkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLnRic1JlcXVlc3QgPSBuZXcgVEJTUmVxdWVzdCh7IHNjaGVtYTogYXNuMS5yZXN1bHQudGJzUmVxdWVzdCB9KTtcbiAgICAgICAgaWYgKE9QVElPTkFMX1NJR05BVFVSRSBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMub3B0aW9uYWxTaWduYXR1cmUgPSBuZXcgU2lnbmF0dXJlKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5vcHRpb25hbFNpZ25hdHVyZSB9KTtcbiAgICB9XG4gICAgdG9TY2hlbWEoZW5jb2RlRmxhZyA9IGZhbHNlKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy50YnNSZXF1ZXN0LnRvU2NoZW1hKGVuY29kZUZsYWcpKTtcbiAgICAgICAgaWYgKHRoaXMub3B0aW9uYWxTaWduYXR1cmUpXG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25hbFNpZ25hdHVyZS50b1NjaGVtYSgpXG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICB0YnNSZXF1ZXN0OiB0aGlzLnRic1JlcXVlc3QudG9KU09OKClcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMub3B0aW9uYWxTaWduYXR1cmUpIHtcbiAgICAgICAgICAgIHJlcy5vcHRpb25hbFNpZ25hdHVyZSA9IHRoaXMub3B0aW9uYWxTaWduYXR1cmUudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG4gICAgYXN5bmMgY3JlYXRlRm9yQ2VydGlmaWNhdGUoY2VydGlmaWNhdGUsIHBhcmFtZXRlcnMsIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICBjb25zdCBjZXJ0SUQgPSBuZXcgQ2VydElEKCk7XG4gICAgICAgIGF3YWl0IGNlcnRJRC5jcmVhdGVGb3JDZXJ0aWZpY2F0ZShjZXJ0aWZpY2F0ZSwgcGFyYW1ldGVycywgY3J5cHRvKTtcbiAgICAgICAgdGhpcy50YnNSZXF1ZXN0LnJlcXVlc3RMaXN0LnB1c2gobmV3IFJlcXVlc3Qoe1xuICAgICAgICAgICAgcmVxQ2VydDogY2VydElELFxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGFzeW5jIHNpZ24ocHJpdmF0ZUtleSwgaGFzaEFsZ29yaXRobSA9IFwiU0hBLTFcIiwgY3J5cHRvID0gZ2V0Q3J5cHRvKHRydWUpKSB7XG4gICAgICAgIFBhcmFtZXRlckVycm9yLmFzc2VydEVtcHR5KHByaXZhdGVLZXksIFwicHJpdmF0ZUtleVwiLCBcIk9DU1BSZXF1ZXN0LnNpZ24gbWV0aG9kXCIpO1xuICAgICAgICBpZiAoIXRoaXMub3B0aW9uYWxTaWduYXR1cmUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5lZWQgdG8gY3JlYXRlIFxcXCJvcHRpb25hbFNpZ25hdHVyZVxcXCIgZmllbGQgYmVmb3JlIHNpZ25pbmdcIik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc2lnbmF0dXJlUGFyYW1zID0gYXdhaXQgY3J5cHRvLmdldFNpZ25hdHVyZVBhcmFtZXRlcnMocHJpdmF0ZUtleSwgaGFzaEFsZ29yaXRobSk7XG4gICAgICAgIGNvbnN0IHBhcmFtZXRlcnMgPSBzaWduYXR1cmVQYXJhbXMucGFyYW1ldGVycztcbiAgICAgICAgdGhpcy5vcHRpb25hbFNpZ25hdHVyZS5zaWduYXR1cmVBbGdvcml0aG0gPSBzaWduYXR1cmVQYXJhbXMuc2lnbmF0dXJlQWxnb3JpdGhtO1xuICAgICAgICBjb25zdCB0YnMgPSB0aGlzLnRic1JlcXVlc3QudG9TY2hlbWEodHJ1ZSkudG9CRVIoZmFsc2UpO1xuICAgICAgICBjb25zdCBzaWduYXR1cmUgPSBhd2FpdCBjcnlwdG8uc2lnbldpdGhQcml2YXRlS2V5KHRicywgcHJpdmF0ZUtleSwgcGFyYW1ldGVycyk7XG4gICAgICAgIHRoaXMub3B0aW9uYWxTaWduYXR1cmUuc2lnbmF0dXJlID0gbmV3IGFzbjFqcy5CaXRTdHJpbmcoeyB2YWx1ZUhleDogc2lnbmF0dXJlIH0pO1xuICAgIH1cbiAgICB2ZXJpZnkoKSB7XG4gICAgfVxufVxuT0NTUFJlcXVlc3QuQ0xBU1NfTkFNRSA9IFwiT0NTUFJlcXVlc3RcIjtcblxuY29uc3QgUkVTUE9OU0VfVFlQRSA9IFwicmVzcG9uc2VUeXBlXCI7XG5jb25zdCBSRVNQT05TRSA9IFwicmVzcG9uc2VcIjtcbmNvbnN0IENMRUFSX1BST1BTJDcgPSBbXG4gICAgUkVTUE9OU0VfVFlQRSxcbiAgICBSRVNQT05TRVxuXTtcbmNsYXNzIFJlc3BvbnNlQnl0ZXMgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnJlc3BvbnNlVHlwZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFJFU1BPTlNFX1RZUEUsIFJlc3BvbnNlQnl0ZXMuZGVmYXVsdFZhbHVlcyhSRVNQT05TRV9UWVBFKSk7XG4gICAgICAgIHRoaXMucmVzcG9uc2UgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBSRVNQT05TRSwgUmVzcG9uc2VCeXRlcy5kZWZhdWx0VmFsdWVzKFJFU1BPTlNFKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBSRVNQT05TRV9UWVBFOlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9TVFJJTkc7XG4gICAgICAgICAgICBjYXNlIFJFU1BPTlNFOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFJFU1BPTlNFX1RZUEU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gRU1QVFlfU1RSSU5HKTtcbiAgICAgICAgICAgIGNhc2UgUkVTUE9OU0U6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5pc0VxdWFsKFJlc3BvbnNlQnl0ZXMuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSkpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyBuYW1lOiAobmFtZXMucmVzcG9uc2VUeXBlIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IG5hbWU6IChuYW1lcy5yZXNwb25zZSB8fCBFTVBUWV9TVFJJTkcpIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkNyk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgUmVzcG9uc2VCeXRlcy5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICByZXNwb25zZVR5cGU6IFJFU1BPTlNFX1RZUEUsXG4gICAgICAgICAgICAgICAgcmVzcG9uc2U6IFJFU1BPTlNFXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5yZXNwb25zZVR5cGUgPSBhc24xLnJlc3VsdC5yZXNwb25zZVR5cGUudmFsdWVCbG9jay50b1N0cmluZygpO1xuICAgICAgICB0aGlzLnJlc3BvbnNlID0gYXNuMS5yZXN1bHQucmVzcG9uc2U7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyB2YWx1ZTogdGhpcy5yZXNwb25zZVR5cGUgfSksXG4gICAgICAgICAgICAgICAgdGhpcy5yZXNwb25zZVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3BvbnNlVHlwZTogdGhpcy5yZXNwb25zZVR5cGUsXG4gICAgICAgICAgICByZXNwb25zZTogdGhpcy5yZXNwb25zZS50b0pTT04oKSxcbiAgICAgICAgfTtcbiAgICB9XG59XG5SZXNwb25zZUJ5dGVzLkNMQVNTX05BTUUgPSBcIlJlc3BvbnNlQnl0ZXNcIjtcblxuY29uc3QgUkVTUE9OU0VfU1RBVFVTID0gXCJyZXNwb25zZVN0YXR1c1wiO1xuY29uc3QgUkVTUE9OU0VfQllURVMgPSBcInJlc3BvbnNlQnl0ZXNcIjtcbmNsYXNzIE9DU1BSZXNwb25zZSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMucmVzcG9uc2VTdGF0dXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBSRVNQT05TRV9TVEFUVVMsIE9DU1BSZXNwb25zZS5kZWZhdWx0VmFsdWVzKFJFU1BPTlNFX1NUQVRVUykpO1xuICAgICAgICBpZiAoUkVTUE9OU0VfQllURVMgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5yZXNwb25zZUJ5dGVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUkVTUE9OU0VfQllURVMsIE9DU1BSZXNwb25zZS5kZWZhdWx0VmFsdWVzKFJFU1BPTlNFX0JZVEVTKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFJFU1BPTlNFX1NUQVRVUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5FbnVtZXJhdGVkKCk7XG4gICAgICAgICAgICBjYXNlIFJFU1BPTlNFX0JZVEVTOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUmVzcG9uc2VCeXRlcygpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBSRVNQT05TRV9TVEFUVVM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5pc0VxdWFsKE9DU1BSZXNwb25zZS5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKSk7XG4gICAgICAgICAgICBjYXNlIFJFU1BPTlNFX0JZVEVTOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKFJlc3BvbnNlQnl0ZXMuY29tcGFyZVdpdGhEZWZhdWx0KFwicmVzcG9uc2VUeXBlXCIsIG1lbWJlclZhbHVlLnJlc3BvbnNlVHlwZSkpICYmXG4gICAgICAgICAgICAgICAgICAgIChSZXNwb25zZUJ5dGVzLmNvbXBhcmVXaXRoRGVmYXVsdChcInJlc3BvbnNlXCIsIG1lbWJlclZhbHVlLnJlc3BvbnNlKSkpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBcIk9DU1BSZXNwb25zZVwiKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5FbnVtZXJhdGVkKHsgbmFtZTogKG5hbWVzLnJlc3BvbnNlU3RhdHVzIHx8IFJFU1BPTlNFX1NUQVRVUykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgUmVzcG9uc2VCeXRlcy5zY2hlbWEobmFtZXMucmVzcG9uc2VCeXRlcyB8fCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBSRVNQT05TRV9CWVRFU1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIFtcbiAgICAgICAgICAgIFJFU1BPTlNFX1NUQVRVUyxcbiAgICAgICAgICAgIFJFU1BPTlNFX0JZVEVTXG4gICAgICAgIF0pO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIE9DU1BSZXNwb25zZS5zY2hlbWEoKSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMucmVzcG9uc2VTdGF0dXMgPSBhc24xLnJlc3VsdC5yZXNwb25zZVN0YXR1cztcbiAgICAgICAgaWYgKFJFU1BPTlNFX0JZVEVTIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5yZXNwb25zZUJ5dGVzID0gbmV3IFJlc3BvbnNlQnl0ZXMoeyBzY2hlbWE6IGFzbjEucmVzdWx0LnJlc3BvbnNlQnl0ZXMgfSk7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMucmVzcG9uc2VTdGF0dXMpO1xuICAgICAgICBpZiAodGhpcy5yZXNwb25zZUJ5dGVzKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFt0aGlzLnJlc3BvbnNlQnl0ZXMudG9TY2hlbWEoKV1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICByZXNwb25zZVN0YXR1czogdGhpcy5yZXNwb25zZVN0YXR1cy50b0pTT04oKVxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5yZXNwb25zZUJ5dGVzKSB7XG4gICAgICAgICAgICByZXMucmVzcG9uc2VCeXRlcyA9IHRoaXMucmVzcG9uc2VCeXRlcy50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbiAgICBhc3luYyBnZXRDZXJ0aWZpY2F0ZVN0YXR1cyhjZXJ0aWZpY2F0ZSwgaXNzdWVyQ2VydGlmaWNhdGUsIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICBsZXQgYmFzaWNSZXNwb25zZTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgaXNGb3JDZXJ0aWZpY2F0ZTogZmFsc2UsXG4gICAgICAgICAgICBzdGF0dXM6IDJcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKCF0aGlzLnJlc3BvbnNlQnl0ZXMpXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICBpZiAodGhpcy5yZXNwb25zZUJ5dGVzLnJlc3BvbnNlVHlwZSAhPT0gaWRfUEtJWF9PQ1NQX0Jhc2ljKVxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGFzbjFCYXNpYyA9IGFzbjFqcy5mcm9tQkVSKHRoaXMucmVzcG9uc2VCeXRlcy5yZXNwb25zZS52YWx1ZUJsb2NrLnZhbHVlSGV4Vmlldyk7XG4gICAgICAgICAgICBBc25FcnJvci5hc3NlcnQoYXNuMUJhc2ljLCBcIkJhc2ljIE9DU1AgcmVzcG9uc2VcIik7XG4gICAgICAgICAgICBiYXNpY1Jlc3BvbnNlID0gbmV3IEJhc2ljT0NTUFJlc3BvbnNlKHsgc2NoZW1hOiBhc24xQmFzaWMucmVzdWx0IH0pO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIHtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJhc2ljUmVzcG9uc2UuZ2V0Q2VydGlmaWNhdGVTdGF0dXMoY2VydGlmaWNhdGUsIGlzc3VlckNlcnRpZmljYXRlLCBjcnlwdG8pO1xuICAgIH1cbiAgICBhc3luYyBzaWduKHByaXZhdGVLZXksIGhhc2hBbGdvcml0aG0sIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGlmICh0aGlzLnJlc3BvbnNlQnl0ZXMgJiYgdGhpcy5yZXNwb25zZUJ5dGVzLnJlc3BvbnNlVHlwZSA9PT0gaWRfUEtJWF9PQ1NQX0Jhc2ljKSB7XG4gICAgICAgICAgICBjb25zdCBiYXNpY1Jlc3BvbnNlID0gQmFzaWNPQ1NQUmVzcG9uc2UuZnJvbUJFUih0aGlzLnJlc3BvbnNlQnl0ZXMucmVzcG9uc2UudmFsdWVCbG9jay52YWx1ZUhleFZpZXcpO1xuICAgICAgICAgICAgcmV0dXJuIGJhc2ljUmVzcG9uc2Uuc2lnbihwcml2YXRlS2V5LCBoYXNoQWxnb3JpdGhtLCBjcnlwdG8pO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBSZXNwb25zZUJ5dGVzIHR5cGU6ICR7KChfYSA9IHRoaXMucmVzcG9uc2VCeXRlcykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnJlc3BvbnNlVHlwZSkgfHwgXCJVbmtub3duXCJ9YCk7XG4gICAgfVxuICAgIGFzeW5jIHZlcmlmeShpc3N1ZXJDZXJ0aWZpY2F0ZSA9IG51bGwsIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGlmICgoUkVTUE9OU0VfQllURVMgaW4gdGhpcykgPT09IGZhbHNlKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRW1wdHkgUmVzcG9uc2VCeXRlcyBmaWVsZFwiKTtcbiAgICAgICAgaWYgKHRoaXMucmVzcG9uc2VCeXRlcyAmJiB0aGlzLnJlc3BvbnNlQnl0ZXMucmVzcG9uc2VUeXBlID09PSBpZF9QS0lYX09DU1BfQmFzaWMpIHtcbiAgICAgICAgICAgIGNvbnN0IGJhc2ljUmVzcG9uc2UgPSBCYXNpY09DU1BSZXNwb25zZS5mcm9tQkVSKHRoaXMucmVzcG9uc2VCeXRlcy5yZXNwb25zZS52YWx1ZUJsb2NrLnZhbHVlSGV4Vmlldyk7XG4gICAgICAgICAgICBpZiAoaXNzdWVyQ2VydGlmaWNhdGUgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWJhc2ljUmVzcG9uc2UuY2VydHMpIHtcbiAgICAgICAgICAgICAgICAgICAgYmFzaWNSZXNwb25zZS5jZXJ0cyA9IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBiYXNpY1Jlc3BvbnNlLmNlcnRzLnB1c2goaXNzdWVyQ2VydGlmaWNhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGJhc2ljUmVzcG9uc2UudmVyaWZ5KHt9LCBjcnlwdG8pO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBSZXNwb25zZUJ5dGVzIHR5cGU6ICR7KChfYSA9IHRoaXMucmVzcG9uc2VCeXRlcykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnJlc3BvbnNlVHlwZSkgfHwgXCJVbmtub3duXCJ9YCk7XG4gICAgfVxufVxuT0NTUFJlc3BvbnNlLkNMQVNTX05BTUUgPSBcIk9DU1BSZXNwb25zZVwiO1xuXG5jb25zdCBUWVBFID0gXCJ0eXBlXCI7XG5jb25zdCBBVFRSSUJVVEVTID0gXCJhdHRyaWJ1dGVzXCI7XG5jb25zdCBFTkNPREVEX1ZBTFVFID0gXCJlbmNvZGVkVmFsdWVcIjtcbmNvbnN0IENMRUFSX1BST1BTJDYgPSBbXG4gICAgQVRUUklCVVRFU1xuXTtcbmNsYXNzIFNpZ25lZEFuZFVuc2lnbmVkQXR0cmlidXRlcyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudHlwZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFRZUEUsIFNpZ25lZEFuZFVuc2lnbmVkQXR0cmlidXRlcy5kZWZhdWx0VmFsdWVzKFRZUEUpKTtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQVRUUklCVVRFUywgU2lnbmVkQW5kVW5zaWduZWRBdHRyaWJ1dGVzLmRlZmF1bHRWYWx1ZXMoQVRUUklCVVRFUykpO1xuICAgICAgICB0aGlzLmVuY29kZWRWYWx1ZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEVOQ09ERURfVkFMVUUsIFNpZ25lZEFuZFVuc2lnbmVkQXR0cmlidXRlcy5kZWZhdWx0VmFsdWVzKEVOQ09ERURfVkFMVUUpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFRZUEU6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgtMSk7XG4gICAgICAgICAgICBjYXNlIEFUVFJJQlVURVM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgY2FzZSBFTkNPREVEX1ZBTFVFOlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9CVUZGRVI7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFRZUEU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gU2lnbmVkQW5kVW5zaWduZWRBdHRyaWJ1dGVzLmRlZmF1bHRWYWx1ZXMoVFlQRSkpO1xuICAgICAgICAgICAgY2FzZSBBVFRSSUJVVEVTOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUubGVuZ3RoID09PSAwKTtcbiAgICAgICAgICAgIGNhc2UgRU5DT0RFRF9WQUxVRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmJ5dGVMZW5ndGggPT09IDApO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgdGFnTnVtYmVyOiBuYW1lcy50YWdOdW1iZXIgfHwgMFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5hdHRyaWJ1dGVzIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBBdHRyaWJ1dGUuc2NoZW1hKClcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDYpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFNpZ25lZEFuZFVuc2lnbmVkQXR0cmlidXRlcy5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IHRoaXMudHlwZSxcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiBBVFRSSUJVVEVTXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy50eXBlID0gYXNuMS5yZXN1bHQuaWRCbG9jay50YWdOdW1iZXI7XG4gICAgICAgIHRoaXMuZW5jb2RlZFZhbHVlID0gcHZ0c3V0aWxzLkJ1ZmZlclNvdXJjZUNvbnZlcnRlci50b0FycmF5QnVmZmVyKGFzbjEucmVzdWx0LnZhbHVlQmVmb3JlRGVjb2RlVmlldyk7XG4gICAgICAgIGNvbnN0IGVuY29kZWRWaWV3ID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5lbmNvZGVkVmFsdWUpO1xuICAgICAgICBlbmNvZGVkVmlld1swXSA9IDB4MzE7XG4gICAgICAgIGlmICgoQVRUUklCVVRFUyBpbiBhc24xLnJlc3VsdCkgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy50eXBlID09PSAwKVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIldyb25nIHN0cnVjdHVyZSBvZiBTaWduZWRVbnNpZ25lZEF0dHJpYnV0ZXNcIik7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHQuYXR0cmlidXRlcywgZWxlbWVudCA9PiBuZXcgQXR0cmlidXRlKHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGlmIChTaWduZWRBbmRVbnNpZ25lZEF0dHJpYnV0ZXMuY29tcGFyZVdpdGhEZWZhdWx0KFRZUEUsIHRoaXMudHlwZSkgfHwgU2lnbmVkQW5kVW5zaWduZWRBdHRyaWJ1dGVzLmNvbXBhcmVXaXRoRGVmYXVsdChBVFRSSUJVVEVTLCB0aGlzLmF0dHJpYnV0ZXMpKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW5jb3JyZWN0bHkgaW5pdGlhbGl6ZWQgXFxcIlNpZ25lZEFuZFVuc2lnbmVkQXR0cmlidXRlc1xcXCIgY2xhc3NcIik7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IHRoaXMudHlwZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMuYXR0cmlidXRlcywgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBpZiAoU2lnbmVkQW5kVW5zaWduZWRBdHRyaWJ1dGVzLmNvbXBhcmVXaXRoRGVmYXVsdChUWVBFLCB0aGlzLnR5cGUpIHx8IFNpZ25lZEFuZFVuc2lnbmVkQXR0cmlidXRlcy5jb21wYXJlV2l0aERlZmF1bHQoQVRUUklCVVRFUywgdGhpcy5hdHRyaWJ1dGVzKSlcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkluY29ycmVjdGx5IGluaXRpYWxpemVkIFxcXCJTaWduZWRBbmRVbnNpZ25lZEF0dHJpYnV0ZXNcXFwiIGNsYXNzXCIpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogdGhpcy50eXBlLFxuICAgICAgICAgICAgYXR0cmlidXRlczogQXJyYXkuZnJvbSh0aGlzLmF0dHJpYnV0ZXMsIG8gPT4gby50b0pTT04oKSlcbiAgICAgICAgfTtcbiAgICB9XG59XG5TaWduZWRBbmRVbnNpZ25lZEF0dHJpYnV0ZXMuQ0xBU1NfTkFNRSA9IFwiU2lnbmVkQW5kVW5zaWduZWRBdHRyaWJ1dGVzXCI7XG5cbmNvbnN0IFZFUlNJT04kNCA9IFwidmVyc2lvblwiO1xuY29uc3QgU0lEID0gXCJzaWRcIjtcbmNvbnN0IERJR0VTVF9BTEdPUklUSE0gPSBcImRpZ2VzdEFsZ29yaXRobVwiO1xuY29uc3QgU0lHTkVEX0FUVFJTID0gXCJzaWduZWRBdHRyc1wiO1xuY29uc3QgU0lHTkFUVVJFX0FMR09SSVRITSA9IFwic2lnbmF0dXJlQWxnb3JpdGhtXCI7XG5jb25zdCBTSUdOQVRVUkUgPSBcInNpZ25hdHVyZVwiO1xuY29uc3QgVU5TSUdORURfQVRUUlMgPSBcInVuc2lnbmVkQXR0cnNcIjtcbmNvbnN0IFNJR05FUl9JTkZPID0gXCJTaWduZXJJbmZvXCI7XG5jb25zdCBTSUdORVJfSU5GT19WRVJTSU9OID0gYCR7U0lHTkVSX0lORk99LiR7VkVSU0lPTiQ0fWA7XG5jb25zdCBTSUdORVJfSU5GT19TSUQgPSBgJHtTSUdORVJfSU5GT30uJHtTSUR9YDtcbmNvbnN0IFNJR05FUl9JTkZPX0RJR0VTVF9BTEdPUklUSE0gPSBgJHtTSUdORVJfSU5GT30uJHtESUdFU1RfQUxHT1JJVEhNfWA7XG5jb25zdCBTSUdORVJfSU5GT19TSUdORURfQVRUUlMgPSBgJHtTSUdORVJfSU5GT30uJHtTSUdORURfQVRUUlN9YDtcbmNvbnN0IFNJR05FUl9JTkZPX1NJR05BVFVSRV9BTEdPUklUSE0gPSBgJHtTSUdORVJfSU5GT30uJHtTSUdOQVRVUkVfQUxHT1JJVEhNfWA7XG5jb25zdCBTSUdORVJfSU5GT19TSUdOQVRVUkUgPSBgJHtTSUdORVJfSU5GT30uJHtTSUdOQVRVUkV9YDtcbmNvbnN0IFNJR05FUl9JTkZPX1VOU0lHTkVEX0FUVFJTID0gYCR7U0lHTkVSX0lORk99LiR7VU5TSUdORURfQVRUUlN9YDtcbmNvbnN0IENMRUFSX1BST1BTJDUgPSBbXG4gICAgU0lHTkVSX0lORk9fVkVSU0lPTixcbiAgICBTSUdORVJfSU5GT19TSUQsXG4gICAgU0lHTkVSX0lORk9fRElHRVNUX0FMR09SSVRITSxcbiAgICBTSUdORVJfSU5GT19TSUdORURfQVRUUlMsXG4gICAgU0lHTkVSX0lORk9fU0lHTkFUVVJFX0FMR09SSVRITSxcbiAgICBTSUdORVJfSU5GT19TSUdOQVRVUkUsXG4gICAgU0lHTkVSX0lORk9fVU5TSUdORURfQVRUUlNcbl07XG5jbGFzcyBTaWduZXJJbmZvIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVkVSU0lPTiQ0LCBTaWduZXJJbmZvLmRlZmF1bHRWYWx1ZXMoVkVSU0lPTiQ0KSk7XG4gICAgICAgIHRoaXMuc2lkID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU0lELCBTaWduZXJJbmZvLmRlZmF1bHRWYWx1ZXMoU0lEKSk7XG4gICAgICAgIHRoaXMuZGlnZXN0QWxnb3JpdGhtID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgRElHRVNUX0FMR09SSVRITSwgU2lnbmVySW5mby5kZWZhdWx0VmFsdWVzKERJR0VTVF9BTEdPUklUSE0pKTtcbiAgICAgICAgaWYgKFNJR05FRF9BVFRSUyBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnNpZ25lZEF0dHJzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU0lHTkVEX0FUVFJTLCBTaWduZXJJbmZvLmRlZmF1bHRWYWx1ZXMoU0lHTkVEX0FUVFJTKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zaWduYXR1cmVBbGdvcml0aG0gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTSUdOQVRVUkVfQUxHT1JJVEhNLCBTaWduZXJJbmZvLmRlZmF1bHRWYWx1ZXMoU0lHTkFUVVJFX0FMR09SSVRITSkpO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNJR05BVFVSRSwgU2lnbmVySW5mby5kZWZhdWx0VmFsdWVzKFNJR05BVFVSRSkpO1xuICAgICAgICBpZiAoVU5TSUdORURfQVRUUlMgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy51bnNpZ25lZEF0dHJzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVU5TSUdORURfQVRUUlMsIFNpZ25lckluZm8uZGVmYXVsdFZhbHVlcyhVTlNJR05FRF9BVFRSUykpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJDQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICBjYXNlIFNJRDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5BbnkoKTtcbiAgICAgICAgICAgIGNhc2UgRElHRVNUX0FMR09SSVRITTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgU0lHTkVEX0FUVFJTOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU2lnbmVkQW5kVW5zaWduZWRBdHRyaWJ1dGVzKHsgdHlwZTogMCB9KTtcbiAgICAgICAgICAgIGNhc2UgU0lHTkFUVVJFX0FMR09SSVRITTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgU0lHTkFUVVJFOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKCk7XG4gICAgICAgICAgICBjYXNlIFVOU0lHTkVEX0FUVFJTOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU2lnbmVkQW5kVW5zaWduZWRBdHRyaWJ1dGVzKHsgdHlwZTogMSB9KTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkVSU0lPTiQ0OlxuICAgICAgICAgICAgICAgIHJldHVybiAoU2lnbmVySW5mby5kZWZhdWx0VmFsdWVzKFZFUlNJT04kNCkgPT09IG1lbWJlclZhbHVlKTtcbiAgICAgICAgICAgIGNhc2UgU0lEOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgaW5zdGFuY2VvZiBhc24xanMuQW55KTtcbiAgICAgICAgICAgIGNhc2UgRElHRVNUX0FMR09SSVRITTpcbiAgICAgICAgICAgICAgICBpZiAoKG1lbWJlclZhbHVlIGluc3RhbmNlb2YgQWxnb3JpdGhtSWRlbnRpZmllcikgPT09IGZhbHNlKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1lbWJlclZhbHVlLmlzRXF1YWwoU2lnbmVySW5mby5kZWZhdWx0VmFsdWVzKERJR0VTVF9BTEdPUklUSE0pKTtcbiAgICAgICAgICAgIGNhc2UgU0lHTkVEX0FUVFJTOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKFNpZ25lZEFuZFVuc2lnbmVkQXR0cmlidXRlcy5jb21wYXJlV2l0aERlZmF1bHQoXCJ0eXBlXCIsIG1lbWJlclZhbHVlLnR5cGUpKVxuICAgICAgICAgICAgICAgICAgICAmJiAoU2lnbmVkQW5kVW5zaWduZWRBdHRyaWJ1dGVzLmNvbXBhcmVXaXRoRGVmYXVsdChcImF0dHJpYnV0ZXNcIiwgbWVtYmVyVmFsdWUuYXR0cmlidXRlcykpXG4gICAgICAgICAgICAgICAgICAgICYmIChTaWduZWRBbmRVbnNpZ25lZEF0dHJpYnV0ZXMuY29tcGFyZVdpdGhEZWZhdWx0KFwiZW5jb2RlZFZhbHVlXCIsIG1lbWJlclZhbHVlLmVuY29kZWRWYWx1ZSkpKTtcbiAgICAgICAgICAgIGNhc2UgU0lHTkFUVVJFX0FMR09SSVRITTpcbiAgICAgICAgICAgICAgICBpZiAoKG1lbWJlclZhbHVlIGluc3RhbmNlb2YgQWxnb3JpdGhtSWRlbnRpZmllcikgPT09IGZhbHNlKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1lbWJlclZhbHVlLmlzRXF1YWwoU2lnbmVySW5mby5kZWZhdWx0VmFsdWVzKFNJR05BVFVSRV9BTEdPUklUSE0pKTtcbiAgICAgICAgICAgIGNhc2UgU0lHTkFUVVJFOlxuICAgICAgICAgICAgY2FzZSBVTlNJR05FRF9BVFRSUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKChTaWduZWRBbmRVbnNpZ25lZEF0dHJpYnV0ZXMuY29tcGFyZVdpdGhEZWZhdWx0KFwidHlwZVwiLCBtZW1iZXJWYWx1ZS50eXBlKSlcbiAgICAgICAgICAgICAgICAgICAgJiYgKFNpZ25lZEFuZFVuc2lnbmVkQXR0cmlidXRlcy5jb21wYXJlV2l0aERlZmF1bHQoXCJhdHRyaWJ1dGVzXCIsIG1lbWJlclZhbHVlLmF0dHJpYnV0ZXMpKVxuICAgICAgICAgICAgICAgICAgICAmJiAoU2lnbmVkQW5kVW5zaWduZWRBdHRyaWJ1dGVzLmNvbXBhcmVXaXRoRGVmYXVsdChcImVuY29kZWRWYWx1ZVwiLCBtZW1iZXJWYWx1ZS5lbmNvZGVkVmFsdWUpKSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiBTSUdORVJfSU5GTyxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLnZlcnNpb24gfHwgU0lHTkVSX0lORk9fVkVSU0lPTikgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5DaG9pY2Uoe1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgSXNzdWVyQW5kU2VyaWFsTnVtYmVyLnNjaGVtYShuYW1lcy5zaWRTY2hlbWEgfHwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogU0lHTkVSX0lORk9fU0lEXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNob2ljZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5zaWQgfHwgU0lHTkVSX0lORk9fU0lEKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW25ldyBhc24xanMuT2N0ZXRTdHJpbmcoKV1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnNpZCB8fCBTSUdORVJfSU5GT19TSUQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIEFsZ29yaXRobUlkZW50aWZpZXIuc2NoZW1hKG5hbWVzLmRpZ2VzdEFsZ29yaXRobSB8fCB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFNJR05FUl9JTkZPX0RJR0VTVF9BTEdPUklUSE1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIFNpZ25lZEFuZFVuc2lnbmVkQXR0cmlidXRlcy5zY2hlbWEobmFtZXMuc2lnbmVkQXR0cnMgfHwge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBTSUdORVJfSU5GT19TSUdORURfQVRUUlMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIEFsZ29yaXRobUlkZW50aWZpZXIuc2NoZW1hKG5hbWVzLnNpZ25hdHVyZUFsZ29yaXRobSB8fCB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFNJR05FUl9JTkZPX1NJR05BVFVSRV9BTEdPUklUSE1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyBuYW1lOiAobmFtZXMuc2lnbmF0dXJlIHx8IFNJR05FUl9JTkZPX1NJR05BVFVSRSkgfSksXG4gICAgICAgICAgICAgICAgU2lnbmVkQW5kVW5zaWduZWRBdHRyaWJ1dGVzLnNjaGVtYShuYW1lcy51bnNpZ25lZEF0dHJzIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogU0lHTkVSX0lORk9fVU5TSUdORURfQVRUUlMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkNSk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgU2lnbmVySW5mby5zY2hlbWEoKSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IGFzbjEucmVzdWx0W1NJR05FUl9JTkZPX1ZFUlNJT05dLnZhbHVlQmxvY2sudmFsdWVEZWM7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRTaWQgPSBhc24xLnJlc3VsdFtTSUdORVJfSU5GT19TSURdO1xuICAgICAgICBpZiAoY3VycmVudFNpZC5pZEJsb2NrLnRhZ0NsYXNzID09PSAxKVxuICAgICAgICAgICAgdGhpcy5zaWQgPSBuZXcgSXNzdWVyQW5kU2VyaWFsTnVtYmVyKHsgc2NoZW1hOiBjdXJyZW50U2lkIH0pO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICB0aGlzLnNpZCA9IGN1cnJlbnRTaWQ7XG4gICAgICAgIHRoaXMuZGlnZXN0QWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0W1NJR05FUl9JTkZPX0RJR0VTVF9BTEdPUklUSE1dIH0pO1xuICAgICAgICBpZiAoU0lHTkVSX0lORk9fU0lHTkVEX0FUVFJTIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5zaWduZWRBdHRycyA9IG5ldyBTaWduZWRBbmRVbnNpZ25lZEF0dHJpYnV0ZXMoeyB0eXBlOiAwLCBzY2hlbWE6IGFzbjEucmVzdWx0W1NJR05FUl9JTkZPX1NJR05FRF9BVFRSU10gfSk7XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0W1NJR05FUl9JTkZPX1NJR05BVFVSRV9BTEdPUklUSE1dIH0pO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZSA9IGFzbjEucmVzdWx0W1NJR05FUl9JTkZPX1NJR05BVFVSRV07XG4gICAgICAgIGlmIChTSUdORVJfSU5GT19VTlNJR05FRF9BVFRSUyBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMudW5zaWduZWRBdHRycyA9IG5ldyBTaWduZWRBbmRVbnNpZ25lZEF0dHJpYnV0ZXMoeyB0eXBlOiAxLCBzY2hlbWE6IGFzbjEucmVzdWx0W1NJR05FUl9JTkZPX1VOU0lHTkVEX0FUVFJTXSB9KTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGlmIChTaWduZXJJbmZvLmNvbXBhcmVXaXRoRGVmYXVsdChTSUQsIHRoaXMuc2lkKSlcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkluY29ycmVjdGx5IGluaXRpYWxpemVkIFxcXCJTaWduZXJJbmZvXFxcIiBjbGFzc1wiKTtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy52ZXJzaW9uIH0pKTtcbiAgICAgICAgaWYgKHRoaXMuc2lkIGluc3RhbmNlb2YgSXNzdWVyQW5kU2VyaWFsTnVtYmVyKVxuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnNpZC50b1NjaGVtYSgpKTtcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnNpZCk7XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5kaWdlc3RBbGdvcml0aG0udG9TY2hlbWEoKSk7XG4gICAgICAgIGlmICh0aGlzLnNpZ25lZEF0dHJzKSB7XG4gICAgICAgICAgICBpZiAoU2lnbmVySW5mby5jb21wYXJlV2l0aERlZmF1bHQoU0lHTkVEX0FUVFJTLCB0aGlzLnNpZ25lZEF0dHJzKSA9PT0gZmFsc2UpXG4gICAgICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnNpZ25lZEF0dHJzLnRvU2NoZW1hKCkpO1xuICAgICAgICB9XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5zaWduYXR1cmVBbGdvcml0aG0udG9TY2hlbWEoKSk7XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5zaWduYXR1cmUpO1xuICAgICAgICBpZiAodGhpcy51bnNpZ25lZEF0dHJzKSB7XG4gICAgICAgICAgICBpZiAoU2lnbmVySW5mby5jb21wYXJlV2l0aERlZmF1bHQoVU5TSUdORURfQVRUUlMsIHRoaXMudW5zaWduZWRBdHRycykgPT09IGZhbHNlKVxuICAgICAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy51bnNpZ25lZEF0dHJzLnRvU2NoZW1hKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGlmIChTaWduZXJJbmZvLmNvbXBhcmVXaXRoRGVmYXVsdChTSUQsIHRoaXMuc2lkKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW5jb3JyZWN0bHkgaW5pdGlhbGl6ZWQgXFxcIlNpZ25lckluZm9cXFwiIGNsYXNzXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICAgIHZlcnNpb246IHRoaXMudmVyc2lvbixcbiAgICAgICAgICAgIGRpZ2VzdEFsZ29yaXRobTogdGhpcy5kaWdlc3RBbGdvcml0aG0udG9KU09OKCksXG4gICAgICAgICAgICBzaWduYXR1cmVBbGdvcml0aG06IHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtLnRvSlNPTigpLFxuICAgICAgICAgICAgc2lnbmF0dXJlOiB0aGlzLnNpZ25hdHVyZS50b0pTT04oKSxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKCEodGhpcy5zaWQgaW5zdGFuY2VvZiBhc24xanMuQW55KSlcbiAgICAgICAgICAgIHJlcy5zaWQgPSB0aGlzLnNpZC50b0pTT04oKTtcbiAgICAgICAgaWYgKHRoaXMuc2lnbmVkQXR0cnMgJiYgU2lnbmVySW5mby5jb21wYXJlV2l0aERlZmF1bHQoU0lHTkVEX0FUVFJTLCB0aGlzLnNpZ25lZEF0dHJzKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHJlcy5zaWduZWRBdHRycyA9IHRoaXMuc2lnbmVkQXR0cnMudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudW5zaWduZWRBdHRycyAmJiBTaWduZXJJbmZvLmNvbXBhcmVXaXRoRGVmYXVsdChVTlNJR05FRF9BVFRSUywgdGhpcy51bnNpZ25lZEF0dHJzKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHJlcy51bnNpZ25lZEF0dHJzID0gdGhpcy51bnNpZ25lZEF0dHJzLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxufVxuU2lnbmVySW5mby5DTEFTU19OQU1FID0gXCJTaWduZXJJbmZvXCI7XG5cbmNvbnN0IFZFUlNJT04kMyA9IFwidmVyc2lvblwiO1xuY29uc3QgUE9MSUNZID0gXCJwb2xpY3lcIjtcbmNvbnN0IE1FU1NBR0VfSU1QUklOVCQxID0gXCJtZXNzYWdlSW1wcmludFwiO1xuY29uc3QgU0VSSUFMX05VTUJFUiA9IFwic2VyaWFsTnVtYmVyXCI7XG5jb25zdCBHRU5fVElNRSA9IFwiZ2VuVGltZVwiO1xuY29uc3QgT1JERVJJTkcgPSBcIm9yZGVyaW5nXCI7XG5jb25zdCBOT05DRSQxID0gXCJub25jZVwiO1xuY29uc3QgQUNDVVJBQ1kgPSBcImFjY3VyYWN5XCI7XG5jb25zdCBUU0EgPSBcInRzYVwiO1xuY29uc3QgRVhURU5TSU9OUyQxID0gXCJleHRlbnNpb25zXCI7XG5jb25zdCBUU1RfSU5GTyA9IFwiVFNUSW5mb1wiO1xuY29uc3QgVFNUX0lORk9fVkVSU0lPTiA9IGAke1RTVF9JTkZPfS4ke1ZFUlNJT04kM31gO1xuY29uc3QgVFNUX0lORk9fUE9MSUNZID0gYCR7VFNUX0lORk99LiR7UE9MSUNZfWA7XG5jb25zdCBUU1RfSU5GT19NRVNTQUdFX0lNUFJJTlQgPSBgJHtUU1RfSU5GT30uJHtNRVNTQUdFX0lNUFJJTlQkMX1gO1xuY29uc3QgVFNUX0lORk9fU0VSSUFMX05VTUJFUiA9IGAke1RTVF9JTkZPfS4ke1NFUklBTF9OVU1CRVJ9YDtcbmNvbnN0IFRTVF9JTkZPX0dFTl9USU1FID0gYCR7VFNUX0lORk99LiR7R0VOX1RJTUV9YDtcbmNvbnN0IFRTVF9JTkZPX0FDQ1VSQUNZID0gYCR7VFNUX0lORk99LiR7QUNDVVJBQ1l9YDtcbmNvbnN0IFRTVF9JTkZPX09SREVSSU5HID0gYCR7VFNUX0lORk99LiR7T1JERVJJTkd9YDtcbmNvbnN0IFRTVF9JTkZPX05PTkNFID0gYCR7VFNUX0lORk99LiR7Tk9OQ0UkMX1gO1xuY29uc3QgVFNUX0lORk9fVFNBID0gYCR7VFNUX0lORk99LiR7VFNBfWA7XG5jb25zdCBUU1RfSU5GT19FWFRFTlNJT05TID0gYCR7VFNUX0lORk99LiR7RVhURU5TSU9OUyQxfWA7XG5jb25zdCBDTEVBUl9QUk9QUyQ0ID0gW1xuICAgIFRTVF9JTkZPX1ZFUlNJT04sXG4gICAgVFNUX0lORk9fUE9MSUNZLFxuICAgIFRTVF9JTkZPX01FU1NBR0VfSU1QUklOVCxcbiAgICBUU1RfSU5GT19TRVJJQUxfTlVNQkVSLFxuICAgIFRTVF9JTkZPX0dFTl9USU1FLFxuICAgIFRTVF9JTkZPX0FDQ1VSQUNZLFxuICAgIFRTVF9JTkZPX09SREVSSU5HLFxuICAgIFRTVF9JTkZPX05PTkNFLFxuICAgIFRTVF9JTkZPX1RTQSxcbiAgICBUU1RfSU5GT19FWFRFTlNJT05TXG5dO1xuY2xhc3MgVFNUSW5mbyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZFUlNJT04kMywgVFNUSW5mby5kZWZhdWx0VmFsdWVzKFZFUlNJT04kMykpO1xuICAgICAgICB0aGlzLnBvbGljeSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFBPTElDWSwgVFNUSW5mby5kZWZhdWx0VmFsdWVzKFBPTElDWSkpO1xuICAgICAgICB0aGlzLm1lc3NhZ2VJbXByaW50ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgTUVTU0FHRV9JTVBSSU5UJDEsIFRTVEluZm8uZGVmYXVsdFZhbHVlcyhNRVNTQUdFX0lNUFJJTlQkMSkpO1xuICAgICAgICB0aGlzLnNlcmlhbE51bWJlciA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNFUklBTF9OVU1CRVIsIFRTVEluZm8uZGVmYXVsdFZhbHVlcyhTRVJJQUxfTlVNQkVSKSk7XG4gICAgICAgIHRoaXMuZ2VuVGltZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEdFTl9USU1FLCBUU1RJbmZvLmRlZmF1bHRWYWx1ZXMoR0VOX1RJTUUpKTtcbiAgICAgICAgaWYgKEFDQ1VSQUNZIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuYWNjdXJhY3kgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBBQ0NVUkFDWSwgVFNUSW5mby5kZWZhdWx0VmFsdWVzKEFDQ1VSQUNZKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE9SREVSSU5HIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMub3JkZXJpbmcgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBPUkRFUklORywgVFNUSW5mby5kZWZhdWx0VmFsdWVzKE9SREVSSU5HKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE5PTkNFJDEgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5ub25jZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE5PTkNFJDEsIFRTVEluZm8uZGVmYXVsdFZhbHVlcyhOT05DRSQxKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFRTQSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnRzYSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFRTQSwgVFNUSW5mby5kZWZhdWx0VmFsdWVzKFRTQSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChFWFRFTlNJT05TJDEgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5leHRlbnNpb25zID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgRVhURU5TSU9OUyQxLCBUU1RJbmZvLmRlZmF1bHRWYWx1ZXMoRVhURU5TSU9OUyQxKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFZFUlNJT04kMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGNhc2UgUE9MSUNZOlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9TVFJJTkc7XG4gICAgICAgICAgICBjYXNlIE1FU1NBR0VfSU1QUklOVCQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTWVzc2FnZUltcHJpbnQoKTtcbiAgICAgICAgICAgIGNhc2UgU0VSSUFMX05VTUJFUjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5JbnRlZ2VyKCk7XG4gICAgICAgICAgICBjYXNlIEdFTl9USU1FOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZSgwLCAwLCAwKTtcbiAgICAgICAgICAgIGNhc2UgQUNDVVJBQ1k6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBY2N1cmFjeSgpO1xuICAgICAgICAgICAgY2FzZSBPUkRFUklORzpcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBjYXNlIE5PTkNFJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuSW50ZWdlcigpO1xuICAgICAgICAgICAgY2FzZSBUU0E6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmFsTmFtZSgpO1xuICAgICAgICAgICAgY2FzZSBFWFRFTlNJT05TJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJDM6XG4gICAgICAgICAgICBjYXNlIFBPTElDWTpcbiAgICAgICAgICAgIGNhc2UgR0VOX1RJTUU6XG4gICAgICAgICAgICBjYXNlIE9SREVSSU5HOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgPT09IFRTVEluZm8uZGVmYXVsdFZhbHVlcyhPUkRFUklORykpO1xuICAgICAgICAgICAgY2FzZSBNRVNTQUdFX0lNUFJJTlQkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKChNZXNzYWdlSW1wcmludC5jb21wYXJlV2l0aERlZmF1bHQoSEFTSF9BTEdPUklUSE0sIG1lbWJlclZhbHVlLmhhc2hBbGdvcml0aG0pKSAmJlxuICAgICAgICAgICAgICAgICAgICAoTWVzc2FnZUltcHJpbnQuY29tcGFyZVdpdGhEZWZhdWx0KEhBU0hFRF9NRVNTQUdFLCBtZW1iZXJWYWx1ZS5oYXNoZWRNZXNzYWdlKSkpO1xuICAgICAgICAgICAgY2FzZSBTRVJJQUxfTlVNQkVSOlxuICAgICAgICAgICAgY2FzZSBOT05DRSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUuaXNFcXVhbChUU1RJbmZvLmRlZmF1bHRWYWx1ZXMoTk9OQ0UkMSkpKTtcbiAgICAgICAgICAgIGNhc2UgQUNDVVJBQ1k6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgoQWNjdXJhY3kuY29tcGFyZVdpdGhEZWZhdWx0KFNFQ09ORFMsIG1lbWJlclZhbHVlLnNlY29uZHMpKSAmJlxuICAgICAgICAgICAgICAgICAgICAoQWNjdXJhY3kuY29tcGFyZVdpdGhEZWZhdWx0KE1JTExJUywgbWVtYmVyVmFsdWUubWlsbGlzKSkgJiZcbiAgICAgICAgICAgICAgICAgICAgKEFjY3VyYWN5LmNvbXBhcmVXaXRoRGVmYXVsdChNSUNST1MsIG1lbWJlclZhbHVlLm1pY3JvcykpKTtcbiAgICAgICAgICAgIGNhc2UgVFNBOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKEdlbmVyYWxOYW1lLmNvbXBhcmVXaXRoRGVmYXVsdChUWVBFJDQsIG1lbWJlclZhbHVlLnR5cGUpKSAmJlxuICAgICAgICAgICAgICAgICAgICAoR2VuZXJhbE5hbWUuY29tcGFyZVdpdGhEZWZhdWx0KFZBTFVFJDUsIG1lbWJlclZhbHVlLnZhbHVlKSkpO1xuICAgICAgICAgICAgY2FzZSBFWFRFTlNJT05TJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBUU1RfSU5GTyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy52ZXJzaW9uIHx8IFRTVF9JTkZPX1ZFUlNJT04pIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IG5hbWU6IChuYW1lcy5wb2xpY3kgfHwgVFNUX0lORk9fUE9MSUNZKSB9KSxcbiAgICAgICAgICAgICAgICBNZXNzYWdlSW1wcmludC5zY2hlbWEobmFtZXMubWVzc2FnZUltcHJpbnQgfHwge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBUU1RfSU5GT19NRVNTQUdFX0lNUFJJTlRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy5zZXJpYWxOdW1iZXIgfHwgVFNUX0lORk9fU0VSSUFMX05VTUJFUikgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5HZW5lcmFsaXplZFRpbWUoeyBuYW1lOiAobmFtZXMuZ2VuVGltZSB8fCBUU1RfSU5GT19HRU5fVElNRSkgfSksXG4gICAgICAgICAgICAgICAgQWNjdXJhY3kuc2NoZW1hKG5hbWVzLmFjY3VyYWN5IHx8IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogVFNUX0lORk9fQUNDVVJBQ1lcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQm9vbGVhbih7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5vcmRlcmluZyB8fCBUU1RfSU5GT19PUkRFUklORyksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLm5vbmNlIHx8IFRTVF9JTkZPX05PTkNFKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWVcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbR2VuZXJhbE5hbWUuc2NoZW1hKG5hbWVzLnRzYSB8fCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBUU1RfSU5GT19UU0FcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KV1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuZXh0ZW5zaW9ucyB8fCBUU1RfSU5GT19FWFRFTlNJT05TKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogRXh0ZW5zaW9uLnNjaGVtYShuYW1lcy5leHRlbnNpb24gfHwge30pXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQ0KTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBUU1RJbmZvLnNjaGVtYSgpKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gYXNuMS5yZXN1bHRbVFNUX0lORk9fVkVSU0lPTl0udmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgdGhpcy5wb2xpY3kgPSBhc24xLnJlc3VsdFtUU1RfSU5GT19QT0xJQ1ldLnZhbHVlQmxvY2sudG9TdHJpbmcoKTtcbiAgICAgICAgdGhpcy5tZXNzYWdlSW1wcmludCA9IG5ldyBNZXNzYWdlSW1wcmludCh7IHNjaGVtYTogYXNuMS5yZXN1bHRbVFNUX0lORk9fTUVTU0FHRV9JTVBSSU5UXSB9KTtcbiAgICAgICAgdGhpcy5zZXJpYWxOdW1iZXIgPSBhc24xLnJlc3VsdFtUU1RfSU5GT19TRVJJQUxfTlVNQkVSXTtcbiAgICAgICAgdGhpcy5nZW5UaW1lID0gYXNuMS5yZXN1bHRbVFNUX0lORk9fR0VOX1RJTUVdLnRvRGF0ZSgpO1xuICAgICAgICBpZiAoVFNUX0lORk9fQUNDVVJBQ1kgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLmFjY3VyYWN5ID0gbmV3IEFjY3VyYWN5KHsgc2NoZW1hOiBhc24xLnJlc3VsdFtUU1RfSU5GT19BQ0NVUkFDWV0gfSk7XG4gICAgICAgIGlmIChUU1RfSU5GT19PUkRFUklORyBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMub3JkZXJpbmcgPSBhc24xLnJlc3VsdFtUU1RfSU5GT19PUkRFUklOR10udmFsdWVCbG9jay52YWx1ZTtcbiAgICAgICAgaWYgKFRTVF9JTkZPX05PTkNFIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5ub25jZSA9IGFzbjEucmVzdWx0W1RTVF9JTkZPX05PTkNFXTtcbiAgICAgICAgaWYgKFRTVF9JTkZPX1RTQSBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMudHNhID0gbmV3IEdlbmVyYWxOYW1lKHsgc2NoZW1hOiBhc24xLnJlc3VsdFtUU1RfSU5GT19UU0FdIH0pO1xuICAgICAgICBpZiAoVFNUX0lORk9fRVhURU5TSU9OUyBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMuZXh0ZW5zaW9ucyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHRbVFNUX0lORk9fRVhURU5TSU9OU10sIGVsZW1lbnQgPT4gbmV3IEV4dGVuc2lvbih7IHNjaGVtYTogZWxlbWVudCB9KSk7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlOiB0aGlzLnZlcnNpb24gfSkpO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLnBvbGljeSB9KSk7XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5tZXNzYWdlSW1wcmludC50b1NjaGVtYSgpKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnNlcmlhbE51bWJlcik7XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5HZW5lcmFsaXplZFRpbWUoeyB2YWx1ZURhdGU6IHRoaXMuZ2VuVGltZSB9KSk7XG4gICAgICAgIGlmICh0aGlzLmFjY3VyYWN5KVxuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLmFjY3VyYWN5LnRvU2NoZW1hKCkpO1xuICAgICAgICBpZiAodGhpcy5vcmRlcmluZyAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkJvb2xlYW4oeyB2YWx1ZTogdGhpcy5vcmRlcmluZyB9KSk7XG4gICAgICAgIGlmICh0aGlzLm5vbmNlKVxuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLm5vbmNlKTtcbiAgICAgICAgaWYgKHRoaXMudHNhKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFt0aGlzLnRzYS50b1NjaGVtYSgpXVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmV4dGVuc2lvbnMpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLmV4dGVuc2lvbnMsIG8gPT4gby50b1NjaGVtYSgpKVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICAgIHZlcnNpb246IHRoaXMudmVyc2lvbixcbiAgICAgICAgICAgIHBvbGljeTogdGhpcy5wb2xpY3ksXG4gICAgICAgICAgICBtZXNzYWdlSW1wcmludDogdGhpcy5tZXNzYWdlSW1wcmludC50b0pTT04oKSxcbiAgICAgICAgICAgIHNlcmlhbE51bWJlcjogdGhpcy5zZXJpYWxOdW1iZXIudG9KU09OKCksXG4gICAgICAgICAgICBnZW5UaW1lOiB0aGlzLmdlblRpbWVcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuYWNjdXJhY3kpXG4gICAgICAgICAgICByZXMuYWNjdXJhY3kgPSB0aGlzLmFjY3VyYWN5LnRvSlNPTigpO1xuICAgICAgICBpZiAodGhpcy5vcmRlcmluZyAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgcmVzLm9yZGVyaW5nID0gdGhpcy5vcmRlcmluZztcbiAgICAgICAgaWYgKHRoaXMubm9uY2UpXG4gICAgICAgICAgICByZXMubm9uY2UgPSB0aGlzLm5vbmNlLnRvSlNPTigpO1xuICAgICAgICBpZiAodGhpcy50c2EpXG4gICAgICAgICAgICByZXMudHNhID0gdGhpcy50c2EudG9KU09OKCk7XG4gICAgICAgIGlmICh0aGlzLmV4dGVuc2lvbnMpXG4gICAgICAgICAgICByZXMuZXh0ZW5zaW9ucyA9IEFycmF5LmZyb20odGhpcy5leHRlbnNpb25zLCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbiAgICBhc3luYyB2ZXJpZnkocGFyYW1zLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgaWYgKCFwYXJhbXMuZGF0YSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiXFxcImRhdGFcXFwiIGlzIGEgbWFuZGF0b3J5IGF0dHJpYnV0ZSBmb3IgVFNUX0lORk8gdmVyaWZpY2F0aW9uXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRhdGEgPSBwYXJhbXMuZGF0YTtcbiAgICAgICAgaWYgKHBhcmFtcy5ub3RCZWZvcmUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmdlblRpbWUgPCBwYXJhbXMubm90QmVmb3JlKVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkdlbmVyYXRpb24gdGltZSBmb3IgVFNUSW5mbyBvYmplY3QgaXMgbGVzcyB0aGFuIG5vdEJlZm9yZSB2YWx1ZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1zLm5vdEFmdGVyKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5nZW5UaW1lID4gcGFyYW1zLm5vdEFmdGVyKVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkdlbmVyYXRpb24gdGltZSBmb3IgVFNUSW5mbyBvYmplY3QgaXMgbW9yZSB0aGFuIG5vdEFmdGVyIHZhbHVlXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHNoYUFsZ29yaXRobSA9IGNyeXB0by5nZXRBbGdvcml0aG1CeU9JRCh0aGlzLm1lc3NhZ2VJbXByaW50Lmhhc2hBbGdvcml0aG0uYWxnb3JpdGhtSWQsIHRydWUsIFwiTWVzc2FnZUltcHJpbnQuaGFzaEFsZ29yaXRobVwiKTtcbiAgICAgICAgY29uc3QgaGFzaCA9IGF3YWl0IGNyeXB0by5kaWdlc3Qoc2hhQWxnb3JpdGhtLm5hbWUsIG5ldyBVaW50OEFycmF5KGRhdGEpKTtcbiAgICAgICAgcmV0dXJuIHB2dHN1dGlscy5CdWZmZXJTb3VyY2VDb252ZXJ0ZXIuaXNFcXVhbChoYXNoLCB0aGlzLm1lc3NhZ2VJbXByaW50Lmhhc2hlZE1lc3NhZ2UudmFsdWVCbG9jay52YWx1ZUhleFZpZXcpO1xuICAgIH1cbn1cblRTVEluZm8uQ0xBU1NfTkFNRSA9IFwiVFNUSW5mb1wiO1xuXG5jb25zdCBWRVJTSU9OJDIgPSBcInZlcnNpb25cIjtcbmNvbnN0IERJR0VTVF9BTEdPUklUSE1TID0gXCJkaWdlc3RBbGdvcml0aG1zXCI7XG5jb25zdCBFTkNBUF9DT05URU5UX0lORk8gPSBcImVuY2FwQ29udGVudEluZm9cIjtcbmNvbnN0IENFUlRJRklDQVRFUyA9IFwiY2VydGlmaWNhdGVzXCI7XG5jb25zdCBDUkxTID0gXCJjcmxzXCI7XG5jb25zdCBTSUdORVJfSU5GT1MgPSBcInNpZ25lckluZm9zXCI7XG5jb25zdCBPQ1NQUyA9IFwib2NzcHNcIjtcbmNvbnN0IFNJR05FRF9EQVRBID0gXCJTaWduZWREYXRhXCI7XG5jb25zdCBTSUdORURfREFUQV9WRVJTSU9OID0gYCR7U0lHTkVEX0RBVEF9LiR7VkVSU0lPTiQyfWA7XG5jb25zdCBTSUdORURfREFUQV9ESUdFU1RfQUxHT1JJVEhNUyA9IGAke1NJR05FRF9EQVRBfS4ke0RJR0VTVF9BTEdPUklUSE1TfWA7XG5jb25zdCBTSUdORURfREFUQV9FTkNBUF9DT05URU5UX0lORk8gPSBgJHtTSUdORURfREFUQX0uJHtFTkNBUF9DT05URU5UX0lORk99YDtcbmNvbnN0IFNJR05FRF9EQVRBX0NFUlRJRklDQVRFUyA9IGAke1NJR05FRF9EQVRBfS4ke0NFUlRJRklDQVRFU31gO1xuY29uc3QgU0lHTkVEX0RBVEFfQ1JMUyA9IGAke1NJR05FRF9EQVRBfS4ke0NSTFN9YDtcbmNvbnN0IFNJR05FRF9EQVRBX1NJR05FUl9JTkZPUyA9IGAke1NJR05FRF9EQVRBfS4ke1NJR05FUl9JTkZPU31gO1xuY29uc3QgQ0xFQVJfUFJPUFMkMyA9IFtcbiAgICBTSUdORURfREFUQV9WRVJTSU9OLFxuICAgIFNJR05FRF9EQVRBX0RJR0VTVF9BTEdPUklUSE1TLFxuICAgIFNJR05FRF9EQVRBX0VOQ0FQX0NPTlRFTlRfSU5GTyxcbiAgICBTSUdORURfREFUQV9DRVJUSUZJQ0FURVMsXG4gICAgU0lHTkVEX0RBVEFfQ1JMUyxcbiAgICBTSUdORURfREFUQV9TSUdORVJfSU5GT1Ncbl07XG5jbGFzcyBTaWduZWREYXRhVmVyaWZ5RXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IoeyBtZXNzYWdlLCBjb2RlID0gMCwgZGF0ZSA9IG5ldyBEYXRlKCksIHNpZ25hdHVyZVZlcmlmaWVkID0gbnVsbCwgc2lnbmVyQ2VydGlmaWNhdGUgPSBudWxsLCBzaWduZXJDZXJ0aWZpY2F0ZVZlcmlmaWVkID0gbnVsbCwgdGltZXN0YW1wU2VyaWFsID0gbnVsbCwgY2VydGlmaWNhdGVQYXRoID0gW10sIH0pIHtcbiAgICAgICAgc3VwZXIobWVzc2FnZSk7XG4gICAgICAgIHRoaXMubmFtZSA9IFwiU2lnbmVkRGF0YVZlcmlmeUVycm9yXCI7XG4gICAgICAgIHRoaXMuZGF0ZSA9IGRhdGU7XG4gICAgICAgIHRoaXMuY29kZSA9IGNvZGU7XG4gICAgICAgIHRoaXMudGltZXN0YW1wU2VyaWFsID0gdGltZXN0YW1wU2VyaWFsO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZVZlcmlmaWVkID0gc2lnbmF0dXJlVmVyaWZpZWQ7XG4gICAgICAgIHRoaXMuc2lnbmVyQ2VydGlmaWNhdGUgPSBzaWduZXJDZXJ0aWZpY2F0ZTtcbiAgICAgICAgdGhpcy5zaWduZXJDZXJ0aWZpY2F0ZVZlcmlmaWVkID0gc2lnbmVyQ2VydGlmaWNhdGVWZXJpZmllZDtcbiAgICAgICAgdGhpcy5jZXJ0aWZpY2F0ZVBhdGggPSBjZXJ0aWZpY2F0ZVBhdGg7XG4gICAgfVxufVxuY2xhc3MgU2lnbmVkRGF0YSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZFUlNJT04kMiwgU2lnbmVkRGF0YS5kZWZhdWx0VmFsdWVzKFZFUlNJT04kMikpO1xuICAgICAgICB0aGlzLmRpZ2VzdEFsZ29yaXRobXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBESUdFU1RfQUxHT1JJVEhNUywgU2lnbmVkRGF0YS5kZWZhdWx0VmFsdWVzKERJR0VTVF9BTEdPUklUSE1TKSk7XG4gICAgICAgIHRoaXMuZW5jYXBDb250ZW50SW5mbyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEVOQ0FQX0NPTlRFTlRfSU5GTywgU2lnbmVkRGF0YS5kZWZhdWx0VmFsdWVzKEVOQ0FQX0NPTlRFTlRfSU5GTykpO1xuICAgICAgICBpZiAoQ0VSVElGSUNBVEVTIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuY2VydGlmaWNhdGVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQ0VSVElGSUNBVEVTLCBTaWduZWREYXRhLmRlZmF1bHRWYWx1ZXMoQ0VSVElGSUNBVEVTKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKENSTFMgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5jcmxzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQ1JMUywgU2lnbmVkRGF0YS5kZWZhdWx0VmFsdWVzKENSTFMpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoT0NTUFMgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5vY3NwcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE9DU1BTLCBTaWduZWREYXRhLmRlZmF1bHRWYWx1ZXMoT0NTUFMpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNpZ25lckluZm9zID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU0lHTkVSX0lORk9TLCBTaWduZWREYXRhLmRlZmF1bHRWYWx1ZXMoU0lHTkVSX0lORk9TKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJDI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICBjYXNlIERJR0VTVF9BTEdPUklUSE1TOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGNhc2UgRU5DQVBfQ09OVEVOVF9JTkZPOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRW5jYXBzdWxhdGVkQ29udGVudEluZm8oKTtcbiAgICAgICAgICAgIGNhc2UgQ0VSVElGSUNBVEVTOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGNhc2UgQ1JMUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBjYXNlIE9DU1BTOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGNhc2UgU0lHTkVSX0lORk9TOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkVSU0lPTiQyOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgPT09IFNpZ25lZERhdGEuZGVmYXVsdFZhbHVlcyhWRVJTSU9OJDIpKTtcbiAgICAgICAgICAgIGNhc2UgRU5DQVBfQ09OVEVOVF9JTkZPOlxuICAgICAgICAgICAgICAgIHJldHVybiBFbmNhcHN1bGF0ZWRDb250ZW50SW5mby5jb21wYXJlV2l0aERlZmF1bHQoXCJlQ29udGVudFR5cGVcIiwgbWVtYmVyVmFsdWUuZUNvbnRlbnRUeXBlKSAmJlxuICAgICAgICAgICAgICAgICAgICBFbmNhcHN1bGF0ZWRDb250ZW50SW5mby5jb21wYXJlV2l0aERlZmF1bHQoXCJlQ29udGVudFwiLCBtZW1iZXJWYWx1ZS5lQ29udGVudCk7XG4gICAgICAgICAgICBjYXNlIERJR0VTVF9BTEdPUklUSE1TOlxuICAgICAgICAgICAgY2FzZSBDRVJUSUZJQ0FURVM6XG4gICAgICAgICAgICBjYXNlIENSTFM6XG4gICAgICAgICAgICBjYXNlIE9DU1BTOlxuICAgICAgICAgICAgY2FzZSBTSUdORVJfSU5GT1M6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICBpZiAobmFtZXMub3B0aW9uYWwgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgbmFtZXMub3B0aW9uYWwgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBTSUdORURfREFUQSksXG4gICAgICAgICAgICBvcHRpb25hbDogbmFtZXMub3B0aW9uYWwsXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy52ZXJzaW9uIHx8IFNJR05FRF9EQVRBX1ZFUlNJT04pIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuU2V0KHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUmVwZWF0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5kaWdlc3RBbGdvcml0aG1zIHx8IFNJR05FRF9EQVRBX0RJR0VTVF9BTEdPUklUSE1TKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIEVuY2Fwc3VsYXRlZENvbnRlbnRJbmZvLnNjaGVtYShuYW1lcy5lbmNhcENvbnRlbnRJbmZvIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogU0lHTkVEX0RBVEFfRU5DQVBfQ09OVEVOVF9JTkZPXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmNlcnRpZmljYXRlcyB8fCBTSUdORURfREFUQV9DRVJUSUZJQ0FURVMpLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IENlcnRpZmljYXRlU2V0LnNjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBSZXZvY2F0aW9uSW5mb0Nob2ljZXMuc2NoZW1hKG5hbWVzLmNybHMgfHwge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmxzOiBTSUdORURfREFUQV9DUkxTXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlNldCh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuc2lnbmVySW5mb3MgfHwgU0lHTkVEX0RBVEFfU0lHTkVSX0lORk9TKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogU2lnbmVySW5mby5zY2hlbWEoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkMyk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgU2lnbmVkRGF0YS5zY2hlbWEoKSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IGFzbjEucmVzdWx0W1NJR05FRF9EQVRBX1ZFUlNJT05dLnZhbHVlQmxvY2sudmFsdWVEZWM7XG4gICAgICAgIGlmIChTSUdORURfREFUQV9ESUdFU1RfQUxHT1JJVEhNUyBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMuZGlnZXN0QWxnb3JpdGhtcyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHRbU0lHTkVEX0RBVEFfRElHRVNUX0FMR09SSVRITVNdLCBhbGdvcml0aG0gPT4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFsZ29yaXRobSB9KSk7XG4gICAgICAgIHRoaXMuZW5jYXBDb250ZW50SW5mbyA9IG5ldyBFbmNhcHN1bGF0ZWRDb250ZW50SW5mbyh7IHNjaGVtYTogYXNuMS5yZXN1bHRbU0lHTkVEX0RBVEFfRU5DQVBfQ09OVEVOVF9JTkZPXSB9KTtcbiAgICAgICAgaWYgKFNJR05FRF9EQVRBX0NFUlRJRklDQVRFUyBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgY29uc3QgY2VydGlmaWNhdGVTZXQgPSBuZXcgQ2VydGlmaWNhdGVTZXQoe1xuICAgICAgICAgICAgICAgIHNjaGVtYTogbmV3IGFzbjFqcy5TZXQoe1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogYXNuMS5yZXN1bHRbU0lHTkVEX0RBVEFfQ0VSVElGSUNBVEVTXS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5jZXJ0aWZpY2F0ZXMgPSBjZXJ0aWZpY2F0ZVNldC5jZXJ0aWZpY2F0ZXMuc2xpY2UoMCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFNJR05FRF9EQVRBX0NSTFMgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHRoaXMuY3JscyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHRbU0lHTkVEX0RBVEFfQ1JMU10sIChjcmwpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoY3JsLmlkQmxvY2sudGFnQ2xhc3MgPT09IDEpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdCh7IHNjaGVtYTogY3JsIH0pO1xuICAgICAgICAgICAgICAgIGNybC5pZEJsb2NrLnRhZ0NsYXNzID0gMTtcbiAgICAgICAgICAgICAgICBjcmwuaWRCbG9jay50YWdOdW1iZXIgPSAxNjtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IE90aGVyUmV2b2NhdGlvbkluZm9Gb3JtYXQoeyBzY2hlbWE6IGNybCB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChTSUdORURfREFUQV9TSUdORVJfSU5GT1MgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLnNpZ25lckluZm9zID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdFtTSUdORURfREFUQV9TSUdORVJfSU5GT1NdLCBzaWduZXJJbmZvU2NoZW1hID0+IG5ldyBTaWduZXJJbmZvKHsgc2NoZW1hOiBzaWduZXJJbmZvU2NoZW1hIH0pKTtcbiAgICB9XG4gICAgdG9TY2hlbWEoZW5jb2RlRmxhZyA9IGZhbHNlKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgIGlmICgodGhpcy5jZXJ0aWZpY2F0ZXMgJiYgdGhpcy5jZXJ0aWZpY2F0ZXMubGVuZ3RoICYmIHRoaXMuY2VydGlmaWNhdGVzLnNvbWUobyA9PiBvIGluc3RhbmNlb2YgT3RoZXJDZXJ0aWZpY2F0ZUZvcm1hdCkpXG4gICAgICAgICAgICB8fCAodGhpcy5jcmxzICYmIHRoaXMuY3Jscy5sZW5ndGggJiYgdGhpcy5jcmxzLnNvbWUobyA9PiBvIGluc3RhbmNlb2YgT3RoZXJSZXZvY2F0aW9uSW5mb0Zvcm1hdCkpKSB7XG4gICAgICAgICAgICB0aGlzLnZlcnNpb24gPSA1O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuY2VydGlmaWNhdGVzICYmIHRoaXMuY2VydGlmaWNhdGVzLmxlbmd0aCAmJiB0aGlzLmNlcnRpZmljYXRlcy5zb21lKG8gPT4gbyBpbnN0YW5jZW9mIEF0dHJpYnV0ZUNlcnRpZmljYXRlVjIpKSB7XG4gICAgICAgICAgICB0aGlzLnZlcnNpb24gPSA0O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCh0aGlzLmNlcnRpZmljYXRlcyAmJiB0aGlzLmNlcnRpZmljYXRlcy5sZW5ndGggJiYgdGhpcy5jZXJ0aWZpY2F0ZXMuc29tZShvID0+IG8gaW5zdGFuY2VvZiBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZVYxKSlcbiAgICAgICAgICAgIHx8IHRoaXMuc2lnbmVySW5mb3Muc29tZShvID0+IG8udmVyc2lvbiA9PT0gMylcbiAgICAgICAgICAgIHx8IHRoaXMuZW5jYXBDb250ZW50SW5mby5lQ29udGVudFR5cGUgIT09IFNpZ25lZERhdGEuSURfREFUQSkge1xuICAgICAgICAgICAgdGhpcy52ZXJzaW9uID0gMztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMudmVyc2lvbiA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy52ZXJzaW9uIH0pKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLlNldCh7XG4gICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLmRpZ2VzdEFsZ29yaXRobXMsIGFsZ29yaXRobSA9PiBhbGdvcml0aG0udG9TY2hlbWEoKSlcbiAgICAgICAgfSkpO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMuZW5jYXBDb250ZW50SW5mby50b1NjaGVtYSgpKTtcbiAgICAgICAgaWYgKHRoaXMuY2VydGlmaWNhdGVzKSB7XG4gICAgICAgICAgICBjb25zdCBjZXJ0aWZpY2F0ZVNldCA9IG5ldyBDZXJ0aWZpY2F0ZVNldCh7IGNlcnRpZmljYXRlczogdGhpcy5jZXJ0aWZpY2F0ZXMgfSk7XG4gICAgICAgICAgICBjb25zdCBjZXJ0aWZpY2F0ZVNldFNjaGVtYSA9IGNlcnRpZmljYXRlU2V0LnRvU2NoZW1hKCk7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IGNlcnRpZmljYXRlU2V0U2NoZW1hLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jcmxzKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy5jcmxzLCBjcmwgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY3JsIGluc3RhbmNlb2YgT3RoZXJSZXZvY2F0aW9uSW5mb0Zvcm1hdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3JsU2NoZW1hID0gY3JsLnRvU2NoZW1hKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjcmxTY2hlbWEuaWRCbG9jay50YWdDbGFzcyA9IDM7XG4gICAgICAgICAgICAgICAgICAgICAgICBjcmxTY2hlbWEuaWRCbG9jay50YWdOdW1iZXIgPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNybFNjaGVtYTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3JsLnRvU2NoZW1hKGVuY29kZUZsYWcpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLlNldCh7XG4gICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLnNpZ25lckluZm9zLCBzaWduZXJJbmZvID0+IHNpZ25lckluZm8udG9TY2hlbWEoKSlcbiAgICAgICAgfSkpO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICB2ZXJzaW9uOiB0aGlzLnZlcnNpb24sXG4gICAgICAgICAgICBkaWdlc3RBbGdvcml0aG1zOiBBcnJheS5mcm9tKHRoaXMuZGlnZXN0QWxnb3JpdGhtcywgYWxnb3JpdGhtID0+IGFsZ29yaXRobS50b0pTT04oKSksXG4gICAgICAgICAgICBlbmNhcENvbnRlbnRJbmZvOiB0aGlzLmVuY2FwQ29udGVudEluZm8udG9KU09OKCksXG4gICAgICAgICAgICBzaWduZXJJbmZvczogQXJyYXkuZnJvbSh0aGlzLnNpZ25lckluZm9zLCBzaWduZXJJbmZvID0+IHNpZ25lckluZm8udG9KU09OKCkpLFxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5jZXJ0aWZpY2F0ZXMpIHtcbiAgICAgICAgICAgIHJlcy5jZXJ0aWZpY2F0ZXMgPSBBcnJheS5mcm9tKHRoaXMuY2VydGlmaWNhdGVzLCBjZXJ0aWZpY2F0ZSA9PiBjZXJ0aWZpY2F0ZS50b0pTT04oKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY3Jscykge1xuICAgICAgICAgICAgcmVzLmNybHMgPSBBcnJheS5mcm9tKHRoaXMuY3JscywgY3JsID0+IGNybC50b0pTT04oKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG4gICAgYXN5bmMgdmVyaWZ5KHsgc2lnbmVyID0gKC0xKSwgZGF0YSA9IChFTVBUWV9CVUZGRVIpLCB0cnVzdGVkQ2VydHMgPSBbXSwgY2hlY2tEYXRlID0gKG5ldyBEYXRlKCkpLCBjaGVja0NoYWluID0gZmFsc2UsIHBhc3NlZFdoZW5Ob3RSZXZWYWx1ZXMgPSBmYWxzZSwgZXh0ZW5kZWRNb2RlID0gZmFsc2UsIGZpbmRPcmlnaW4gPSBudWxsLCBmaW5kSXNzdWVyID0gbnVsbCB9ID0ge30sIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICBsZXQgc2lnbmVyQ2VydCA9IG51bGw7XG4gICAgICAgIGxldCB0aW1lc3RhbXBTZXJpYWwgPSBudWxsO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgbGV0IG1lc3NhZ2VEaWdlc3RWYWx1ZSA9IEVNUFRZX0JVRkZFUjtcbiAgICAgICAgICAgIGxldCBzaGFBbGdvcml0aG0gPSBFTVBUWV9TVFJJTkc7XG4gICAgICAgICAgICBsZXQgY2VydGlmaWNhdGVQYXRoID0gW107XG4gICAgICAgICAgICBjb25zdCBzaWduZXJJbmZvID0gdGhpcy5zaWduZXJJbmZvc1tzaWduZXJdO1xuICAgICAgICAgICAgaWYgKCFzaWduZXJJbmZvKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFNpZ25lZERhdGFWZXJpZnlFcnJvcih7XG4gICAgICAgICAgICAgICAgICAgIGRhdGU6IGNoZWNrRGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgY29kZTogMSxcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogXCJVbmFibGUgdG8gZ2V0IHNpZ25lciBieSBzdXBwbGllZCBpbmRleFwiLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCF0aGlzLmNlcnRpZmljYXRlcykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBTaWduZWREYXRhVmVyaWZ5RXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICBkYXRlOiBjaGVja0RhdGUsXG4gICAgICAgICAgICAgICAgICAgIGNvZGU6IDIsXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiTm8gY2VydGlmaWNhdGVzIGF0dGFjaGVkIHRvIHRoaXMgc2lnbmVkIGRhdGFcIixcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzaWduZXJJbmZvLnNpZCBpbnN0YW5jZW9mIElzc3VlckFuZFNlcmlhbE51bWJlcikge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY2VydGlmaWNhdGUgb2YgdGhpcy5jZXJ0aWZpY2F0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoY2VydGlmaWNhdGUgaW5zdGFuY2VvZiBDZXJ0aWZpY2F0ZSkpXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChjZXJ0aWZpY2F0ZS5pc3N1ZXIuaXNFcXVhbChzaWduZXJJbmZvLnNpZC5pc3N1ZXIpKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgKGNlcnRpZmljYXRlLnNlcmlhbE51bWJlci5pc0VxdWFsKHNpZ25lckluZm8uc2lkLnNlcmlhbE51bWJlcikpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaWduZXJDZXJ0ID0gY2VydGlmaWNhdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNpZCA9IHNpZ25lckluZm8uc2lkO1xuICAgICAgICAgICAgICAgIGNvbnN0IGtleUlkID0gc2lkLmlkQmxvY2suaXNDb25zdHJ1Y3RlZFxuICAgICAgICAgICAgICAgICAgICA/IHNpZC52YWx1ZUJsb2NrLnZhbHVlWzBdLnZhbHVlQmxvY2sudmFsdWVIZXhcbiAgICAgICAgICAgICAgICAgICAgOiBzaWQudmFsdWVCbG9jay52YWx1ZUhleDtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNlcnRpZmljYXRlIG9mIHRoaXMuY2VydGlmaWNhdGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghKGNlcnRpZmljYXRlIGluc3RhbmNlb2YgQ2VydGlmaWNhdGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBkaWdlc3QgPSBhd2FpdCBjcnlwdG8uZGlnZXN0KHsgbmFtZTogXCJzaGEtMVwiIH0sIGNlcnRpZmljYXRlLnN1YmplY3RQdWJsaWNLZXlJbmZvLnN1YmplY3RQdWJsaWNLZXkudmFsdWVCbG9jay52YWx1ZUhleFZpZXcpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocHZ1dGlscy5pc0VxdWFsQnVmZmVyKGRpZ2VzdCwga2V5SWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaWduZXJDZXJ0ID0gY2VydGlmaWNhdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghc2lnbmVyQ2VydCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBTaWduZWREYXRhVmVyaWZ5RXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICBkYXRlOiBjaGVja0RhdGUsXG4gICAgICAgICAgICAgICAgICAgIGNvZGU6IDMsXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiVW5hYmxlIHRvIGZpbmQgc2lnbmVyIGNlcnRpZmljYXRlXCIsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5lbmNhcENvbnRlbnRJbmZvLmVDb250ZW50VHlwZSA9PT0gaWRfZUNvbnRlbnRUeXBlX1RTVEluZm8pIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZW5jYXBDb250ZW50SW5mby5lQ29udGVudCkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgU2lnbmVkRGF0YVZlcmlmeUVycm9yKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGNoZWNrRGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvZGU6IDE1LFxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogXCJFcnJvciBkdXJpbmcgdmVyaWZpY2F0aW9uOiBUU1RJbmZvIGVDb250ZW50IGlzIGVtcHR5XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaWduYXR1cmVWZXJpZmllZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25lckNlcnRpZmljYXRlOiBzaWduZXJDZXJ0LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGltZXN0YW1wU2VyaWFsLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmVyQ2VydGlmaWNhdGVWZXJpZmllZDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbGV0IHRzdEluZm87XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgdHN0SW5mbyA9IFRTVEluZm8uZnJvbUJFUih0aGlzLmVuY2FwQ29udGVudEluZm8uZUNvbnRlbnQudmFsdWVCbG9jay52YWx1ZUhleFZpZXcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBTaWduZWREYXRhVmVyaWZ5RXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogY2hlY2tEYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29kZTogMTUsXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkVycm9yIGR1cmluZyB2ZXJpZmljYXRpb246IFRTVEluZm8gd3JvbmcgQVNOLjEgc2NoZW1hIFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmF0dXJlVmVyaWZpZWQ6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaWduZXJDZXJ0aWZpY2F0ZTogc2lnbmVyQ2VydCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVzdGFtcFNlcmlhbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25lckNlcnRpZmljYXRlVmVyaWZpZWQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNoZWNrRGF0ZSA9IHRzdEluZm8uZ2VuVGltZTtcbiAgICAgICAgICAgICAgICB0aW1lc3RhbXBTZXJpYWwgPSB0c3RJbmZvLnNlcmlhbE51bWJlci52YWx1ZUJsb2NrLnZhbHVlSGV4Vmlldy5zbGljZSgpLmJ1ZmZlcjtcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5ieXRlTGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBTaWduZWREYXRhVmVyaWZ5RXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogY2hlY2tEYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29kZTogNCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiTWlzc2VkIGRldGFjaGVkIGRhdGEgaW5wdXQgYXJyYXlcIixcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghKGF3YWl0IHRzdEluZm8udmVyaWZ5KHsgZGF0YSB9LCBjcnlwdG8pKSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgU2lnbmVkRGF0YVZlcmlmeUVycm9yKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGNoZWNrRGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvZGU6IDE1LFxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogXCJFcnJvciBkdXJpbmcgdmVyaWZpY2F0aW9uOiBUU1RJbmZvIHZlcmlmaWNhdGlvbiBpcyBmYWlsZWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25hdHVyZVZlcmlmaWVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25lckNlcnRpZmljYXRlOiBzaWduZXJDZXJ0LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGltZXN0YW1wU2VyaWFsLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmVyQ2VydGlmaWNhdGVWZXJpZmllZDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY2hlY2tDaGFpbikge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNlcnRzID0gdGhpcy5jZXJ0aWZpY2F0ZXMuZmlsdGVyKGNlcnRpZmljYXRlID0+IChjZXJ0aWZpY2F0ZSBpbnN0YW5jZW9mIENlcnRpZmljYXRlICYmICEhY2hlY2tDQShjZXJ0aWZpY2F0ZSwgc2lnbmVyQ2VydCkpKTtcbiAgICAgICAgICAgICAgICBjb25zdCBjaGFpblBhcmFtcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tEYXRlLFxuICAgICAgICAgICAgICAgICAgICBjZXJ0cyxcbiAgICAgICAgICAgICAgICAgICAgdHJ1c3RlZENlcnRzLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaWYgKGZpbmRJc3N1ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhaW5QYXJhbXMuZmluZElzc3VlciA9IGZpbmRJc3N1ZXI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChmaW5kT3JpZ2luKSB7XG4gICAgICAgICAgICAgICAgICAgIGNoYWluUGFyYW1zLmZpbmRPcmlnaW4gPSBmaW5kT3JpZ2luO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBjaGFpbkVuZ2luZSA9IG5ldyBDZXJ0aWZpY2F0ZUNoYWluVmFsaWRhdGlvbkVuZ2luZShjaGFpblBhcmFtcyk7XG4gICAgICAgICAgICAgICAgY2hhaW5FbmdpbmUuY2VydHMucHVzaChzaWduZXJDZXJ0KTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jcmxzKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY3JsIG9mIHRoaXMuY3Jscykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFwidGhpc1VwZGF0ZVwiIGluIGNybClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFpbkVuZ2luZS5jcmxzLnB1c2goY3JsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjcmwub3RoZXJSZXZJbmZvRm9ybWF0ID09PSBpZF9QS0lYX09DU1BfQmFzaWMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYWluRW5naW5lLm9jc3BzLnB1c2gobmV3IEJhc2ljT0NTUFJlc3BvbnNlKHsgc2NoZW1hOiBjcmwub3RoZXJSZXZJbmZvIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vY3Nwcykge1xuICAgICAgICAgICAgICAgICAgICBjaGFpbkVuZ2luZS5vY3Nwcy5wdXNoKC4uLih0aGlzLm9jc3BzKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IHZlcmlmaWNhdGlvblJlc3VsdCA9IGF3YWl0IGNoYWluRW5naW5lLnZlcmlmeSh7IHBhc3NlZFdoZW5Ob3RSZXZWYWx1ZXMgfSwgY3J5cHRvKVxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBTaWduZWREYXRhVmVyaWZ5RXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogY2hlY2tEYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29kZTogNSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGBWYWxpZGF0aW9uIG9mIHNpZ25lcidzIGNlcnRpZmljYXRlIGZhaWxlZCB3aXRoIGVycm9yOiAkeygoZSBpbnN0YW5jZW9mIE9iamVjdCkgPyBlLnJlc3VsdE1lc3NhZ2UgOiBlKX1gLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmVyQ2VydGlmaWNhdGU6IHNpZ25lckNlcnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaWduZXJDZXJ0aWZpY2F0ZVZlcmlmaWVkOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAodmVyaWZpY2F0aW9uUmVzdWx0LmNlcnRpZmljYXRlUGF0aCkge1xuICAgICAgICAgICAgICAgICAgICBjZXJ0aWZpY2F0ZVBhdGggPSB2ZXJpZmljYXRpb25SZXN1bHQuY2VydGlmaWNhdGVQYXRoO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIXZlcmlmaWNhdGlvblJlc3VsdC5yZXN1bHQpXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBTaWduZWREYXRhVmVyaWZ5RXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogY2hlY2tEYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29kZTogNSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGBWYWxpZGF0aW9uIG9mIHNpZ25lcidzIGNlcnRpZmljYXRlIGZhaWxlZDogJHt2ZXJpZmljYXRpb25SZXN1bHQucmVzdWx0TWVzc2FnZX1gLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmVyQ2VydGlmaWNhdGU6IHNpZ25lckNlcnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaWduZXJDZXJ0aWZpY2F0ZVZlcmlmaWVkOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHNpZ25lckluZm9IYXNoQWxnb3JpdGhtID0gY3J5cHRvLmdldEFsZ29yaXRobUJ5T0lEKHNpZ25lckluZm8uZGlnZXN0QWxnb3JpdGhtLmFsZ29yaXRobUlkKTtcbiAgICAgICAgICAgIGlmICghKFwibmFtZVwiIGluIHNpZ25lckluZm9IYXNoQWxnb3JpdGhtKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBTaWduZWREYXRhVmVyaWZ5RXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICBkYXRlOiBjaGVja0RhdGUsXG4gICAgICAgICAgICAgICAgICAgIGNvZGU6IDcsXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGBVbnN1cHBvcnRlZCBzaWduYXR1cmUgYWxnb3JpdGhtOiAke3NpZ25lckluZm8uZGlnZXN0QWxnb3JpdGhtLmFsZ29yaXRobUlkfWAsXG4gICAgICAgICAgICAgICAgICAgIHNpZ25lckNlcnRpZmljYXRlOiBzaWduZXJDZXJ0LFxuICAgICAgICAgICAgICAgICAgICBzaWduZXJDZXJ0aWZpY2F0ZVZlcmlmaWVkOiB0cnVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzaGFBbGdvcml0aG0gPSBzaWduZXJJbmZvSGFzaEFsZ29yaXRobS5uYW1lO1xuICAgICAgICAgICAgY29uc3QgZUNvbnRlbnQgPSB0aGlzLmVuY2FwQ29udGVudEluZm8uZUNvbnRlbnQ7XG4gICAgICAgICAgICBpZiAoZUNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoKGVDb250ZW50LmlkQmxvY2sudGFnQ2xhc3MgPT09IDEpICYmXG4gICAgICAgICAgICAgICAgICAgIChlQ29udGVudC5pZEJsb2NrLnRhZ051bWJlciA9PT0gNCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGVDb250ZW50LmdldFZhbHVlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGVDb250ZW50LnZhbHVlQmxvY2sudmFsdWVCZWZvcmVEZWNvZGVWaWV3LnNsaWNlKCkuYnVmZmVyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGEuYnl0ZUxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgU2lnbmVkRGF0YVZlcmlmeUVycm9yKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGNoZWNrRGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvZGU6IDgsXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIk1pc3NlZCBkZXRhY2hlZCBkYXRhIGlucHV0IGFycmF5XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaWduZXJDZXJ0aWZpY2F0ZTogc2lnbmVyQ2VydCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25lckNlcnRpZmljYXRlVmVyaWZpZWQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNpZ25lckluZm8uc2lnbmVkQXR0cnMpIHtcbiAgICAgICAgICAgICAgICBsZXQgZm91bmRDb250ZW50VHlwZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGxldCBmb3VuZE1lc3NhZ2VEaWdlc3QgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGF0dHJpYnV0ZSBvZiBzaWduZXJJbmZvLnNpZ25lZEF0dHJzLmF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZS50eXBlID09PSBcIjEuMi44NDAuMTEzNTQ5LjEuOS4zXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3VuZENvbnRlbnRUeXBlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZS50eXBlID09PSBcIjEuMi44NDAuMTEzNTQ5LjEuOS40XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kTWVzc2FnZURpZ2VzdCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlRGlnZXN0VmFsdWUgPSBhdHRyaWJ1dGUudmFsdWVzWzBdLnZhbHVlQmxvY2sudmFsdWVIZXg7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGZvdW5kQ29udGVudFR5cGUgJiYgZm91bmRNZXNzYWdlRGlnZXN0KVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChmb3VuZENvbnRlbnRUeXBlID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgU2lnbmVkRGF0YVZlcmlmeUVycm9yKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGNoZWNrRGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvZGU6IDksXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkF0dHJpYnV0ZSBcXFwiY29udGVudC10eXBlXFxcIiBpcyBhIG1hbmRhdG9yeSBhdHRyaWJ1dGUgZm9yIFxcXCJzaWduZWQgYXR0cmlidXRlc1xcXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25lckNlcnRpZmljYXRlOiBzaWduZXJDZXJ0LFxuICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmVyQ2VydGlmaWNhdGVWZXJpZmllZDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGZvdW5kTWVzc2FnZURpZ2VzdCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFNpZ25lZERhdGFWZXJpZnlFcnJvcih7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBjaGVja0RhdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2RlOiAxMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiQXR0cmlidXRlIFxcXCJtZXNzYWdlLWRpZ2VzdFxcXCIgaXMgYSBtYW5kYXRvcnkgYXR0cmlidXRlIGZvciBcXFwic2lnbmVkIGF0dHJpYnV0ZXNcXFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaWduYXR1cmVWZXJpZmllZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25lckNlcnRpZmljYXRlOiBzaWduZXJDZXJ0LFxuICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmVyQ2VydGlmaWNhdGVWZXJpZmllZDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2lnbmVySW5mby5zaWduZWRBdHRycykge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VEaWdlc3QgPSBhd2FpdCBjcnlwdG8uZGlnZXN0KHNoYUFsZ29yaXRobSwgbmV3IFVpbnQ4QXJyYXkoZGF0YSkpO1xuICAgICAgICAgICAgICAgIGlmICghcHZ1dGlscy5pc0VxdWFsQnVmZmVyKG1lc3NhZ2VEaWdlc3QsIG1lc3NhZ2VEaWdlc3RWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFNpZ25lZERhdGFWZXJpZnlFcnJvcih7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBjaGVja0RhdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2RlOiAxNSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiRXJyb3IgZHVyaW5nIHZlcmlmaWNhdGlvbjogTWVzc2FnZSBkaWdlc3QgZG9lc24ndCBtYXRjaFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmF0dXJlVmVyaWZpZWQ6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaWduZXJDZXJ0aWZpY2F0ZTogc2lnbmVyQ2VydCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVzdGFtcFNlcmlhbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25lckNlcnRpZmljYXRlVmVyaWZpZWQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGRhdGEgPSBzaWduZXJJbmZvLnNpZ25lZEF0dHJzLmVuY29kZWRWYWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHZlcmlmeVJlc3VsdCA9IHNpZ25lckluZm8uc2lnbmF0dXJlQWxnb3JpdGhtLmFsZ29yaXRobUlkID09PSBcIjEuMi44NDAuMTEzNTQ5LjEuMS4xXCJcbiAgICAgICAgICAgICAgICA/IGF3YWl0IGNyeXB0by52ZXJpZnlXaXRoUHVibGljS2V5KGRhdGEsIHNpZ25lckluZm8uc2lnbmF0dXJlLCBzaWduZXJDZXJ0LnN1YmplY3RQdWJsaWNLZXlJbmZvLCBzaWduZXJJbmZvLnNpZ25hdHVyZUFsZ29yaXRobSwgc2hhQWxnb3JpdGhtKVxuICAgICAgICAgICAgICAgIDogYXdhaXQgY3J5cHRvLnZlcmlmeVdpdGhQdWJsaWNLZXkoZGF0YSwgc2lnbmVySW5mby5zaWduYXR1cmUsIHNpZ25lckNlcnQuc3ViamVjdFB1YmxpY0tleUluZm8sIHNpZ25lckluZm8uc2lnbmF0dXJlQWxnb3JpdGhtKTtcbiAgICAgICAgICAgIGlmIChleHRlbmRlZE1vZGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBkYXRlOiBjaGVja0RhdGUsXG4gICAgICAgICAgICAgICAgICAgIGNvZGU6IDE0LFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBFTVBUWV9TVFJJTkcsXG4gICAgICAgICAgICAgICAgICAgIHNpZ25hdHVyZVZlcmlmaWVkOiB2ZXJpZnlSZXN1bHQsXG4gICAgICAgICAgICAgICAgICAgIHNpZ25lckNlcnRpZmljYXRlOiBzaWduZXJDZXJ0LFxuICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXBTZXJpYWwsXG4gICAgICAgICAgICAgICAgICAgIHNpZ25lckNlcnRpZmljYXRlVmVyaWZpZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGNlcnRpZmljYXRlUGF0aFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmVyaWZ5UmVzdWx0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIFNpZ25lZERhdGFWZXJpZnlFcnJvcikge1xuICAgICAgICAgICAgICAgIHRocm93IGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyBuZXcgU2lnbmVkRGF0YVZlcmlmeUVycm9yKHtcbiAgICAgICAgICAgICAgICBkYXRlOiBjaGVja0RhdGUsXG4gICAgICAgICAgICAgICAgY29kZTogMTUsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogYEVycm9yIGR1cmluZyB2ZXJpZmljYXRpb246ICR7ZSBpbnN0YW5jZW9mIEVycm9yID8gZS5tZXNzYWdlIDogZX1gLFxuICAgICAgICAgICAgICAgIHNpZ25hdHVyZVZlcmlmaWVkOiBudWxsLFxuICAgICAgICAgICAgICAgIHNpZ25lckNlcnRpZmljYXRlOiBzaWduZXJDZXJ0LFxuICAgICAgICAgICAgICAgIHRpbWVzdGFtcFNlcmlhbCxcbiAgICAgICAgICAgICAgICBzaWduZXJDZXJ0aWZpY2F0ZVZlcmlmaWVkOiB0cnVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyBzaWduKHByaXZhdGVLZXksIHNpZ25lckluZGV4LCBoYXNoQWxnb3JpdGhtID0gXCJTSEEtMVwiLCBkYXRhID0gKEVNUFRZX0JVRkZFUiksIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGlmICghcHJpdmF0ZUtleSlcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5lZWQgdG8gcHJvdmlkZSBhIHByaXZhdGUga2V5IGZvciBzaWduaW5nXCIpO1xuICAgICAgICBjb25zdCBzaWduZXJJbmZvID0gdGhpcy5zaWduZXJJbmZvc1tzaWduZXJJbmRleF07XG4gICAgICAgIGlmICghc2lnbmVySW5mbykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJTaWduZXJJbmZvIGluZGV4IGlzIG91dCBvZiByYW5nZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoISgoX2EgPSBzaWduZXJJbmZvLnNpZ25lZEF0dHJzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuYXR0cmlidXRlcy5sZW5ndGgpICYmIFwiaGFzaFwiIGluIHByaXZhdGVLZXkuYWxnb3JpdGhtICYmIFwiaGFzaFwiIGluIHByaXZhdGVLZXkuYWxnb3JpdGhtICYmIHByaXZhdGVLZXkuYWxnb3JpdGhtLmhhc2gpIHtcbiAgICAgICAgICAgIGhhc2hBbGdvcml0aG0gPSBwcml2YXRlS2V5LmFsZ29yaXRobS5oYXNoLm5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaGFzaEFsZ29yaXRobU9JRCA9IGNyeXB0by5nZXRPSURCeUFsZ29yaXRobSh7IG5hbWU6IGhhc2hBbGdvcml0aG0gfSwgdHJ1ZSwgXCJoYXNoQWxnb3JpdGhtXCIpO1xuICAgICAgICBpZiAoKHRoaXMuZGlnZXN0QWxnb3JpdGhtcy5maWx0ZXIoYWxnb3JpdGhtID0+IGFsZ29yaXRobS5hbGdvcml0aG1JZCA9PT0gaGFzaEFsZ29yaXRobU9JRCkpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5kaWdlc3RBbGdvcml0aG1zLnB1c2gobmV3IEFsZ29yaXRobUlkZW50aWZpZXIoe1xuICAgICAgICAgICAgICAgIGFsZ29yaXRobUlkOiBoYXNoQWxnb3JpdGhtT0lELFxuICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogbmV3IGFzbjFqcy5OdWxsKClcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBzaWduZXJJbmZvLmRpZ2VzdEFsZ29yaXRobSA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHtcbiAgICAgICAgICAgIGFsZ29yaXRobUlkOiBoYXNoQWxnb3JpdGhtT0lELFxuICAgICAgICAgICAgYWxnb3JpdGhtUGFyYW1zOiBuZXcgYXNuMWpzLk51bGwoKVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3Qgc2lnbmF0dXJlUGFyYW1zID0gYXdhaXQgY3J5cHRvLmdldFNpZ25hdHVyZVBhcmFtZXRlcnMocHJpdmF0ZUtleSwgaGFzaEFsZ29yaXRobSk7XG4gICAgICAgIGNvbnN0IHBhcmFtZXRlcnMgPSBzaWduYXR1cmVQYXJhbXMucGFyYW1ldGVycztcbiAgICAgICAgc2lnbmVySW5mby5zaWduYXR1cmVBbGdvcml0aG0gPSBzaWduYXR1cmVQYXJhbXMuc2lnbmF0dXJlQWxnb3JpdGhtO1xuICAgICAgICBpZiAoc2lnbmVySW5mby5zaWduZWRBdHRycykge1xuICAgICAgICAgICAgaWYgKHNpZ25lckluZm8uc2lnbmVkQXR0cnMuZW5jb2RlZFZhbHVlLmJ5dGVMZW5ndGggIT09IDApXG4gICAgICAgICAgICAgICAgZGF0YSA9IHNpZ25lckluZm8uc2lnbmVkQXR0cnMuZW5jb2RlZFZhbHVlO1xuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZGF0YSA9IHNpZ25lckluZm8uc2lnbmVkQXR0cnMudG9TY2hlbWEoKS50b0JFUigpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHZpZXcgPSBwdnRzdXRpbHMuQnVmZmVyU291cmNlQ29udmVydGVyLnRvVWludDhBcnJheShkYXRhKTtcbiAgICAgICAgICAgICAgICB2aWV3WzBdID0gMHgzMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGVDb250ZW50ID0gdGhpcy5lbmNhcENvbnRlbnRJbmZvLmVDb250ZW50O1xuICAgICAgICAgICAgaWYgKGVDb250ZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKChlQ29udGVudC5pZEJsb2NrLnRhZ0NsYXNzID09PSAxKSAmJlxuICAgICAgICAgICAgICAgICAgICAoZUNvbnRlbnQuaWRCbG9jay50YWdOdW1iZXIgPT09IDQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSBlQ29udGVudC5nZXRWYWx1ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSBlQ29udGVudC52YWx1ZUJsb2NrLnZhbHVlQmVmb3JlRGVjb2RlVmlldy5zbGljZSgpLmJ1ZmZlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChkYXRhLmJ5dGVMZW5ndGggPT09IDApXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk1pc3NlZCBkZXRhY2hlZCBkYXRhIGlucHV0IGFycmF5XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHNpZ25hdHVyZSA9IGF3YWl0IGNyeXB0by5zaWduV2l0aFByaXZhdGVLZXkoZGF0YSwgcHJpdmF0ZUtleSwgcGFyYW1ldGVycyk7XG4gICAgICAgIHNpZ25lckluZm8uc2lnbmF0dXJlID0gbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiBzaWduYXR1cmUgfSk7XG4gICAgfVxufVxuU2lnbmVkRGF0YS5DTEFTU19OQU1FID0gXCJTaWduZWREYXRhXCI7XG5TaWduZWREYXRhLklEX0RBVEEgPSBpZF9Db250ZW50VHlwZV9EYXRhO1xuXG5jb25zdCBWRVJTSU9OJDEgPSBcInZlcnNpb25cIjtcbmNvbnN0IEFVVEhfU0FGRSA9IFwiYXV0aFNhZmVcIjtcbmNvbnN0IE1BQ19EQVRBID0gXCJtYWNEYXRhXCI7XG5jb25zdCBQQVJTRURfVkFMVUUgPSBcInBhcnNlZFZhbHVlXCI7XG5jb25zdCBDTEVSQV9QUk9QUyA9IFtcbiAgICBWRVJTSU9OJDEsXG4gICAgQVVUSF9TQUZFLFxuICAgIE1BQ19EQVRBXG5dO1xuY2xhc3MgUEZYIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVkVSU0lPTiQxLCBQRlguZGVmYXVsdFZhbHVlcyhWRVJTSU9OJDEpKTtcbiAgICAgICAgdGhpcy5hdXRoU2FmZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEFVVEhfU0FGRSwgUEZYLmRlZmF1bHRWYWx1ZXMoQVVUSF9TQUZFKSk7XG4gICAgICAgIGlmIChNQUNfREFUQSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLm1hY0RhdGEgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBNQUNfREFUQSwgUEZYLmRlZmF1bHRWYWx1ZXMoTUFDX0RBVEEpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoUEFSU0VEX1ZBTFVFIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMucGFyc2VkVmFsdWUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBQQVJTRURfVkFMVUUsIFBGWC5kZWZhdWx0VmFsdWVzKFBBUlNFRF9WQUxVRSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDM7XG4gICAgICAgICAgICBjYXNlIEFVVEhfU0FGRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG5ldyBDb250ZW50SW5mbygpKTtcbiAgICAgICAgICAgIGNhc2UgTUFDX0RBVEE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChuZXcgTWFjRGF0YSgpKTtcbiAgICAgICAgICAgIGNhc2UgUEFSU0VEX1ZBTFVFOlxuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkVSU0lPTiQxOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgPT09IFBGWC5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKTtcbiAgICAgICAgICAgIGNhc2UgQVVUSF9TQUZFOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKENvbnRlbnRJbmZvLmNvbXBhcmVXaXRoRGVmYXVsdChcImNvbnRlbnRUeXBlXCIsIG1lbWJlclZhbHVlLmNvbnRlbnRUeXBlKSkgJiZcbiAgICAgICAgICAgICAgICAgICAgKENvbnRlbnRJbmZvLmNvbXBhcmVXaXRoRGVmYXVsdChcImNvbnRlbnRcIiwgbWVtYmVyVmFsdWUuY29udGVudCkpKTtcbiAgICAgICAgICAgIGNhc2UgTUFDX0RBVEE6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgoTWFjRGF0YS5jb21wYXJlV2l0aERlZmF1bHQoXCJtYWNcIiwgbWVtYmVyVmFsdWUubWFjKSkgJiZcbiAgICAgICAgICAgICAgICAgICAgKE1hY0RhdGEuY29tcGFyZVdpdGhEZWZhdWx0KFwibWFjU2FsdFwiLCBtZW1iZXJWYWx1ZS5tYWNTYWx0KSkgJiZcbiAgICAgICAgICAgICAgICAgICAgKE1hY0RhdGEuY29tcGFyZVdpdGhEZWZhdWx0KFwiaXRlcmF0aW9uc1wiLCBtZW1iZXJWYWx1ZS5pdGVyYXRpb25zKSkpO1xuICAgICAgICAgICAgY2FzZSBQQVJTRURfVkFMVUU6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgobWVtYmVyVmFsdWUgaW5zdGFuY2VvZiBPYmplY3QpICYmIChPYmplY3Qua2V5cyhtZW1iZXJWYWx1ZSkubGVuZ3RoID09PSAwKSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy52ZXJzaW9uIHx8IFZFUlNJT04kMSkgfSksXG4gICAgICAgICAgICAgICAgQ29udGVudEluZm8uc2NoZW1hKG5hbWVzLmF1dGhTYWZlIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogQVVUSF9TQUZFXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBNYWNEYXRhLnNjaGVtYShuYW1lcy5tYWNEYXRhIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogTUFDX0RBVEEsXG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVSQV9QUk9QUyk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgUEZYLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIHZlcnNpb246IFZFUlNJT04kMSxcbiAgICAgICAgICAgICAgICBhdXRoU2FmZToge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBBVVRIX1NBRkVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbWFjRGF0YToge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBNQUNfREFUQVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IGFzbjEucmVzdWx0LnZlcnNpb24udmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgdGhpcy5hdXRoU2FmZSA9IG5ldyBDb250ZW50SW5mbyh7IHNjaGVtYTogYXNuMS5yZXN1bHQuYXV0aFNhZmUgfSk7XG4gICAgICAgIGlmIChNQUNfREFUQSBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMubWFjRGF0YSA9IG5ldyBNYWNEYXRhKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5tYWNEYXRhIH0pO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXG4gICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy52ZXJzaW9uIH0pLFxuICAgICAgICAgICAgdGhpcy5hdXRoU2FmZS50b1NjaGVtYSgpXG4gICAgICAgIF07XG4gICAgICAgIGlmICh0aGlzLm1hY0RhdGEpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5tYWNEYXRhLnRvU2NoZW1hKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dCA9IHtcbiAgICAgICAgICAgIHZlcnNpb246IHRoaXMudmVyc2lvbixcbiAgICAgICAgICAgIGF1dGhTYWZlOiB0aGlzLmF1dGhTYWZlLnRvSlNPTigpXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLm1hY0RhdGEpIHtcbiAgICAgICAgICAgIG91dHB1dC5tYWNEYXRhID0gdGhpcy5tYWNEYXRhLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxuICAgIGFzeW5jIG1ha2VJbnRlcm5hbFZhbHVlcyhwYXJhbWV0ZXJzID0ge30sIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICBBcmd1bWVudEVycm9yLmFzc2VydChwYXJhbWV0ZXJzLCBcInBhcmFtZXRlcnNcIiwgXCJvYmplY3RcIik7XG4gICAgICAgIGlmICghdGhpcy5wYXJzZWRWYWx1ZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUGxlYXNlIGNhbGwgXFxcInBhcnNlVmFsdWVzXFxcIiBmdW5jdGlvbiBmaXJzdCBpbiBvcmRlciB0byBtYWtlIFxcXCJwYXJzZWRWYWx1ZVxcXCIgZGF0YVwiKTtcbiAgICAgICAgfVxuICAgICAgICBQYXJhbWV0ZXJFcnJvci5hc3NlcnRFbXB0eSh0aGlzLnBhcnNlZFZhbHVlLmludGVncml0eU1vZGUsIFwiaW50ZWdyaXR5TW9kZVwiLCBcInBhcnNlZFZhbHVlXCIpO1xuICAgICAgICBQYXJhbWV0ZXJFcnJvci5hc3NlcnRFbXB0eSh0aGlzLnBhcnNlZFZhbHVlLmF1dGhlbnRpY2F0ZWRTYWZlLCBcImF1dGhlbnRpY2F0ZWRTYWZlXCIsIFwicGFyc2VkVmFsdWVcIik7XG4gICAgICAgIHN3aXRjaCAodGhpcy5wYXJzZWRWYWx1ZS5pbnRlZ3JpdHlNb2RlKSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIShcIml0ZXJhdGlvbnNcIiBpbiBwYXJhbWV0ZXJzKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBQYXJhbWV0ZXJFcnJvcihcIml0ZXJhdGlvbnNcIik7XG4gICAgICAgICAgICAgICAgICAgIFBhcmFtZXRlckVycm9yLmFzc2VydEVtcHR5KHBhcmFtZXRlcnMucGJrZGYySGFzaEFsZ29yaXRobSwgXCJwYmtkZjJIYXNoQWxnb3JpdGhtXCIpO1xuICAgICAgICAgICAgICAgICAgICBQYXJhbWV0ZXJFcnJvci5hc3NlcnRFbXB0eShwYXJhbWV0ZXJzLmhtYWNIYXNoQWxnb3JpdGhtLCBcImhtYWNIYXNoQWxnb3JpdGhtXCIpO1xuICAgICAgICAgICAgICAgICAgICBQYXJhbWV0ZXJFcnJvci5hc3NlcnRFbXB0eShwYXJhbWV0ZXJzLnBhc3N3b3JkLCBcInBhc3N3b3JkXCIpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzYWx0QnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKDY0KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2FsdFZpZXcgPSBuZXcgVWludDhBcnJheShzYWx0QnVmZmVyKTtcbiAgICAgICAgICAgICAgICAgICAgY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhzYWx0Vmlldyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLnBhcnNlZFZhbHVlLmF1dGhlbnRpY2F0ZWRTYWZlLnRvU2NoZW1hKCkudG9CRVIoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmF1dGhTYWZlID0gbmV3IENvbnRlbnRJbmZvKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiBDb250ZW50SW5mby5EQVRBLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiBkYXRhIH0pXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjcnlwdG8uc3RhbXBEYXRhV2l0aFBhc3N3b3JkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBwYXJhbWV0ZXJzLnBhc3N3b3JkLFxuICAgICAgICAgICAgICAgICAgICAgICAgaGFzaEFsZ29yaXRobTogcGFyYW1ldGVycy5obWFjSGFzaEFsZ29yaXRobSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNhbHQ6IHNhbHRCdWZmZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVyYXRpb25Db3VudDogcGFyYW1ldGVycy5pdGVyYXRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFRvU3RhbXA6IGRhdGFcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWFjRGF0YSA9IG5ldyBNYWNEYXRhKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hYzogbmV3IERpZ2VzdEluZm8oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZ2VzdEFsZ29yaXRobTogbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1JZDogY3J5cHRvLmdldE9JREJ5QWxnb3JpdGhtKHsgbmFtZTogcGFyYW1ldGVycy5obWFjSGFzaEFsZ29yaXRobSB9LCB0cnVlLCBcImhtYWNIYXNoQWxnb3JpdGhtXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZ2VzdDogbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiByZXN1bHQgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWFjU2FsdDogbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiBzYWx0QnVmZmVyIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlcmF0aW9uczogcGFyYW1ldGVycy5pdGVyYXRpb25zXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghKFwic2lnbmluZ0NlcnRpZmljYXRlXCIgaW4gcGFyYW1ldGVycykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBQYXJhbWV0ZXJFcnJvcihcInNpZ25pbmdDZXJ0aWZpY2F0ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBQYXJhbWV0ZXJFcnJvci5hc3NlcnRFbXB0eShwYXJhbWV0ZXJzLnByaXZhdGVLZXksIFwicHJpdmF0ZUtleVwiKTtcbiAgICAgICAgICAgICAgICAgICAgUGFyYW1ldGVyRXJyb3IuYXNzZXJ0RW1wdHkocGFyYW1ldGVycy5oYXNoQWxnb3JpdGhtLCBcImhhc2hBbGdvcml0aG1cIik7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRvQmVTaWduZWQgPSB0aGlzLnBhcnNlZFZhbHVlLmF1dGhlbnRpY2F0ZWRTYWZlLnRvU2NoZW1hKCkudG9CRVIoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjbXNTaWduZWQgPSBuZXcgU2lnbmVkRGF0YSh7XG4gICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgZW5jYXBDb250ZW50SW5mbzogbmV3IEVuY2Fwc3VsYXRlZENvbnRlbnRJbmZvKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlQ29udGVudFR5cGU6IFwiMS4yLjg0MC4xMTM1NDkuMS43LjFcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlQ29udGVudDogbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiB0b0JlU2lnbmVkIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRpZmljYXRlczogW3BhcmFtZXRlcnMuc2lnbmluZ0NlcnRpZmljYXRlXVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY3J5cHRvLmRpZ2VzdCh7IG5hbWU6IHBhcmFtZXRlcnMuaGFzaEFsZ29yaXRobSB9LCBuZXcgVWludDhBcnJheSh0b0JlU2lnbmVkKSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNpZ25lZEF0dHIgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgc2lnbmVkQXR0ci5wdXNoKG5ldyBBdHRyaWJ1dGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCIxLjIuODQwLjExMzU0OS4xLjkuM1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgdmFsdWU6IFwiMS4yLjg0MC4xMTM1NDkuMS43LjFcIiB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgIHNpZ25lZEF0dHIucHVzaChuZXcgQXR0cmlidXRlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiMS4yLjg0MC4xMTM1NDkuMS45LjVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlczogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuVVRDVGltZSh7IHZhbHVlRGF0ZTogbmV3IERhdGUoKSB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgIHNpZ25lZEF0dHIucHVzaChuZXcgQXR0cmlidXRlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiMS4yLjg0MC4xMTM1NDkuMS45LjRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlczogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyB2YWx1ZUhleDogcmVzdWx0IH0pXG4gICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgY21zU2lnbmVkLnNpZ25lckluZm9zLnB1c2gobmV3IFNpZ25lckluZm8oe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbjogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZDogbmV3IElzc3VlckFuZFNlcmlhbE51bWJlcih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNzdWVyOiBwYXJhbWV0ZXJzLnNpZ25pbmdDZXJ0aWZpY2F0ZS5pc3N1ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VyaWFsTnVtYmVyOiBwYXJhbWV0ZXJzLnNpZ25pbmdDZXJ0aWZpY2F0ZS5zZXJpYWxOdW1iZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmVkQXR0cnM6IG5ldyBTaWduZWRBbmRVbnNpZ25lZEF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczogc2lnbmVkQXR0clxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbXNTaWduZWQuc2lnbihwYXJhbWV0ZXJzLnByaXZhdGVLZXksIDAsIHBhcmFtZXRlcnMuaGFzaEFsZ29yaXRobSwgdW5kZWZpbmVkLCBjcnlwdG8pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmF1dGhTYWZlID0gbmV3IENvbnRlbnRJbmZvKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiBcIjEuMi44NDAuMTEzNTQ5LjEuNy4yXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBjbXNTaWduZWQudG9TY2hlbWEodHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFBhcmFtZXRlciBcImludGVncml0eU1vZGVcIiBoYXMgdW5rbm93biB2YWx1ZTogJHt0aGlzLnBhcnNlZFZhbHVlLmludGVncml0eU1vZGV9YCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYXN5bmMgcGFyc2VJbnRlcm5hbFZhbHVlcyhwYXJhbWV0ZXJzLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgQXJndW1lbnRFcnJvci5hc3NlcnQocGFyYW1ldGVycywgXCJwYXJhbWV0ZXJzXCIsIFwib2JqZWN0XCIpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5jaGVja0ludGVncml0eSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwYXJhbWV0ZXJzLmNoZWNrSW50ZWdyaXR5ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBhcnNlZFZhbHVlID0ge307XG4gICAgICAgIHN3aXRjaCAodGhpcy5hdXRoU2FmZS5jb250ZW50VHlwZSkge1xuICAgICAgICAgICAgY2FzZSBDb250ZW50SW5mby5EQVRBOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgUGFyYW1ldGVyRXJyb3IuYXNzZXJ0RW1wdHkocGFyYW1ldGVycy5wYXNzd29yZCwgXCJwYXNzd29yZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJzZWRWYWx1ZS5pbnRlZ3JpdHlNb2RlID0gMDtcbiAgICAgICAgICAgICAgICAgICAgQXJndW1lbnRFcnJvci5hc3NlcnQodGhpcy5hdXRoU2FmZS5jb250ZW50LCBcImF1dGhTYWZlLmNvbnRlbnRcIiwgYXNuMWpzLk9jdGV0U3RyaW5nKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYXV0aFNhZmVDb250ZW50ID0gdGhpcy5hdXRoU2FmZS5jb250ZW50LmdldFZhbHVlKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyc2VkVmFsdWUuYXV0aGVudGljYXRlZFNhZmUgPSBBdXRoZW50aWNhdGVkU2FmZS5mcm9tQkVSKGF1dGhTYWZlQ29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbWV0ZXJzLmNoZWNrSW50ZWdyaXR5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMubWFjRGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkFic2VudCBcXFwibWFjRGF0YVxcXCIgdmFsdWUsIGNhbiBub3QgY2hlY2sgUEtDUyMxMiBkYXRhIGludGVncml0eVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGhhc2hBbGdvcml0aG0gPSBjcnlwdG8uZ2V0QWxnb3JpdGhtQnlPSUQodGhpcy5tYWNEYXRhLm1hYy5kaWdlc3RBbGdvcml0aG0uYWxnb3JpdGhtSWQsIHRydWUsIFwiZGlnZXN0QWxnb3JpdGhtXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY3J5cHRvLnZlcmlmeURhdGFTdGFtcGVkV2l0aFBhc3N3b3JkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZDogcGFyYW1ldGVycy5wYXNzd29yZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNoQWxnb3JpdGhtOiBoYXNoQWxnb3JpdGhtLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FsdDogQnVmZmVyU291cmNlQ29udmVydGVyLnRvQXJyYXlCdWZmZXIodGhpcy5tYWNEYXRhLm1hY1NhbHQudmFsdWVCbG9jay52YWx1ZUhleFZpZXcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZXJhdGlvbkNvdW50OiB0aGlzLm1hY0RhdGEuaXRlcmF0aW9ucyB8fCAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUb1ZlcmlmeTogYXV0aFNhZmVDb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25hdHVyZVRvVmVyaWZ5OiBCdWZmZXJTb3VyY2VDb252ZXJ0ZXIudG9BcnJheUJ1ZmZlcih0aGlzLm1hY0RhdGEubWFjLmRpZ2VzdC52YWx1ZUJsb2NrLnZhbHVlSGV4VmlldyksXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW50ZWdyaXR5IGZvciB0aGUgUEtDUyMxMiBkYXRhIGlzIGJyb2tlbiFcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIENvbnRlbnRJbmZvLlNJR05FRF9EQVRBOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJzZWRWYWx1ZS5pbnRlZ3JpdHlNb2RlID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY21zU2lnbmVkID0gbmV3IFNpZ25lZERhdGEoeyBzY2hlbWE6IHRoaXMuYXV0aFNhZmUuY29udGVudCB9KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZUNvbnRlbnQgPSBjbXNTaWduZWQuZW5jYXBDb250ZW50SW5mby5lQ29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgUGFyYW1ldGVyRXJyb3IuYXNzZXJ0KGVDb250ZW50LCBcImVDb250ZW50XCIsIFwiY21zU2lnbmVkLmVuY2FwQ29udGVudEluZm9cIik7XG4gICAgICAgICAgICAgICAgICAgIEFyZ3VtZW50RXJyb3IuYXNzZXJ0KGVDb250ZW50LCBcImVDb250ZW50XCIsIGFzbjFqcy5PY3RldFN0cmluZyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBlQ29udGVudC5nZXRWYWx1ZSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcnNlZFZhbHVlLmF1dGhlbnRpY2F0ZWRTYWZlID0gQXV0aGVudGljYXRlZFNhZmUuZnJvbUJFUihkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb2sgPSBhd2FpdCBjbXNTaWduZWQudmVyaWZ5KHsgc2lnbmVyOiAwLCBjaGVja0NoYWluOiBmYWxzZSB9LCBjcnlwdG8pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIW9rKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnRlZ3JpdHkgZm9yIHRoZSBQS0NTIzEyIGRhdGEgaXMgYnJva2VuIVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbmNvcnJlY3QgdmFsdWUgZm9yIFwidGhpcy5hdXRoU2FmZS5jb250ZW50VHlwZVwiOiAke3RoaXMuYXV0aFNhZmUuY29udGVudFR5cGV9YCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5QRlguQ0xBU1NfTkFNRSA9IFwiUEZYXCI7XG5cbmNvbnN0IFNUQVRVUyQxID0gXCJzdGF0dXNcIjtcbmNvbnN0IFNUQVRVU19TVFJJTkdTID0gXCJzdGF0dXNTdHJpbmdzXCI7XG5jb25zdCBGQUlMX0lORk8gPSBcImZhaWxJbmZvXCI7XG5jb25zdCBDTEVBUl9QUk9QUyQyID0gW1xuICAgIFNUQVRVUyQxLFxuICAgIFNUQVRVU19TVFJJTkdTLFxuICAgIEZBSUxfSU5GT1xuXTtcbnZhciBQS0lTdGF0dXM7XG4oZnVuY3Rpb24gKFBLSVN0YXR1cykge1xuICAgIFBLSVN0YXR1c1tQS0lTdGF0dXNbXCJncmFudGVkXCJdID0gMF0gPSBcImdyYW50ZWRcIjtcbiAgICBQS0lTdGF0dXNbUEtJU3RhdHVzW1wiZ3JhbnRlZFdpdGhNb2RzXCJdID0gMV0gPSBcImdyYW50ZWRXaXRoTW9kc1wiO1xuICAgIFBLSVN0YXR1c1tQS0lTdGF0dXNbXCJyZWplY3Rpb25cIl0gPSAyXSA9IFwicmVqZWN0aW9uXCI7XG4gICAgUEtJU3RhdHVzW1BLSVN0YXR1c1tcIndhaXRpbmdcIl0gPSAzXSA9IFwid2FpdGluZ1wiO1xuICAgIFBLSVN0YXR1c1tQS0lTdGF0dXNbXCJyZXZvY2F0aW9uV2FybmluZ1wiXSA9IDRdID0gXCJyZXZvY2F0aW9uV2FybmluZ1wiO1xuICAgIFBLSVN0YXR1c1tQS0lTdGF0dXNbXCJyZXZvY2F0aW9uTm90aWZpY2F0aW9uXCJdID0gNV0gPSBcInJldm9jYXRpb25Ob3RpZmljYXRpb25cIjtcbn0pKFBLSVN0YXR1cyB8fCAoUEtJU3RhdHVzID0ge30pKTtcbmNsYXNzIFBLSVN0YXR1c0luZm8gZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnN0YXR1cyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNUQVRVUyQxLCBQS0lTdGF0dXNJbmZvLmRlZmF1bHRWYWx1ZXMoU1RBVFVTJDEpKTtcbiAgICAgICAgaWYgKFNUQVRVU19TVFJJTkdTIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdHVzU3RyaW5ncyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNUQVRVU19TVFJJTkdTLCBQS0lTdGF0dXNJbmZvLmRlZmF1bHRWYWx1ZXMoU1RBVFVTX1NUUklOR1MpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoRkFJTF9JTkZPIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuZmFpbEluZm8gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBGQUlMX0lORk8sIFBLSVN0YXR1c0luZm8uZGVmYXVsdFZhbHVlcyhGQUlMX0lORk8pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgU1RBVFVTJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDI7XG4gICAgICAgICAgICBjYXNlIFNUQVRVU19TVFJJTkdTOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGNhc2UgRkFJTF9JTkZPOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkJpdFN0cmluZygpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBTVEFUVVMkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlID09PSBQS0lTdGF0dXNJbmZvLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkpO1xuICAgICAgICAgICAgY2FzZSBTVEFUVVNfU1RSSU5HUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBjYXNlIEZBSUxfSU5GTzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmlzRXF1YWwoUEtJU3RhdHVzSW5mby5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy5zdGF0dXMgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuc3RhdHVzU3RyaW5ncyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBuZXcgYXNuMWpzLlV0ZjhTdHJpbmcoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQml0U3RyaW5nKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmZhaWxJbmZvIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQyKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBQS0lTdGF0dXNJbmZvLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIHN0YXR1czogU1RBVFVTJDEsXG4gICAgICAgICAgICAgICAgc3RhdHVzU3RyaW5nczogU1RBVFVTX1NUUklOR1MsXG4gICAgICAgICAgICAgICAgZmFpbEluZm86IEZBSUxfSU5GT1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIGNvbnN0IF9zdGF0dXMgPSBhc24xLnJlc3VsdC5zdGF0dXM7XG4gICAgICAgIGlmICgoX3N0YXR1cy52YWx1ZUJsb2NrLmlzSGV4T25seSA9PT0gdHJ1ZSkgfHxcbiAgICAgICAgICAgIChfc3RhdHVzLnZhbHVlQmxvY2sudmFsdWVEZWMgPCAwKSB8fFxuICAgICAgICAgICAgKF9zdGF0dXMudmFsdWVCbG9jay52YWx1ZURlYyA+IDUpKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUEtJU3RhdHVzSW5mbyBcXFwic3RhdHVzXFxcIiBoYXMgaW52YWxpZCB2YWx1ZVwiKTtcbiAgICAgICAgdGhpcy5zdGF0dXMgPSBfc3RhdHVzLnZhbHVlQmxvY2sudmFsdWVEZWM7XG4gICAgICAgIGlmIChTVEFUVVNfU1RSSU5HUyBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMuc3RhdHVzU3RyaW5ncyA9IGFzbjEucmVzdWx0LnN0YXR1c1N0cmluZ3M7XG4gICAgICAgIGlmIChGQUlMX0lORk8gaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLmZhaWxJbmZvID0gYXNuMS5yZXN1bHQuZmFpbEluZm87XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlOiB0aGlzLnN0YXR1cyB9KSk7XG4gICAgICAgIGlmICh0aGlzLnN0YXR1c1N0cmluZ3MpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuc3RhdHVzU3RyaW5nc1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmZhaWxJbmZvKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMuZmFpbEluZm8pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICAgIHN0YXR1czogdGhpcy5zdGF0dXNcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuc3RhdHVzU3RyaW5ncykge1xuICAgICAgICAgICAgcmVzLnN0YXR1c1N0cmluZ3MgPSBBcnJheS5mcm9tKHRoaXMuc3RhdHVzU3RyaW5ncywgbyA9PiBvLnRvSlNPTigpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5mYWlsSW5mbykge1xuICAgICAgICAgICAgcmVzLmZhaWxJbmZvID0gdGhpcy5mYWlsSW5mby50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbn1cblBLSVN0YXR1c0luZm8uQ0xBU1NfTkFNRSA9IFwiUEtJU3RhdHVzSW5mb1wiO1xuXG5jb25zdCBWRVJTSU9OID0gXCJ2ZXJzaW9uXCI7XG5jb25zdCBNRVNTQUdFX0lNUFJJTlQgPSBcIm1lc3NhZ2VJbXByaW50XCI7XG5jb25zdCBSRVFfUE9MSUNZID0gXCJyZXFQb2xpY3lcIjtcbmNvbnN0IE5PTkNFID0gXCJub25jZVwiO1xuY29uc3QgQ0VSVF9SRVEgPSBcImNlcnRSZXFcIjtcbmNvbnN0IEVYVEVOU0lPTlMgPSBcImV4dGVuc2lvbnNcIjtcbmNvbnN0IFRJTUVfU1RBTVBfUkVRID0gXCJUaW1lU3RhbXBSZXFcIjtcbmNvbnN0IFRJTUVfU1RBTVBfUkVRX1ZFUlNJT04gPSBgJHtUSU1FX1NUQU1QX1JFUX0uJHtWRVJTSU9OfWA7XG5jb25zdCBUSU1FX1NUQU1QX1JFUV9NRVNTQUdFX0lNUFJJTlQgPSBgJHtUSU1FX1NUQU1QX1JFUX0uJHtNRVNTQUdFX0lNUFJJTlR9YDtcbmNvbnN0IFRJTUVfU1RBTVBfUkVRX1BPTElDWSA9IGAke1RJTUVfU1RBTVBfUkVRfS4ke1JFUV9QT0xJQ1l9YDtcbmNvbnN0IFRJTUVfU1RBTVBfUkVRX05PTkNFID0gYCR7VElNRV9TVEFNUF9SRVF9LiR7Tk9OQ0V9YDtcbmNvbnN0IFRJTUVfU1RBTVBfUkVRX0NFUlRfUkVRID0gYCR7VElNRV9TVEFNUF9SRVF9LiR7Q0VSVF9SRVF9YDtcbmNvbnN0IFRJTUVfU1RBTVBfUkVRX0VYVEVOU0lPTlMgPSBgJHtUSU1FX1NUQU1QX1JFUX0uJHtFWFRFTlNJT05TfWA7XG5jb25zdCBDTEVBUl9QUk9QUyQxID0gW1xuICAgIFRJTUVfU1RBTVBfUkVRX1ZFUlNJT04sXG4gICAgVElNRV9TVEFNUF9SRVFfTUVTU0FHRV9JTVBSSU5ULFxuICAgIFRJTUVfU1RBTVBfUkVRX1BPTElDWSxcbiAgICBUSU1FX1NUQU1QX1JFUV9OT05DRSxcbiAgICBUSU1FX1NUQU1QX1JFUV9DRVJUX1JFUSxcbiAgICBUSU1FX1NUQU1QX1JFUV9FWFRFTlNJT05TLFxuXTtcbmNsYXNzIFRpbWVTdGFtcFJlcSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZFUlNJT04sIFRpbWVTdGFtcFJlcS5kZWZhdWx0VmFsdWVzKFZFUlNJT04pKTtcbiAgICAgICAgdGhpcy5tZXNzYWdlSW1wcmludCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE1FU1NBR0VfSU1QUklOVCwgVGltZVN0YW1wUmVxLmRlZmF1bHRWYWx1ZXMoTUVTU0FHRV9JTVBSSU5UKSk7XG4gICAgICAgIGlmIChSRVFfUE9MSUNZIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMucmVxUG9saWN5ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUkVRX1BPTElDWSwgVGltZVN0YW1wUmVxLmRlZmF1bHRWYWx1ZXMoUkVRX1BPTElDWSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOT05DRSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLm5vbmNlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgTk9OQ0UsIFRpbWVTdGFtcFJlcS5kZWZhdWx0VmFsdWVzKE5PTkNFKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKENFUlRfUkVRIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuY2VydFJlcSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIENFUlRfUkVRLCBUaW1lU3RhbXBSZXEuZGVmYXVsdFZhbHVlcyhDRVJUX1JFUSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChFWFRFTlNJT05TIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuZXh0ZW5zaW9ucyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEVYVEVOU0lPTlMsIFRpbWVTdGFtcFJlcS5kZWZhdWx0VmFsdWVzKEVYVEVOU0lPTlMpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkVSU0lPTjpcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGNhc2UgTUVTU0FHRV9JTVBSSU5UOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTWVzc2FnZUltcHJpbnQoKTtcbiAgICAgICAgICAgIGNhc2UgUkVRX1BPTElDWTpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfU1RSSU5HO1xuICAgICAgICAgICAgY2FzZSBOT05DRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5JbnRlZ2VyKCk7XG4gICAgICAgICAgICBjYXNlIENFUlRfUkVROlxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIGNhc2UgRVhURU5TSU9OUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFZFUlNJT046XG4gICAgICAgICAgICBjYXNlIFJFUV9QT0xJQ1k6XG4gICAgICAgICAgICBjYXNlIENFUlRfUkVROlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgPT09IFRpbWVTdGFtcFJlcS5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKTtcbiAgICAgICAgICAgIGNhc2UgTUVTU0FHRV9JTVBSSU5UOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKE1lc3NhZ2VJbXByaW50LmNvbXBhcmVXaXRoRGVmYXVsdChcImhhc2hBbGdvcml0aG1cIiwgbWVtYmVyVmFsdWUuaGFzaEFsZ29yaXRobSkpICYmXG4gICAgICAgICAgICAgICAgICAgIChNZXNzYWdlSW1wcmludC5jb21wYXJlV2l0aERlZmF1bHQoXCJoYXNoZWRNZXNzYWdlXCIsIG1lbWJlclZhbHVlLmhhc2hlZE1lc3NhZ2UpKSk7XG4gICAgICAgICAgICBjYXNlIE5PTkNFOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUuaXNFcXVhbChUaW1lU3RhbXBSZXEuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSkpO1xuICAgICAgICAgICAgY2FzZSBFWFRFTlNJT05TOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUubGVuZ3RoID09PSAwKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgVElNRV9TVEFNUF9SRVEpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMudmVyc2lvbiB8fCBUSU1FX1NUQU1QX1JFUV9WRVJTSU9OKSB9KSxcbiAgICAgICAgICAgICAgICBNZXNzYWdlSW1wcmludC5zY2hlbWEobmFtZXMubWVzc2FnZUltcHJpbnQgfHwge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBUSU1FX1NUQU1QX1JFUV9NRVNTQUdFX0lNUFJJTlRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5yZXFQb2xpY3kgfHwgVElNRV9TVEFNUF9SRVFfUE9MSUNZKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWVcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMubm9uY2UgfHwgVElNRV9TVEFNUF9SRVFfTk9OQ0UpLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQm9vbGVhbih7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5jZXJ0UmVxIHx8IFRJTUVfU1RBTVBfUkVRX0NFUlRfUkVRKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWVcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmV4dGVuc2lvbnMgfHwgVElNRV9TVEFNUF9SRVFfRVhURU5TSU9OUyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IEV4dGVuc2lvbi5zY2hlbWEoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSldXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQxKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBUaW1lU3RhbXBSZXEuc2NoZW1hKCkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLnZlcnNpb24gPSBhc24xLnJlc3VsdFtUSU1FX1NUQU1QX1JFUV9WRVJTSU9OXS52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgICAgICB0aGlzLm1lc3NhZ2VJbXByaW50ID0gbmV3IE1lc3NhZ2VJbXByaW50KHsgc2NoZW1hOiBhc24xLnJlc3VsdFtUSU1FX1NUQU1QX1JFUV9NRVNTQUdFX0lNUFJJTlRdIH0pO1xuICAgICAgICBpZiAoVElNRV9TVEFNUF9SRVFfUE9MSUNZIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5yZXFQb2xpY3kgPSBhc24xLnJlc3VsdFtUSU1FX1NUQU1QX1JFUV9QT0xJQ1ldLnZhbHVlQmxvY2sudG9TdHJpbmcoKTtcbiAgICAgICAgaWYgKFRJTUVfU1RBTVBfUkVRX05PTkNFIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5ub25jZSA9IGFzbjEucmVzdWx0W1RJTUVfU1RBTVBfUkVRX05PTkNFXTtcbiAgICAgICAgaWYgKFRJTUVfU1RBTVBfUkVRX0NFUlRfUkVRIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5jZXJ0UmVxID0gYXNuMS5yZXN1bHRbVElNRV9TVEFNUF9SRVFfQ0VSVF9SRVFdLnZhbHVlQmxvY2sudmFsdWU7XG4gICAgICAgIGlmIChUSU1FX1NUQU1QX1JFUV9FWFRFTlNJT05TIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5leHRlbnNpb25zID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdFtUSU1FX1NUQU1QX1JFUV9FWFRFTlNJT05TXSwgZWxlbWVudCA9PiBuZXcgRXh0ZW5zaW9uKHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWU6IHRoaXMudmVyc2lvbiB9KSk7XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5tZXNzYWdlSW1wcmludC50b1NjaGVtYSgpKTtcbiAgICAgICAgaWYgKHRoaXMucmVxUG9saWN5KVxuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyB2YWx1ZTogdGhpcy5yZXFQb2xpY3kgfSkpO1xuICAgICAgICBpZiAodGhpcy5ub25jZSlcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5ub25jZSk7XG4gICAgICAgIGlmICgoQ0VSVF9SRVEgaW4gdGhpcykgJiYgKFRpbWVTdGFtcFJlcS5jb21wYXJlV2l0aERlZmF1bHQoQ0VSVF9SRVEsIHRoaXMuY2VydFJlcSkgPT09IGZhbHNlKSlcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Cb29sZWFuKHsgdmFsdWU6IHRoaXMuY2VydFJlcSB9KSk7XG4gICAgICAgIGlmICh0aGlzLmV4dGVuc2lvbnMpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLmV4dGVuc2lvbnMsIG8gPT4gby50b1NjaGVtYSgpKVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICAgIHZlcnNpb246IHRoaXMudmVyc2lvbixcbiAgICAgICAgICAgIG1lc3NhZ2VJbXByaW50OiB0aGlzLm1lc3NhZ2VJbXByaW50LnRvSlNPTigpXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLnJlcVBvbGljeSAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgcmVzLnJlcVBvbGljeSA9IHRoaXMucmVxUG9saWN5O1xuICAgICAgICBpZiAodGhpcy5ub25jZSAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgcmVzLm5vbmNlID0gdGhpcy5ub25jZS50b0pTT04oKTtcbiAgICAgICAgaWYgKCh0aGlzLmNlcnRSZXEgIT09IHVuZGVmaW5lZCkgJiYgKFRpbWVTdGFtcFJlcS5jb21wYXJlV2l0aERlZmF1bHQoQ0VSVF9SRVEsIHRoaXMuY2VydFJlcSkgPT09IGZhbHNlKSlcbiAgICAgICAgICAgIHJlcy5jZXJ0UmVxID0gdGhpcy5jZXJ0UmVxO1xuICAgICAgICBpZiAodGhpcy5leHRlbnNpb25zKSB7XG4gICAgICAgICAgICByZXMuZXh0ZW5zaW9ucyA9IEFycmF5LmZyb20odGhpcy5leHRlbnNpb25zLCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxufVxuVGltZVN0YW1wUmVxLkNMQVNTX05BTUUgPSBcIlRpbWVTdGFtcFJlcVwiO1xuXG5jb25zdCBTVEFUVVMgPSBcInN0YXR1c1wiO1xuY29uc3QgVElNRV9TVEFNUF9UT0tFTiA9IFwidGltZVN0YW1wVG9rZW5cIjtcbmNvbnN0IFRJTUVfU1RBTVBfUkVTUCA9IFwiVGltZVN0YW1wUmVzcFwiO1xuY29uc3QgVElNRV9TVEFNUF9SRVNQX1NUQVRVUyA9IGAke1RJTUVfU1RBTVBfUkVTUH0uJHtTVEFUVVN9YDtcbmNvbnN0IFRJTUVfU1RBTVBfUkVTUF9UT0tFTiA9IGAke1RJTUVfU1RBTVBfUkVTUH0uJHtUSU1FX1NUQU1QX1RPS0VOfWA7XG5jb25zdCBDTEVBUl9QUk9QUyA9IFtcbiAgICBUSU1FX1NUQU1QX1JFU1BfU1RBVFVTLFxuICAgIFRJTUVfU1RBTVBfUkVTUF9UT0tFTlxuXTtcbmNsYXNzIFRpbWVTdGFtcFJlc3AgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnN0YXR1cyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNUQVRVUywgVGltZVN0YW1wUmVzcC5kZWZhdWx0VmFsdWVzKFNUQVRVUykpO1xuICAgICAgICBpZiAoVElNRV9TVEFNUF9UT0tFTiBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnRpbWVTdGFtcFRva2VuID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVElNRV9TVEFNUF9UT0tFTiwgVGltZVN0YW1wUmVzcC5kZWZhdWx0VmFsdWVzKFRJTUVfU1RBTVBfVE9LRU4pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgU1RBVFVTOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUEtJU3RhdHVzSW5mbygpO1xuICAgICAgICAgICAgY2FzZSBUSU1FX1NUQU1QX1RPS0VOOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29udGVudEluZm8oKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgU1RBVFVTOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKFBLSVN0YXR1c0luZm8uY29tcGFyZVdpdGhEZWZhdWx0KFNUQVRVUywgbWVtYmVyVmFsdWUuc3RhdHVzKSkgJiZcbiAgICAgICAgICAgICAgICAgICAgKChcInN0YXR1c1N0cmluZ3NcIiBpbiBtZW1iZXJWYWx1ZSkgPT09IGZhbHNlKSAmJlxuICAgICAgICAgICAgICAgICAgICAoKFwiZmFpbEluZm9cIiBpbiBtZW1iZXJWYWx1ZSkgPT09IGZhbHNlKSk7XG4gICAgICAgICAgICBjYXNlIFRJTUVfU1RBTVBfVE9LRU46XG4gICAgICAgICAgICAgICAgcmV0dXJuICgobWVtYmVyVmFsdWUuY29udGVudFR5cGUgPT09IEVNUFRZX1NUUklORykgJiZcbiAgICAgICAgICAgICAgICAgICAgKG1lbWJlclZhbHVlLmNvbnRlbnQgaW5zdGFuY2VvZiBhc24xanMuQW55KSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IFRJTUVfU1RBTVBfUkVTUCksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIFBLSVN0YXR1c0luZm8uc2NoZW1hKG5hbWVzLnN0YXR1cyB8fCB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFRJTUVfU1RBTVBfUkVTUF9TVEFUVVNcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIENvbnRlbnRJbmZvLnNjaGVtYShuYW1lcy50aW1lU3RhbXBUb2tlbiB8fCB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFRJTUVfU1RBTVBfUkVTUF9UT0tFTixcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBUaW1lU3RhbXBSZXNwLnNjaGVtYSgpKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5zdGF0dXMgPSBuZXcgUEtJU3RhdHVzSW5mbyh7IHNjaGVtYTogYXNuMS5yZXN1bHRbVElNRV9TVEFNUF9SRVNQX1NUQVRVU10gfSk7XG4gICAgICAgIGlmIChUSU1FX1NUQU1QX1JFU1BfVE9LRU4gaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLnRpbWVTdGFtcFRva2VuID0gbmV3IENvbnRlbnRJbmZvKHsgc2NoZW1hOiBhc24xLnJlc3VsdFtUSU1FX1NUQU1QX1JFU1BfVE9LRU5dIH0pO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnN0YXR1cy50b1NjaGVtYSgpKTtcbiAgICAgICAgaWYgKHRoaXMudGltZVN0YW1wVG9rZW4pIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy50aW1lU3RhbXBUb2tlbi50b1NjaGVtYSgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICBzdGF0dXM6IHRoaXMuc3RhdHVzLnRvSlNPTigpXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLnRpbWVTdGFtcFRva2VuKSB7XG4gICAgICAgICAgICByZXMudGltZVN0YW1wVG9rZW4gPSB0aGlzLnRpbWVTdGFtcFRva2VuLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxuICAgIGFzeW5jIHNpZ24ocHJpdmF0ZUtleSwgaGFzaEFsZ29yaXRobSwgY3J5cHRvID0gZ2V0Q3J5cHRvKHRydWUpKSB7XG4gICAgICAgIHRoaXMuYXNzZXJ0Q29udGVudFR5cGUoKTtcbiAgICAgICAgY29uc3Qgc2lnbmVkID0gbmV3IFNpZ25lZERhdGEoeyBzY2hlbWE6IHRoaXMudGltZVN0YW1wVG9rZW4uY29udGVudCB9KTtcbiAgICAgICAgcmV0dXJuIHNpZ25lZC5zaWduKHByaXZhdGVLZXksIDAsIGhhc2hBbGdvcml0aG0sIHVuZGVmaW5lZCwgY3J5cHRvKTtcbiAgICB9XG4gICAgYXN5bmMgdmVyaWZ5KHZlcmlmaWNhdGlvblBhcmFtZXRlcnMgPSB7IHNpZ25lcjogMCwgdHJ1c3RlZENlcnRzOiBbXSwgZGF0YTogRU1QVFlfQlVGRkVSIH0sIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICB0aGlzLmFzc2VydENvbnRlbnRUeXBlKCk7XG4gICAgICAgIGNvbnN0IHNpZ25lZCA9IG5ldyBTaWduZWREYXRhKHsgc2NoZW1hOiB0aGlzLnRpbWVTdGFtcFRva2VuLmNvbnRlbnQgfSk7XG4gICAgICAgIHJldHVybiBzaWduZWQudmVyaWZ5KHZlcmlmaWNhdGlvblBhcmFtZXRlcnMsIGNyeXB0byk7XG4gICAgfVxuICAgIGFzc2VydENvbnRlbnRUeXBlKCkge1xuICAgICAgICBpZiAoIXRoaXMudGltZVN0YW1wVG9rZW4pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInRpbWVTdGFtcFRva2VuIGlzIGFic2VudCBpbiBUU1AgcmVzcG9uc2VcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudGltZVN0YW1wVG9rZW4uY29udGVudFR5cGUgIT09IGlkX0NvbnRlbnRUeXBlX1NpZ25lZERhdGEpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgV3JvbmcgZm9ybWF0IG9mIHRpbWVTdGFtcFRva2VuOiAke3RoaXMudGltZVN0YW1wVG9rZW4uY29udGVudFR5cGV9YCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5UaW1lU3RhbXBSZXNwLkNMQVNTX05BTUUgPSBcIlRpbWVTdGFtcFJlc3BcIjtcblxuZnVuY3Rpb24gaW5pdENyeXB0b0VuZ2luZSgpIHtcbiAgICBpZiAodHlwZW9mIGdsb2JhbFRoaXMgIT09IFwidW5kZWZpbmVkXCIgJiYgXCJjcnlwdG9cIiBpbiBnbG9iYWxUaGlzKSB7XG4gICAgICAgIGxldCBlbmdpbmVOYW1lID0gXCJ3ZWJjcnlwdG9cIjtcbiAgICAgICAgaWYgKFwid2Via2l0U3VidGxlXCIgaW4gZ2xvYmFsVGhpcy5jcnlwdG8pIHtcbiAgICAgICAgICAgIGVuZ2luZU5hbWUgPSBcInNhZmFyaVwiO1xuICAgICAgICB9XG4gICAgICAgIHNldEVuZ2luZShlbmdpbmVOYW1lLCBuZXcgQ3J5cHRvRW5naW5lKHsgbmFtZTogZW5naW5lTmFtZSwgY3J5cHRvOiBnbG9iYWxUaGlzLmNyeXB0byB9KSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGVvZiBjcnlwdG8gIT09IFwidW5kZWZpbmVkXCIgJiYgXCJ3ZWJjcnlwdG9cIiBpbiBjcnlwdG8pIHtcbiAgICAgICAgY29uc3QgbmFtZSA9IFwiTm9kZUpTIF4xNVwiO1xuICAgICAgICBjb25zdCBub2RlQ3J5cHRvID0gY3J5cHRvLndlYmNyeXB0bztcbiAgICAgICAgc2V0RW5naW5lKG5hbWUsIG5ldyBDcnlwdG9FbmdpbmUoeyBuYW1lLCBjcnlwdG86IG5vZGVDcnlwdG8gfSkpO1xuICAgIH1cbn1cblxuaW5pdENyeXB0b0VuZ2luZSgpO1xuXG5leHBvcnQgeyBBYnN0cmFjdENyeXB0b0VuZ2luZSwgQWNjZXNzRGVzY3JpcHRpb24sIEFjY3VyYWN5LCBBbGdvcml0aG1JZGVudGlmaWVyLCBBbHROYW1lLCBBcmd1bWVudEVycm9yLCBBc25FcnJvciwgQXR0Q2VydFZhbGlkaXR5UGVyaW9kLCBBdHRyaWJ1dGUsIEF0dHJpYnV0ZUNlcnRpZmljYXRlSW5mb1YxLCBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMiwgQXR0cmlidXRlQ2VydGlmaWNhdGVWMSwgQXR0cmlidXRlQ2VydGlmaWNhdGVWMiwgQXR0cmlidXRlVHlwZUFuZFZhbHVlLCBBdXRoZW50aWNhdGVkU2FmZSwgQXV0aG9yaXR5S2V5SWRlbnRpZmllciwgQmFzaWNDb25zdHJhaW50cywgQmFzaWNPQ1NQUmVzcG9uc2UsIENBVmVyc2lvbiwgQ1JMQmFnLCBDUkxEaXN0cmlidXRpb25Qb2ludHMsIENlcnRCYWcsIENlcnRJRCwgQ2VydGlmaWNhdGUsIENlcnRpZmljYXRlQ2hhaW5WYWxpZGF0aW9uRW5naW5lLCBDZXJ0aWZpY2F0ZVBvbGljaWVzLCBDZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0LCBDZXJ0aWZpY2F0ZVNldCwgQ2VydGlmaWNhdGVUZW1wbGF0ZSwgQ2VydGlmaWNhdGlvblJlcXVlc3QsIENoYWluVmFsaWRhdGlvbkNvZGUsIENoYWluVmFsaWRhdGlvbkVycm9yLCBDb250ZW50SW5mbywgQ3J5cHRvRW5naW5lLCBEaWdlc3RJbmZvLCBEaXN0cmlidXRpb25Qb2ludCwgRUNDQ01TU2hhcmVkSW5mbywgRUNOYW1lZEN1cnZlcywgRUNQcml2YXRlS2V5LCBFQ1B1YmxpY0tleSwgRW5jYXBzdWxhdGVkQ29udGVudEluZm8sIEVuY3J5cHRlZENvbnRlbnRJbmZvLCBFbmNyeXB0ZWREYXRhLCBFbnZlbG9wZWREYXRhLCBFeHRLZXlVc2FnZSwgRXh0ZW5zaW9uLCBFeHRlbnNpb25WYWx1ZUZhY3RvcnksIEV4dGVuc2lvbnMsIEdlbmVyYWxOYW1lLCBHZW5lcmFsTmFtZXMsIEdlbmVyYWxTdWJ0cmVlLCBIQVNIRURfTUVTU0FHRSwgSEFTSF9BTEdPUklUSE0sIEhvbGRlciwgSW5mb0FjY2VzcywgSXNzdWVyQW5kU2VyaWFsTnVtYmVyLCBJc3N1ZXJTZXJpYWwsIElzc3VpbmdEaXN0cmlidXRpb25Qb2ludCwgS0VLSWRlbnRpZmllciwgS0VLUmVjaXBpZW50SW5mbywgS2V5QWdyZWVSZWNpcGllbnRJZGVudGlmaWVyLCBLZXlBZ3JlZVJlY2lwaWVudEluZm8sIEtleUJhZywgS2V5VHJhbnNSZWNpcGllbnRJbmZvLCBNSUNST1MsIE1JTExJUywgTWFjRGF0YSwgTWVzc2FnZUltcHJpbnQsIE5hbWVDb25zdHJhaW50cywgT0NTUFJlcXVlc3QsIE9DU1BSZXNwb25zZSwgT2JqZWN0RGlnZXN0SW5mbywgT3JpZ2luYXRvcklkZW50aWZpZXJPcktleSwgT3JpZ2luYXRvckluZm8sIE9yaWdpbmF0b3JQdWJsaWNLZXksIE90aGVyQ2VydGlmaWNhdGVGb3JtYXQsIE90aGVyS2V5QXR0cmlidXRlLCBPdGhlclByaW1lSW5mbywgT3RoZXJSZWNpcGllbnRJbmZvLCBPdGhlclJldm9jYXRpb25JbmZvRm9ybWF0LCBQQkVTMlBhcmFtcywgUEJLREYyUGFyYW1zLCBQRlgsIFBLQ1M4U2hyb3VkZWRLZXlCYWcsIFBLSVN0YXR1cywgUEtJU3RhdHVzSW5mbywgUE9MSUNZX0lERU5USUZJRVIsIFBPTElDWV9RVUFMSUZJRVJTLCBQYXJhbWV0ZXJFcnJvciwgUGFzc3dvcmRSZWNpcGllbnRpbmZvLCBQa2lPYmplY3QsIFBvbGljeUNvbnN0cmFpbnRzLCBQb2xpY3lJbmZvcm1hdGlvbiwgUG9saWN5TWFwcGluZywgUG9saWN5TWFwcGluZ3MsIFBvbGljeVF1YWxpZmllckluZm8sIFByaXZhdGVLZXlJbmZvLCBQcml2YXRlS2V5VXNhZ2VQZXJpb2QsIFB1YmxpY0tleUluZm8sIFFDU3RhdGVtZW50LCBRQ1N0YXRlbWVudHMsIFJETiwgUlNBRVNPQUVQUGFyYW1zLCBSU0FQcml2YXRlS2V5LCBSU0FQdWJsaWNLZXksIFJTQVNTQVBTU1BhcmFtcywgUmVjaXBpZW50RW5jcnlwdGVkS2V5LCBSZWNpcGllbnRFbmNyeXB0ZWRLZXlzLCBSZWNpcGllbnRJZGVudGlmaWVyLCBSZWNpcGllbnRJbmZvLCBSZWNpcGllbnRLZXlJZGVudGlmaWVyLCBSZWxhdGl2ZURpc3Rpbmd1aXNoZWROYW1lcywgUmVxdWVzdCwgUmVzcG9uc2VCeXRlcywgUmVzcG9uc2VEYXRhLCBSZXZvY2F0aW9uSW5mb0Nob2ljZXMsIFJldm9rZWRDZXJ0aWZpY2F0ZSwgU0VDT05EUywgU2FmZUJhZywgU2FmZUJhZ1ZhbHVlRmFjdG9yeSwgU2FmZUNvbnRlbnRzLCBTZWNyZXRCYWcsIFNpZ25hdHVyZSwgU2lnbmVkQW5kVW5zaWduZWRBdHRyaWJ1dGVzLCBTaWduZWRDZXJ0aWZpY2F0ZVRpbWVzdGFtcCwgU2lnbmVkQ2VydGlmaWNhdGVUaW1lc3RhbXBMaXN0LCBTaWduZWREYXRhLCBTaWduZWREYXRhVmVyaWZ5RXJyb3IsIFNpZ25lckluZm8sIFNpbmdsZVJlc3BvbnNlLCBTdWJqZWN0RGlyZWN0b3J5QXR0cmlidXRlcywgVEJTUmVxdWVzdCwgVFNUSW5mbywgVFlQRSQ0IGFzIFRZUEUsIFRZUEVfQU5EX1ZBTFVFUywgVGltZSwgVGltZVN0YW1wUmVxLCBUaW1lU3RhbXBSZXNwLCBUaW1lVHlwZSwgVjJGb3JtLCBWQUxVRSQ1IGFzIFZBTFVFLCBWQUxVRV9CRUZPUkVfREVDT0RFLCBjaGVja0NBLCBjcmVhdGVDTVNFQ0RTQVNpZ25hdHVyZSwgY3JlYXRlRUNEU0FTaWduYXR1cmVGcm9tQ01TLCBlbmdpbmUsIGdldEFsZ29yaXRobUJ5T0lELCBnZXRBbGdvcml0aG1QYXJhbWV0ZXJzLCBnZXRDcnlwdG8sIGdldEVuZ2luZSwgZ2V0SGFzaEFsZ29yaXRobSwgZ2V0T0lEQnlBbGdvcml0aG0sIGdldFJhbmRvbVZhbHVlcywgaWRfQW55UG9saWN5LCBpZF9BdXRob3JpdHlJbmZvQWNjZXNzLCBpZF9BdXRob3JpdHlLZXlJZGVudGlmaWVyLCBpZF9CYXNlQ1JMTnVtYmVyLCBpZF9CYXNpY0NvbnN0cmFpbnRzLCBpZF9DUkxCYWdfWDUwOUNSTCwgaWRfQ1JMRGlzdHJpYnV0aW9uUG9pbnRzLCBpZF9DUkxOdW1iZXIsIGlkX0NSTFJlYXNvbiwgaWRfQ2VydEJhZ19BdHRyaWJ1dGVDZXJ0aWZpY2F0ZSwgaWRfQ2VydEJhZ19TRFNJQ2VydGlmaWNhdGUsIGlkX0NlcnRCYWdfWDUwOUNlcnRpZmljYXRlLCBpZF9DZXJ0aWZpY2F0ZUlzc3VlciwgaWRfQ2VydGlmaWNhdGVQb2xpY2llcywgaWRfQ29udGVudFR5cGVfRGF0YSwgaWRfQ29udGVudFR5cGVfRW5jcnlwdGVkRGF0YSwgaWRfQ29udGVudFR5cGVfRW52ZWxvcGVkRGF0YSwgaWRfQ29udGVudFR5cGVfU2lnbmVkRGF0YSwgaWRfRXh0S2V5VXNhZ2UsIGlkX0ZyZXNoZXN0Q1JMLCBpZF9JbmhpYml0QW55UG9saWN5LCBpZF9JbnZhbGlkaXR5RGF0ZSwgaWRfSXNzdWVyQWx0TmFtZSwgaWRfSXNzdWluZ0Rpc3RyaWJ1dGlvblBvaW50LCBpZF9LZXlVc2FnZSwgaWRfTWljcm9zb2Z0QXBwUG9saWNpZXMsIGlkX01pY3Jvc29mdENhVmVyc2lvbiwgaWRfTWljcm9zb2Z0Q2VydFRlbXBsYXRlVjEsIGlkX01pY3Jvc29mdENlcnRUZW1wbGF0ZVYyLCBpZF9NaWNyb3NvZnRQcmV2Q2FDZXJ0SGFzaCwgaWRfTmFtZUNvbnN0cmFpbnRzLCBpZF9QS0lYX09DU1BfQmFzaWMsIGlkX1BvbGljeUNvbnN0cmFpbnRzLCBpZF9Qb2xpY3lNYXBwaW5ncywgaWRfUHJpdmF0ZUtleVVzYWdlUGVyaW9kLCBpZF9RQ1N0YXRlbWVudHMsIGlkX1NpZ25lZENlcnRpZmljYXRlVGltZXN0YW1wTGlzdCwgaWRfU3ViamVjdEFsdE5hbWUsIGlkX1N1YmplY3REaXJlY3RvcnlBdHRyaWJ1dGVzLCBpZF9TdWJqZWN0SW5mb0FjY2VzcywgaWRfU3ViamVjdEtleUlkZW50aWZpZXIsIGlkX2FkLCBpZF9hZF9jYUlzc3VlcnMsIGlkX2FkX29jc3AsIGlkX2VDb250ZW50VHlwZV9UU1RJbmZvLCBpZF9wa2l4LCBpZF9zaGExLCBpZF9zaGEyNTYsIGlkX3NoYTM4NCwgaWRfc2hhNTEyLCBrZGYsIHNldEVuZ2luZSwgc3RyaW5nUHJlcCwgdmVyaWZ5U0NUc0ZvckNlcnRpZmljYXRlIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/pkijs/build/index.es.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/_assert.js":
/*!**********************************************************************!*\
  !*** ./node_modules/pkijs/node_modules/@noble/hashes/esm/_assert.js ***!
  \**********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   bool: () => (/* binding */ bool),\n/* harmony export */   bytes: () => (/* binding */ bytes),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   exists: () => (/* binding */ exists),\n/* harmony export */   hash: () => (/* binding */ hash),\n/* harmony export */   isBytes: () => (/* binding */ isBytes),\n/* harmony export */   number: () => (/* binding */ number),\n/* harmony export */   output: () => (/* binding */ output)\n/* harmony export */ });\nfunction number(n) {\n    if (!Number.isSafeInteger(n) || n < 0)\n        throw new Error(`positive integer expected, not ${n}`);\n}\nfunction bool(b) {\n    if (typeof b !== 'boolean')\n        throw new Error(`boolean expected, not ${b}`);\n}\n// copied from utils\nfunction isBytes(a) {\n    return (a instanceof Uint8Array ||\n        (a != null && typeof a === 'object' && a.constructor.name === 'Uint8Array'));\n}\nfunction bytes(b, ...lengths) {\n    if (!isBytes(b))\n        throw new Error('Uint8Array expected');\n    if (lengths.length > 0 && !lengths.includes(b.length))\n        throw new Error(`Uint8Array expected of length ${lengths}, not of length=${b.length}`);\n}\nfunction hash(h) {\n    if (typeof h !== 'function' || typeof h.create !== 'function')\n        throw new Error('Hash should be wrapped by utils.wrapConstructor');\n    number(h.outputLen);\n    number(h.blockLen);\n}\nfunction exists(instance, checkFinished = true) {\n    if (instance.destroyed)\n        throw new Error('Hash instance has been destroyed');\n    if (checkFinished && instance.finished)\n        throw new Error('Hash#digest() has already been called');\n}\nfunction output(out, instance) {\n    bytes(out);\n    const min = instance.outputLen;\n    if (out.length < min) {\n        throw new Error(`digestInto() expects output buffer of length at least ${min}`);\n    }\n}\n\nconst assert = { number, bool, bytes, hash, exists, output };\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (assert);\n//# sourceMappingURL=_assert.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvcGtpanMvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL19hc3NlcnQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0EsMERBQTBELEVBQUU7QUFDNUQ7QUFDQTtBQUNBO0FBQ0EsaURBQWlELEVBQUU7QUFDbkQ7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBeUQsUUFBUSxrQkFBa0IsU0FBUztBQUM1RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUZBQWlGLElBQUk7QUFDckY7QUFDQTtBQUNxRDtBQUNyRCxpQkFBaUI7QUFDakIsaUVBQWUsTUFBTSxFQUFDO0FBQ3RCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VsZi13b3Jrc2hvcC8uL25vZGVfbW9kdWxlcy9wa2lqcy9ub2RlX21vZHVsZXMvQG5vYmxlL2hhc2hlcy9lc20vX2Fzc2VydC5qcz8wZWI2Il0sInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIG51bWJlcihuKSB7XG4gICAgaWYgKCFOdW1iZXIuaXNTYWZlSW50ZWdlcihuKSB8fCBuIDwgMClcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBwb3NpdGl2ZSBpbnRlZ2VyIGV4cGVjdGVkLCBub3QgJHtufWApO1xufVxuZnVuY3Rpb24gYm9vbChiKSB7XG4gICAgaWYgKHR5cGVvZiBiICE9PSAnYm9vbGVhbicpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgYm9vbGVhbiBleHBlY3RlZCwgbm90ICR7Yn1gKTtcbn1cbi8vIGNvcGllZCBmcm9tIHV0aWxzXG5leHBvcnQgZnVuY3Rpb24gaXNCeXRlcyhhKSB7XG4gICAgcmV0dXJuIChhIGluc3RhbmNlb2YgVWludDhBcnJheSB8fFxuICAgICAgICAoYSAhPSBudWxsICYmIHR5cGVvZiBhID09PSAnb2JqZWN0JyAmJiBhLmNvbnN0cnVjdG9yLm5hbWUgPT09ICdVaW50OEFycmF5JykpO1xufVxuZnVuY3Rpb24gYnl0ZXMoYiwgLi4ubGVuZ3Rocykge1xuICAgIGlmICghaXNCeXRlcyhiKSlcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVaW50OEFycmF5IGV4cGVjdGVkJyk7XG4gICAgaWYgKGxlbmd0aHMubGVuZ3RoID4gMCAmJiAhbGVuZ3Rocy5pbmNsdWRlcyhiLmxlbmd0aCkpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVWludDhBcnJheSBleHBlY3RlZCBvZiBsZW5ndGggJHtsZW5ndGhzfSwgbm90IG9mIGxlbmd0aD0ke2IubGVuZ3RofWApO1xufVxuZnVuY3Rpb24gaGFzaChoKSB7XG4gICAgaWYgKHR5cGVvZiBoICE9PSAnZnVuY3Rpb24nIHx8IHR5cGVvZiBoLmNyZWF0ZSAhPT0gJ2Z1bmN0aW9uJylcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdIYXNoIHNob3VsZCBiZSB3cmFwcGVkIGJ5IHV0aWxzLndyYXBDb25zdHJ1Y3RvcicpO1xuICAgIG51bWJlcihoLm91dHB1dExlbik7XG4gICAgbnVtYmVyKGguYmxvY2tMZW4pO1xufVxuZnVuY3Rpb24gZXhpc3RzKGluc3RhbmNlLCBjaGVja0ZpbmlzaGVkID0gdHJ1ZSkge1xuICAgIGlmIChpbnN0YW5jZS5kZXN0cm95ZWQpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSGFzaCBpbnN0YW5jZSBoYXMgYmVlbiBkZXN0cm95ZWQnKTtcbiAgICBpZiAoY2hlY2tGaW5pc2hlZCAmJiBpbnN0YW5jZS5maW5pc2hlZClcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdIYXNoI2RpZ2VzdCgpIGhhcyBhbHJlYWR5IGJlZW4gY2FsbGVkJyk7XG59XG5mdW5jdGlvbiBvdXRwdXQob3V0LCBpbnN0YW5jZSkge1xuICAgIGJ5dGVzKG91dCk7XG4gICAgY29uc3QgbWluID0gaW5zdGFuY2Uub3V0cHV0TGVuO1xuICAgIGlmIChvdXQubGVuZ3RoIDwgbWluKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgZGlnZXN0SW50bygpIGV4cGVjdHMgb3V0cHV0IGJ1ZmZlciBvZiBsZW5ndGggYXQgbGVhc3QgJHttaW59YCk7XG4gICAgfVxufVxuZXhwb3J0IHsgbnVtYmVyLCBib29sLCBieXRlcywgaGFzaCwgZXhpc3RzLCBvdXRwdXQgfTtcbmNvbnN0IGFzc2VydCA9IHsgbnVtYmVyLCBib29sLCBieXRlcywgaGFzaCwgZXhpc3RzLCBvdXRwdXQgfTtcbmV4cG9ydCBkZWZhdWx0IGFzc2VydDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPV9hc3NlcnQuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/_assert.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/_md.js":
/*!******************************************************************!*\
  !*** ./node_modules/pkijs/node_modules/@noble/hashes/esm/_md.js ***!
  \******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Chi: () => (/* binding */ Chi),\n/* harmony export */   HashMD: () => (/* binding */ HashMD),\n/* harmony export */   Maj: () => (/* binding */ Maj)\n/* harmony export */ });\n/* harmony import */ var _assert_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./_assert.js */ \"(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/_assert.js\");\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils.js */ \"(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/utils.js\");\n\n\n// Polyfill for Safari 14\nfunction setBigUint64(view, byteOffset, value, isLE) {\n    if (typeof view.setBigUint64 === 'function')\n        return view.setBigUint64(byteOffset, value, isLE);\n    const _32n = BigInt(32);\n    const _u32_max = BigInt(0xffffffff);\n    const wh = Number((value >> _32n) & _u32_max);\n    const wl = Number(value & _u32_max);\n    const h = isLE ? 4 : 0;\n    const l = isLE ? 0 : 4;\n    view.setUint32(byteOffset + h, wh, isLE);\n    view.setUint32(byteOffset + l, wl, isLE);\n}\n// Choice: a ? b : c\nconst Chi = (a, b, c) => (a & b) ^ (~a & c);\n// Majority function, true if any two inpust is true\nconst Maj = (a, b, c) => (a & b) ^ (a & c) ^ (b & c);\n/**\n * Merkle-Damgard hash construction base class.\n * Could be used to create MD5, RIPEMD, SHA1, SHA2.\n */\nclass HashMD extends _utils_js__WEBPACK_IMPORTED_MODULE_0__.Hash {\n    constructor(blockLen, outputLen, padOffset, isLE) {\n        super();\n        this.blockLen = blockLen;\n        this.outputLen = outputLen;\n        this.padOffset = padOffset;\n        this.isLE = isLE;\n        this.finished = false;\n        this.length = 0;\n        this.pos = 0;\n        this.destroyed = false;\n        this.buffer = new Uint8Array(blockLen);\n        this.view = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.createView)(this.buffer);\n    }\n    update(data) {\n        (0,_assert_js__WEBPACK_IMPORTED_MODULE_1__.exists)(this);\n        const { view, buffer, blockLen } = this;\n        data = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.toBytes)(data);\n        const len = data.length;\n        for (let pos = 0; pos < len;) {\n            const take = Math.min(blockLen - this.pos, len - pos);\n            // Fast path: we have at least one block in input, cast it to view and process\n            if (take === blockLen) {\n                const dataView = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.createView)(data);\n                for (; blockLen <= len - pos; pos += blockLen)\n                    this.process(dataView, pos);\n                continue;\n            }\n            buffer.set(data.subarray(pos, pos + take), this.pos);\n            this.pos += take;\n            pos += take;\n            if (this.pos === blockLen) {\n                this.process(view, 0);\n                this.pos = 0;\n            }\n        }\n        this.length += data.length;\n        this.roundClean();\n        return this;\n    }\n    digestInto(out) {\n        (0,_assert_js__WEBPACK_IMPORTED_MODULE_1__.exists)(this);\n        (0,_assert_js__WEBPACK_IMPORTED_MODULE_1__.output)(out, this);\n        this.finished = true;\n        // Padding\n        // We can avoid allocation of buffer for padding completely if it\n        // was previously not allocated here. But it won't change performance.\n        const { buffer, view, blockLen, isLE } = this;\n        let { pos } = this;\n        // append the bit '1' to the message\n        buffer[pos++] = 0b10000000;\n        this.buffer.subarray(pos).fill(0);\n        // we have less than padOffset left in buffer, so we cannot put length in\n        // current block, need process it and pad again\n        if (this.padOffset > blockLen - pos) {\n            this.process(view, 0);\n            pos = 0;\n        }\n        // Pad until full block byte with zeros\n        for (let i = pos; i < blockLen; i++)\n            buffer[i] = 0;\n        // Note: sha512 requires length to be 128bit integer, but length in JS will overflow before that\n        // You need to write around 2 exabytes (u64_max / 8 / (1024**6)) for this to happen.\n        // So we just write lowest 64 bits of that value.\n        setBigUint64(view, blockLen - 8, BigInt(this.length * 8), isLE);\n        this.process(view, 0);\n        const oview = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.createView)(out);\n        const len = this.outputLen;\n        // NOTE: we do division by 4 later, which should be fused in single op with modulo by JIT\n        if (len % 4)\n            throw new Error('_sha2: outputLen should be aligned to 32bit');\n        const outLen = len / 4;\n        const state = this.get();\n        if (outLen > state.length)\n            throw new Error('_sha2: outputLen bigger than state');\n        for (let i = 0; i < outLen; i++)\n            oview.setUint32(4 * i, state[i], isLE);\n    }\n    digest() {\n        const { buffer, outputLen } = this;\n        this.digestInto(buffer);\n        const res = buffer.slice(0, outputLen);\n        this.destroy();\n        return res;\n    }\n    _cloneInto(to) {\n        to || (to = new this.constructor());\n        to.set(...this.get());\n        const { blockLen, buffer, length, finished, destroyed, pos } = this;\n        to.length = length;\n        to.pos = pos;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        if (length % blockLen)\n            to.buffer.set(buffer);\n        return to;\n    }\n}\n//# sourceMappingURL=_md.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvcGtpanMvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL19tZC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUE4QztBQUNTO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNPLHFCQUFxQiwyQ0FBSTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLHFEQUFVO0FBQzlCO0FBQ0E7QUFDQSxRQUFRLGtEQUFNO0FBQ2QsZ0JBQWdCLHlCQUF5QjtBQUN6QyxlQUFlLGtEQUFPO0FBQ3RCO0FBQ0EsMEJBQTBCLFVBQVU7QUFDcEM7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLHFEQUFVO0FBQzNDLHVCQUF1Qix1QkFBdUI7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLGtEQUFNO0FBQ2QsUUFBUSxrREFBTTtBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLCtCQUErQjtBQUMvQyxjQUFjLE1BQU07QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsY0FBYztBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IscURBQVU7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixZQUFZO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixvQkFBb0I7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixxREFBcUQ7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZWxmLXdvcmtzaG9wLy4vbm9kZV9tb2R1bGVzL3BraWpzL25vZGVfbW9kdWxlcy9Abm9ibGUvaGFzaGVzL2VzbS9fbWQuanM/MGU5ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBleGlzdHMsIG91dHB1dCB9IGZyb20gJy4vX2Fzc2VydC5qcyc7XG5pbXBvcnQgeyBIYXNoLCBjcmVhdGVWaWV3LCB0b0J5dGVzIH0gZnJvbSAnLi91dGlscy5qcyc7XG4vLyBQb2x5ZmlsbCBmb3IgU2FmYXJpIDE0XG5mdW5jdGlvbiBzZXRCaWdVaW50NjQodmlldywgYnl0ZU9mZnNldCwgdmFsdWUsIGlzTEUpIHtcbiAgICBpZiAodHlwZW9mIHZpZXcuc2V0QmlnVWludDY0ID09PSAnZnVuY3Rpb24nKVxuICAgICAgICByZXR1cm4gdmlldy5zZXRCaWdVaW50NjQoYnl0ZU9mZnNldCwgdmFsdWUsIGlzTEUpO1xuICAgIGNvbnN0IF8zMm4gPSBCaWdJbnQoMzIpO1xuICAgIGNvbnN0IF91MzJfbWF4ID0gQmlnSW50KDB4ZmZmZmZmZmYpO1xuICAgIGNvbnN0IHdoID0gTnVtYmVyKCh2YWx1ZSA+PiBfMzJuKSAmIF91MzJfbWF4KTtcbiAgICBjb25zdCB3bCA9IE51bWJlcih2YWx1ZSAmIF91MzJfbWF4KTtcbiAgICBjb25zdCBoID0gaXNMRSA/IDQgOiAwO1xuICAgIGNvbnN0IGwgPSBpc0xFID8gMCA6IDQ7XG4gICAgdmlldy5zZXRVaW50MzIoYnl0ZU9mZnNldCArIGgsIHdoLCBpc0xFKTtcbiAgICB2aWV3LnNldFVpbnQzMihieXRlT2Zmc2V0ICsgbCwgd2wsIGlzTEUpO1xufVxuLy8gQ2hvaWNlOiBhID8gYiA6IGNcbmV4cG9ydCBjb25zdCBDaGkgPSAoYSwgYiwgYykgPT4gKGEgJiBiKSBeICh+YSAmIGMpO1xuLy8gTWFqb3JpdHkgZnVuY3Rpb24sIHRydWUgaWYgYW55IHR3byBpbnB1c3QgaXMgdHJ1ZVxuZXhwb3J0IGNvbnN0IE1haiA9IChhLCBiLCBjKSA9PiAoYSAmIGIpIF4gKGEgJiBjKSBeIChiICYgYyk7XG4vKipcbiAqIE1lcmtsZS1EYW1nYXJkIGhhc2ggY29uc3RydWN0aW9uIGJhc2UgY2xhc3MuXG4gKiBDb3VsZCBiZSB1c2VkIHRvIGNyZWF0ZSBNRDUsIFJJUEVNRCwgU0hBMSwgU0hBMi5cbiAqL1xuZXhwb3J0IGNsYXNzIEhhc2hNRCBleHRlbmRzIEhhc2gge1xuICAgIGNvbnN0cnVjdG9yKGJsb2NrTGVuLCBvdXRwdXRMZW4sIHBhZE9mZnNldCwgaXNMRSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmJsb2NrTGVuID0gYmxvY2tMZW47XG4gICAgICAgIHRoaXMub3V0cHV0TGVuID0gb3V0cHV0TGVuO1xuICAgICAgICB0aGlzLnBhZE9mZnNldCA9IHBhZE9mZnNldDtcbiAgICAgICAgdGhpcy5pc0xFID0gaXNMRTtcbiAgICAgICAgdGhpcy5maW5pc2hlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMucG9zID0gMDtcbiAgICAgICAgdGhpcy5kZXN0cm95ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5idWZmZXIgPSBuZXcgVWludDhBcnJheShibG9ja0xlbik7XG4gICAgICAgIHRoaXMudmlldyA9IGNyZWF0ZVZpZXcodGhpcy5idWZmZXIpO1xuICAgIH1cbiAgICB1cGRhdGUoZGF0YSkge1xuICAgICAgICBleGlzdHModGhpcyk7XG4gICAgICAgIGNvbnN0IHsgdmlldywgYnVmZmVyLCBibG9ja0xlbiB9ID0gdGhpcztcbiAgICAgICAgZGF0YSA9IHRvQnl0ZXMoZGF0YSk7XG4gICAgICAgIGNvbnN0IGxlbiA9IGRhdGEubGVuZ3RoO1xuICAgICAgICBmb3IgKGxldCBwb3MgPSAwOyBwb3MgPCBsZW47KSB7XG4gICAgICAgICAgICBjb25zdCB0YWtlID0gTWF0aC5taW4oYmxvY2tMZW4gLSB0aGlzLnBvcywgbGVuIC0gcG9zKTtcbiAgICAgICAgICAgIC8vIEZhc3QgcGF0aDogd2UgaGF2ZSBhdCBsZWFzdCBvbmUgYmxvY2sgaW4gaW5wdXQsIGNhc3QgaXQgdG8gdmlldyBhbmQgcHJvY2Vzc1xuICAgICAgICAgICAgaWYgKHRha2UgPT09IGJsb2NrTGVuKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGF0YVZpZXcgPSBjcmVhdGVWaWV3KGRhdGEpO1xuICAgICAgICAgICAgICAgIGZvciAoOyBibG9ja0xlbiA8PSBsZW4gLSBwb3M7IHBvcyArPSBibG9ja0xlbilcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzKGRhdGFWaWV3LCBwb3MpO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnVmZmVyLnNldChkYXRhLnN1YmFycmF5KHBvcywgcG9zICsgdGFrZSksIHRoaXMucG9zKTtcbiAgICAgICAgICAgIHRoaXMucG9zICs9IHRha2U7XG4gICAgICAgICAgICBwb3MgKz0gdGFrZTtcbiAgICAgICAgICAgIGlmICh0aGlzLnBvcyA9PT0gYmxvY2tMZW4pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByb2Nlc3ModmlldywgMCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wb3MgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMubGVuZ3RoICs9IGRhdGEubGVuZ3RoO1xuICAgICAgICB0aGlzLnJvdW5kQ2xlYW4oKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGRpZ2VzdEludG8ob3V0KSB7XG4gICAgICAgIGV4aXN0cyh0aGlzKTtcbiAgICAgICAgb3V0cHV0KG91dCwgdGhpcyk7XG4gICAgICAgIHRoaXMuZmluaXNoZWQgPSB0cnVlO1xuICAgICAgICAvLyBQYWRkaW5nXG4gICAgICAgIC8vIFdlIGNhbiBhdm9pZCBhbGxvY2F0aW9uIG9mIGJ1ZmZlciBmb3IgcGFkZGluZyBjb21wbGV0ZWx5IGlmIGl0XG4gICAgICAgIC8vIHdhcyBwcmV2aW91c2x5IG5vdCBhbGxvY2F0ZWQgaGVyZS4gQnV0IGl0IHdvbid0IGNoYW5nZSBwZXJmb3JtYW5jZS5cbiAgICAgICAgY29uc3QgeyBidWZmZXIsIHZpZXcsIGJsb2NrTGVuLCBpc0xFIH0gPSB0aGlzO1xuICAgICAgICBsZXQgeyBwb3MgfSA9IHRoaXM7XG4gICAgICAgIC8vIGFwcGVuZCB0aGUgYml0ICcxJyB0byB0aGUgbWVzc2FnZVxuICAgICAgICBidWZmZXJbcG9zKytdID0gMGIxMDAwMDAwMDtcbiAgICAgICAgdGhpcy5idWZmZXIuc3ViYXJyYXkocG9zKS5maWxsKDApO1xuICAgICAgICAvLyB3ZSBoYXZlIGxlc3MgdGhhbiBwYWRPZmZzZXQgbGVmdCBpbiBidWZmZXIsIHNvIHdlIGNhbm5vdCBwdXQgbGVuZ3RoIGluXG4gICAgICAgIC8vIGN1cnJlbnQgYmxvY2ssIG5lZWQgcHJvY2VzcyBpdCBhbmQgcGFkIGFnYWluXG4gICAgICAgIGlmICh0aGlzLnBhZE9mZnNldCA+IGJsb2NrTGVuIC0gcG9zKSB7XG4gICAgICAgICAgICB0aGlzLnByb2Nlc3ModmlldywgMCk7XG4gICAgICAgICAgICBwb3MgPSAwO1xuICAgICAgICB9XG4gICAgICAgIC8vIFBhZCB1bnRpbCBmdWxsIGJsb2NrIGJ5dGUgd2l0aCB6ZXJvc1xuICAgICAgICBmb3IgKGxldCBpID0gcG9zOyBpIDwgYmxvY2tMZW47IGkrKylcbiAgICAgICAgICAgIGJ1ZmZlcltpXSA9IDA7XG4gICAgICAgIC8vIE5vdGU6IHNoYTUxMiByZXF1aXJlcyBsZW5ndGggdG8gYmUgMTI4Yml0IGludGVnZXIsIGJ1dCBsZW5ndGggaW4gSlMgd2lsbCBvdmVyZmxvdyBiZWZvcmUgdGhhdFxuICAgICAgICAvLyBZb3UgbmVlZCB0byB3cml0ZSBhcm91bmQgMiBleGFieXRlcyAodTY0X21heCAvIDggLyAoMTAyNCoqNikpIGZvciB0aGlzIHRvIGhhcHBlbi5cbiAgICAgICAgLy8gU28gd2UganVzdCB3cml0ZSBsb3dlc3QgNjQgYml0cyBvZiB0aGF0IHZhbHVlLlxuICAgICAgICBzZXRCaWdVaW50NjQodmlldywgYmxvY2tMZW4gLSA4LCBCaWdJbnQodGhpcy5sZW5ndGggKiA4KSwgaXNMRSk7XG4gICAgICAgIHRoaXMucHJvY2Vzcyh2aWV3LCAwKTtcbiAgICAgICAgY29uc3Qgb3ZpZXcgPSBjcmVhdGVWaWV3KG91dCk7XG4gICAgICAgIGNvbnN0IGxlbiA9IHRoaXMub3V0cHV0TGVuO1xuICAgICAgICAvLyBOT1RFOiB3ZSBkbyBkaXZpc2lvbiBieSA0IGxhdGVyLCB3aGljaCBzaG91bGQgYmUgZnVzZWQgaW4gc2luZ2xlIG9wIHdpdGggbW9kdWxvIGJ5IEpJVFxuICAgICAgICBpZiAobGVuICUgNClcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignX3NoYTI6IG91dHB1dExlbiBzaG91bGQgYmUgYWxpZ25lZCB0byAzMmJpdCcpO1xuICAgICAgICBjb25zdCBvdXRMZW4gPSBsZW4gLyA0O1xuICAgICAgICBjb25zdCBzdGF0ZSA9IHRoaXMuZ2V0KCk7XG4gICAgICAgIGlmIChvdXRMZW4gPiBzdGF0ZS5sZW5ndGgpXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ19zaGEyOiBvdXRwdXRMZW4gYmlnZ2VyIHRoYW4gc3RhdGUnKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvdXRMZW47IGkrKylcbiAgICAgICAgICAgIG92aWV3LnNldFVpbnQzMig0ICogaSwgc3RhdGVbaV0sIGlzTEUpO1xuICAgIH1cbiAgICBkaWdlc3QoKSB7XG4gICAgICAgIGNvbnN0IHsgYnVmZmVyLCBvdXRwdXRMZW4gfSA9IHRoaXM7XG4gICAgICAgIHRoaXMuZGlnZXN0SW50byhidWZmZXIpO1xuICAgICAgICBjb25zdCByZXMgPSBidWZmZXIuc2xpY2UoMCwgb3V0cHV0TGVuKTtcbiAgICAgICAgdGhpcy5kZXN0cm95KCk7XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxuICAgIF9jbG9uZUludG8odG8pIHtcbiAgICAgICAgdG8gfHwgKHRvID0gbmV3IHRoaXMuY29uc3RydWN0b3IoKSk7XG4gICAgICAgIHRvLnNldCguLi50aGlzLmdldCgpKTtcbiAgICAgICAgY29uc3QgeyBibG9ja0xlbiwgYnVmZmVyLCBsZW5ndGgsIGZpbmlzaGVkLCBkZXN0cm95ZWQsIHBvcyB9ID0gdGhpcztcbiAgICAgICAgdG8ubGVuZ3RoID0gbGVuZ3RoO1xuICAgICAgICB0by5wb3MgPSBwb3M7XG4gICAgICAgIHRvLmZpbmlzaGVkID0gZmluaXNoZWQ7XG4gICAgICAgIHRvLmRlc3Ryb3llZCA9IGRlc3Ryb3llZDtcbiAgICAgICAgaWYgKGxlbmd0aCAlIGJsb2NrTGVuKVxuICAgICAgICAgICAgdG8uYnVmZmVyLnNldChidWZmZXIpO1xuICAgICAgICByZXR1cm4gdG87XG4gICAgfVxufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9X21kLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/_md.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/_u64.js":
/*!*******************************************************************!*\
  !*** ./node_modules/pkijs/node_modules/@noble/hashes/esm/_u64.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   add: () => (/* binding */ add),\n/* harmony export */   add3H: () => (/* binding */ add3H),\n/* harmony export */   add3L: () => (/* binding */ add3L),\n/* harmony export */   add4H: () => (/* binding */ add4H),\n/* harmony export */   add4L: () => (/* binding */ add4L),\n/* harmony export */   add5H: () => (/* binding */ add5H),\n/* harmony export */   add5L: () => (/* binding */ add5L),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   fromBig: () => (/* binding */ fromBig),\n/* harmony export */   rotlBH: () => (/* binding */ rotlBH),\n/* harmony export */   rotlBL: () => (/* binding */ rotlBL),\n/* harmony export */   rotlSH: () => (/* binding */ rotlSH),\n/* harmony export */   rotlSL: () => (/* binding */ rotlSL),\n/* harmony export */   rotr32H: () => (/* binding */ rotr32H),\n/* harmony export */   rotr32L: () => (/* binding */ rotr32L),\n/* harmony export */   rotrBH: () => (/* binding */ rotrBH),\n/* harmony export */   rotrBL: () => (/* binding */ rotrBL),\n/* harmony export */   rotrSH: () => (/* binding */ rotrSH),\n/* harmony export */   rotrSL: () => (/* binding */ rotrSL),\n/* harmony export */   shrSH: () => (/* binding */ shrSH),\n/* harmony export */   shrSL: () => (/* binding */ shrSL),\n/* harmony export */   split: () => (/* binding */ split),\n/* harmony export */   toBig: () => (/* binding */ toBig)\n/* harmony export */ });\nconst U32_MASK64 = /* @__PURE__ */ BigInt(2 ** 32 - 1);\nconst _32n = /* @__PURE__ */ BigInt(32);\n// We are not using BigUint64Array, because they are extremely slow as per 2022\nfunction fromBig(n, le = false) {\n    if (le)\n        return { h: Number(n & U32_MASK64), l: Number((n >> _32n) & U32_MASK64) };\n    return { h: Number((n >> _32n) & U32_MASK64) | 0, l: Number(n & U32_MASK64) | 0 };\n}\nfunction split(lst, le = false) {\n    let Ah = new Uint32Array(lst.length);\n    let Al = new Uint32Array(lst.length);\n    for (let i = 0; i < lst.length; i++) {\n        const { h, l } = fromBig(lst[i], le);\n        [Ah[i], Al[i]] = [h, l];\n    }\n    return [Ah, Al];\n}\nconst toBig = (h, l) => (BigInt(h >>> 0) << _32n) | BigInt(l >>> 0);\n// for Shift in [0, 32)\nconst shrSH = (h, _l, s) => h >>> s;\nconst shrSL = (h, l, s) => (h << (32 - s)) | (l >>> s);\n// Right rotate for Shift in [1, 32)\nconst rotrSH = (h, l, s) => (h >>> s) | (l << (32 - s));\nconst rotrSL = (h, l, s) => (h << (32 - s)) | (l >>> s);\n// Right rotate for Shift in (32, 64), NOTE: 32 is special case.\nconst rotrBH = (h, l, s) => (h << (64 - s)) | (l >>> (s - 32));\nconst rotrBL = (h, l, s) => (h >>> (s - 32)) | (l << (64 - s));\n// Right rotate for shift===32 (just swaps l&h)\nconst rotr32H = (_h, l) => l;\nconst rotr32L = (h, _l) => h;\n// Left rotate for Shift in [1, 32)\nconst rotlSH = (h, l, s) => (h << s) | (l >>> (32 - s));\nconst rotlSL = (h, l, s) => (l << s) | (h >>> (32 - s));\n// Left rotate for Shift in (32, 64), NOTE: 32 is special case.\nconst rotlBH = (h, l, s) => (l << (s - 32)) | (h >>> (64 - s));\nconst rotlBL = (h, l, s) => (h << (s - 32)) | (l >>> (64 - s));\n// JS uses 32-bit signed integers for bitwise operations which means we cannot\n// simple take carry out of low bit sum by shift, we need to use division.\nfunction add(Ah, Al, Bh, Bl) {\n    const l = (Al >>> 0) + (Bl >>> 0);\n    return { h: (Ah + Bh + ((l / 2 ** 32) | 0)) | 0, l: l | 0 };\n}\n// Addition with more than 2 elements\nconst add3L = (Al, Bl, Cl) => (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0);\nconst add3H = (low, Ah, Bh, Ch) => (Ah + Bh + Ch + ((low / 2 ** 32) | 0)) | 0;\nconst add4L = (Al, Bl, Cl, Dl) => (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0) + (Dl >>> 0);\nconst add4H = (low, Ah, Bh, Ch, Dh) => (Ah + Bh + Ch + Dh + ((low / 2 ** 32) | 0)) | 0;\nconst add5L = (Al, Bl, Cl, Dl, El) => (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0) + (Dl >>> 0) + (El >>> 0);\nconst add5H = (low, Ah, Bh, Ch, Dh, Eh) => (Ah + Bh + Ch + Dh + Eh + ((low / 2 ** 32) | 0)) | 0;\n// prettier-ignore\n\n// prettier-ignore\nconst u64 = {\n    fromBig, split, toBig,\n    shrSH, shrSL,\n    rotrSH, rotrSL, rotrBH, rotrBL,\n    rotr32H, rotr32L,\n    rotlSH, rotlSL, rotlBH, rotlBL,\n    add, add3L, add3H, add4L, add4H, add5H, add5L,\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (u64);\n//# sourceMappingURL=_u64.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvcGtpanMvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL191NjQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixnQkFBZ0I7QUFDcEMsZ0JBQWdCLE9BQU87QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNpTDtBQUNqTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRUFBZSxHQUFHLEVBQUM7QUFDbkIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZWxmLXdvcmtzaG9wLy4vbm9kZV9tb2R1bGVzL3BraWpzL25vZGVfbW9kdWxlcy9Abm9ibGUvaGFzaGVzL2VzbS9fdTY0LmpzPzExYzIiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgVTMyX01BU0s2NCA9IC8qIEBfX1BVUkVfXyAqLyBCaWdJbnQoMiAqKiAzMiAtIDEpO1xuY29uc3QgXzMybiA9IC8qIEBfX1BVUkVfXyAqLyBCaWdJbnQoMzIpO1xuLy8gV2UgYXJlIG5vdCB1c2luZyBCaWdVaW50NjRBcnJheSwgYmVjYXVzZSB0aGV5IGFyZSBleHRyZW1lbHkgc2xvdyBhcyBwZXIgMjAyMlxuZnVuY3Rpb24gZnJvbUJpZyhuLCBsZSA9IGZhbHNlKSB7XG4gICAgaWYgKGxlKVxuICAgICAgICByZXR1cm4geyBoOiBOdW1iZXIobiAmIFUzMl9NQVNLNjQpLCBsOiBOdW1iZXIoKG4gPj4gXzMybikgJiBVMzJfTUFTSzY0KSB9O1xuICAgIHJldHVybiB7IGg6IE51bWJlcigobiA+PiBfMzJuKSAmIFUzMl9NQVNLNjQpIHwgMCwgbDogTnVtYmVyKG4gJiBVMzJfTUFTSzY0KSB8IDAgfTtcbn1cbmZ1bmN0aW9uIHNwbGl0KGxzdCwgbGUgPSBmYWxzZSkge1xuICAgIGxldCBBaCA9IG5ldyBVaW50MzJBcnJheShsc3QubGVuZ3RoKTtcbiAgICBsZXQgQWwgPSBuZXcgVWludDMyQXJyYXkobHN0Lmxlbmd0aCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgeyBoLCBsIH0gPSBmcm9tQmlnKGxzdFtpXSwgbGUpO1xuICAgICAgICBbQWhbaV0sIEFsW2ldXSA9IFtoLCBsXTtcbiAgICB9XG4gICAgcmV0dXJuIFtBaCwgQWxdO1xufVxuY29uc3QgdG9CaWcgPSAoaCwgbCkgPT4gKEJpZ0ludChoID4+PiAwKSA8PCBfMzJuKSB8IEJpZ0ludChsID4+PiAwKTtcbi8vIGZvciBTaGlmdCBpbiBbMCwgMzIpXG5jb25zdCBzaHJTSCA9IChoLCBfbCwgcykgPT4gaCA+Pj4gcztcbmNvbnN0IHNoclNMID0gKGgsIGwsIHMpID0+IChoIDw8ICgzMiAtIHMpKSB8IChsID4+PiBzKTtcbi8vIFJpZ2h0IHJvdGF0ZSBmb3IgU2hpZnQgaW4gWzEsIDMyKVxuY29uc3Qgcm90clNIID0gKGgsIGwsIHMpID0+IChoID4+PiBzKSB8IChsIDw8ICgzMiAtIHMpKTtcbmNvbnN0IHJvdHJTTCA9IChoLCBsLCBzKSA9PiAoaCA8PCAoMzIgLSBzKSkgfCAobCA+Pj4gcyk7XG4vLyBSaWdodCByb3RhdGUgZm9yIFNoaWZ0IGluICgzMiwgNjQpLCBOT1RFOiAzMiBpcyBzcGVjaWFsIGNhc2UuXG5jb25zdCByb3RyQkggPSAoaCwgbCwgcykgPT4gKGggPDwgKDY0IC0gcykpIHwgKGwgPj4+IChzIC0gMzIpKTtcbmNvbnN0IHJvdHJCTCA9IChoLCBsLCBzKSA9PiAoaCA+Pj4gKHMgLSAzMikpIHwgKGwgPDwgKDY0IC0gcykpO1xuLy8gUmlnaHQgcm90YXRlIGZvciBzaGlmdD09PTMyIChqdXN0IHN3YXBzIGwmaClcbmNvbnN0IHJvdHIzMkggPSAoX2gsIGwpID0+IGw7XG5jb25zdCByb3RyMzJMID0gKGgsIF9sKSA9PiBoO1xuLy8gTGVmdCByb3RhdGUgZm9yIFNoaWZ0IGluIFsxLCAzMilcbmNvbnN0IHJvdGxTSCA9IChoLCBsLCBzKSA9PiAoaCA8PCBzKSB8IChsID4+PiAoMzIgLSBzKSk7XG5jb25zdCByb3RsU0wgPSAoaCwgbCwgcykgPT4gKGwgPDwgcykgfCAoaCA+Pj4gKDMyIC0gcykpO1xuLy8gTGVmdCByb3RhdGUgZm9yIFNoaWZ0IGluICgzMiwgNjQpLCBOT1RFOiAzMiBpcyBzcGVjaWFsIGNhc2UuXG5jb25zdCByb3RsQkggPSAoaCwgbCwgcykgPT4gKGwgPDwgKHMgLSAzMikpIHwgKGggPj4+ICg2NCAtIHMpKTtcbmNvbnN0IHJvdGxCTCA9IChoLCBsLCBzKSA9PiAoaCA8PCAocyAtIDMyKSkgfCAobCA+Pj4gKDY0IC0gcykpO1xuLy8gSlMgdXNlcyAzMi1iaXQgc2lnbmVkIGludGVnZXJzIGZvciBiaXR3aXNlIG9wZXJhdGlvbnMgd2hpY2ggbWVhbnMgd2UgY2Fubm90XG4vLyBzaW1wbGUgdGFrZSBjYXJyeSBvdXQgb2YgbG93IGJpdCBzdW0gYnkgc2hpZnQsIHdlIG5lZWQgdG8gdXNlIGRpdmlzaW9uLlxuZnVuY3Rpb24gYWRkKEFoLCBBbCwgQmgsIEJsKSB7XG4gICAgY29uc3QgbCA9IChBbCA+Pj4gMCkgKyAoQmwgPj4+IDApO1xuICAgIHJldHVybiB7IGg6IChBaCArIEJoICsgKChsIC8gMiAqKiAzMikgfCAwKSkgfCAwLCBsOiBsIHwgMCB9O1xufVxuLy8gQWRkaXRpb24gd2l0aCBtb3JlIHRoYW4gMiBlbGVtZW50c1xuY29uc3QgYWRkM0wgPSAoQWwsIEJsLCBDbCkgPT4gKEFsID4+PiAwKSArIChCbCA+Pj4gMCkgKyAoQ2wgPj4+IDApO1xuY29uc3QgYWRkM0ggPSAobG93LCBBaCwgQmgsIENoKSA9PiAoQWggKyBCaCArIENoICsgKChsb3cgLyAyICoqIDMyKSB8IDApKSB8IDA7XG5jb25zdCBhZGQ0TCA9IChBbCwgQmwsIENsLCBEbCkgPT4gKEFsID4+PiAwKSArIChCbCA+Pj4gMCkgKyAoQ2wgPj4+IDApICsgKERsID4+PiAwKTtcbmNvbnN0IGFkZDRIID0gKGxvdywgQWgsIEJoLCBDaCwgRGgpID0+IChBaCArIEJoICsgQ2ggKyBEaCArICgobG93IC8gMiAqKiAzMikgfCAwKSkgfCAwO1xuY29uc3QgYWRkNUwgPSAoQWwsIEJsLCBDbCwgRGwsIEVsKSA9PiAoQWwgPj4+IDApICsgKEJsID4+PiAwKSArIChDbCA+Pj4gMCkgKyAoRGwgPj4+IDApICsgKEVsID4+PiAwKTtcbmNvbnN0IGFkZDVIID0gKGxvdywgQWgsIEJoLCBDaCwgRGgsIEVoKSA9PiAoQWggKyBCaCArIENoICsgRGggKyBFaCArICgobG93IC8gMiAqKiAzMikgfCAwKSkgfCAwO1xuLy8gcHJldHRpZXItaWdub3JlXG5leHBvcnQgeyBmcm9tQmlnLCBzcGxpdCwgdG9CaWcsIHNoclNILCBzaHJTTCwgcm90clNILCByb3RyU0wsIHJvdHJCSCwgcm90ckJMLCByb3RyMzJILCByb3RyMzJMLCByb3RsU0gsIHJvdGxTTCwgcm90bEJILCByb3RsQkwsIGFkZCwgYWRkM0wsIGFkZDNILCBhZGQ0TCwgYWRkNEgsIGFkZDVILCBhZGQ1TCwgfTtcbi8vIHByZXR0aWVyLWlnbm9yZVxuY29uc3QgdTY0ID0ge1xuICAgIGZyb21CaWcsIHNwbGl0LCB0b0JpZyxcbiAgICBzaHJTSCwgc2hyU0wsXG4gICAgcm90clNILCByb3RyU0wsIHJvdHJCSCwgcm90ckJMLFxuICAgIHJvdHIzMkgsIHJvdHIzMkwsXG4gICAgcm90bFNILCByb3RsU0wsIHJvdGxCSCwgcm90bEJMLFxuICAgIGFkZCwgYWRkM0wsIGFkZDNILCBhZGQ0TCwgYWRkNEgsIGFkZDVILCBhZGQ1TCxcbn07XG5leHBvcnQgZGVmYXVsdCB1NjQ7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1fdTY0LmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/_u64.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/cryptoNode.js":
/*!*************************************************************************!*\
  !*** ./node_modules/pkijs/node_modules/@noble/hashes/esm/cryptoNode.js ***!
  \*************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("var node_crypto__WEBPACK_IMPORTED_MODULE_0___namespace_cache;\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   crypto: () => (/* binding */ crypto)\n/* harmony export */ });\n/* harmony import */ var node_crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! node:crypto */ \"node:crypto\");\n// We use WebCrypto aka globalThis.crypto, which exists in browsers and node.js 16+.\n// See utils.ts for details.\n// The file will throw on node.js 14 and earlier.\n// @ts-ignore\n\nconst crypto = /*#__PURE__*/ (node_crypto__WEBPACK_IMPORTED_MODULE_0___namespace_cache || (node_crypto__WEBPACK_IMPORTED_MODULE_0___namespace_cache = __webpack_require__.t(node_crypto__WEBPACK_IMPORTED_MODULE_0__, 2))) && typeof /*#__PURE__*/ (node_crypto__WEBPACK_IMPORTED_MODULE_0___namespace_cache || (node_crypto__WEBPACK_IMPORTED_MODULE_0___namespace_cache = __webpack_require__.t(node_crypto__WEBPACK_IMPORTED_MODULE_0__, 2))) === 'object' && \"webcrypto\" in /*#__PURE__*/ (node_crypto__WEBPACK_IMPORTED_MODULE_0___namespace_cache || (node_crypto__WEBPACK_IMPORTED_MODULE_0___namespace_cache = __webpack_require__.t(node_crypto__WEBPACK_IMPORTED_MODULE_0__, 2))) ? node_crypto__WEBPACK_IMPORTED_MODULE_0__.webcrypto : undefined;\n//# sourceMappingURL=cryptoNode.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvcGtpanMvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL2NyeXB0b05vZGUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDa0M7QUFDM0IsZUFBZSwyTUFBRSxXQUFXLDJNQUFFLGlCQUFpQiwwTkFBaUIsR0FBRyxrREFBWTtBQUN0RiIsInNvdXJjZXMiOlsid2VicGFjazovL3NlbGYtd29ya3Nob3AvLi9ub2RlX21vZHVsZXMvcGtpanMvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL2NyeXB0b05vZGUuanM/NWRjYSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBXZSB1c2UgV2ViQ3J5cHRvIGFrYSBnbG9iYWxUaGlzLmNyeXB0bywgd2hpY2ggZXhpc3RzIGluIGJyb3dzZXJzIGFuZCBub2RlLmpzIDE2Ky5cbi8vIFNlZSB1dGlscy50cyBmb3IgZGV0YWlscy5cbi8vIFRoZSBmaWxlIHdpbGwgdGhyb3cgb24gbm9kZS5qcyAxNCBhbmQgZWFybGllci5cbi8vIEB0cy1pZ25vcmVcbmltcG9ydCAqIGFzIG5jIGZyb20gJ25vZGU6Y3J5cHRvJztcbmV4cG9ydCBjb25zdCBjcnlwdG8gPSBuYyAmJiB0eXBlb2YgbmMgPT09ICdvYmplY3QnICYmICd3ZWJjcnlwdG8nIGluIG5jID8gbmMud2ViY3J5cHRvIDogdW5kZWZpbmVkO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y3J5cHRvTm9kZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/cryptoNode.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/sha1.js":
/*!*******************************************************************!*\
  !*** ./node_modules/pkijs/node_modules/@noble/hashes/esm/sha1.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   sha1: () => (/* binding */ sha1)\n/* harmony export */ });\n/* harmony import */ var _md_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./_md.js */ \"(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/_md.js\");\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils.js */ \"(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/utils.js\");\n\n\n// SHA1 (RFC 3174) was cryptographically broken. It's still used. Don't use it for a new protocol.\n// Initial state\nconst SHA1_IV = /* @__PURE__ */ new Uint32Array([\n    0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476, 0xc3d2e1f0,\n]);\n// Temporary buffer, not used to store anything between runs\n// Named this way because it matches specification.\nconst SHA1_W = /* @__PURE__ */ new Uint32Array(80);\nclass SHA1 extends _md_js__WEBPACK_IMPORTED_MODULE_0__.HashMD {\n    constructor() {\n        super(64, 20, 8, false);\n        this.A = SHA1_IV[0] | 0;\n        this.B = SHA1_IV[1] | 0;\n        this.C = SHA1_IV[2] | 0;\n        this.D = SHA1_IV[3] | 0;\n        this.E = SHA1_IV[4] | 0;\n    }\n    get() {\n        const { A, B, C, D, E } = this;\n        return [A, B, C, D, E];\n    }\n    set(A, B, C, D, E) {\n        this.A = A | 0;\n        this.B = B | 0;\n        this.C = C | 0;\n        this.D = D | 0;\n        this.E = E | 0;\n    }\n    process(view, offset) {\n        for (let i = 0; i < 16; i++, offset += 4)\n            SHA1_W[i] = view.getUint32(offset, false);\n        for (let i = 16; i < 80; i++)\n            SHA1_W[i] = (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.rotl)(SHA1_W[i - 3] ^ SHA1_W[i - 8] ^ SHA1_W[i - 14] ^ SHA1_W[i - 16], 1);\n        // Compression function main loop, 80 rounds\n        let { A, B, C, D, E } = this;\n        for (let i = 0; i < 80; i++) {\n            let F, K;\n            if (i < 20) {\n                F = (0,_md_js__WEBPACK_IMPORTED_MODULE_0__.Chi)(B, C, D);\n                K = 0x5a827999;\n            }\n            else if (i < 40) {\n                F = B ^ C ^ D;\n                K = 0x6ed9eba1;\n            }\n            else if (i < 60) {\n                F = (0,_md_js__WEBPACK_IMPORTED_MODULE_0__.Maj)(B, C, D);\n                K = 0x8f1bbcdc;\n            }\n            else {\n                F = B ^ C ^ D;\n                K = 0xca62c1d6;\n            }\n            const T = ((0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.rotl)(A, 5) + F + E + K + SHA1_W[i]) | 0;\n            E = D;\n            D = C;\n            C = (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.rotl)(B, 30);\n            B = A;\n            A = T;\n        }\n        // Add the compressed chunk to the current hash value\n        A = (A + this.A) | 0;\n        B = (B + this.B) | 0;\n        C = (C + this.C) | 0;\n        D = (D + this.D) | 0;\n        E = (E + this.E) | 0;\n        this.set(A, B, C, D, E);\n    }\n    roundClean() {\n        SHA1_W.fill(0);\n    }\n    destroy() {\n        this.set(0, 0, 0, 0, 0);\n        this.buffer.fill(0);\n    }\n}\nconst sha1 = /* @__PURE__ */ (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.wrapConstructor)(() => new SHA1());\n//# sourceMappingURL=sha1.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvcGtpanMvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL3NoYTEuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQTRDO0FBQ087QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQiwwQ0FBTTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsZ0JBQWdCO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLFFBQVE7QUFDaEM7QUFDQSx5QkFBeUIsUUFBUTtBQUNqQyx3QkFBd0IsK0NBQUk7QUFDNUI7QUFDQSxjQUFjLGdCQUFnQjtBQUM5Qix3QkFBd0IsUUFBUTtBQUNoQztBQUNBO0FBQ0Esb0JBQW9CLDJDQUFHO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLDJDQUFHO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QiwrQ0FBSTtBQUMzQjtBQUNBO0FBQ0EsZ0JBQWdCLCtDQUFJO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ08sNkJBQTZCLDBEQUFlO0FBQ25EIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VsZi13b3Jrc2hvcC8uL25vZGVfbW9kdWxlcy9wa2lqcy9ub2RlX21vZHVsZXMvQG5vYmxlL2hhc2hlcy9lc20vc2hhMS5qcz81MzA5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEhhc2hNRCwgQ2hpLCBNYWogfSBmcm9tICcuL19tZC5qcyc7XG5pbXBvcnQgeyByb3RsLCB3cmFwQ29uc3RydWN0b3IgfSBmcm9tICcuL3V0aWxzLmpzJztcbi8vIFNIQTEgKFJGQyAzMTc0KSB3YXMgY3J5cHRvZ3JhcGhpY2FsbHkgYnJva2VuLiBJdCdzIHN0aWxsIHVzZWQuIERvbid0IHVzZSBpdCBmb3IgYSBuZXcgcHJvdG9jb2wuXG4vLyBJbml0aWFsIHN0YXRlXG5jb25zdCBTSEExX0lWID0gLyogQF9fUFVSRV9fICovIG5ldyBVaW50MzJBcnJheShbXG4gICAgMHg2NzQ1MjMwMSwgMHhlZmNkYWI4OSwgMHg5OGJhZGNmZSwgMHgxMDMyNTQ3NiwgMHhjM2QyZTFmMCxcbl0pO1xuLy8gVGVtcG9yYXJ5IGJ1ZmZlciwgbm90IHVzZWQgdG8gc3RvcmUgYW55dGhpbmcgYmV0d2VlbiBydW5zXG4vLyBOYW1lZCB0aGlzIHdheSBiZWNhdXNlIGl0IG1hdGNoZXMgc3BlY2lmaWNhdGlvbi5cbmNvbnN0IFNIQTFfVyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVWludDMyQXJyYXkoODApO1xuY2xhc3MgU0hBMSBleHRlbmRzIEhhc2hNRCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKDY0LCAyMCwgOCwgZmFsc2UpO1xuICAgICAgICB0aGlzLkEgPSBTSEExX0lWWzBdIHwgMDtcbiAgICAgICAgdGhpcy5CID0gU0hBMV9JVlsxXSB8IDA7XG4gICAgICAgIHRoaXMuQyA9IFNIQTFfSVZbMl0gfCAwO1xuICAgICAgICB0aGlzLkQgPSBTSEExX0lWWzNdIHwgMDtcbiAgICAgICAgdGhpcy5FID0gU0hBMV9JVls0XSB8IDA7XG4gICAgfVxuICAgIGdldCgpIHtcbiAgICAgICAgY29uc3QgeyBBLCBCLCBDLCBELCBFIH0gPSB0aGlzO1xuICAgICAgICByZXR1cm4gW0EsIEIsIEMsIEQsIEVdO1xuICAgIH1cbiAgICBzZXQoQSwgQiwgQywgRCwgRSkge1xuICAgICAgICB0aGlzLkEgPSBBIHwgMDtcbiAgICAgICAgdGhpcy5CID0gQiB8IDA7XG4gICAgICAgIHRoaXMuQyA9IEMgfCAwO1xuICAgICAgICB0aGlzLkQgPSBEIHwgMDtcbiAgICAgICAgdGhpcy5FID0gRSB8IDA7XG4gICAgfVxuICAgIHByb2Nlc3Modmlldywgb2Zmc2V0KSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTY7IGkrKywgb2Zmc2V0ICs9IDQpXG4gICAgICAgICAgICBTSEExX1dbaV0gPSB2aWV3LmdldFVpbnQzMihvZmZzZXQsIGZhbHNlKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDE2OyBpIDwgODA7IGkrKylcbiAgICAgICAgICAgIFNIQTFfV1tpXSA9IHJvdGwoU0hBMV9XW2kgLSAzXSBeIFNIQTFfV1tpIC0gOF0gXiBTSEExX1dbaSAtIDE0XSBeIFNIQTFfV1tpIC0gMTZdLCAxKTtcbiAgICAgICAgLy8gQ29tcHJlc3Npb24gZnVuY3Rpb24gbWFpbiBsb29wLCA4MCByb3VuZHNcbiAgICAgICAgbGV0IHsgQSwgQiwgQywgRCwgRSB9ID0gdGhpcztcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA4MDsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgRiwgSztcbiAgICAgICAgICAgIGlmIChpIDwgMjApIHtcbiAgICAgICAgICAgICAgICBGID0gQ2hpKEIsIEMsIEQpO1xuICAgICAgICAgICAgICAgIEsgPSAweDVhODI3OTk5O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoaSA8IDQwKSB7XG4gICAgICAgICAgICAgICAgRiA9IEIgXiBDIF4gRDtcbiAgICAgICAgICAgICAgICBLID0gMHg2ZWQ5ZWJhMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGkgPCA2MCkge1xuICAgICAgICAgICAgICAgIEYgPSBNYWooQiwgQywgRCk7XG4gICAgICAgICAgICAgICAgSyA9IDB4OGYxYmJjZGM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBGID0gQiBeIEMgXiBEO1xuICAgICAgICAgICAgICAgIEsgPSAweGNhNjJjMWQ2O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgVCA9IChyb3RsKEEsIDUpICsgRiArIEUgKyBLICsgU0hBMV9XW2ldKSB8IDA7XG4gICAgICAgICAgICBFID0gRDtcbiAgICAgICAgICAgIEQgPSBDO1xuICAgICAgICAgICAgQyA9IHJvdGwoQiwgMzApO1xuICAgICAgICAgICAgQiA9IEE7XG4gICAgICAgICAgICBBID0gVDtcbiAgICAgICAgfVxuICAgICAgICAvLyBBZGQgdGhlIGNvbXByZXNzZWQgY2h1bmsgdG8gdGhlIGN1cnJlbnQgaGFzaCB2YWx1ZVxuICAgICAgICBBID0gKEEgKyB0aGlzLkEpIHwgMDtcbiAgICAgICAgQiA9IChCICsgdGhpcy5CKSB8IDA7XG4gICAgICAgIEMgPSAoQyArIHRoaXMuQykgfCAwO1xuICAgICAgICBEID0gKEQgKyB0aGlzLkQpIHwgMDtcbiAgICAgICAgRSA9IChFICsgdGhpcy5FKSB8IDA7XG4gICAgICAgIHRoaXMuc2V0KEEsIEIsIEMsIEQsIEUpO1xuICAgIH1cbiAgICByb3VuZENsZWFuKCkge1xuICAgICAgICBTSEExX1cuZmlsbCgwKTtcbiAgICB9XG4gICAgZGVzdHJveSgpIHtcbiAgICAgICAgdGhpcy5zZXQoMCwgMCwgMCwgMCwgMCk7XG4gICAgICAgIHRoaXMuYnVmZmVyLmZpbGwoMCk7XG4gICAgfVxufVxuZXhwb3J0IGNvbnN0IHNoYTEgPSAvKiBAX19QVVJFX18gKi8gd3JhcENvbnN0cnVjdG9yKCgpID0+IG5ldyBTSEExKCkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2hhMS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/sha1.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/sha256.js":
/*!*********************************************************************!*\
  !*** ./node_modules/pkijs/node_modules/@noble/hashes/esm/sha256.js ***!
  \*********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   sha224: () => (/* binding */ sha224),\n/* harmony export */   sha256: () => (/* binding */ sha256)\n/* harmony export */ });\n/* harmony import */ var _md_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./_md.js */ \"(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/_md.js\");\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils.js */ \"(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/utils.js\");\n\n\n// SHA2-256 need to try 2^128 hashes to execute birthday attack.\n// BTC network is doing 2^67 hashes/sec as per early 2023.\n// Round constants:\n// first 32 bits of the fractional parts of the cube roots of the first 64 primes 2..311)\n// prettier-ignore\nconst SHA256_K = /* @__PURE__ */ new Uint32Array([\n    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2\n]);\n// Initial state:\n// first 32 bits of the fractional parts of the square roots of the first 8 primes 2..19\n// prettier-ignore\nconst SHA256_IV = /* @__PURE__ */ new Uint32Array([\n    0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19\n]);\n// Temporary buffer, not used to store anything between runs\n// Named this way because it matches specification.\nconst SHA256_W = /* @__PURE__ */ new Uint32Array(64);\nclass SHA256 extends _md_js__WEBPACK_IMPORTED_MODULE_0__.HashMD {\n    constructor() {\n        super(64, 32, 8, false);\n        // We cannot use array here since array allows indexing by variable\n        // which means optimizer/compiler cannot use registers.\n        this.A = SHA256_IV[0] | 0;\n        this.B = SHA256_IV[1] | 0;\n        this.C = SHA256_IV[2] | 0;\n        this.D = SHA256_IV[3] | 0;\n        this.E = SHA256_IV[4] | 0;\n        this.F = SHA256_IV[5] | 0;\n        this.G = SHA256_IV[6] | 0;\n        this.H = SHA256_IV[7] | 0;\n    }\n    get() {\n        const { A, B, C, D, E, F, G, H } = this;\n        return [A, B, C, D, E, F, G, H];\n    }\n    // prettier-ignore\n    set(A, B, C, D, E, F, G, H) {\n        this.A = A | 0;\n        this.B = B | 0;\n        this.C = C | 0;\n        this.D = D | 0;\n        this.E = E | 0;\n        this.F = F | 0;\n        this.G = G | 0;\n        this.H = H | 0;\n    }\n    process(view, offset) {\n        // Extend the first 16 words into the remaining 48 words w[16..63] of the message schedule array\n        for (let i = 0; i < 16; i++, offset += 4)\n            SHA256_W[i] = view.getUint32(offset, false);\n        for (let i = 16; i < 64; i++) {\n            const W15 = SHA256_W[i - 15];\n            const W2 = SHA256_W[i - 2];\n            const s0 = (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.rotr)(W15, 7) ^ (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.rotr)(W15, 18) ^ (W15 >>> 3);\n            const s1 = (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.rotr)(W2, 17) ^ (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.rotr)(W2, 19) ^ (W2 >>> 10);\n            SHA256_W[i] = (s1 + SHA256_W[i - 7] + s0 + SHA256_W[i - 16]) | 0;\n        }\n        // Compression function main loop, 64 rounds\n        let { A, B, C, D, E, F, G, H } = this;\n        for (let i = 0; i < 64; i++) {\n            const sigma1 = (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.rotr)(E, 6) ^ (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.rotr)(E, 11) ^ (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.rotr)(E, 25);\n            const T1 = (H + sigma1 + (0,_md_js__WEBPACK_IMPORTED_MODULE_0__.Chi)(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n            const sigma0 = (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.rotr)(A, 2) ^ (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.rotr)(A, 13) ^ (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.rotr)(A, 22);\n            const T2 = (sigma0 + (0,_md_js__WEBPACK_IMPORTED_MODULE_0__.Maj)(A, B, C)) | 0;\n            H = G;\n            G = F;\n            F = E;\n            E = (D + T1) | 0;\n            D = C;\n            C = B;\n            B = A;\n            A = (T1 + T2) | 0;\n        }\n        // Add the compressed chunk to the current hash value\n        A = (A + this.A) | 0;\n        B = (B + this.B) | 0;\n        C = (C + this.C) | 0;\n        D = (D + this.D) | 0;\n        E = (E + this.E) | 0;\n        F = (F + this.F) | 0;\n        G = (G + this.G) | 0;\n        H = (H + this.H) | 0;\n        this.set(A, B, C, D, E, F, G, H);\n    }\n    roundClean() {\n        SHA256_W.fill(0);\n    }\n    destroy() {\n        this.set(0, 0, 0, 0, 0, 0, 0, 0);\n        this.buffer.fill(0);\n    }\n}\n// Constants from https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf\nclass SHA224 extends SHA256 {\n    constructor() {\n        super();\n        this.A = 0xc1059ed8 | 0;\n        this.B = 0x367cd507 | 0;\n        this.C = 0x3070dd17 | 0;\n        this.D = 0xf70e5939 | 0;\n        this.E = 0xffc00b31 | 0;\n        this.F = 0x68581511 | 0;\n        this.G = 0x64f98fa7 | 0;\n        this.H = 0xbefa4fa4 | 0;\n        this.outputLen = 28;\n    }\n}\n/**\n * SHA2-256 hash function\n * @param message - data that would be hashed\n */\nconst sha256 = /* @__PURE__ */ (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.wrapConstructor)(() => new SHA256());\nconst sha224 = /* @__PURE__ */ (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.wrapConstructor)(() => new SHA224());\n//# sourceMappingURL=sha256.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvcGtpanMvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL3NoYTI1Ni5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQTRDO0FBQ087QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLDBDQUFNO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IseUJBQXlCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixRQUFRO0FBQ2hDO0FBQ0EseUJBQXlCLFFBQVE7QUFDakM7QUFDQTtBQUNBLHVCQUF1QiwrQ0FBSSxXQUFXLCtDQUFJO0FBQzFDLHVCQUF1QiwrQ0FBSSxXQUFXLCtDQUFJO0FBQzFDO0FBQ0E7QUFDQTtBQUNBLGNBQWMseUJBQXlCO0FBQ3ZDLHdCQUF3QixRQUFRO0FBQ2hDLDJCQUEyQiwrQ0FBSSxTQUFTLCtDQUFJLFVBQVUsK0NBQUk7QUFDMUQscUNBQXFDLDJDQUFHO0FBQ3hDLDJCQUEyQiwrQ0FBSSxTQUFTLCtDQUFJLFVBQVUsK0NBQUk7QUFDMUQsaUNBQWlDLDJDQUFHO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTywrQkFBK0IsMERBQWU7QUFDOUMsK0JBQStCLDBEQUFlO0FBQ3JEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VsZi13b3Jrc2hvcC8uL25vZGVfbW9kdWxlcy9wa2lqcy9ub2RlX21vZHVsZXMvQG5vYmxlL2hhc2hlcy9lc20vc2hhMjU2LmpzPzg0MTMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSGFzaE1ELCBDaGksIE1haiB9IGZyb20gJy4vX21kLmpzJztcbmltcG9ydCB7IHJvdHIsIHdyYXBDb25zdHJ1Y3RvciB9IGZyb20gJy4vdXRpbHMuanMnO1xuLy8gU0hBMi0yNTYgbmVlZCB0byB0cnkgMl4xMjggaGFzaGVzIHRvIGV4ZWN1dGUgYmlydGhkYXkgYXR0YWNrLlxuLy8gQlRDIG5ldHdvcmsgaXMgZG9pbmcgMl42NyBoYXNoZXMvc2VjIGFzIHBlciBlYXJseSAyMDIzLlxuLy8gUm91bmQgY29uc3RhbnRzOlxuLy8gZmlyc3QgMzIgYml0cyBvZiB0aGUgZnJhY3Rpb25hbCBwYXJ0cyBvZiB0aGUgY3ViZSByb290cyBvZiB0aGUgZmlyc3QgNjQgcHJpbWVzIDIuLjMxMSlcbi8vIHByZXR0aWVyLWlnbm9yZVxuY29uc3QgU0hBMjU2X0sgPSAvKiBAX19QVVJFX18gKi8gbmV3IFVpbnQzMkFycmF5KFtcbiAgICAweDQyOGEyZjk4LCAweDcxMzc0NDkxLCAweGI1YzBmYmNmLCAweGU5YjVkYmE1LCAweDM5NTZjMjViLCAweDU5ZjExMWYxLCAweDkyM2Y4MmE0LCAweGFiMWM1ZWQ1LFxuICAgIDB4ZDgwN2FhOTgsIDB4MTI4MzViMDEsIDB4MjQzMTg1YmUsIDB4NTUwYzdkYzMsIDB4NzJiZTVkNzQsIDB4ODBkZWIxZmUsIDB4OWJkYzA2YTcsIDB4YzE5YmYxNzQsXG4gICAgMHhlNDliNjljMSwgMHhlZmJlNDc4NiwgMHgwZmMxOWRjNiwgMHgyNDBjYTFjYywgMHgyZGU5MmM2ZiwgMHg0YTc0ODRhYSwgMHg1Y2IwYTlkYywgMHg3NmY5ODhkYSxcbiAgICAweDk4M2U1MTUyLCAweGE4MzFjNjZkLCAweGIwMDMyN2M4LCAweGJmNTk3ZmM3LCAweGM2ZTAwYmYzLCAweGQ1YTc5MTQ3LCAweDA2Y2E2MzUxLCAweDE0MjkyOTY3LFxuICAgIDB4MjdiNzBhODUsIDB4MmUxYjIxMzgsIDB4NGQyYzZkZmMsIDB4NTMzODBkMTMsIDB4NjUwYTczNTQsIDB4NzY2YTBhYmIsIDB4ODFjMmM5MmUsIDB4OTI3MjJjODUsXG4gICAgMHhhMmJmZThhMSwgMHhhODFhNjY0YiwgMHhjMjRiOGI3MCwgMHhjNzZjNTFhMywgMHhkMTkyZTgxOSwgMHhkNjk5MDYyNCwgMHhmNDBlMzU4NSwgMHgxMDZhYTA3MCxcbiAgICAweDE5YTRjMTE2LCAweDFlMzc2YzA4LCAweDI3NDg3NzRjLCAweDM0YjBiY2I1LCAweDM5MWMwY2IzLCAweDRlZDhhYTRhLCAweDViOWNjYTRmLCAweDY4MmU2ZmYzLFxuICAgIDB4NzQ4ZjgyZWUsIDB4NzhhNTYzNmYsIDB4ODRjODc4MTQsIDB4OGNjNzAyMDgsIDB4OTBiZWZmZmEsIDB4YTQ1MDZjZWIsIDB4YmVmOWEzZjcsIDB4YzY3MTc4ZjJcbl0pO1xuLy8gSW5pdGlhbCBzdGF0ZTpcbi8vIGZpcnN0IDMyIGJpdHMgb2YgdGhlIGZyYWN0aW9uYWwgcGFydHMgb2YgdGhlIHNxdWFyZSByb290cyBvZiB0aGUgZmlyc3QgOCBwcmltZXMgMi4uMTlcbi8vIHByZXR0aWVyLWlnbm9yZVxuY29uc3QgU0hBMjU2X0lWID0gLyogQF9fUFVSRV9fICovIG5ldyBVaW50MzJBcnJheShbXG4gICAgMHg2YTA5ZTY2NywgMHhiYjY3YWU4NSwgMHgzYzZlZjM3MiwgMHhhNTRmZjUzYSwgMHg1MTBlNTI3ZiwgMHg5YjA1Njg4YywgMHgxZjgzZDlhYiwgMHg1YmUwY2QxOVxuXSk7XG4vLyBUZW1wb3JhcnkgYnVmZmVyLCBub3QgdXNlZCB0byBzdG9yZSBhbnl0aGluZyBiZXR3ZWVuIHJ1bnNcbi8vIE5hbWVkIHRoaXMgd2F5IGJlY2F1c2UgaXQgbWF0Y2hlcyBzcGVjaWZpY2F0aW9uLlxuY29uc3QgU0hBMjU2X1cgPSAvKiBAX19QVVJFX18gKi8gbmV3IFVpbnQzMkFycmF5KDY0KTtcbmNsYXNzIFNIQTI1NiBleHRlbmRzIEhhc2hNRCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKDY0LCAzMiwgOCwgZmFsc2UpO1xuICAgICAgICAvLyBXZSBjYW5ub3QgdXNlIGFycmF5IGhlcmUgc2luY2UgYXJyYXkgYWxsb3dzIGluZGV4aW5nIGJ5IHZhcmlhYmxlXG4gICAgICAgIC8vIHdoaWNoIG1lYW5zIG9wdGltaXplci9jb21waWxlciBjYW5ub3QgdXNlIHJlZ2lzdGVycy5cbiAgICAgICAgdGhpcy5BID0gU0hBMjU2X0lWWzBdIHwgMDtcbiAgICAgICAgdGhpcy5CID0gU0hBMjU2X0lWWzFdIHwgMDtcbiAgICAgICAgdGhpcy5DID0gU0hBMjU2X0lWWzJdIHwgMDtcbiAgICAgICAgdGhpcy5EID0gU0hBMjU2X0lWWzNdIHwgMDtcbiAgICAgICAgdGhpcy5FID0gU0hBMjU2X0lWWzRdIHwgMDtcbiAgICAgICAgdGhpcy5GID0gU0hBMjU2X0lWWzVdIHwgMDtcbiAgICAgICAgdGhpcy5HID0gU0hBMjU2X0lWWzZdIHwgMDtcbiAgICAgICAgdGhpcy5IID0gU0hBMjU2X0lWWzddIHwgMDtcbiAgICB9XG4gICAgZ2V0KCkge1xuICAgICAgICBjb25zdCB7IEEsIEIsIEMsIEQsIEUsIEYsIEcsIEggfSA9IHRoaXM7XG4gICAgICAgIHJldHVybiBbQSwgQiwgQywgRCwgRSwgRiwgRywgSF07XG4gICAgfVxuICAgIC8vIHByZXR0aWVyLWlnbm9yZVxuICAgIHNldChBLCBCLCBDLCBELCBFLCBGLCBHLCBIKSB7XG4gICAgICAgIHRoaXMuQSA9IEEgfCAwO1xuICAgICAgICB0aGlzLkIgPSBCIHwgMDtcbiAgICAgICAgdGhpcy5DID0gQyB8IDA7XG4gICAgICAgIHRoaXMuRCA9IEQgfCAwO1xuICAgICAgICB0aGlzLkUgPSBFIHwgMDtcbiAgICAgICAgdGhpcy5GID0gRiB8IDA7XG4gICAgICAgIHRoaXMuRyA9IEcgfCAwO1xuICAgICAgICB0aGlzLkggPSBIIHwgMDtcbiAgICB9XG4gICAgcHJvY2Vzcyh2aWV3LCBvZmZzZXQpIHtcbiAgICAgICAgLy8gRXh0ZW5kIHRoZSBmaXJzdCAxNiB3b3JkcyBpbnRvIHRoZSByZW1haW5pbmcgNDggd29yZHMgd1sxNi4uNjNdIG9mIHRoZSBtZXNzYWdlIHNjaGVkdWxlIGFycmF5XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTY7IGkrKywgb2Zmc2V0ICs9IDQpXG4gICAgICAgICAgICBTSEEyNTZfV1tpXSA9IHZpZXcuZ2V0VWludDMyKG9mZnNldCwgZmFsc2UpO1xuICAgICAgICBmb3IgKGxldCBpID0gMTY7IGkgPCA2NDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBXMTUgPSBTSEEyNTZfV1tpIC0gMTVdO1xuICAgICAgICAgICAgY29uc3QgVzIgPSBTSEEyNTZfV1tpIC0gMl07XG4gICAgICAgICAgICBjb25zdCBzMCA9IHJvdHIoVzE1LCA3KSBeIHJvdHIoVzE1LCAxOCkgXiAoVzE1ID4+PiAzKTtcbiAgICAgICAgICAgIGNvbnN0IHMxID0gcm90cihXMiwgMTcpIF4gcm90cihXMiwgMTkpIF4gKFcyID4+PiAxMCk7XG4gICAgICAgICAgICBTSEEyNTZfV1tpXSA9IChzMSArIFNIQTI1Nl9XW2kgLSA3XSArIHMwICsgU0hBMjU2X1dbaSAtIDE2XSkgfCAwO1xuICAgICAgICB9XG4gICAgICAgIC8vIENvbXByZXNzaW9uIGZ1bmN0aW9uIG1haW4gbG9vcCwgNjQgcm91bmRzXG4gICAgICAgIGxldCB7IEEsIEIsIEMsIEQsIEUsIEYsIEcsIEggfSA9IHRoaXM7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNjQ7IGkrKykge1xuICAgICAgICAgICAgY29uc3Qgc2lnbWExID0gcm90cihFLCA2KSBeIHJvdHIoRSwgMTEpIF4gcm90cihFLCAyNSk7XG4gICAgICAgICAgICBjb25zdCBUMSA9IChIICsgc2lnbWExICsgQ2hpKEUsIEYsIEcpICsgU0hBMjU2X0tbaV0gKyBTSEEyNTZfV1tpXSkgfCAwO1xuICAgICAgICAgICAgY29uc3Qgc2lnbWEwID0gcm90cihBLCAyKSBeIHJvdHIoQSwgMTMpIF4gcm90cihBLCAyMik7XG4gICAgICAgICAgICBjb25zdCBUMiA9IChzaWdtYTAgKyBNYWooQSwgQiwgQykpIHwgMDtcbiAgICAgICAgICAgIEggPSBHO1xuICAgICAgICAgICAgRyA9IEY7XG4gICAgICAgICAgICBGID0gRTtcbiAgICAgICAgICAgIEUgPSAoRCArIFQxKSB8IDA7XG4gICAgICAgICAgICBEID0gQztcbiAgICAgICAgICAgIEMgPSBCO1xuICAgICAgICAgICAgQiA9IEE7XG4gICAgICAgICAgICBBID0gKFQxICsgVDIpIHwgMDtcbiAgICAgICAgfVxuICAgICAgICAvLyBBZGQgdGhlIGNvbXByZXNzZWQgY2h1bmsgdG8gdGhlIGN1cnJlbnQgaGFzaCB2YWx1ZVxuICAgICAgICBBID0gKEEgKyB0aGlzLkEpIHwgMDtcbiAgICAgICAgQiA9IChCICsgdGhpcy5CKSB8IDA7XG4gICAgICAgIEMgPSAoQyArIHRoaXMuQykgfCAwO1xuICAgICAgICBEID0gKEQgKyB0aGlzLkQpIHwgMDtcbiAgICAgICAgRSA9IChFICsgdGhpcy5FKSB8IDA7XG4gICAgICAgIEYgPSAoRiArIHRoaXMuRikgfCAwO1xuICAgICAgICBHID0gKEcgKyB0aGlzLkcpIHwgMDtcbiAgICAgICAgSCA9IChIICsgdGhpcy5IKSB8IDA7XG4gICAgICAgIHRoaXMuc2V0KEEsIEIsIEMsIEQsIEUsIEYsIEcsIEgpO1xuICAgIH1cbiAgICByb3VuZENsZWFuKCkge1xuICAgICAgICBTSEEyNTZfVy5maWxsKDApO1xuICAgIH1cbiAgICBkZXN0cm95KCkge1xuICAgICAgICB0aGlzLnNldCgwLCAwLCAwLCAwLCAwLCAwLCAwLCAwKTtcbiAgICAgICAgdGhpcy5idWZmZXIuZmlsbCgwKTtcbiAgICB9XG59XG4vLyBDb25zdGFudHMgZnJvbSBodHRwczovL252bHB1YnMubmlzdC5nb3YvbmlzdHB1YnMvRklQUy9OSVNULkZJUFMuMTgwLTQucGRmXG5jbGFzcyBTSEEyMjQgZXh0ZW5kcyBTSEEyNTYge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLkEgPSAweGMxMDU5ZWQ4IHwgMDtcbiAgICAgICAgdGhpcy5CID0gMHgzNjdjZDUwNyB8IDA7XG4gICAgICAgIHRoaXMuQyA9IDB4MzA3MGRkMTcgfCAwO1xuICAgICAgICB0aGlzLkQgPSAweGY3MGU1OTM5IHwgMDtcbiAgICAgICAgdGhpcy5FID0gMHhmZmMwMGIzMSB8IDA7XG4gICAgICAgIHRoaXMuRiA9IDB4Njg1ODE1MTEgfCAwO1xuICAgICAgICB0aGlzLkcgPSAweDY0Zjk4ZmE3IHwgMDtcbiAgICAgICAgdGhpcy5IID0gMHhiZWZhNGZhNCB8IDA7XG4gICAgICAgIHRoaXMub3V0cHV0TGVuID0gMjg7XG4gICAgfVxufVxuLyoqXG4gKiBTSEEyLTI1NiBoYXNoIGZ1bmN0aW9uXG4gKiBAcGFyYW0gbWVzc2FnZSAtIGRhdGEgdGhhdCB3b3VsZCBiZSBoYXNoZWRcbiAqL1xuZXhwb3J0IGNvbnN0IHNoYTI1NiA9IC8qIEBfX1BVUkVfXyAqLyB3cmFwQ29uc3RydWN0b3IoKCkgPT4gbmV3IFNIQTI1NigpKTtcbmV4cG9ydCBjb25zdCBzaGEyMjQgPSAvKiBAX19QVVJFX18gKi8gd3JhcENvbnN0cnVjdG9yKCgpID0+IG5ldyBTSEEyMjQoKSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zaGEyNTYuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/sha256.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/sha512.js":
/*!*********************************************************************!*\
  !*** ./node_modules/pkijs/node_modules/@noble/hashes/esm/sha512.js ***!
  \*********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SHA512: () => (/* binding */ SHA512),\n/* harmony export */   sha384: () => (/* binding */ sha384),\n/* harmony export */   sha512: () => (/* binding */ sha512),\n/* harmony export */   sha512_224: () => (/* binding */ sha512_224),\n/* harmony export */   sha512_256: () => (/* binding */ sha512_256)\n/* harmony export */ });\n/* harmony import */ var _md_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./_md.js */ \"(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/_md.js\");\n/* harmony import */ var _u64_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./_u64.js */ \"(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/_u64.js\");\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils.js */ \"(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/utils.js\");\n\n\n\n// Round contants (first 32 bits of the fractional parts of the cube roots of the first 80 primes 2..409):\n// prettier-ignore\nconst [SHA512_Kh, SHA512_Kl] = /* @__PURE__ */ (() => _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].split([\n    '0x428a2f98d728ae22', '0x7137449123ef65cd', '0xb5c0fbcfec4d3b2f', '0xe9b5dba58189dbbc',\n    '0x3956c25bf348b538', '0x59f111f1b605d019', '0x923f82a4af194f9b', '0xab1c5ed5da6d8118',\n    '0xd807aa98a3030242', '0x12835b0145706fbe', '0x243185be4ee4b28c', '0x550c7dc3d5ffb4e2',\n    '0x72be5d74f27b896f', '0x80deb1fe3b1696b1', '0x9bdc06a725c71235', '0xc19bf174cf692694',\n    '0xe49b69c19ef14ad2', '0xefbe4786384f25e3', '0x0fc19dc68b8cd5b5', '0x240ca1cc77ac9c65',\n    '0x2de92c6f592b0275', '0x4a7484aa6ea6e483', '0x5cb0a9dcbd41fbd4', '0x76f988da831153b5',\n    '0x983e5152ee66dfab', '0xa831c66d2db43210', '0xb00327c898fb213f', '0xbf597fc7beef0ee4',\n    '0xc6e00bf33da88fc2', '0xd5a79147930aa725', '0x06ca6351e003826f', '0x142929670a0e6e70',\n    '0x27b70a8546d22ffc', '0x2e1b21385c26c926', '0x4d2c6dfc5ac42aed', '0x53380d139d95b3df',\n    '0x650a73548baf63de', '0x766a0abb3c77b2a8', '0x81c2c92e47edaee6', '0x92722c851482353b',\n    '0xa2bfe8a14cf10364', '0xa81a664bbc423001', '0xc24b8b70d0f89791', '0xc76c51a30654be30',\n    '0xd192e819d6ef5218', '0xd69906245565a910', '0xf40e35855771202a', '0x106aa07032bbd1b8',\n    '0x19a4c116b8d2d0c8', '0x1e376c085141ab53', '0x2748774cdf8eeb99', '0x34b0bcb5e19b48a8',\n    '0x391c0cb3c5c95a63', '0x4ed8aa4ae3418acb', '0x5b9cca4f7763e373', '0x682e6ff3d6b2b8a3',\n    '0x748f82ee5defb2fc', '0x78a5636f43172f60', '0x84c87814a1f0ab72', '0x8cc702081a6439ec',\n    '0x90befffa23631e28', '0xa4506cebde82bde9', '0xbef9a3f7b2c67915', '0xc67178f2e372532b',\n    '0xca273eceea26619c', '0xd186b8c721c0c207', '0xeada7dd6cde0eb1e', '0xf57d4f7fee6ed178',\n    '0x06f067aa72176fba', '0x0a637dc5a2c898a6', '0x113f9804bef90dae', '0x1b710b35131c471b',\n    '0x28db77f523047d84', '0x32caab7b40c72493', '0x3c9ebe0a15c9bebc', '0x431d67c49c100d4c',\n    '0x4cc5d4becb3e42b6', '0x597f299cfc657e2a', '0x5fcb6fab3ad6faec', '0x6c44198c4a475817'\n].map(n => BigInt(n))))();\n// Temporary buffer, not used to store anything between runs\nconst SHA512_W_H = /* @__PURE__ */ new Uint32Array(80);\nconst SHA512_W_L = /* @__PURE__ */ new Uint32Array(80);\nclass SHA512 extends _md_js__WEBPACK_IMPORTED_MODULE_1__.HashMD {\n    constructor() {\n        super(128, 64, 16, false);\n        // We cannot use array here since array allows indexing by variable which means optimizer/compiler cannot use registers.\n        // Also looks cleaner and easier to verify with spec.\n        // Initial state (first 32 bits of the fractional parts of the square roots of the first 8 primes 2..19):\n        // h -- high 32 bits, l -- low 32 bits\n        this.Ah = 0x6a09e667 | 0;\n        this.Al = 0xf3bcc908 | 0;\n        this.Bh = 0xbb67ae85 | 0;\n        this.Bl = 0x84caa73b | 0;\n        this.Ch = 0x3c6ef372 | 0;\n        this.Cl = 0xfe94f82b | 0;\n        this.Dh = 0xa54ff53a | 0;\n        this.Dl = 0x5f1d36f1 | 0;\n        this.Eh = 0x510e527f | 0;\n        this.El = 0xade682d1 | 0;\n        this.Fh = 0x9b05688c | 0;\n        this.Fl = 0x2b3e6c1f | 0;\n        this.Gh = 0x1f83d9ab | 0;\n        this.Gl = 0xfb41bd6b | 0;\n        this.Hh = 0x5be0cd19 | 0;\n        this.Hl = 0x137e2179 | 0;\n    }\n    // prettier-ignore\n    get() {\n        const { Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl } = this;\n        return [Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl];\n    }\n    // prettier-ignore\n    set(Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl) {\n        this.Ah = Ah | 0;\n        this.Al = Al | 0;\n        this.Bh = Bh | 0;\n        this.Bl = Bl | 0;\n        this.Ch = Ch | 0;\n        this.Cl = Cl | 0;\n        this.Dh = Dh | 0;\n        this.Dl = Dl | 0;\n        this.Eh = Eh | 0;\n        this.El = El | 0;\n        this.Fh = Fh | 0;\n        this.Fl = Fl | 0;\n        this.Gh = Gh | 0;\n        this.Gl = Gl | 0;\n        this.Hh = Hh | 0;\n        this.Hl = Hl | 0;\n    }\n    process(view, offset) {\n        // Extend the first 16 words into the remaining 64 words w[16..79] of the message schedule array\n        for (let i = 0; i < 16; i++, offset += 4) {\n            SHA512_W_H[i] = view.getUint32(offset);\n            SHA512_W_L[i] = view.getUint32((offset += 4));\n        }\n        for (let i = 16; i < 80; i++) {\n            // s0 := (w[i-15] rightrotate 1) xor (w[i-15] rightrotate 8) xor (w[i-15] rightshift 7)\n            const W15h = SHA512_W_H[i - 15] | 0;\n            const W15l = SHA512_W_L[i - 15] | 0;\n            const s0h = _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].rotrSH(W15h, W15l, 1) ^ _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].rotrSH(W15h, W15l, 8) ^ _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].shrSH(W15h, W15l, 7);\n            const s0l = _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].rotrSL(W15h, W15l, 1) ^ _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].rotrSL(W15h, W15l, 8) ^ _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].shrSL(W15h, W15l, 7);\n            // s1 := (w[i-2] rightrotate 19) xor (w[i-2] rightrotate 61) xor (w[i-2] rightshift 6)\n            const W2h = SHA512_W_H[i - 2] | 0;\n            const W2l = SHA512_W_L[i - 2] | 0;\n            const s1h = _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].rotrSH(W2h, W2l, 19) ^ _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].rotrBH(W2h, W2l, 61) ^ _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].shrSH(W2h, W2l, 6);\n            const s1l = _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].rotrSL(W2h, W2l, 19) ^ _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].rotrBL(W2h, W2l, 61) ^ _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].shrSL(W2h, W2l, 6);\n            // SHA256_W[i] = s0 + s1 + SHA256_W[i - 7] + SHA256_W[i - 16];\n            const SUMl = _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].add4L(s0l, s1l, SHA512_W_L[i - 7], SHA512_W_L[i - 16]);\n            const SUMh = _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].add4H(SUMl, s0h, s1h, SHA512_W_H[i - 7], SHA512_W_H[i - 16]);\n            SHA512_W_H[i] = SUMh | 0;\n            SHA512_W_L[i] = SUMl | 0;\n        }\n        let { Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl } = this;\n        // Compression function main loop, 80 rounds\n        for (let i = 0; i < 80; i++) {\n            // S1 := (e rightrotate 14) xor (e rightrotate 18) xor (e rightrotate 41)\n            const sigma1h = _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].rotrSH(Eh, El, 14) ^ _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].rotrSH(Eh, El, 18) ^ _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].rotrBH(Eh, El, 41);\n            const sigma1l = _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].rotrSL(Eh, El, 14) ^ _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].rotrSL(Eh, El, 18) ^ _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].rotrBL(Eh, El, 41);\n            //const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n            const CHIh = (Eh & Fh) ^ (~Eh & Gh);\n            const CHIl = (El & Fl) ^ (~El & Gl);\n            // T1 = H + sigma1 + Chi(E, F, G) + SHA512_K[i] + SHA512_W[i]\n            // prettier-ignore\n            const T1ll = _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].add5L(Hl, sigma1l, CHIl, SHA512_Kl[i], SHA512_W_L[i]);\n            const T1h = _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].add5H(T1ll, Hh, sigma1h, CHIh, SHA512_Kh[i], SHA512_W_H[i]);\n            const T1l = T1ll | 0;\n            // S0 := (a rightrotate 28) xor (a rightrotate 34) xor (a rightrotate 39)\n            const sigma0h = _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].rotrSH(Ah, Al, 28) ^ _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].rotrBH(Ah, Al, 34) ^ _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].rotrBH(Ah, Al, 39);\n            const sigma0l = _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].rotrSL(Ah, Al, 28) ^ _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].rotrBL(Ah, Al, 34) ^ _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].rotrBL(Ah, Al, 39);\n            const MAJh = (Ah & Bh) ^ (Ah & Ch) ^ (Bh & Ch);\n            const MAJl = (Al & Bl) ^ (Al & Cl) ^ (Bl & Cl);\n            Hh = Gh | 0;\n            Hl = Gl | 0;\n            Gh = Fh | 0;\n            Gl = Fl | 0;\n            Fh = Eh | 0;\n            Fl = El | 0;\n            ({ h: Eh, l: El } = _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].add(Dh | 0, Dl | 0, T1h | 0, T1l | 0));\n            Dh = Ch | 0;\n            Dl = Cl | 0;\n            Ch = Bh | 0;\n            Cl = Bl | 0;\n            Bh = Ah | 0;\n            Bl = Al | 0;\n            const All = _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].add3L(T1l, sigma0l, MAJl);\n            Ah = _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].add3H(All, T1h, sigma0h, MAJh);\n            Al = All | 0;\n        }\n        // Add the compressed chunk to the current hash value\n        ({ h: Ah, l: Al } = _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].add(this.Ah | 0, this.Al | 0, Ah | 0, Al | 0));\n        ({ h: Bh, l: Bl } = _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].add(this.Bh | 0, this.Bl | 0, Bh | 0, Bl | 0));\n        ({ h: Ch, l: Cl } = _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].add(this.Ch | 0, this.Cl | 0, Ch | 0, Cl | 0));\n        ({ h: Dh, l: Dl } = _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].add(this.Dh | 0, this.Dl | 0, Dh | 0, Dl | 0));\n        ({ h: Eh, l: El } = _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].add(this.Eh | 0, this.El | 0, Eh | 0, El | 0));\n        ({ h: Fh, l: Fl } = _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].add(this.Fh | 0, this.Fl | 0, Fh | 0, Fl | 0));\n        ({ h: Gh, l: Gl } = _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].add(this.Gh | 0, this.Gl | 0, Gh | 0, Gl | 0));\n        ({ h: Hh, l: Hl } = _u64_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].add(this.Hh | 0, this.Hl | 0, Hh | 0, Hl | 0));\n        this.set(Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl);\n    }\n    roundClean() {\n        SHA512_W_H.fill(0);\n        SHA512_W_L.fill(0);\n    }\n    destroy() {\n        this.buffer.fill(0);\n        this.set(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);\n    }\n}\nclass SHA512_224 extends SHA512 {\n    constructor() {\n        super();\n        // h -- high 32 bits, l -- low 32 bits\n        this.Ah = 0x8c3d37c8 | 0;\n        this.Al = 0x19544da2 | 0;\n        this.Bh = 0x73e19966 | 0;\n        this.Bl = 0x89dcd4d6 | 0;\n        this.Ch = 0x1dfab7ae | 0;\n        this.Cl = 0x32ff9c82 | 0;\n        this.Dh = 0x679dd514 | 0;\n        this.Dl = 0x582f9fcf | 0;\n        this.Eh = 0x0f6d2b69 | 0;\n        this.El = 0x7bd44da8 | 0;\n        this.Fh = 0x77e36f73 | 0;\n        this.Fl = 0x04c48942 | 0;\n        this.Gh = 0x3f9d85a8 | 0;\n        this.Gl = 0x6a1d36c8 | 0;\n        this.Hh = 0x1112e6ad | 0;\n        this.Hl = 0x91d692a1 | 0;\n        this.outputLen = 28;\n    }\n}\nclass SHA512_256 extends SHA512 {\n    constructor() {\n        super();\n        // h -- high 32 bits, l -- low 32 bits\n        this.Ah = 0x22312194 | 0;\n        this.Al = 0xfc2bf72c | 0;\n        this.Bh = 0x9f555fa3 | 0;\n        this.Bl = 0xc84c64c2 | 0;\n        this.Ch = 0x2393b86b | 0;\n        this.Cl = 0x6f53b151 | 0;\n        this.Dh = 0x96387719 | 0;\n        this.Dl = 0x5940eabd | 0;\n        this.Eh = 0x96283ee2 | 0;\n        this.El = 0xa88effe3 | 0;\n        this.Fh = 0xbe5e1e25 | 0;\n        this.Fl = 0x53863992 | 0;\n        this.Gh = 0x2b0199fc | 0;\n        this.Gl = 0x2c85b8aa | 0;\n        this.Hh = 0x0eb72ddc | 0;\n        this.Hl = 0x81c52ca2 | 0;\n        this.outputLen = 32;\n    }\n}\nclass SHA384 extends SHA512 {\n    constructor() {\n        super();\n        // h -- high 32 bits, l -- low 32 bits\n        this.Ah = 0xcbbb9d5d | 0;\n        this.Al = 0xc1059ed8 | 0;\n        this.Bh = 0x629a292a | 0;\n        this.Bl = 0x367cd507 | 0;\n        this.Ch = 0x9159015a | 0;\n        this.Cl = 0x3070dd17 | 0;\n        this.Dh = 0x152fecd8 | 0;\n        this.Dl = 0xf70e5939 | 0;\n        this.Eh = 0x67332667 | 0;\n        this.El = 0xffc00b31 | 0;\n        this.Fh = 0x8eb44a87 | 0;\n        this.Fl = 0x68581511 | 0;\n        this.Gh = 0xdb0c2e0d | 0;\n        this.Gl = 0x64f98fa7 | 0;\n        this.Hh = 0x47b5481d | 0;\n        this.Hl = 0xbefa4fa4 | 0;\n        this.outputLen = 48;\n    }\n}\nconst sha512 = /* @__PURE__ */ (0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.wrapConstructor)(() => new SHA512());\nconst sha512_224 = /* @__PURE__ */ (0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.wrapConstructor)(() => new SHA512_224());\nconst sha512_256 = /* @__PURE__ */ (0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.wrapConstructor)(() => new SHA512_256());\nconst sha384 = /* @__PURE__ */ (0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.wrapConstructor)(() => new SHA384());\n//# sourceMappingURL=sha512.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvcGtpanMvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL3NoYTUxMi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFrQztBQUNOO0FBQ2lCO0FBQzdDO0FBQ0E7QUFDQSxzREFBc0QscURBQVM7QUFDL0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ08scUJBQXFCLDBDQUFNO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGlFQUFpRTtBQUNqRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLFFBQVE7QUFDaEM7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLFFBQVE7QUFDakM7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHNEQUFVLGtCQUFrQixzREFBVSxrQkFBa0IscURBQVM7QUFDekYsd0JBQXdCLHNEQUFVLGtCQUFrQixzREFBVSxrQkFBa0IscURBQVM7QUFDekY7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHNEQUFVLGlCQUFpQixzREFBVSxpQkFBaUIscURBQVM7QUFDdkYsd0JBQXdCLHNEQUFVLGlCQUFpQixzREFBVSxpQkFBaUIscURBQVM7QUFDdkY7QUFDQSx5QkFBeUIscURBQVM7QUFDbEMseUJBQXlCLHFEQUFTO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBLGNBQWMsaUVBQWlFO0FBQy9FO0FBQ0Esd0JBQXdCLFFBQVE7QUFDaEM7QUFDQSw0QkFBNEIsc0RBQVUsZUFBZSxzREFBVSxlQUFlLHNEQUFVO0FBQ3hGLDRCQUE0QixzREFBVSxlQUFlLHNEQUFVLGVBQWUsc0RBQVU7QUFDeEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixxREFBUztBQUNsQyx3QkFBd0IscURBQVM7QUFDakM7QUFDQTtBQUNBLDRCQUE0QixzREFBVSxlQUFlLHNEQUFVLGVBQWUsc0RBQVU7QUFDeEYsNEJBQTRCLHNEQUFVLGVBQWUsc0RBQVUsZUFBZSxzREFBVTtBQUN4RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxlQUFlLEVBQUUsbURBQU87QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHFEQUFTO0FBQ2pDLGlCQUFpQixxREFBUztBQUMxQjtBQUNBO0FBQ0E7QUFDQSxXQUFXLGVBQWUsRUFBRSxtREFBTztBQUNuQyxXQUFXLGVBQWUsRUFBRSxtREFBTztBQUNuQyxXQUFXLGVBQWUsRUFBRSxtREFBTztBQUNuQyxXQUFXLGVBQWUsRUFBRSxtREFBTztBQUNuQyxXQUFXLGVBQWUsRUFBRSxtREFBTztBQUNuQyxXQUFXLGVBQWUsRUFBRSxtREFBTztBQUNuQyxXQUFXLGVBQWUsRUFBRSxtREFBTztBQUNuQyxXQUFXLGVBQWUsRUFBRSxtREFBTztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ08sK0JBQStCLDBEQUFlO0FBQzlDLG1DQUFtQywwREFBZTtBQUNsRCxtQ0FBbUMsMERBQWU7QUFDbEQsK0JBQStCLDBEQUFlO0FBQ3JEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VsZi13b3Jrc2hvcC8uL25vZGVfbW9kdWxlcy9wa2lqcy9ub2RlX21vZHVsZXMvQG5vYmxlL2hhc2hlcy9lc20vc2hhNTEyLmpzPzQ0ODIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSGFzaE1EIH0gZnJvbSAnLi9fbWQuanMnO1xuaW1wb3J0IHU2NCBmcm9tICcuL191NjQuanMnO1xuaW1wb3J0IHsgd3JhcENvbnN0cnVjdG9yIH0gZnJvbSAnLi91dGlscy5qcyc7XG4vLyBSb3VuZCBjb250YW50cyAoZmlyc3QgMzIgYml0cyBvZiB0aGUgZnJhY3Rpb25hbCBwYXJ0cyBvZiB0aGUgY3ViZSByb290cyBvZiB0aGUgZmlyc3QgODAgcHJpbWVzIDIuLjQwOSk6XG4vLyBwcmV0dGllci1pZ25vcmVcbmNvbnN0IFtTSEE1MTJfS2gsIFNIQTUxMl9LbF0gPSAvKiBAX19QVVJFX18gKi8gKCgpID0+IHU2NC5zcGxpdChbXG4gICAgJzB4NDI4YTJmOThkNzI4YWUyMicsICcweDcxMzc0NDkxMjNlZjY1Y2QnLCAnMHhiNWMwZmJjZmVjNGQzYjJmJywgJzB4ZTliNWRiYTU4MTg5ZGJiYycsXG4gICAgJzB4Mzk1NmMyNWJmMzQ4YjUzOCcsICcweDU5ZjExMWYxYjYwNWQwMTknLCAnMHg5MjNmODJhNGFmMTk0ZjliJywgJzB4YWIxYzVlZDVkYTZkODExOCcsXG4gICAgJzB4ZDgwN2FhOThhMzAzMDI0MicsICcweDEyODM1YjAxNDU3MDZmYmUnLCAnMHgyNDMxODViZTRlZTRiMjhjJywgJzB4NTUwYzdkYzNkNWZmYjRlMicsXG4gICAgJzB4NzJiZTVkNzRmMjdiODk2ZicsICcweDgwZGViMWZlM2IxNjk2YjEnLCAnMHg5YmRjMDZhNzI1YzcxMjM1JywgJzB4YzE5YmYxNzRjZjY5MjY5NCcsXG4gICAgJzB4ZTQ5YjY5YzE5ZWYxNGFkMicsICcweGVmYmU0Nzg2Mzg0ZjI1ZTMnLCAnMHgwZmMxOWRjNjhiOGNkNWI1JywgJzB4MjQwY2ExY2M3N2FjOWM2NScsXG4gICAgJzB4MmRlOTJjNmY1OTJiMDI3NScsICcweDRhNzQ4NGFhNmVhNmU0ODMnLCAnMHg1Y2IwYTlkY2JkNDFmYmQ0JywgJzB4NzZmOTg4ZGE4MzExNTNiNScsXG4gICAgJzB4OTgzZTUxNTJlZTY2ZGZhYicsICcweGE4MzFjNjZkMmRiNDMyMTAnLCAnMHhiMDAzMjdjODk4ZmIyMTNmJywgJzB4YmY1OTdmYzdiZWVmMGVlNCcsXG4gICAgJzB4YzZlMDBiZjMzZGE4OGZjMicsICcweGQ1YTc5MTQ3OTMwYWE3MjUnLCAnMHgwNmNhNjM1MWUwMDM4MjZmJywgJzB4MTQyOTI5NjcwYTBlNmU3MCcsXG4gICAgJzB4MjdiNzBhODU0NmQyMmZmYycsICcweDJlMWIyMTM4NWMyNmM5MjYnLCAnMHg0ZDJjNmRmYzVhYzQyYWVkJywgJzB4NTMzODBkMTM5ZDk1YjNkZicsXG4gICAgJzB4NjUwYTczNTQ4YmFmNjNkZScsICcweDc2NmEwYWJiM2M3N2IyYTgnLCAnMHg4MWMyYzkyZTQ3ZWRhZWU2JywgJzB4OTI3MjJjODUxNDgyMzUzYicsXG4gICAgJzB4YTJiZmU4YTE0Y2YxMDM2NCcsICcweGE4MWE2NjRiYmM0MjMwMDEnLCAnMHhjMjRiOGI3MGQwZjg5NzkxJywgJzB4Yzc2YzUxYTMwNjU0YmUzMCcsXG4gICAgJzB4ZDE5MmU4MTlkNmVmNTIxOCcsICcweGQ2OTkwNjI0NTU2NWE5MTAnLCAnMHhmNDBlMzU4NTU3NzEyMDJhJywgJzB4MTA2YWEwNzAzMmJiZDFiOCcsXG4gICAgJzB4MTlhNGMxMTZiOGQyZDBjOCcsICcweDFlMzc2YzA4NTE0MWFiNTMnLCAnMHgyNzQ4Nzc0Y2RmOGVlYjk5JywgJzB4MzRiMGJjYjVlMTliNDhhOCcsXG4gICAgJzB4MzkxYzBjYjNjNWM5NWE2MycsICcweDRlZDhhYTRhZTM0MThhY2InLCAnMHg1YjljY2E0Zjc3NjNlMzczJywgJzB4NjgyZTZmZjNkNmIyYjhhMycsXG4gICAgJzB4NzQ4ZjgyZWU1ZGVmYjJmYycsICcweDc4YTU2MzZmNDMxNzJmNjAnLCAnMHg4NGM4NzgxNGExZjBhYjcyJywgJzB4OGNjNzAyMDgxYTY0MzllYycsXG4gICAgJzB4OTBiZWZmZmEyMzYzMWUyOCcsICcweGE0NTA2Y2ViZGU4MmJkZTknLCAnMHhiZWY5YTNmN2IyYzY3OTE1JywgJzB4YzY3MTc4ZjJlMzcyNTMyYicsXG4gICAgJzB4Y2EyNzNlY2VlYTI2NjE5YycsICcweGQxODZiOGM3MjFjMGMyMDcnLCAnMHhlYWRhN2RkNmNkZTBlYjFlJywgJzB4ZjU3ZDRmN2ZlZTZlZDE3OCcsXG4gICAgJzB4MDZmMDY3YWE3MjE3NmZiYScsICcweDBhNjM3ZGM1YTJjODk4YTYnLCAnMHgxMTNmOTgwNGJlZjkwZGFlJywgJzB4MWI3MTBiMzUxMzFjNDcxYicsXG4gICAgJzB4MjhkYjc3ZjUyMzA0N2Q4NCcsICcweDMyY2FhYjdiNDBjNzI0OTMnLCAnMHgzYzllYmUwYTE1YzliZWJjJywgJzB4NDMxZDY3YzQ5YzEwMGQ0YycsXG4gICAgJzB4NGNjNWQ0YmVjYjNlNDJiNicsICcweDU5N2YyOTljZmM2NTdlMmEnLCAnMHg1ZmNiNmZhYjNhZDZmYWVjJywgJzB4NmM0NDE5OGM0YTQ3NTgxNydcbl0ubWFwKG4gPT4gQmlnSW50KG4pKSkpKCk7XG4vLyBUZW1wb3JhcnkgYnVmZmVyLCBub3QgdXNlZCB0byBzdG9yZSBhbnl0aGluZyBiZXR3ZWVuIHJ1bnNcbmNvbnN0IFNIQTUxMl9XX0ggPSAvKiBAX19QVVJFX18gKi8gbmV3IFVpbnQzMkFycmF5KDgwKTtcbmNvbnN0IFNIQTUxMl9XX0wgPSAvKiBAX19QVVJFX18gKi8gbmV3IFVpbnQzMkFycmF5KDgwKTtcbmV4cG9ydCBjbGFzcyBTSEE1MTIgZXh0ZW5kcyBIYXNoTUQge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigxMjgsIDY0LCAxNiwgZmFsc2UpO1xuICAgICAgICAvLyBXZSBjYW5ub3QgdXNlIGFycmF5IGhlcmUgc2luY2UgYXJyYXkgYWxsb3dzIGluZGV4aW5nIGJ5IHZhcmlhYmxlIHdoaWNoIG1lYW5zIG9wdGltaXplci9jb21waWxlciBjYW5ub3QgdXNlIHJlZ2lzdGVycy5cbiAgICAgICAgLy8gQWxzbyBsb29rcyBjbGVhbmVyIGFuZCBlYXNpZXIgdG8gdmVyaWZ5IHdpdGggc3BlYy5cbiAgICAgICAgLy8gSW5pdGlhbCBzdGF0ZSAoZmlyc3QgMzIgYml0cyBvZiB0aGUgZnJhY3Rpb25hbCBwYXJ0cyBvZiB0aGUgc3F1YXJlIHJvb3RzIG9mIHRoZSBmaXJzdCA4IHByaW1lcyAyLi4xOSk6XG4gICAgICAgIC8vIGggLS0gaGlnaCAzMiBiaXRzLCBsIC0tIGxvdyAzMiBiaXRzXG4gICAgICAgIHRoaXMuQWggPSAweDZhMDllNjY3IHwgMDtcbiAgICAgICAgdGhpcy5BbCA9IDB4ZjNiY2M5MDggfCAwO1xuICAgICAgICB0aGlzLkJoID0gMHhiYjY3YWU4NSB8IDA7XG4gICAgICAgIHRoaXMuQmwgPSAweDg0Y2FhNzNiIHwgMDtcbiAgICAgICAgdGhpcy5DaCA9IDB4M2M2ZWYzNzIgfCAwO1xuICAgICAgICB0aGlzLkNsID0gMHhmZTk0ZjgyYiB8IDA7XG4gICAgICAgIHRoaXMuRGggPSAweGE1NGZmNTNhIHwgMDtcbiAgICAgICAgdGhpcy5EbCA9IDB4NWYxZDM2ZjEgfCAwO1xuICAgICAgICB0aGlzLkVoID0gMHg1MTBlNTI3ZiB8IDA7XG4gICAgICAgIHRoaXMuRWwgPSAweGFkZTY4MmQxIHwgMDtcbiAgICAgICAgdGhpcy5GaCA9IDB4OWIwNTY4OGMgfCAwO1xuICAgICAgICB0aGlzLkZsID0gMHgyYjNlNmMxZiB8IDA7XG4gICAgICAgIHRoaXMuR2ggPSAweDFmODNkOWFiIHwgMDtcbiAgICAgICAgdGhpcy5HbCA9IDB4ZmI0MWJkNmIgfCAwO1xuICAgICAgICB0aGlzLkhoID0gMHg1YmUwY2QxOSB8IDA7XG4gICAgICAgIHRoaXMuSGwgPSAweDEzN2UyMTc5IHwgMDtcbiAgICB9XG4gICAgLy8gcHJldHRpZXItaWdub3JlXG4gICAgZ2V0KCkge1xuICAgICAgICBjb25zdCB7IEFoLCBBbCwgQmgsIEJsLCBDaCwgQ2wsIERoLCBEbCwgRWgsIEVsLCBGaCwgRmwsIEdoLCBHbCwgSGgsIEhsIH0gPSB0aGlzO1xuICAgICAgICByZXR1cm4gW0FoLCBBbCwgQmgsIEJsLCBDaCwgQ2wsIERoLCBEbCwgRWgsIEVsLCBGaCwgRmwsIEdoLCBHbCwgSGgsIEhsXTtcbiAgICB9XG4gICAgLy8gcHJldHRpZXItaWdub3JlXG4gICAgc2V0KEFoLCBBbCwgQmgsIEJsLCBDaCwgQ2wsIERoLCBEbCwgRWgsIEVsLCBGaCwgRmwsIEdoLCBHbCwgSGgsIEhsKSB7XG4gICAgICAgIHRoaXMuQWggPSBBaCB8IDA7XG4gICAgICAgIHRoaXMuQWwgPSBBbCB8IDA7XG4gICAgICAgIHRoaXMuQmggPSBCaCB8IDA7XG4gICAgICAgIHRoaXMuQmwgPSBCbCB8IDA7XG4gICAgICAgIHRoaXMuQ2ggPSBDaCB8IDA7XG4gICAgICAgIHRoaXMuQ2wgPSBDbCB8IDA7XG4gICAgICAgIHRoaXMuRGggPSBEaCB8IDA7XG4gICAgICAgIHRoaXMuRGwgPSBEbCB8IDA7XG4gICAgICAgIHRoaXMuRWggPSBFaCB8IDA7XG4gICAgICAgIHRoaXMuRWwgPSBFbCB8IDA7XG4gICAgICAgIHRoaXMuRmggPSBGaCB8IDA7XG4gICAgICAgIHRoaXMuRmwgPSBGbCB8IDA7XG4gICAgICAgIHRoaXMuR2ggPSBHaCB8IDA7XG4gICAgICAgIHRoaXMuR2wgPSBHbCB8IDA7XG4gICAgICAgIHRoaXMuSGggPSBIaCB8IDA7XG4gICAgICAgIHRoaXMuSGwgPSBIbCB8IDA7XG4gICAgfVxuICAgIHByb2Nlc3Modmlldywgb2Zmc2V0KSB7XG4gICAgICAgIC8vIEV4dGVuZCB0aGUgZmlyc3QgMTYgd29yZHMgaW50byB0aGUgcmVtYWluaW5nIDY0IHdvcmRzIHdbMTYuLjc5XSBvZiB0aGUgbWVzc2FnZSBzY2hlZHVsZSBhcnJheVxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDE2OyBpKyssIG9mZnNldCArPSA0KSB7XG4gICAgICAgICAgICBTSEE1MTJfV19IW2ldID0gdmlldy5nZXRVaW50MzIob2Zmc2V0KTtcbiAgICAgICAgICAgIFNIQTUxMl9XX0xbaV0gPSB2aWV3LmdldFVpbnQzMigob2Zmc2V0ICs9IDQpKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGxldCBpID0gMTY7IGkgPCA4MDsgaSsrKSB7XG4gICAgICAgICAgICAvLyBzMCA6PSAod1tpLTE1XSByaWdodHJvdGF0ZSAxKSB4b3IgKHdbaS0xNV0gcmlnaHRyb3RhdGUgOCkgeG9yICh3W2ktMTVdIHJpZ2h0c2hpZnQgNylcbiAgICAgICAgICAgIGNvbnN0IFcxNWggPSBTSEE1MTJfV19IW2kgLSAxNV0gfCAwO1xuICAgICAgICAgICAgY29uc3QgVzE1bCA9IFNIQTUxMl9XX0xbaSAtIDE1XSB8IDA7XG4gICAgICAgICAgICBjb25zdCBzMGggPSB1NjQucm90clNIKFcxNWgsIFcxNWwsIDEpIF4gdTY0LnJvdHJTSChXMTVoLCBXMTVsLCA4KSBeIHU2NC5zaHJTSChXMTVoLCBXMTVsLCA3KTtcbiAgICAgICAgICAgIGNvbnN0IHMwbCA9IHU2NC5yb3RyU0woVzE1aCwgVzE1bCwgMSkgXiB1NjQucm90clNMKFcxNWgsIFcxNWwsIDgpIF4gdTY0LnNoclNMKFcxNWgsIFcxNWwsIDcpO1xuICAgICAgICAgICAgLy8gczEgOj0gKHdbaS0yXSByaWdodHJvdGF0ZSAxOSkgeG9yICh3W2ktMl0gcmlnaHRyb3RhdGUgNjEpIHhvciAod1tpLTJdIHJpZ2h0c2hpZnQgNilcbiAgICAgICAgICAgIGNvbnN0IFcyaCA9IFNIQTUxMl9XX0hbaSAtIDJdIHwgMDtcbiAgICAgICAgICAgIGNvbnN0IFcybCA9IFNIQTUxMl9XX0xbaSAtIDJdIHwgMDtcbiAgICAgICAgICAgIGNvbnN0IHMxaCA9IHU2NC5yb3RyU0goVzJoLCBXMmwsIDE5KSBeIHU2NC5yb3RyQkgoVzJoLCBXMmwsIDYxKSBeIHU2NC5zaHJTSChXMmgsIFcybCwgNik7XG4gICAgICAgICAgICBjb25zdCBzMWwgPSB1NjQucm90clNMKFcyaCwgVzJsLCAxOSkgXiB1NjQucm90ckJMKFcyaCwgVzJsLCA2MSkgXiB1NjQuc2hyU0woVzJoLCBXMmwsIDYpO1xuICAgICAgICAgICAgLy8gU0hBMjU2X1dbaV0gPSBzMCArIHMxICsgU0hBMjU2X1dbaSAtIDddICsgU0hBMjU2X1dbaSAtIDE2XTtcbiAgICAgICAgICAgIGNvbnN0IFNVTWwgPSB1NjQuYWRkNEwoczBsLCBzMWwsIFNIQTUxMl9XX0xbaSAtIDddLCBTSEE1MTJfV19MW2kgLSAxNl0pO1xuICAgICAgICAgICAgY29uc3QgU1VNaCA9IHU2NC5hZGQ0SChTVU1sLCBzMGgsIHMxaCwgU0hBNTEyX1dfSFtpIC0gN10sIFNIQTUxMl9XX0hbaSAtIDE2XSk7XG4gICAgICAgICAgICBTSEE1MTJfV19IW2ldID0gU1VNaCB8IDA7XG4gICAgICAgICAgICBTSEE1MTJfV19MW2ldID0gU1VNbCB8IDA7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHsgQWgsIEFsLCBCaCwgQmwsIENoLCBDbCwgRGgsIERsLCBFaCwgRWwsIEZoLCBGbCwgR2gsIEdsLCBIaCwgSGwgfSA9IHRoaXM7XG4gICAgICAgIC8vIENvbXByZXNzaW9uIGZ1bmN0aW9uIG1haW4gbG9vcCwgODAgcm91bmRzXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgODA7IGkrKykge1xuICAgICAgICAgICAgLy8gUzEgOj0gKGUgcmlnaHRyb3RhdGUgMTQpIHhvciAoZSByaWdodHJvdGF0ZSAxOCkgeG9yIChlIHJpZ2h0cm90YXRlIDQxKVxuICAgICAgICAgICAgY29uc3Qgc2lnbWExaCA9IHU2NC5yb3RyU0goRWgsIEVsLCAxNCkgXiB1NjQucm90clNIKEVoLCBFbCwgMTgpIF4gdTY0LnJvdHJCSChFaCwgRWwsIDQxKTtcbiAgICAgICAgICAgIGNvbnN0IHNpZ21hMWwgPSB1NjQucm90clNMKEVoLCBFbCwgMTQpIF4gdTY0LnJvdHJTTChFaCwgRWwsIDE4KSBeIHU2NC5yb3RyQkwoRWgsIEVsLCA0MSk7XG4gICAgICAgICAgICAvL2NvbnN0IFQxID0gKEggKyBzaWdtYTEgKyBDaGkoRSwgRiwgRykgKyBTSEEyNTZfS1tpXSArIFNIQTI1Nl9XW2ldKSB8IDA7XG4gICAgICAgICAgICBjb25zdCBDSEloID0gKEVoICYgRmgpIF4gKH5FaCAmIEdoKTtcbiAgICAgICAgICAgIGNvbnN0IENISWwgPSAoRWwgJiBGbCkgXiAofkVsICYgR2wpO1xuICAgICAgICAgICAgLy8gVDEgPSBIICsgc2lnbWExICsgQ2hpKEUsIEYsIEcpICsgU0hBNTEyX0tbaV0gKyBTSEE1MTJfV1tpXVxuICAgICAgICAgICAgLy8gcHJldHRpZXItaWdub3JlXG4gICAgICAgICAgICBjb25zdCBUMWxsID0gdTY0LmFkZDVMKEhsLCBzaWdtYTFsLCBDSElsLCBTSEE1MTJfS2xbaV0sIFNIQTUxMl9XX0xbaV0pO1xuICAgICAgICAgICAgY29uc3QgVDFoID0gdTY0LmFkZDVIKFQxbGwsIEhoLCBzaWdtYTFoLCBDSEloLCBTSEE1MTJfS2hbaV0sIFNIQTUxMl9XX0hbaV0pO1xuICAgICAgICAgICAgY29uc3QgVDFsID0gVDFsbCB8IDA7XG4gICAgICAgICAgICAvLyBTMCA6PSAoYSByaWdodHJvdGF0ZSAyOCkgeG9yIChhIHJpZ2h0cm90YXRlIDM0KSB4b3IgKGEgcmlnaHRyb3RhdGUgMzkpXG4gICAgICAgICAgICBjb25zdCBzaWdtYTBoID0gdTY0LnJvdHJTSChBaCwgQWwsIDI4KSBeIHU2NC5yb3RyQkgoQWgsIEFsLCAzNCkgXiB1NjQucm90ckJIKEFoLCBBbCwgMzkpO1xuICAgICAgICAgICAgY29uc3Qgc2lnbWEwbCA9IHU2NC5yb3RyU0woQWgsIEFsLCAyOCkgXiB1NjQucm90ckJMKEFoLCBBbCwgMzQpIF4gdTY0LnJvdHJCTChBaCwgQWwsIDM5KTtcbiAgICAgICAgICAgIGNvbnN0IE1BSmggPSAoQWggJiBCaCkgXiAoQWggJiBDaCkgXiAoQmggJiBDaCk7XG4gICAgICAgICAgICBjb25zdCBNQUpsID0gKEFsICYgQmwpIF4gKEFsICYgQ2wpIF4gKEJsICYgQ2wpO1xuICAgICAgICAgICAgSGggPSBHaCB8IDA7XG4gICAgICAgICAgICBIbCA9IEdsIHwgMDtcbiAgICAgICAgICAgIEdoID0gRmggfCAwO1xuICAgICAgICAgICAgR2wgPSBGbCB8IDA7XG4gICAgICAgICAgICBGaCA9IEVoIHwgMDtcbiAgICAgICAgICAgIEZsID0gRWwgfCAwO1xuICAgICAgICAgICAgKHsgaDogRWgsIGw6IEVsIH0gPSB1NjQuYWRkKERoIHwgMCwgRGwgfCAwLCBUMWggfCAwLCBUMWwgfCAwKSk7XG4gICAgICAgICAgICBEaCA9IENoIHwgMDtcbiAgICAgICAgICAgIERsID0gQ2wgfCAwO1xuICAgICAgICAgICAgQ2ggPSBCaCB8IDA7XG4gICAgICAgICAgICBDbCA9IEJsIHwgMDtcbiAgICAgICAgICAgIEJoID0gQWggfCAwO1xuICAgICAgICAgICAgQmwgPSBBbCB8IDA7XG4gICAgICAgICAgICBjb25zdCBBbGwgPSB1NjQuYWRkM0woVDFsLCBzaWdtYTBsLCBNQUpsKTtcbiAgICAgICAgICAgIEFoID0gdTY0LmFkZDNIKEFsbCwgVDFoLCBzaWdtYTBoLCBNQUpoKTtcbiAgICAgICAgICAgIEFsID0gQWxsIHwgMDtcbiAgICAgICAgfVxuICAgICAgICAvLyBBZGQgdGhlIGNvbXByZXNzZWQgY2h1bmsgdG8gdGhlIGN1cnJlbnQgaGFzaCB2YWx1ZVxuICAgICAgICAoeyBoOiBBaCwgbDogQWwgfSA9IHU2NC5hZGQodGhpcy5BaCB8IDAsIHRoaXMuQWwgfCAwLCBBaCB8IDAsIEFsIHwgMCkpO1xuICAgICAgICAoeyBoOiBCaCwgbDogQmwgfSA9IHU2NC5hZGQodGhpcy5CaCB8IDAsIHRoaXMuQmwgfCAwLCBCaCB8IDAsIEJsIHwgMCkpO1xuICAgICAgICAoeyBoOiBDaCwgbDogQ2wgfSA9IHU2NC5hZGQodGhpcy5DaCB8IDAsIHRoaXMuQ2wgfCAwLCBDaCB8IDAsIENsIHwgMCkpO1xuICAgICAgICAoeyBoOiBEaCwgbDogRGwgfSA9IHU2NC5hZGQodGhpcy5EaCB8IDAsIHRoaXMuRGwgfCAwLCBEaCB8IDAsIERsIHwgMCkpO1xuICAgICAgICAoeyBoOiBFaCwgbDogRWwgfSA9IHU2NC5hZGQodGhpcy5FaCB8IDAsIHRoaXMuRWwgfCAwLCBFaCB8IDAsIEVsIHwgMCkpO1xuICAgICAgICAoeyBoOiBGaCwgbDogRmwgfSA9IHU2NC5hZGQodGhpcy5GaCB8IDAsIHRoaXMuRmwgfCAwLCBGaCB8IDAsIEZsIHwgMCkpO1xuICAgICAgICAoeyBoOiBHaCwgbDogR2wgfSA9IHU2NC5hZGQodGhpcy5HaCB8IDAsIHRoaXMuR2wgfCAwLCBHaCB8IDAsIEdsIHwgMCkpO1xuICAgICAgICAoeyBoOiBIaCwgbDogSGwgfSA9IHU2NC5hZGQodGhpcy5IaCB8IDAsIHRoaXMuSGwgfCAwLCBIaCB8IDAsIEhsIHwgMCkpO1xuICAgICAgICB0aGlzLnNldChBaCwgQWwsIEJoLCBCbCwgQ2gsIENsLCBEaCwgRGwsIEVoLCBFbCwgRmgsIEZsLCBHaCwgR2wsIEhoLCBIbCk7XG4gICAgfVxuICAgIHJvdW5kQ2xlYW4oKSB7XG4gICAgICAgIFNIQTUxMl9XX0guZmlsbCgwKTtcbiAgICAgICAgU0hBNTEyX1dfTC5maWxsKDApO1xuICAgIH1cbiAgICBkZXN0cm95KCkge1xuICAgICAgICB0aGlzLmJ1ZmZlci5maWxsKDApO1xuICAgICAgICB0aGlzLnNldCgwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwKTtcbiAgICB9XG59XG5jbGFzcyBTSEE1MTJfMjI0IGV4dGVuZHMgU0hBNTEyIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgLy8gaCAtLSBoaWdoIDMyIGJpdHMsIGwgLS0gbG93IDMyIGJpdHNcbiAgICAgICAgdGhpcy5BaCA9IDB4OGMzZDM3YzggfCAwO1xuICAgICAgICB0aGlzLkFsID0gMHgxOTU0NGRhMiB8IDA7XG4gICAgICAgIHRoaXMuQmggPSAweDczZTE5OTY2IHwgMDtcbiAgICAgICAgdGhpcy5CbCA9IDB4ODlkY2Q0ZDYgfCAwO1xuICAgICAgICB0aGlzLkNoID0gMHgxZGZhYjdhZSB8IDA7XG4gICAgICAgIHRoaXMuQ2wgPSAweDMyZmY5YzgyIHwgMDtcbiAgICAgICAgdGhpcy5EaCA9IDB4Njc5ZGQ1MTQgfCAwO1xuICAgICAgICB0aGlzLkRsID0gMHg1ODJmOWZjZiB8IDA7XG4gICAgICAgIHRoaXMuRWggPSAweDBmNmQyYjY5IHwgMDtcbiAgICAgICAgdGhpcy5FbCA9IDB4N2JkNDRkYTggfCAwO1xuICAgICAgICB0aGlzLkZoID0gMHg3N2UzNmY3MyB8IDA7XG4gICAgICAgIHRoaXMuRmwgPSAweDA0YzQ4OTQyIHwgMDtcbiAgICAgICAgdGhpcy5HaCA9IDB4M2Y5ZDg1YTggfCAwO1xuICAgICAgICB0aGlzLkdsID0gMHg2YTFkMzZjOCB8IDA7XG4gICAgICAgIHRoaXMuSGggPSAweDExMTJlNmFkIHwgMDtcbiAgICAgICAgdGhpcy5IbCA9IDB4OTFkNjkyYTEgfCAwO1xuICAgICAgICB0aGlzLm91dHB1dExlbiA9IDI4O1xuICAgIH1cbn1cbmNsYXNzIFNIQTUxMl8yNTYgZXh0ZW5kcyBTSEE1MTIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICAvLyBoIC0tIGhpZ2ggMzIgYml0cywgbCAtLSBsb3cgMzIgYml0c1xuICAgICAgICB0aGlzLkFoID0gMHgyMjMxMjE5NCB8IDA7XG4gICAgICAgIHRoaXMuQWwgPSAweGZjMmJmNzJjIHwgMDtcbiAgICAgICAgdGhpcy5CaCA9IDB4OWY1NTVmYTMgfCAwO1xuICAgICAgICB0aGlzLkJsID0gMHhjODRjNjRjMiB8IDA7XG4gICAgICAgIHRoaXMuQ2ggPSAweDIzOTNiODZiIHwgMDtcbiAgICAgICAgdGhpcy5DbCA9IDB4NmY1M2IxNTEgfCAwO1xuICAgICAgICB0aGlzLkRoID0gMHg5NjM4NzcxOSB8IDA7XG4gICAgICAgIHRoaXMuRGwgPSAweDU5NDBlYWJkIHwgMDtcbiAgICAgICAgdGhpcy5FaCA9IDB4OTYyODNlZTIgfCAwO1xuICAgICAgICB0aGlzLkVsID0gMHhhODhlZmZlMyB8IDA7XG4gICAgICAgIHRoaXMuRmggPSAweGJlNWUxZTI1IHwgMDtcbiAgICAgICAgdGhpcy5GbCA9IDB4NTM4NjM5OTIgfCAwO1xuICAgICAgICB0aGlzLkdoID0gMHgyYjAxOTlmYyB8IDA7XG4gICAgICAgIHRoaXMuR2wgPSAweDJjODViOGFhIHwgMDtcbiAgICAgICAgdGhpcy5IaCA9IDB4MGViNzJkZGMgfCAwO1xuICAgICAgICB0aGlzLkhsID0gMHg4MWM1MmNhMiB8IDA7XG4gICAgICAgIHRoaXMub3V0cHV0TGVuID0gMzI7XG4gICAgfVxufVxuY2xhc3MgU0hBMzg0IGV4dGVuZHMgU0hBNTEyIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgLy8gaCAtLSBoaWdoIDMyIGJpdHMsIGwgLS0gbG93IDMyIGJpdHNcbiAgICAgICAgdGhpcy5BaCA9IDB4Y2JiYjlkNWQgfCAwO1xuICAgICAgICB0aGlzLkFsID0gMHhjMTA1OWVkOCB8IDA7XG4gICAgICAgIHRoaXMuQmggPSAweDYyOWEyOTJhIHwgMDtcbiAgICAgICAgdGhpcy5CbCA9IDB4MzY3Y2Q1MDcgfCAwO1xuICAgICAgICB0aGlzLkNoID0gMHg5MTU5MDE1YSB8IDA7XG4gICAgICAgIHRoaXMuQ2wgPSAweDMwNzBkZDE3IHwgMDtcbiAgICAgICAgdGhpcy5EaCA9IDB4MTUyZmVjZDggfCAwO1xuICAgICAgICB0aGlzLkRsID0gMHhmNzBlNTkzOSB8IDA7XG4gICAgICAgIHRoaXMuRWggPSAweDY3MzMyNjY3IHwgMDtcbiAgICAgICAgdGhpcy5FbCA9IDB4ZmZjMDBiMzEgfCAwO1xuICAgICAgICB0aGlzLkZoID0gMHg4ZWI0NGE4NyB8IDA7XG4gICAgICAgIHRoaXMuRmwgPSAweDY4NTgxNTExIHwgMDtcbiAgICAgICAgdGhpcy5HaCA9IDB4ZGIwYzJlMGQgfCAwO1xuICAgICAgICB0aGlzLkdsID0gMHg2NGY5OGZhNyB8IDA7XG4gICAgICAgIHRoaXMuSGggPSAweDQ3YjU0ODFkIHwgMDtcbiAgICAgICAgdGhpcy5IbCA9IDB4YmVmYTRmYTQgfCAwO1xuICAgICAgICB0aGlzLm91dHB1dExlbiA9IDQ4O1xuICAgIH1cbn1cbmV4cG9ydCBjb25zdCBzaGE1MTIgPSAvKiBAX19QVVJFX18gKi8gd3JhcENvbnN0cnVjdG9yKCgpID0+IG5ldyBTSEE1MTIoKSk7XG5leHBvcnQgY29uc3Qgc2hhNTEyXzIyNCA9IC8qIEBfX1BVUkVfXyAqLyB3cmFwQ29uc3RydWN0b3IoKCkgPT4gbmV3IFNIQTUxMl8yMjQoKSk7XG5leHBvcnQgY29uc3Qgc2hhNTEyXzI1NiA9IC8qIEBfX1BVUkVfXyAqLyB3cmFwQ29uc3RydWN0b3IoKCkgPT4gbmV3IFNIQTUxMl8yNTYoKSk7XG5leHBvcnQgY29uc3Qgc2hhMzg0ID0gLyogQF9fUFVSRV9fICovIHdyYXBDb25zdHJ1Y3RvcigoKSA9PiBuZXcgU0hBMzg0KCkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2hhNTEyLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/sha512.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/utils.js":
/*!********************************************************************!*\
  !*** ./node_modules/pkijs/node_modules/@noble/hashes/esm/utils.js ***!
  \********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Hash: () => (/* binding */ Hash),\n/* harmony export */   asyncLoop: () => (/* binding */ asyncLoop),\n/* harmony export */   byteSwap: () => (/* binding */ byteSwap),\n/* harmony export */   byteSwap32: () => (/* binding */ byteSwap32),\n/* harmony export */   byteSwapIfBE: () => (/* binding */ byteSwapIfBE),\n/* harmony export */   bytesToHex: () => (/* binding */ bytesToHex),\n/* harmony export */   checkOpts: () => (/* binding */ checkOpts),\n/* harmony export */   concatBytes: () => (/* binding */ concatBytes),\n/* harmony export */   createView: () => (/* binding */ createView),\n/* harmony export */   hexToBytes: () => (/* binding */ hexToBytes),\n/* harmony export */   isBytes: () => (/* binding */ isBytes),\n/* harmony export */   isLE: () => (/* binding */ isLE),\n/* harmony export */   nextTick: () => (/* binding */ nextTick),\n/* harmony export */   randomBytes: () => (/* binding */ randomBytes),\n/* harmony export */   rotl: () => (/* binding */ rotl),\n/* harmony export */   rotr: () => (/* binding */ rotr),\n/* harmony export */   toBytes: () => (/* binding */ toBytes),\n/* harmony export */   u32: () => (/* binding */ u32),\n/* harmony export */   u8: () => (/* binding */ u8),\n/* harmony export */   utf8ToBytes: () => (/* binding */ utf8ToBytes),\n/* harmony export */   wrapConstructor: () => (/* binding */ wrapConstructor),\n/* harmony export */   wrapConstructorWithOpts: () => (/* binding */ wrapConstructorWithOpts),\n/* harmony export */   wrapXOFConstructorWithOpts: () => (/* binding */ wrapXOFConstructorWithOpts)\n/* harmony export */ });\n/* harmony import */ var _noble_hashes_crypto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @noble/hashes/crypto */ \"(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/cryptoNode.js\");\n/* harmony import */ var _assert_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./_assert.js */ \"(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/_assert.js\");\n/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// We use WebCrypto aka globalThis.crypto, which exists in browsers and node.js 16+.\n// node.js versions earlier than v19 don't declare it in global scope.\n// For node.js, package.json#exports field mapping rewrites import\n// from `crypto` to `cryptoNode`, which imports native module.\n// Makes the utils un-importable in browsers without a bundler.\n// Once node.js 18 is deprecated (2025-04-30), we can just drop the import.\n\n\n// export { isBytes } from './_assert.js';\n// We can't reuse isBytes from _assert, because somehow this causes huge perf issues\nfunction isBytes(a) {\n    return (a instanceof Uint8Array ||\n        (a != null && typeof a === 'object' && a.constructor.name === 'Uint8Array'));\n}\n// Cast array to different type\nconst u8 = (arr) => new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\nconst u32 = (arr) => new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\n// Cast array to view\nconst createView = (arr) => new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n// The rotate right (circular right shift) operation for uint32\nconst rotr = (word, shift) => (word << (32 - shift)) | (word >>> shift);\n// The rotate left (circular left shift) operation for uint32\nconst rotl = (word, shift) => (word << shift) | ((word >>> (32 - shift)) >>> 0);\nconst isLE = new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44;\n// The byte swap operation for uint32\nconst byteSwap = (word) => ((word << 24) & 0xff000000) |\n    ((word << 8) & 0xff0000) |\n    ((word >>> 8) & 0xff00) |\n    ((word >>> 24) & 0xff);\n// Conditionally byte swap if on a big-endian platform\nconst byteSwapIfBE = isLE ? (n) => n : (n) => byteSwap(n);\n// In place byte swap for Uint32Array\nfunction byteSwap32(arr) {\n    for (let i = 0; i < arr.length; i++) {\n        arr[i] = byteSwap(arr[i]);\n    }\n}\n// Array where index 0xf0 (240) is mapped to string 'f0'\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nfunction bytesToHex(bytes) {\n    (0,_assert_js__WEBPACK_IMPORTED_MODULE_0__.bytes)(bytes);\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\n// We use optimized technique to convert hex string to byte array\nconst asciis = { _0: 48, _9: 57, _A: 65, _F: 70, _a: 97, _f: 102 };\nfunction asciiToBase16(char) {\n    if (char >= asciis._0 && char <= asciis._9)\n        return char - asciis._0;\n    if (char >= asciis._A && char <= asciis._F)\n        return char - (asciis._A - 10);\n    if (char >= asciis._a && char <= asciis._f)\n        return char - (asciis._a - 10);\n    return;\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nfunction hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const hl = hex.length;\n    const al = hl / 2;\n    if (hl % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + hl);\n    const array = new Uint8Array(al);\n    for (let ai = 0, hi = 0; ai < al; ai++, hi += 2) {\n        const n1 = asciiToBase16(hex.charCodeAt(hi));\n        const n2 = asciiToBase16(hex.charCodeAt(hi + 1));\n        if (n1 === undefined || n2 === undefined) {\n            const char = hex[hi] + hex[hi + 1];\n            throw new Error('hex string expected, got non-hex character \"' + char + '\" at index ' + hi);\n        }\n        array[ai] = n1 * 16 + n2;\n    }\n    return array;\n}\n// There is no setImmediate in browser and setTimeout is slow.\n// call of async fn will return Promise, which will be fullfiled only on\n// next scheduler queue processing step and this is exactly what we need.\nconst nextTick = async () => { };\n// Returns control to thread each 'tick' ms to avoid blocking\nasync function asyncLoop(iters, tick, cb) {\n    let ts = Date.now();\n    for (let i = 0; i < iters; i++) {\n        cb(i);\n        // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n        const diff = Date.now() - ts;\n        if (diff >= 0 && diff < tick)\n            continue;\n        await nextTick();\n        ts += diff;\n    }\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nfunction utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n/**\n * Normalizes (non-hex) string or Uint8Array to Uint8Array.\n * Warning: when Uint8Array is passed, it would NOT get copied.\n * Keep in mind for future mutable operations.\n */\nfunction toBytes(data) {\n    if (typeof data === 'string')\n        data = utf8ToBytes(data);\n    (0,_assert_js__WEBPACK_IMPORTED_MODULE_0__.bytes)(data);\n    return data;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nfunction concatBytes(...arrays) {\n    let sum = 0;\n    for (let i = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        (0,_assert_js__WEBPACK_IMPORTED_MODULE_0__.bytes)(a);\n        sum += a.length;\n    }\n    const res = new Uint8Array(sum);\n    for (let i = 0, pad = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        res.set(a, pad);\n        pad += a.length;\n    }\n    return res;\n}\n// For runtime check if class implements interface\nclass Hash {\n    // Safe version that clones internal state\n    clone() {\n        return this._cloneInto();\n    }\n}\nconst toStr = {}.toString;\nfunction checkOpts(defaults, opts) {\n    if (opts !== undefined && toStr.call(opts) !== '[object Object]')\n        throw new Error('Options should be object or undefined');\n    const merged = Object.assign(defaults, opts);\n    return merged;\n}\nfunction wrapConstructor(hashCons) {\n    const hashC = (msg) => hashCons().update(toBytes(msg)).digest();\n    const tmp = hashCons();\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = () => hashCons();\n    return hashC;\n}\nfunction wrapConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\nfunction wrapXOFConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\n/**\n * Secure PRNG. Uses `crypto.getRandomValues`, which defers to OS.\n */\nfunction randomBytes(bytesLength = 32) {\n    if (_noble_hashes_crypto__WEBPACK_IMPORTED_MODULE_1__.crypto && typeof _noble_hashes_crypto__WEBPACK_IMPORTED_MODULE_1__.crypto.getRandomValues === 'function') {\n        return _noble_hashes_crypto__WEBPACK_IMPORTED_MODULE_1__.crypto.getRandomValues(new Uint8Array(bytesLength));\n    }\n    throw new Error('crypto.getRandomValues must be defined');\n}\n//# sourceMappingURL=utils.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvcGtpanMvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL3V0aWxzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUM4QztBQUNDO0FBQy9DLFlBQVksVUFBVTtBQUN0QjtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNBO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ0E7QUFDUDtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ087QUFDUCxvQkFBb0IsZ0JBQWdCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLGFBQWE7QUFDeEQ7QUFDQTtBQUNBO0FBQ087QUFDUCxJQUFJLGlEQUFNO0FBQ1Y7QUFDQTtBQUNBLG9CQUFvQixrQkFBa0I7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLFNBQVM7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNBLG9CQUFvQixXQUFXO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQSw0REFBNEQsV0FBVztBQUN2RSwwREFBMEQ7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0EsSUFBSSxpREFBTTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0Esb0JBQW9CLG1CQUFtQjtBQUN2QztBQUNBLFFBQVEsaURBQU07QUFDZDtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsbUJBQW1CO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ1Q7QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1AsUUFBUSx3REFBTSxXQUFXLHdEQUFNO0FBQy9CLGVBQWUsd0RBQU07QUFDckI7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZWxmLXdvcmtzaG9wLy4vbm9kZV9tb2R1bGVzL3BraWpzL25vZGVfbW9kdWxlcy9Abm9ibGUvaGFzaGVzL2VzbS91dGlscy5qcz8wZTEwIl0sInNvdXJjZXNDb250ZW50IjpbIi8qISBub2JsZS1oYXNoZXMgLSBNSVQgTGljZW5zZSAoYykgMjAyMiBQYXVsIE1pbGxlciAocGF1bG1pbGxyLmNvbSkgKi9cbi8vIFdlIHVzZSBXZWJDcnlwdG8gYWthIGdsb2JhbFRoaXMuY3J5cHRvLCB3aGljaCBleGlzdHMgaW4gYnJvd3NlcnMgYW5kIG5vZGUuanMgMTYrLlxuLy8gbm9kZS5qcyB2ZXJzaW9ucyBlYXJsaWVyIHRoYW4gdjE5IGRvbid0IGRlY2xhcmUgaXQgaW4gZ2xvYmFsIHNjb3BlLlxuLy8gRm9yIG5vZGUuanMsIHBhY2thZ2UuanNvbiNleHBvcnRzIGZpZWxkIG1hcHBpbmcgcmV3cml0ZXMgaW1wb3J0XG4vLyBmcm9tIGBjcnlwdG9gIHRvIGBjcnlwdG9Ob2RlYCwgd2hpY2ggaW1wb3J0cyBuYXRpdmUgbW9kdWxlLlxuLy8gTWFrZXMgdGhlIHV0aWxzIHVuLWltcG9ydGFibGUgaW4gYnJvd3NlcnMgd2l0aG91dCBhIGJ1bmRsZXIuXG4vLyBPbmNlIG5vZGUuanMgMTggaXMgZGVwcmVjYXRlZCAoMjAyNS0wNC0zMCksIHdlIGNhbiBqdXN0IGRyb3AgdGhlIGltcG9ydC5cbmltcG9ydCB7IGNyeXB0byB9IGZyb20gJ0Bub2JsZS9oYXNoZXMvY3J5cHRvJztcbmltcG9ydCB7IGJ5dGVzIGFzIGFieXRlcyB9IGZyb20gJy4vX2Fzc2VydC5qcyc7XG4vLyBleHBvcnQgeyBpc0J5dGVzIH0gZnJvbSAnLi9fYXNzZXJ0LmpzJztcbi8vIFdlIGNhbid0IHJldXNlIGlzQnl0ZXMgZnJvbSBfYXNzZXJ0LCBiZWNhdXNlIHNvbWVob3cgdGhpcyBjYXVzZXMgaHVnZSBwZXJmIGlzc3Vlc1xuZXhwb3J0IGZ1bmN0aW9uIGlzQnl0ZXMoYSkge1xuICAgIHJldHVybiAoYSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkgfHxcbiAgICAgICAgKGEgIT0gbnVsbCAmJiB0eXBlb2YgYSA9PT0gJ29iamVjdCcgJiYgYS5jb25zdHJ1Y3Rvci5uYW1lID09PSAnVWludDhBcnJheScpKTtcbn1cbi8vIENhc3QgYXJyYXkgdG8gZGlmZmVyZW50IHR5cGVcbmV4cG9ydCBjb25zdCB1OCA9IChhcnIpID0+IG5ldyBVaW50OEFycmF5KGFyci5idWZmZXIsIGFyci5ieXRlT2Zmc2V0LCBhcnIuYnl0ZUxlbmd0aCk7XG5leHBvcnQgY29uc3QgdTMyID0gKGFycikgPT4gbmV3IFVpbnQzMkFycmF5KGFyci5idWZmZXIsIGFyci5ieXRlT2Zmc2V0LCBNYXRoLmZsb29yKGFyci5ieXRlTGVuZ3RoIC8gNCkpO1xuLy8gQ2FzdCBhcnJheSB0byB2aWV3XG5leHBvcnQgY29uc3QgY3JlYXRlVmlldyA9IChhcnIpID0+IG5ldyBEYXRhVmlldyhhcnIuYnVmZmVyLCBhcnIuYnl0ZU9mZnNldCwgYXJyLmJ5dGVMZW5ndGgpO1xuLy8gVGhlIHJvdGF0ZSByaWdodCAoY2lyY3VsYXIgcmlnaHQgc2hpZnQpIG9wZXJhdGlvbiBmb3IgdWludDMyXG5leHBvcnQgY29uc3Qgcm90ciA9ICh3b3JkLCBzaGlmdCkgPT4gKHdvcmQgPDwgKDMyIC0gc2hpZnQpKSB8ICh3b3JkID4+PiBzaGlmdCk7XG4vLyBUaGUgcm90YXRlIGxlZnQgKGNpcmN1bGFyIGxlZnQgc2hpZnQpIG9wZXJhdGlvbiBmb3IgdWludDMyXG5leHBvcnQgY29uc3Qgcm90bCA9ICh3b3JkLCBzaGlmdCkgPT4gKHdvcmQgPDwgc2hpZnQpIHwgKCh3b3JkID4+PiAoMzIgLSBzaGlmdCkpID4+PiAwKTtcbmV4cG9ydCBjb25zdCBpc0xFID0gbmV3IFVpbnQ4QXJyYXkobmV3IFVpbnQzMkFycmF5KFsweDExMjIzMzQ0XSkuYnVmZmVyKVswXSA9PT0gMHg0NDtcbi8vIFRoZSBieXRlIHN3YXAgb3BlcmF0aW9uIGZvciB1aW50MzJcbmV4cG9ydCBjb25zdCBieXRlU3dhcCA9ICh3b3JkKSA9PiAoKHdvcmQgPDwgMjQpICYgMHhmZjAwMDAwMCkgfFxuICAgICgod29yZCA8PCA4KSAmIDB4ZmYwMDAwKSB8XG4gICAgKCh3b3JkID4+PiA4KSAmIDB4ZmYwMCkgfFxuICAgICgod29yZCA+Pj4gMjQpICYgMHhmZik7XG4vLyBDb25kaXRpb25hbGx5IGJ5dGUgc3dhcCBpZiBvbiBhIGJpZy1lbmRpYW4gcGxhdGZvcm1cbmV4cG9ydCBjb25zdCBieXRlU3dhcElmQkUgPSBpc0xFID8gKG4pID0+IG4gOiAobikgPT4gYnl0ZVN3YXAobik7XG4vLyBJbiBwbGFjZSBieXRlIHN3YXAgZm9yIFVpbnQzMkFycmF5XG5leHBvcnQgZnVuY3Rpb24gYnl0ZVN3YXAzMihhcnIpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykge1xuICAgICAgICBhcnJbaV0gPSBieXRlU3dhcChhcnJbaV0pO1xuICAgIH1cbn1cbi8vIEFycmF5IHdoZXJlIGluZGV4IDB4ZjAgKDI0MCkgaXMgbWFwcGVkIHRvIHN0cmluZyAnZjAnXG5jb25zdCBoZXhlcyA9IC8qIEBfX1BVUkVfXyAqLyBBcnJheS5mcm9tKHsgbGVuZ3RoOiAyNTYgfSwgKF8sIGkpID0+IGkudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsICcwJykpO1xuLyoqXG4gKiBAZXhhbXBsZSBieXRlc1RvSGV4KFVpbnQ4QXJyYXkuZnJvbShbMHhjYSwgMHhmZSwgMHgwMSwgMHgyM10pKSAvLyAnY2FmZTAxMjMnXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBieXRlc1RvSGV4KGJ5dGVzKSB7XG4gICAgYWJ5dGVzKGJ5dGVzKTtcbiAgICAvLyBwcmUtY2FjaGluZyBpbXByb3ZlcyB0aGUgc3BlZWQgNnhcbiAgICBsZXQgaGV4ID0gJyc7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBieXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBoZXggKz0gaGV4ZXNbYnl0ZXNbaV1dO1xuICAgIH1cbiAgICByZXR1cm4gaGV4O1xufVxuLy8gV2UgdXNlIG9wdGltaXplZCB0ZWNobmlxdWUgdG8gY29udmVydCBoZXggc3RyaW5nIHRvIGJ5dGUgYXJyYXlcbmNvbnN0IGFzY2lpcyA9IHsgXzA6IDQ4LCBfOTogNTcsIF9BOiA2NSwgX0Y6IDcwLCBfYTogOTcsIF9mOiAxMDIgfTtcbmZ1bmN0aW9uIGFzY2lpVG9CYXNlMTYoY2hhcikge1xuICAgIGlmIChjaGFyID49IGFzY2lpcy5fMCAmJiBjaGFyIDw9IGFzY2lpcy5fOSlcbiAgICAgICAgcmV0dXJuIGNoYXIgLSBhc2NpaXMuXzA7XG4gICAgaWYgKGNoYXIgPj0gYXNjaWlzLl9BICYmIGNoYXIgPD0gYXNjaWlzLl9GKVxuICAgICAgICByZXR1cm4gY2hhciAtIChhc2NpaXMuX0EgLSAxMCk7XG4gICAgaWYgKGNoYXIgPj0gYXNjaWlzLl9hICYmIGNoYXIgPD0gYXNjaWlzLl9mKVxuICAgICAgICByZXR1cm4gY2hhciAtIChhc2NpaXMuX2EgLSAxMCk7XG4gICAgcmV0dXJuO1xufVxuLyoqXG4gKiBAZXhhbXBsZSBoZXhUb0J5dGVzKCdjYWZlMDEyMycpIC8vIFVpbnQ4QXJyYXkuZnJvbShbMHhjYSwgMHhmZSwgMHgwMSwgMHgyM10pXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBoZXhUb0J5dGVzKGhleCkge1xuICAgIGlmICh0eXBlb2YgaGV4ICE9PSAnc3RyaW5nJylcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdoZXggc3RyaW5nIGV4cGVjdGVkLCBnb3QgJyArIHR5cGVvZiBoZXgpO1xuICAgIGNvbnN0IGhsID0gaGV4Lmxlbmd0aDtcbiAgICBjb25zdCBhbCA9IGhsIC8gMjtcbiAgICBpZiAoaGwgJSAyKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3BhZGRlZCBoZXggc3RyaW5nIGV4cGVjdGVkLCBnb3QgdW5wYWRkZWQgaGV4IG9mIGxlbmd0aCAnICsgaGwpO1xuICAgIGNvbnN0IGFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYWwpO1xuICAgIGZvciAobGV0IGFpID0gMCwgaGkgPSAwOyBhaSA8IGFsOyBhaSsrLCBoaSArPSAyKSB7XG4gICAgICAgIGNvbnN0IG4xID0gYXNjaWlUb0Jhc2UxNihoZXguY2hhckNvZGVBdChoaSkpO1xuICAgICAgICBjb25zdCBuMiA9IGFzY2lpVG9CYXNlMTYoaGV4LmNoYXJDb2RlQXQoaGkgKyAxKSk7XG4gICAgICAgIGlmIChuMSA9PT0gdW5kZWZpbmVkIHx8IG4yID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IGNoYXIgPSBoZXhbaGldICsgaGV4W2hpICsgMV07XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2hleCBzdHJpbmcgZXhwZWN0ZWQsIGdvdCBub24taGV4IGNoYXJhY3RlciBcIicgKyBjaGFyICsgJ1wiIGF0IGluZGV4ICcgKyBoaSk7XG4gICAgICAgIH1cbiAgICAgICAgYXJyYXlbYWldID0gbjEgKiAxNiArIG4yO1xuICAgIH1cbiAgICByZXR1cm4gYXJyYXk7XG59XG4vLyBUaGVyZSBpcyBubyBzZXRJbW1lZGlhdGUgaW4gYnJvd3NlciBhbmQgc2V0VGltZW91dCBpcyBzbG93LlxuLy8gY2FsbCBvZiBhc3luYyBmbiB3aWxsIHJldHVybiBQcm9taXNlLCB3aGljaCB3aWxsIGJlIGZ1bGxmaWxlZCBvbmx5IG9uXG4vLyBuZXh0IHNjaGVkdWxlciBxdWV1ZSBwcm9jZXNzaW5nIHN0ZXAgYW5kIHRoaXMgaXMgZXhhY3RseSB3aGF0IHdlIG5lZWQuXG5leHBvcnQgY29uc3QgbmV4dFRpY2sgPSBhc3luYyAoKSA9PiB7IH07XG4vLyBSZXR1cm5zIGNvbnRyb2wgdG8gdGhyZWFkIGVhY2ggJ3RpY2snIG1zIHRvIGF2b2lkIGJsb2NraW5nXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXN5bmNMb29wKGl0ZXJzLCB0aWNrLCBjYikge1xuICAgIGxldCB0cyA9IERhdGUubm93KCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVyczsgaSsrKSB7XG4gICAgICAgIGNiKGkpO1xuICAgICAgICAvLyBEYXRlLm5vdygpIGlzIG5vdCBtb25vdG9uaWMsIHNvIGluIGNhc2UgaWYgY2xvY2sgZ29lcyBiYWNrd2FyZHMgd2UgcmV0dXJuIHJldHVybiBjb250cm9sIHRvb1xuICAgICAgICBjb25zdCBkaWZmID0gRGF0ZS5ub3coKSAtIHRzO1xuICAgICAgICBpZiAoZGlmZiA+PSAwICYmIGRpZmYgPCB0aWNrKVxuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIGF3YWl0IG5leHRUaWNrKCk7XG4gICAgICAgIHRzICs9IGRpZmY7XG4gICAgfVxufVxuLyoqXG4gKiBAZXhhbXBsZSB1dGY4VG9CeXRlcygnYWJjJykgLy8gbmV3IFVpbnQ4QXJyYXkoWzk3LCA5OCwgOTldKVxuICovXG5leHBvcnQgZnVuY3Rpb24gdXRmOFRvQnl0ZXMoc3RyKSB7XG4gICAgaWYgKHR5cGVvZiBzdHIgIT09ICdzdHJpbmcnKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYHV0ZjhUb0J5dGVzIGV4cGVjdGVkIHN0cmluZywgZ290ICR7dHlwZW9mIHN0cn1gKTtcbiAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkobmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKHN0cikpOyAvLyBodHRwczovL2J1Z3ppbC5sYS8xNjgxODA5XG59XG4vKipcbiAqIE5vcm1hbGl6ZXMgKG5vbi1oZXgpIHN0cmluZyBvciBVaW50OEFycmF5IHRvIFVpbnQ4QXJyYXkuXG4gKiBXYXJuaW5nOiB3aGVuIFVpbnQ4QXJyYXkgaXMgcGFzc2VkLCBpdCB3b3VsZCBOT1QgZ2V0IGNvcGllZC5cbiAqIEtlZXAgaW4gbWluZCBmb3IgZnV0dXJlIG11dGFibGUgb3BlcmF0aW9ucy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRvQnl0ZXMoZGF0YSkge1xuICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ3N0cmluZycpXG4gICAgICAgIGRhdGEgPSB1dGY4VG9CeXRlcyhkYXRhKTtcbiAgICBhYnl0ZXMoZGF0YSk7XG4gICAgcmV0dXJuIGRhdGE7XG59XG4vKipcbiAqIENvcGllcyBzZXZlcmFsIFVpbnQ4QXJyYXlzIGludG8gb25lLlxuICovXG5leHBvcnQgZnVuY3Rpb24gY29uY2F0Qnl0ZXMoLi4uYXJyYXlzKSB7XG4gICAgbGV0IHN1bSA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnJheXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgYSA9IGFycmF5c1tpXTtcbiAgICAgICAgYWJ5dGVzKGEpO1xuICAgICAgICBzdW0gKz0gYS5sZW5ndGg7XG4gICAgfVxuICAgIGNvbnN0IHJlcyA9IG5ldyBVaW50OEFycmF5KHN1bSk7XG4gICAgZm9yIChsZXQgaSA9IDAsIHBhZCA9IDA7IGkgPCBhcnJheXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgYSA9IGFycmF5c1tpXTtcbiAgICAgICAgcmVzLnNldChhLCBwYWQpO1xuICAgICAgICBwYWQgKz0gYS5sZW5ndGg7XG4gICAgfVxuICAgIHJldHVybiByZXM7XG59XG4vLyBGb3IgcnVudGltZSBjaGVjayBpZiBjbGFzcyBpbXBsZW1lbnRzIGludGVyZmFjZVxuZXhwb3J0IGNsYXNzIEhhc2gge1xuICAgIC8vIFNhZmUgdmVyc2lvbiB0aGF0IGNsb25lcyBpbnRlcm5hbCBzdGF0ZVxuICAgIGNsb25lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2xvbmVJbnRvKCk7XG4gICAgfVxufVxuY29uc3QgdG9TdHIgPSB7fS50b1N0cmluZztcbmV4cG9ydCBmdW5jdGlvbiBjaGVja09wdHMoZGVmYXVsdHMsIG9wdHMpIHtcbiAgICBpZiAob3B0cyAhPT0gdW5kZWZpbmVkICYmIHRvU3RyLmNhbGwob3B0cykgIT09ICdbb2JqZWN0IE9iamVjdF0nKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ09wdGlvbnMgc2hvdWxkIGJlIG9iamVjdCBvciB1bmRlZmluZWQnKTtcbiAgICBjb25zdCBtZXJnZWQgPSBPYmplY3QuYXNzaWduKGRlZmF1bHRzLCBvcHRzKTtcbiAgICByZXR1cm4gbWVyZ2VkO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHdyYXBDb25zdHJ1Y3RvcihoYXNoQ29ucykge1xuICAgIGNvbnN0IGhhc2hDID0gKG1zZykgPT4gaGFzaENvbnMoKS51cGRhdGUodG9CeXRlcyhtc2cpKS5kaWdlc3QoKTtcbiAgICBjb25zdCB0bXAgPSBoYXNoQ29ucygpO1xuICAgIGhhc2hDLm91dHB1dExlbiA9IHRtcC5vdXRwdXRMZW47XG4gICAgaGFzaEMuYmxvY2tMZW4gPSB0bXAuYmxvY2tMZW47XG4gICAgaGFzaEMuY3JlYXRlID0gKCkgPT4gaGFzaENvbnMoKTtcbiAgICByZXR1cm4gaGFzaEM7XG59XG5leHBvcnQgZnVuY3Rpb24gd3JhcENvbnN0cnVjdG9yV2l0aE9wdHMoaGFzaENvbnMpIHtcbiAgICBjb25zdCBoYXNoQyA9IChtc2csIG9wdHMpID0+IGhhc2hDb25zKG9wdHMpLnVwZGF0ZSh0b0J5dGVzKG1zZykpLmRpZ2VzdCgpO1xuICAgIGNvbnN0IHRtcCA9IGhhc2hDb25zKHt9KTtcbiAgICBoYXNoQy5vdXRwdXRMZW4gPSB0bXAub3V0cHV0TGVuO1xuICAgIGhhc2hDLmJsb2NrTGVuID0gdG1wLmJsb2NrTGVuO1xuICAgIGhhc2hDLmNyZWF0ZSA9IChvcHRzKSA9PiBoYXNoQ29ucyhvcHRzKTtcbiAgICByZXR1cm4gaGFzaEM7XG59XG5leHBvcnQgZnVuY3Rpb24gd3JhcFhPRkNvbnN0cnVjdG9yV2l0aE9wdHMoaGFzaENvbnMpIHtcbiAgICBjb25zdCBoYXNoQyA9IChtc2csIG9wdHMpID0+IGhhc2hDb25zKG9wdHMpLnVwZGF0ZSh0b0J5dGVzKG1zZykpLmRpZ2VzdCgpO1xuICAgIGNvbnN0IHRtcCA9IGhhc2hDb25zKHt9KTtcbiAgICBoYXNoQy5vdXRwdXRMZW4gPSB0bXAub3V0cHV0TGVuO1xuICAgIGhhc2hDLmJsb2NrTGVuID0gdG1wLmJsb2NrTGVuO1xuICAgIGhhc2hDLmNyZWF0ZSA9IChvcHRzKSA9PiBoYXNoQ29ucyhvcHRzKTtcbiAgICByZXR1cm4gaGFzaEM7XG59XG4vKipcbiAqIFNlY3VyZSBQUk5HLiBVc2VzIGBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzYCwgd2hpY2ggZGVmZXJzIHRvIE9TLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmFuZG9tQnl0ZXMoYnl0ZXNMZW5ndGggPSAzMikge1xuICAgIGlmIChjcnlwdG8gJiYgdHlwZW9mIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgcmV0dXJuIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMobmV3IFVpbnQ4QXJyYXkoYnl0ZXNMZW5ndGgpKTtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKCdjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzIG11c3QgYmUgZGVmaW5lZCcpO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dXRpbHMuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/pkijs/node_modules/@noble/hashes/esm/utils.js\n");

/***/ })

};
;